<HTML><HEAD><TITLE>[Appendix A] A.3 Header Section Format</TITLE><METANAME="DC.title"CONTENT="DNS &amp; BIND"><METANAME="DC.creator"CONTENT="Cricket Liu &amp; Paul Albitz"><METANAME="DC.publisher"CONTENT="O'Reilly &amp; Associates, Inc."><METANAME="DC.date"CONTENT="1999-01-06T18:45:19Z"><METANAME="DC.type"CONTENT="Text.Monograph"><METANAME="DC.format"CONTENT="text/html"SCHEME="MIME"><METANAME="DC.source"CONTENT="1-56592-512-2"SCHEME="ISBN"><METANAME="DC.language"CONTENT="en-US"><METANAME="generator"CONTENT="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><LINKREV="made"HREF="mailto:online-books@oreilly.com"TITLE="Online Books Comments"><LINKREL="up"HREF="appa_01.htm"TITLE="A. DNS Message Format and Resource Records"><LINKREL="prev"HREF="appa_02.htm"TITLE="A.2 DNS Message"><LINKREL="next"HREF="appa_04.htm"TITLE="A.4 Resource Record Data"></HEAD><BODYBGCOLOR="#FFFFFF"TEXT="#000000"><DIVCLASS="htmlnav"><H1><IMGSRC="gifs/smbanner.gif"ALT="DNS &amp; BIND"USEMAP="#srchmap"BORDER="0"></H1><MAPNAME="srchmap"><AREASHAPE="RECT"COORDS="0,0,466,65"HREF="index.htm"ALT="DNS &amp; BIND"><AREASHAPE="RECT"COORDS="467,0,514,18"HREF="../search/dsrch.htm"ALT="Search this book"></MAP><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="appa_02.htm"TITLE="A.2 DNS Message"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: A.2 DNS Message"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><B><FONTFACE="ARIEL,HELVETICA,HELV,SANSERIF"SIZE="-1">Appendix A<BR>DNS Message Format and ResourceRecords</FONT></B></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="appa_04.htm"TITLE="A.4 Resource Record Data"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: A.4 Resource Record Data"BORDER="0"></A></TD></TR></TABLE>&nbsp;<HRALIGN="LEFT"WIDTH="515"TITLE="footer"></DIV><DIVCLASS="SECT1"><H2CLASS="sect1"><ACLASS="title"NAME="AUTOID-18625">A.3 Header Section Format</A></H2><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-18628"></A>(From RFC 1035, pages 26-28)</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">                                    1  1  1  1  1  1      0  1  2  3  4  5  6  7  8  9  0  1  2  3  4  5    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+    |                      ID                       |    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+    |QR|   Opcode  |AA|TC|RD|RA|   Z    |   RCODE   |    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+    |                    QDCOUNT                    |    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+    |                    ANCOUNT                    |    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+    |                    NSCOUNT                    |    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+    |                    ARCOUNT                    |    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+where:ID             A 16 bit identifier assigned by the program that               generates any kind of query.  This identifier is copied               the corresponding reply and can be used by the requester               to match up replies to outstanding queries.QR             A one bit field that specifies whether this message is a               query (0), or a response (1).OPCODE         A four bit field that specifies kind of query in this               message.  This value is set by the originator of a query               and copied into the response.  The values are:               0               a standard query (QUERY)               1               an inverse query (IQUERY)               2               a server status request (STATUS)               3-15            reserved for future useAA             Authoritative Answer - this bit is valid in responses,               and specifies that the responding name server is an               authority for the domain name in question section.               Note that the contents of the answer section may have               multiple owner names because of aliases.  The AA bit               corresponds to the name which matches the query name, or               the first owner name in the answer section.TC             TrunCation - specifies that this message was truncated               due to length greater than that permitted on the               transmission channel.RD             Recursion Desired - this bit may be set in a query and               is copied into the response.  If RD is set, it directs               the name server to pursue the query recursively.               Recursive query support is optional.RA             Recursion Available - this bit is set or cleared in a               response, and denotes whether recursive query support is               available in the name server.Z              Reserved for future use.  Must be zero in all queries               and responses.<ACLASS="indexterm"NAME="AUTOID-18631"></A>RCODE          Response code - this 4 bit field is set as part of               responses.  The values have the following               interpretation:               0               No error condition               1               Format error - The name server was                               unable to interpret the query.               2               Server failure - The name server was                               unable to process this query due to a                               problem with the name server.               3               Name Error - Meaningful only for                               responses from an authoritative name                               server, this code signifies that the                               domain name referenced in the query does                               not exist.               4               Not Implemented - The name server does                               not support the requested kind of query.               5               Refused - The name server refuses to                               perform the specified operation for                               policy reasons.  For example, a name                               server may not wish to provide the                               information to the particular requester,                               or a name server may not wish to perform                               a particular operation (e.g., zone                               transfer) for particular data.               6-15            Reserved for future use.QDCOUNT        an unsigned 16 bit integer specifying the number of               entries in the question section.ANCOUNT        an unsigned 16 bit integer specifying the number of               resource records in the answer section.NSCOUNT        an unsigned 16 bit integer specifying the number of name               server resource records in the authority records               section.ARCOUNT        an unsigned 16 bit integer specifying the number of               resource records in the additional records section.</PRE></BLOCKQUOTE><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="AUTOID-18633">A.3.1 Question Section Format</A></H3><PCLASS="para">(From RFC 1035,pages 28-29)</P><PCLASS="para">The<ACLASS="indexterm"NAME="AUTOID-18637"></A>question section is used to carry the&quot;question&quot; in most queries, i.e., the parameters that define what isbeing asked. The section contains QDCOUNT (usually1) entries, each of the following format:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">                                    1  1  1  1  1  1      0  1  2  3  4  5  6  7  8  9  0  1  2  3  4  5    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+    |                                               |    /                     QNAME                     /    /                                               /    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+    |                     QTYPE                     |    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+    |                     QCLASS                    |    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+where:QNAME          a domain name represented as a sequence of labels, where               each label consists of a length octet followed by that               number of octets.  The domain name terminates with the               zero length octet for the null label of the root.  Note               that this field may be an odd number of octets; no               padding is used.QTYPE          a two octet code which specifies the type of the query.               The values for this field include all codes valid for a               TYPE field, together with some more general codes which               can match more than one type of RR.QCLASS         a two octet code that specifies the class of the query.               For example, the QCLASS field is IN for the Internet.</PRE></BLOCKQUOTE><DIVCLASS="sect3"><H4CLASS="sect3"><ACLASS="title"NAME="AUTOID-18640">A.3.1.1 QCLASS values</A></H4><PCLASS="para">(From RFC 1035, page 13)</P><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-18644"></A>QCLASSfields appear in the question section of a query. QCLASS valuesare a superset of CLASS values; every CLASS is a valid QCLASS. Inaddition to CLASS values, the following QCLASSes are defined:</P><DLCLASS="variablelist"><DTCLASS="term">*</DT><DDCLASS="listitem"><PCLASS="para">255 any class.</P></DD></DL></DIV><DIVCLASS="sect3"><H4CLASS="sect3"><ACLASS="title"NAME="AUTOID-18651">A.3.1.2 QTYPE values</A></H4><PCLASS="para">(From RFC 1035, pages 12-13)</P><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-18655"></A>QTYPEfields appear in the question part of a query. QTYPES are a supersetof TYPEs, hence all TYPEs are valid QTYPEs. In addition, the followingQTYPEs are defined:</P><DLCLASS="variablelist"><DTCLASS="term">AXFR</DT><DDCLASS="listitem"><PCLASS="para">252 A request for a transfer of an entire zone</P></DD><DTCLASS="term">MAILB</DT><DDCLASS="listitem"><PCLASS="para">253 A request for mailbox-related records (MB, MGor MR)</P></DD><DTCLASS="term">MAILA</DT><DDCLASS="listitem"><PCLASS="para">254 A request for mail agent RRs (Obsolete&nbsp;- seeMX)</P></DD><DTCLASS="term">*</DT><DDCLASS="listitem"><PCLASS="para">255 A request for all records</P></DD></DL></DIV></DIV><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="AUTOID-18674">A.3.2 Answer, Authority, and Additional Section Format</A></H3><PCLASS="para">(From RFC 1035, pages 29-30)</P><PCLASS="para">The<ACLASS="indexterm"NAME="AUTOID-18678"></A><ACLASS="indexterm"NAME="AUTOID-18680"></A><ACLASS="indexterm"NAME="AUTOID-18682"></A>answer, authority, and additionalsections all share the same format: a variable number of resourcerecords, where the number of records is specified in the corresponding countfield in the header. Each resource record has the following format:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">                                    1  1  1  1  1  1      0  1  2  3  4  5  6  7  8  9  0  1  2  3  4  5    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+    |                                               |    /                                               /    /                      NAME                     /    |                                               |    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+    |                      TYPE                     |    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+    |                     CLASS                     |    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+    |                      TTL                      |    |                                               |    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+    |                   RDLENGTH                    |    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--|    /                     RDATA                     /    /                                               /    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+where:NAME           a domain name to which this resource record pertains.TYPE           two octets containing one of the RR type codes.  This               field specifies the meaning of the data in the RDATA               field.CLASS          two octets which specify the class of the data in the               RDATA field.TTL            a 32 bit unsigned integer that specifies the time               interval (in seconds) that the resource record may be               cached before it should be discarded.  Zero values are               interpreted to mean that the RR can only be used for the               transaction in progress, and should not be cached.RDLENGTH       an unsigned 16 bit integer that specifies the length in               octets of the RDATA field.RDATA          a variable length string of octets that describes the               resource.  The format of this information varies               according to the TYPE and CLASS of the resource record.               For example, if the TYPE is A and the CLASS is IN,               the RDATA field is a 4 octet ARPA Internet address.</PRE></BLOCKQUOTE></DIV><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="AUTOID-18685">A.3.3 Data Transmission Order</A></H3><PCLASS="para">(From RFC 1035,pages 8-9)</P><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-18689"></A><ACLASS="indexterm"NAME="AUTOID-18692"></A><ACLASS="indexterm"NAME="AUTOID-18694"></A>Theorder of transmission of the header and data described in this documentis resolved to the octet level. Whenever a diagram shows a groupof octets, the order of transmission of those octets is the normalorder in which they are read in English. For example, in the followingdiagram, the octets are transmitted in the order they are numbered.</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">     0                   1     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+    |       1       |       2       |    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+    |       3       |       4       |    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+    |       5       |       6       |    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</PRE></BLOCKQUOTE><PCLASS="para">Whenever an octet represents a numeric quantity,the left most bit in the diagram is the high order or most significantbit. That is, the bit labeled 0 is the most significant bit. Forexample, the following diagram represents the value 170 (decimal).</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">     0 1 2 3 4 5 6 7    +-+-+-+-+-+-+-+-+    |1 0 1 0 1 0 1 0|    +-+-+-+-+-+-+-+-+</PRE></BLOCKQUOTE><PCLASS="para">Similarly, whenever a multi-octet field representsa numeric quantity the left most bit of the whole field is the mostsignificant bit. When a multi-octet quantity is transmitted, themost significant octet is transmitted first.<ACLASS="indexterm"NAME="AUTOID-18700"></A><ACLASS="indexterm"NAME="AUTOID-18701"></A><ACLASS="indexterm"NAME="AUTOID-18702"></A></P></DIV></DIV><DIVCLASS="htmlnav"><P></P><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="appa_02.htm"TITLE="A.2 DNS Message"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: A.2 DNS Message"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="book"HREF="index.htm"TITLE="DNS &amp; BIND"><IMGSRC="../gifs/txthome.gif"ALT="DNS &amp; BIND"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="appa_04.htm"TITLE="A.4 Resource Record Data"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: A.4 Resource Record Data"BORDER="0"></A></TD></TR><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172">A.2 DNS Message</TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="index"HREF="index/idx_0.htm"TITLE="Book Index"><IMGSRC="../gifs/index.gif"ALT="Book Index"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172">A.4 Resource Record Data</TD></TR></TABLE><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><PCLASS="nav"><FONTSIZE="-1">[ <AHREF="../index.htm"TITLE="The Networking CD Bookshelf">Library Home</A> | <AHREF="index.htm"TITLE="DNS &amp; BIND">DNS &amp; BIND</A> | <AHREF="../tcpip/index.htm"TITLE="TCP/IP Network Administration">TCP/IP</A> | <AHREF="../sendmail/index.htm"TITLE="sendmail">sendmail</A> | <AHREF="../smdref/index.htm"TITLE="sendmail Desktop Reference">sendmail Reference</A> | <AHREF="../firewall/index.htm"TITLE="Building Internet Firewalls">Firewalls</A> | <AHREF="../puis/index.htm"TITLE="Practical UNIX &amp; Internet Security">Practical Security</A> ]</FONT></P></DIV></BODY></HTML>