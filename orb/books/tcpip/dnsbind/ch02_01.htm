<HTML><HEAD><TITLE>[Chapter 2] How Does DNS Work?</TITLE><METANAME="DC.title"CONTENT="DNS &amp; BIND"><METANAME="DC.creator"CONTENT="Cricket Liu &amp; Paul Albitz"><METANAME="DC.publisher"CONTENT="O'Reilly &amp; Associates, Inc."><METANAME="DC.date"CONTENT="1999-01-06T18:23:29Z"><METANAME="DC.type"CONTENT="Text.Monograph"><METANAME="DC.format"CONTENT="text/html"SCHEME="MIME"><METANAME="DC.source"CONTENT="1-56592-512-2"SCHEME="ISBN"><METANAME="DC.language"CONTENT="en-US"><METANAME="generator"CONTENT="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><LINKREV="made"HREF="mailto:online-books@oreilly.com"TITLE="Online Books Comments"><LINKREL="up"HREF="index.htm"TITLE="DNS &amp; BIND"><LINKREL="prev"HREF="ch01_05.htm"TITLE="1.5 Must I Use DNS?"><LINKREL="next"HREF="ch02_02.htm"TITLE="2.2 The Internet Domain Name Space"></HEAD><BODYBGCOLOR="#FFFFFF"TEXT="#000000"><DIVCLASS="htmlnav"><H1><IMGSRC="gifs/smbanner.gif"ALT="DNS &amp; BIND"USEMAP="#srchmap"BORDER="0"></H1><MAPNAME="srchmap"><AREASHAPE="RECT"COORDS="0,0,466,65"HREF="index.htm"ALT="DNS &amp; BIND"><AREASHAPE="RECT"COORDS="467,0,514,18"HREF="../search/dsrch.htm"ALT="Search this book"></MAP><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch01_05.htm"TITLE="1.5 Must I Use DNS?"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 1.5 Must I Use DNS?"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><B><FONTFACE="ARIEL,HELVETICA,HELV,SANSERIF"SIZE="-1">Chapter 2</FONT></B></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch02_02.htm"TITLE="2.2 The Internet Domain Name Space"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 2.2 The Internet Domain Name Space"BORDER="0"></A></TD></TR></TABLE>&nbsp;<HRALIGN="LEFT"WIDTH="515"TITLE="footer"></DIV><DIVCLASS="CHAPTER"><H1CLASS="chapter"><ACLASS="title"NAME="DNS3-CHP-2">2. How Does <SPANCLASS="acronym">DNS</SPAN> Work?</A></H1><DIVCLASS="htmltoc"><P><B>Contents:</B><BR><ACLASS="sect1"HREF="#AUTOID-767"TITLE="2.1 The Domain Name Space">The Domain Name Space</A><BR><ACLASS="sect1"HREF="ch02_02.htm"TITLE="2.2 The Internet Domain Name Space">The Internet Domain Name Space</A><BR><ACLASS="sect1"HREF="ch02_03.htm"TITLE="2.3 Delegation">Delegation</A><BR><ACLASS="sect1"HREF="ch02_04.htm"TITLE="2.4 Name Servers and Zones">Name Servers and Zones</A><BR><ACLASS="sect1"HREF="ch02_05.htm"TITLE="2.5 Resolvers">Resolvers</A><BR><ACLASS="sect1"HREF="ch02_06.htm"TITLE="2.6 Resolution">Resolution</A><BR><ACLASS="sect1"HREF="ch02_07.htm"TITLE="2.7 Caching">Caching</A></P><P></P></DIV><DIVCLASS="epigraph"><PCLASS="para"ALIGN="right"><I><SPANCLASS="quote">"... and what is the use of a book,"</SPAN> thoughtAlice, <SPANCLASS="quote">"without pictures or conversations?"</SPAN></I></P></DIV><PCLASS="para">The Domain Name System is basically a database of hostinformation. Admittedly, you get a lot with that: funny dotted names,networked name servers, a shadowy <SPANCLASS="quote">"name space."</SPAN> But keepin mind that, in the end, the service <SPANCLASS="acronym">DNS</SPAN> providesis information about internet hosts.</P><PCLASS="para">We've already covered some important aspects of<SPANCLASS="acronym">DNS</SPAN>, including its client-server architecture andthe structure of the <SPANCLASS="acronym">DNS</SPAN> database. However, wehaven't gone into much detail, and we haven't explained the nuts andbolts of <SPANCLASS="acronym">DNS</SPAN>'s operation.</P><PCLASS="para">In this chapter, we'll explain and illustrate the mechanismsthat make <SPANCLASS="acronym">DNS</SPAN> work. We'll also introduce the termsyou'll need to know to read the rest of the book (and to converseintelligently with your fellow domain administrators).</P><PCLASS="para">First, though, let's take a more detailed look at conceptsintroduced in the previous chapter. We'll try to add enough detail tospice it up a little.</P><DIVCLASS="sect1"><H2CLASS="sect1"><ACLASS="title"NAME="AUTOID-767">2.1 The Domain Name Space</A></H2><PCLASS="para"><SPANCLASS="acronym">DNS</SPAN>'s distributed database is indexed bydomain names. Each domain name is essentially just a path in a largeinverted tree, called the<ACLASS="indexterm"NAME="AUTOID-771"></A><ACLASS="indexterm"NAME="AUTOID-774"></A><ACLASS="indexterm"NAME="AUTOID-776"></A><ACLASS="indexterm"NAME="AUTOID-779"></A><ACLASS="indexterm"NAME="DNS3-IDX-2-DOMAIN-NAME-SPACE"></A><ICLASS="firstterm">domain name space</I>. The tree's hierarchicalstructure, shown in <ACLASS="xref"HREF="ch02_01.htm#DNS3-CHP-2-FIG-1"TITLE="The structure of the DNS name space">Figure 2.1</A>, is similar tothe structure of the <SPANCLASS="acronym">UNIX</SPAN> filesystem. The tree hasa single root at the top.[1] In the <SPANCLASS="acronym">UNIX</SPAN> filesystem,this is called the root directory, represented by a slash(<SPANCLASS="quote">"/"</SPAN>). <SPANCLASS="acronym">DNS</SPAN> simply calls it <SPANCLASS="quote">"theroot."</SPAN> Like a filesystem, <SPANCLASS="acronym">DNS</SPAN>'s tree canbranch any number of ways at each intersection point, called a<ACLASS="indexterm"NAME="AUTOID-794"></A>node.  The depth of the tree is limited to 127 levels (a limit you'renot likely to reach).</P><BLOCKQUOTECLASS="footnote"><PCLASS="para">[1] Clearly this is a computer scientist's tree, not abotanist's.</P></BLOCKQUOTE><H4CLASS="figure"><ACLASS="title"NAME="DNS3-CHP-2-FIG-1">Figure 2.1: The structure of the <SPANCLASS="acronym">DNS</SPAN> name space</A></H4><IMGCLASS="graphic"SRC="figs/dns3_0201.gif"ALT="Figure 2.1"><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="AUTOID-800">2.1.1 Domain Names</A></H3><PCLASS="para">Each node in the tree has a text label (without dots) that canbe up to 63 characters long.  A null (zero-length) label is reservedfor the root. The full<ACLASS="indexterm"NAME="AUTOID-803"></A><ICLASS="firstterm">domain name</I> of any node in the tree is thesequence of labels on the path from that node to the root. Domainnames are always read from the node toward the root (<SPANCLASS="quote">"up"</SPAN>the tree), and with dots separating the names in the path.</P><PCLASS="para">If the root node's label actually appears in a node's domainname, the name looks as though it ends in a dot, as in<SPANCLASS="quote">"www.oreilly.com."</SPAN>. (It actually ends with adot&nbsp;- the separator&nbsp;- and the root's null label.) When theroot node's label appears by itself, it is written as a single dot,<SPANCLASS="quote">"."</SPAN>, for convenience. Consequently, some softwareinterprets a<ACLASS="indexterm"NAME="AUTOID-810"></A><ACLASS="indexterm"NAME="AUTOID-813"></A><ACLASS="indexterm"NAME="AUTOID-815"></A><ACLASS="indexterm"NAME="AUTOID-818"></A>trailing dot in a domain name to indicate that the domain name is<ICLASS="firstterm">absolute</I>.  An absolute domain name is writtenrelative to the root, and unambiguously specifies a node's location inthe hierarchy. An absolute domain name is also referred to as a<ICLASS="firstterm">fully qualified domain name</I>, often abbreviated<ACLASS="indexterm"NAME="AUTOID-823"></A><ACLASS="indexterm"NAME="AUTOID-825"></A><ICLASS="firstterm"><SPANCLASS="acronym">FQDN</SPAN></I>. Names without trailingdots are sometimes interpreted as relative to some domain other thanthe root, just as directory names without a leading slash are ofteninterpreted as relative to the current directory.</P><PCLASS="para"><SPANCLASS="acronym">DNS</SPAN> requires that sibling nodes&nbsp;- nodesthat are children of the same parent&nbsp;- have different labels. Thisrestriction guarantees that a domain name uniquely identifies a singlenode in the tree. The restriction really isn't a limitation, becausethe labels only need to be unique among the children, not among allthe nodes in the tree. The same restriction applies to the<SPANCLASS="acronym">UNIX</SPAN> filesystem: You can't give two siblingdirectories the same name. Just as you can't have two <ICLASS="systemitem.sitename">hobbes.pa.ca.us</I> nodes in the name space,you can't have two <ICLASS="filename">/usr/bin</I> directories (<ACLASS="xref"HREF="ch02_01.htm#DNS3-CHP-2-FIG-2"TITLE="Ensuring uniqueness in domain names and in UNIX pathnames">Figure 2.2</A>). You can, however, have both a<ICLASS="systemitem.sitename">hobbes.pa.ca.us</I> node and a<ICLASS="systemitem.sitename">hobbes.lg.ca.us</I>, as you canhave both a <ICLASS="filename">/bin</I> directory and a<ICLASS="filename">/usr/bin</I> directory.</P><H4CLASS="figure"><ACLASS="title"NAME="DNS3-CHP-2-FIG-2">Figure 2.2: Ensuring uniqueness in domain names and in<SPANCLASS="acronym">UNIX</SPAN> pathnames</A></H4><IMGCLASS="graphic"SRC="figs/dns3_0202.gif"ALT="Figure 2.2"></DIV><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="AUTOID-844">2.1.2 Domains</A></H3><PCLASS="para">A<ACLASS="indexterm"NAME="DNS3-IDX-2-DOMAINS"></A><ICLASS="firstterm">domain</I> is simply a subtree of the domain namespace. The domain name of a domain is the same as the domain name ofthe node at the very top of the domain. So, for example, the top ofthe <ICLASS="systemitem.sitename">purdue.edu</I> domain is anode named <ICLASS="systemitem.sitename">purdue.edu</I>, asshown in <ACLASS="xref"HREF="ch02_01.htm#DNS3-CHP-2-FIG-3"TITLE="The purdue.edu domain">Figure 2.3</A>.</P><H4CLASS="figure"><ACLASS="title"NAME="DNS3-CHP-2-FIG-3">Figure 2.3: The purdue.edu domain</A></H4><IMGCLASS="graphic"SRC="figs/dns3_0203.gif"ALT="Figure 2.3"><PCLASS="para">Likewise, in a filesystem, at the top of the<ICLASS="filename">/usr</I> directory, you'd expect to find a nodecalled <ICLASS="filename">/usr</I>, as shown in <ACLASS="xref"HREF="ch02_01.htm#DNS3-CHP-2-FIG-4"TITLE="The /usr directory">Figure 2.4</A>.</P><H4CLASS="figure"><ACLASS="title"NAME="DNS3-CHP-2-FIG-4">Figure 2.4: The /usr directory</A></H4><IMGCLASS="graphic"SRC="figs/dns3_0204.gif"ALT="Figure 2.4"><PCLASS="para">Any domain name in the subtree is considered a part of thedomain. Because a domain name can be in many subtrees, a domain namecan also be in many domains. For example, the domain name <ICLASS="systemitem.sitename">pa.ca.us</I> is part of the <ICLASS="systemitem.sitename">ca.us</I> domain and also part of the<ICLASS="systemitem.sitename">us</I> domain, as shown in <ACLASS="xref"HREF="ch02_01.htm#DNS3-CHP-2-FIG-5"TITLE="A node in multiple domains">Figure 2.5</A>.</P><H4CLASS="figure"><ACLASS="title"NAME="DNS3-CHP-2-FIG-5">Figure 2.5: A node in multiple domains</A></H4><IMGCLASS="graphic"SRC="figs/dns3_0205.gif"ALT="Figure 2.5"><PCLASS="para">So in the abstract, a domain is just a subtree of the domainname space. But if a domain is simply made up of domain names andother domains, where are all the hosts? Domains are groups of hosts,right?</P><PCLASS="para">The<ACLASS="indexterm"NAME="AUTOID-873"></A>hosts arethere, represented by domain names. Remember, domain names are justindexes into the <SPANCLASS="acronym">DNS</SPAN> database. The<SPANCLASS="quote">"hosts"</SPAN> are the domain names that point to informationabout individual hosts. And a domain contains all the hosts whosedomain names are within the domain. The hosts are related<EMCLASS="emphasis">logically</EM>, often by geography or organizationalaffiliation, and not necessarily by network or address or hardwaretype. You might have ten different hosts, each of them on a differentnetwork and each one perhaps even in a different country, all in thesame domain.[2]</P><BLOCKQUOTECLASS="footnote"><PCLASS="para">[2] One note of caution: Don't confuse domains in the Domain NameSystem with domains in Sun's<ACLASS="indexterm"NAME="AUTOID-880"></A>Network Information Service (<SPANCLASS="acronym">NIS</SPAN>). Though an<SPANCLASS="acronym">NIS</SPAN> domain also refers to a group of hosts, andboth types of domains have similarly structured names, the conceptsare quite different. <SPANCLASS="acronym">NIS</SPAN> uses hierarchical names,but the hierarchy ends there: hosts in the same <SPANCLASS="acronym">NIS</SPAN>domain share certain data about hosts and users, but they can'tnavigate the <SPANCLASS="acronym">NIS</SPAN> name space to find data in other<SPANCLASS="acronym">NIS</SPAN> domains.  <SPANCLASS="acronym">NT</SPAN> domains, whichprovide account management and security services, also don't have anyrelationship to <SPANCLASS="acronym">DNS</SPAN> domains.</P></BLOCKQUOTE><PCLASS="para">Domain names at the leaves of the tree generally representindividual hosts, and they may point to network addresses, hardwareinformation, and mail routing information. Domain names in theinterior of the tree can name a host <EMCLASS="emphasis">and</EM> canpoint to information about the domain. Interior domain names aren'trestricted to one or the other. They can represent both the domainthey correspond to and a particular host on the network. For example,<ICLASS="systemitem.sitename">hp.com</I> is both the name ofthe Hewlett-Packard Company's domain and the domain name of a hostthat runs <SPANCLASS="acronym">HP</SPAN>'s main web server.</P><PCLASS="para">The type of information retrieved when you use a domain namedepends on the context in which you use it. Sending mail to someone at<ICLASS="systemitem.sitename">hp.com</I> would return mailrouting information, while <KBDCLASS="command">telnet</KBD>ing to the domainname would look up the host information (in <ACLASS="xref"HREF="ch02_01.htm#DNS3-CHP-2-FIG-6"TITLE="An interior node with both host and structural data">Figure 2.6</A>, for example, <ICLASS="systemitem.sitename">hp.com</I>'s <SPANCLASS="acronym">IP</SPAN>address).[3]</P><BLOCKQUOTECLASS="footnote"><PCLASS="para">[3]  The terms <ICLASS="wordasword">domain</I> and<ICLASS="wordasword">subdomain</I> are often used interchangeably, ornearly so, in <SPANCLASS="acronym">DNS</SPAN> and <SPANCLASS="acronym">BIND</SPAN>documentation.  Here, we use <ICLASS="wordasword">subdomain</I> onlyas a relative term: a domain is a subdomain of another domain if theroot of the subdomain is within the domain.</P></BLOCKQUOTE><H4CLASS="figure"><ACLASS="title"NAME="DNS3-CHP-2-FIG-6">Figure 2.6: An interior node with both host and structural data</A></H4><IMGCLASS="graphic"SRC="figs/dns3_0206.gif"ALT="Figure 2.6"><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-912"></A><ACLASS="indexterm"NAME="AUTOID-915"></A><ACLASS="indexterm"NAME="AUTOID-917"></A>A simple way of deciding whether a domain is a subdomain of anotherdomain is to compare their domain names. A subdomain's domain nameends with the domain name of its parent domain. For example, thedomain <ICLASS="systemitem.sitename">la.tyrell.com</I> must bea subdomain of <ICLASS="systemitem.sitename">tyrell.com</I>because <ICLASS="systemitem.sitename">la.tyrell.com</I> endswith <ICLASS="systemitem.sitename">tyrell.com</I>. Similarly,it's a subdomain of <ICLASS="systemitem.sitename">com</I>, asis <ICLASS="systemitem.sitename">tyrell.com</I>.</P><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-927"></A><ACLASS="indexterm"NAME="AUTOID-929"></A><ACLASS="indexterm"NAME="AUTOID-932"></A><ACLASS="indexterm"NAME="AUTOID-934"></A><ACLASS="indexterm"NAME="AUTOID-937"></A>Besides being referred to in relative terms, as subdomains of otherdomains, domains are often referred to by<ICLASS="firstterm">level</I>. On mailing lists and in Usenetnewsgroups, you may see the terms <ICLASS="firstterm">top-leveldomain</I> or <ICLASS="firstterm">second-level domain</I>bandied about. These terms simply refer to a domain's position in thedomain name space:</P><ULCLASS="itemizedlist"><LICLASS="listitem"><PCLASS="para">A top-level domain is a child of the root.</P></LI><LICLASS="listitem"><PCLASS="para">A first-level domain is a child of the root (a top-leveldomain).</P></LI><LICLASS="listitem"><PCLASS="para">A second-level domain is a child of a first-level domain, and soon.<ACLASS="indexterm"NAME="AUTOID-950"></A></P></LI></UL></DIV><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="AUTOID-951">2.1.3 Resource Records</A></H3><PCLASS="para">The data associated with domain names are contained in<ACLASS="indexterm"NAME="AUTOID-954"></A><ACLASS="indexterm"NAME="AUTOID-957"></A><ACLASS="indexterm"NAME="AUTOID-959"></A><ICLASS="firstterm">resource records</I>, or<ICLASS="firstterm"><SPANCLASS="acronym">RR</SPAN>s</I>. Records are dividedinto classes, each of which pertains to a type of network orsoftware. Currently, there are classes for internets (any<SPANCLASS="acronym">TCP</SPAN>/<SPANCLASS="acronym">IP</SPAN>-based internet), networksbased on the Chaosnet protocols, and networks that use Hesiodsoftware.  (Chaosnet is an old network of largely historicsignificance.)</P><PCLASS="para">The internet class is by far the most popular. (We're not reallysure if anyone still uses the<ACLASS="indexterm"NAME="AUTOID-967"></A>Chaosnet class, and use of the<ACLASS="indexterm"NAME="AUTOID-969"></A><ACLASS="indexterm"NAME="AUTOID-971"></A>Hesiod class is mostly confined to <SPANCLASS="acronym">MIT</SPAN>.) Weconcentrate here on the internet class.</P><PCLASS="para">Within a class, records also come in several types, whichcorrespond to the different varieties of data that may be stored inthe domain name space. Different classes may define different recordtypes, though some types may be common to more than one class. Forexample, almost every class defines an<ACLASS="indexterm"NAME="AUTOID-975"></A><ICLASS="firstterm">address</I> type. Each record type in a given class defines a particularrecord syntax, which all resource records of that class and type mustadhere to. (For details on all internet resource record types andtheir syntaxes, see <ACLASS="xref"HREF="appa_01.htm"TITLE="DNS Message Format and Resource Records">Appendix A, <CITECLASS="appendix">DNS Message Format and ResourceRecords</CITE></A>.)</P><PCLASS="para">If this information seems sketchy, don't worry&nbsp;- we'll coverthe records in the internet class in more detail later. The commonrecords are described in <ACLASS="xref"HREF="ch04_01.htm"TITLE="Setting Up BIND">Chapter 4, <CITECLASS="chapter">Setting Up <SPANCLASS="acronym">BIND</SPAN></CITE></A>, and acomprehensive list is included as part of <ACLASS="xref"HREF="appa_01.htm"TITLE="DNS Message Format and Resource Records">Appendix A</A>.</P><ACLASS="indexterm"NAME="AUTOID-983"></A></DIV></DIV></DIV><DIVCLASS="htmlnav"><P></P><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch01_05.htm"TITLE="1.5 Must I Use DNS?"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 1.5 Must I Use DNS?"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="book"HREF="index.htm"TITLE="DNS &amp; BIND"><IMGSRC="../gifs/txthome.gif"ALT="DNS &amp; BIND"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch02_02.htm"TITLE="2.2 The Internet Domain Name Space"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 2.2 The Internet Domain Name Space"BORDER="0"></A></TD></TR><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172">1.5 Must I Use DNS?</TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="index"HREF="index/idx_0.htm"TITLE="Book Index"><IMGSRC="../gifs/index.gif"ALT="Book Index"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172">2.2 The Internet Domain Name Space</TD></TR></TABLE><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><PCLASS="nav"><FONTSIZE="-1">[ <AHREF="../index.htm"TITLE="The Networking CD Bookshelf">Library Home</A> | <AHREF="index.htm"TITLE="DNS &amp; BIND">DNS &amp; BIND</A> | <AHREF="../tcpip/index.htm"TITLE="TCP/IP Network Administration">TCP/IP</A> | <AHREF="../sendmail/index.htm"TITLE="sendmail">sendmail</A> | <AHREF="../smdref/index.htm"TITLE="sendmail Desktop Reference">sendmail Reference</A> | <AHREF="../firewall/index.htm"TITLE="Building Internet Firewalls">Firewalls</A> | <AHREF="../puis/index.htm"TITLE="Practical UNIX &amp; Internet Security">Practical Security</A> ]</FONT></P></DIV></BODY></HTML>