<HTML><HEAD><TITLE>[Chapter 2] 2.4 Name Servers and Zones</TITLE><METANAME="DC.title"CONTENT="DNS &amp; BIND"><METANAME="DC.creator"CONTENT="Cricket Liu &amp; Paul Albitz"><METANAME="DC.publisher"CONTENT="O'Reilly &amp; Associates, Inc."><METANAME="DC.date"CONTENT="1999-01-06T18:23:49Z"><METANAME="DC.type"CONTENT="Text.Monograph"><METANAME="DC.format"CONTENT="text/html"SCHEME="MIME"><METANAME="DC.source"CONTENT="1-56592-512-2"SCHEME="ISBN"><METANAME="DC.language"CONTENT="en-US"><METANAME="generator"CONTENT="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><LINKREV="made"HREF="mailto:online-books@oreilly.com"TITLE="Online Books Comments"><LINKREL="up"HREF="ch02_01.htm"TITLE="2. How Does DNS Work?"><LINKREL="prev"HREF="ch02_03.htm"TITLE="2.3 Delegation"><LINKREL="next"HREF="ch02_05.htm"TITLE="2.5 Resolvers"></HEAD><BODYBGCOLOR="#FFFFFF"TEXT="#000000"><DIVCLASS="htmlnav"><H1><IMGSRC="gifs/smbanner.gif"ALT="DNS &amp; BIND"USEMAP="#srchmap"BORDER="0"></H1><MAPNAME="srchmap"><AREASHAPE="RECT"COORDS="0,0,466,65"HREF="index.htm"ALT="DNS &amp; BIND"><AREASHAPE="RECT"COORDS="467,0,514,18"HREF="../search/dsrch.htm"ALT="Search this book"></MAP><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch02_03.htm"TITLE="2.3 Delegation"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 2.3 Delegation"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><B><FONTFACE="ARIEL,HELVETICA,HELV,SANSERIF"SIZE="-1">Chapter 2<BR>How Does <SPANCLASS="acronym">DNS</SPAN> Work?</FONT></B></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch02_05.htm"TITLE="2.5 Resolvers"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 2.5 Resolvers"BORDER="0"></A></TD></TR></TABLE>&nbsp;<HRALIGN="LEFT"WIDTH="515"TITLE="footer"></DIV><DIVCLASS="SECT1"><H2CLASS="sect1"><ACLASS="title"NAME="AUTOID-1235">2.4 Name Servers and Zones</A></H2><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-1238"></A><ACLASS="indexterm"NAME="DNS3-IDX-2-ZONES"></A><ACLASS="indexterm"NAME="DNS3-IDX-2-NAME-SERVERS"></A>The programs that store information about the domain name space arecalled <ICLASS="firstterm">name servers</I>. Name servers generallyhave complete information about some part of the domain name space,called a <ICLASS="firstterm">zone</I>, which they load from a file orfrom another name server. The name server is then said to have<ICLASS="firstterm">authority</I> for that zone.  Name servers can beauthoritative for multiple zones, too.</P><PCLASS="para">The difference between a zone and a<ACLASS="indexterm"NAME="AUTOID-1249"></A>domain is important, but subtle.  All top-level domains, and manydomains at the second level and lower, like <ICLASS="systemitem.sitename">berkeley.edu</I> and <ICLASS="systemitem.sitename">hp.com</I>, are broken into smaller, moremanageable units by delegation. These units are called zones. The<ICLASS="systemitem.sitename">edu</I> domain, shown in <ACLASS="xref"HREF="ch02_04.htm#DNS3-CHP-2-FIG-8"TITLE="The edu domain broken into zones">Figure 2.8</A>, is divided into many zones, including the<ICLASS="systemitem.sitename">berkeley.edu</I> zone, the<ICLASS="systemitem.sitename">purdue.edu</I> zone, and the<ICLASS="systemitem.sitename">nwu.edu</I> zone.  At the top ofthe domain, there's also an <ICLASS="systemitem.sitename">edu</I>zone. It's natural that the folks who run <ICLASS="systemitem.sitename">edu</I> would break up the <ICLASS="systemitem.sitename">edu</I> domain: otherwise, they'd have tomanage the <ICLASS="systemitem.sitename">berkeley.edu</I>subdomain themselves. It makes much more sense to delegate <ICLASS="systemitem.sitename">berkeley.edu</I> to Berkeley.  What's left forthe folks who run <ICLASS="systemitem.sitename">edu</I>?  The<ICLASS="systemitem.sitename">edu</I> zone, which would containmostly delegation information to subdomains of <ICLASS="systemitem.sitename">edu</I>.</P><H4CLASS="figure"><ACLASS="title"NAME="DNS3-CHP-2-FIG-8">Figure 2.8: The edu domain broken into zones</A></H4><IMGCLASS="graphic"SRC="figs/dns3_0208.gif"ALT="Figure 2.8"><PCLASS="para">The <ICLASS="systemitem.sitename">berkeley.edu</I>subdomain is, in turn, broken up into multiple zones by delegation, asshown in <ACLASS="xref"HREF="ch02_04.htm#DNS3-CHP-2-FIG-9"TITLE="The berkeley.edu domain broken into zones">Figure 2.9</A>. There are delegatedsubdomains called <ICLASS="systemitem.sitename">cc</I>,<ICLASS="systemitem.sitename">cs</I>, <ICLASS="systemitem.sitename">ce</I>, <ICLASS="systemitem.sitename">me</I>, and more.  Each of these subdomains isdelegated to a set of name servers, some of which are alsoauthoritative for <ICLASS="systemitem.sitename">berkeley.edu</I>.However, the zones are still separate, and may have a totallydifferent group of authoritative name servers.</P><H4CLASS="figure"><ACLASS="title"NAME="DNS3-CHP-2-FIG-9">Figure 2.9: The berkeley.edu domain broken into zones</A></H4><IMGCLASS="graphic"SRC="figs/dns3_0209.gif"ALT="Figure 2.9"><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-1282"></A>A zone contains the domain names that the domain with the samedomain name contains, except for domain names in delegatedsubdomains. For example, the top-level domain <ICLASS="systemitem.sitename">ca</I> (for Canada) may have the subdomains<ICLASS="systemitem.sitename">ab.ca</I>, <ICLASS="systemitem.sitename">on.ca</I>, and <ICLASS="systemitem.sitename">qc.ca</I>, for the provinces Alberta,Ontario, and Quebec. Authority for the <ICLASS="systemitem.sitename">ab.ca</I>, <ICLASS="systemitem.sitename">on.ca</I>, and <ICLASS="systemitem.sitename">qc.ca</I> domains may be delegated to nameservers in each of the provinces. The <EMCLASS="emphasis">domain</EM><ICLASS="systemitem.sitename">ca</I> contains all the data in<ICLASS="systemitem.sitename">ca</I> plus all the data in<ICLASS="systemitem.sitename">ab.ca</I>, <ICLASS="systemitem.sitename">on.ca</I>, and <ICLASS="systemitem.sitename">qc.ca</I>.  But the <EMCLASS="emphasis">zone</EM><ICLASS="systemitem.sitename">ca</I> contains only the data in<ICLASS="systemitem.sitename">ca</I> (see <ACLASS="xref"HREF="ch02_04.htm#DNS3-CHP-2-FIG-10"TITLE="The domain ca...">Figure 2.10</A>), which is probably mostly pointers tothe delegated subdomains.</P><PCLASS="para">If a subdomain of the domain isn't delegated away, however, thezone contains the domain names and data in the subdomain. So the<ICLASS="systemitem.sitename">bc.ca</I> and <ICLASS="systemitem.sitename">sk.ca</I> (British Columbia and Saskatchewan)subdomains of the <ICLASS="systemitem.sitename">ca</I> domainmay exist, but might not be delegated. (Perhaps the provincial authoritiesin B.C. and Saskatchewan aren't yet ready to manage their subdomains,but the authorities running the top-level <ICLASS="systemitem.sitename">ca</I> domain want to preserve the<ACLASS="indexterm"NAME="AUTOID-1307"></A><ACLASS="indexterm"NAME="AUTOID-1310"></A>consistency of the name space and implement subdomains for all theCanadian provinces right away.) In this case, the zone <ICLASS="systemitem.sitename">ca</I> has a ragged bottom edge, containing<ICLASS="systemitem.sitename">bc.ca</I> and <ICLASS="systemitem.sitename">sk.ca</I>, but not the other <ICLASS="systemitem.sitename">ca</I> subdomains, as shown in <ACLASS="xref"HREF="ch02_04.htm#DNS3-CHP-2-FIG-11"TITLE="...versus the zone ca">Figure 2.11</A>.</P><H4CLASS="figure"><ACLASS="title"NAME="DNS3-CHP-2-FIG-10">Figure 2.10: The domain ca...</A></H4><IMGCLASS="graphic"SRC="figs/dns3_0210.gif"ALT="Figure 2.10"><H4CLASS="figure"><ACLASS="title"NAME="DNS3-CHP-2-FIG-11">Figure 2.11: ...versus the zone ca</A></H4><IMGCLASS="graphic"SRC="figs/dns3_0211.gif"ALT="Figure 2.11"><PCLASS="para">Now it's clear why name servers load zones instead of domains: adomain might contain more information than the name server wouldneed.[6] A domain could contain data delegated to other nameservers. Since a zone is bounded by delegation, it will never includedelegated data.</P><BLOCKQUOTECLASS="footnote"><PCLASS="para">[6]  Imagine if a root name server loaded the root domain instead ofthe root zone: it would be loading the entire name space!</P></BLOCKQUOTE><PCLASS="para">If you're just starting out, however, your domain probably won'thave any subdomains. In this case, since there's no delegation goingon, your domain and your zone contain the same data.</P><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="AUTOID-1327">2.4.1 Delegating Domains</A></H3><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-1330"></A><ACLASS="indexterm"NAME="AUTOID-1333"></A>Even though you may not need to delegate parts of your domain justyet, it's helpful to understand a little more about how the process ofdelegating a domain works. Delegation, in the abstract, involvesassigning responsibility for some part of your domain to anotherorganization.  What really happens, however, is the assignment ofauthority for your subdomains to different name servers. (Note that wesaid <SPANCLASS="quote">"name servers,"</SPAN> not just <SPANCLASS="quote">"nameserver."</SPAN>)</P><PCLASS="para">Your data, instead of containing information about the subdomainyou've delegated, includes pointers to the name servers that areauthoritative for that subdomain. Now if one of your name servers isasked for data in the subdomain, it can reply with a list of the rightname servers to talk to.</P></DIV><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="AUTOID-1338">2.4.2 Types of Name Servers</A></H3><PCLASS="para"><ACLASS="indexterm"NAME="DNS3-IDX-2-PRIMARY-NAME-SERVERS"></A><ACLASS="indexterm"NAME="DNS3-IDX-2-SLAVE-SECONDARY-NAME-SERVERS"></A>The <SPANCLASS="acronym">DNS</SPAN> specs define two types of name servers:<ACLASS="indexterm"NAME="AUTOID-1346"></A><ACLASS="indexterm"NAME="AUTOID-1350"></A><ACLASS="indexterm"NAME="AUTOID-1353"></A><ICLASS="firstterm">primary masters</I> and <ICLASS="firstterm">secondarymasters</I>. A <EMCLASS="emphasis">primary master</EM> name serverfor a zone reads the data for the zone from a file on its host. A<EMCLASS="emphasis">secondary master</EM> name server for a zone gets thezone data from another name server that is authoritative for the zone,called its master server. Quite often, the master server is the zone'sprimary master, but that's not required: a secondary master can loadzone data from another secondary. When a secondary starts up, itcontacts its master name server and, if necessary, pulls the zone dataover. This is referred to as a<ACLASS="indexterm"NAME="AUTOID-1361"></A><ICLASS="firstterm">zone transfer</I>.  Nowadays, the preferred termfor a secondary master name server is a <ICLASS="firstterm">slave,</I>though many people (and much software, including Microsoft's<SPANCLASS="acronym">DNS</SPAN> Manager) still call them secondaries.</P><PCLASS="para">Both the primary master and slave name servers for a zone areauthoritative for that zone. Despite the somewhat disparaging name,slaves aren't second-class name servers.  <SPANCLASS="acronym">DNS</SPAN>provides these two types of name servers to make administrationeasier. Once you've created the data for your zone and set up aprimary master name server, you don't need to fool with copying thatdata from host to host to create new name servers for the zone.  Yousimply set up slave name servers that load their data from the primarymaster for the zone. Once they're set up, the slaves will transfer newzone data when necessary.</P><PCLASS="para">Slave name servers are important because it's a good idea to setup more than one name server for any given zone. You'll want more thanone for redundancy, to spread the load around, and to make sure thatall the hosts in the zone have a name server close by. Using slavename servers makes this administratively workable.</P><PCLASS="para">Calling a <EMCLASS="emphasis">particular</EM> name server a primarymaster name server or a slave name server is a little imprecise,though. We mentioned earlier that a name server can be authoritativefor more than one zone. Similarly, a name server can be a primarymaster for one zone and a slave for another. Most name servers,however, are either primary for most of the zones they load or slavefor most of the zones they load. So if we call a particular nameserver a primary or a slave, we mean that it's the primary master or aslave for <EMCLASS="emphasis">most</EM> of the zones it loads.</P><ACLASS="indexterm"NAME="AUTOID-1373"></A><ACLASS="indexterm"NAME="AUTOID-1374"></A></DIV><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="AUTOID-1375">2.4.3 Data Files</A></H3><PCLASS="para">The files from which primary master name servers load their zonedata are called, simply enough,<ACLASS="indexterm"NAME="AUTOID-1378"></A>zone data files or just data files. Weoften refer to them as<ACLASS="indexterm"NAME="AUTOID-1382"></A><ACLASS="indexterm"NAME="AUTOID-1384"></A><ICLASS="firstterm">db files</I>, short for <ICLASS="firstterm">databasefiles</I>. Slave name servers can also load their zone datafrom data files. Slaves are usually configured to back up the zonedata they transfer from a master name server to data files. If theslave is later killed and restarted, it will read the backup datafiles first, then check to see whether the data are current. This bothobviates the need to transfer the zone data if it hasn't changed andprovides a source of the data if the master is down.</P><PCLASS="para">The data files contain resource records that describe thezone. The resource records describe all the hosts in the zone and markany delegation of subdomains. <SPANCLASS="acronym">BIND</SPAN> also allowsspecial directives to include the contents of other data files in adata file, much like the <KBDCLASS="command">#include</KBD> statement in Cprogramming.<ACLASS="indexterm"NAME="AUTOID-1392"></A><ACLASS="indexterm"NAME="AUTOID-1393"></A></P></DIV></DIV><DIVCLASS="htmlnav"><P></P><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch02_03.htm"TITLE="2.3 Delegation"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 2.3 Delegation"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="book"HREF="index.htm"TITLE="DNS &amp; BIND"><IMGSRC="../gifs/txthome.gif"ALT="DNS &amp; BIND"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch02_05.htm"TITLE="2.5 Resolvers"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 2.5 Resolvers"BORDER="0"></A></TD></TR><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172">2.3 Delegation</TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="index"HREF="index/idx_0.htm"TITLE="Book Index"><IMGSRC="../gifs/index.gif"ALT="Book Index"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172">2.5 Resolvers</TD></TR></TABLE><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><PCLASS="nav"><FONTSIZE="-1">[ <AHREF="../index.htm"TITLE="The Networking CD Bookshelf">Library Home</A> | <AHREF="index.htm"TITLE="DNS &amp; BIND">DNS &amp; BIND</A> | <AHREF="../tcpip/index.htm"TITLE="TCP/IP Network Administration">TCP/IP</A> | <AHREF="../sendmail/index.htm"TITLE="sendmail">sendmail</A> | <AHREF="../smdref/index.htm"TITLE="sendmail Desktop Reference">sendmail Reference</A> | <AHREF="../firewall/index.htm"TITLE="Building Internet Firewalls">Firewalls</A> | <AHREF="../puis/index.htm"TITLE="Practical UNIX &amp; Internet Security">Practical Security</A> ]</FONT></P></DIV></BODY></HTML>