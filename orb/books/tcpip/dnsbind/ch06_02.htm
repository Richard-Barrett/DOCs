<HTML><HEAD><TITLE>[Chapter 6] 6.2 Sample Resolver Configurations</TITLE><METANAME="DC.title"CONTENT="DNS &amp; BIND"><METANAME="DC.creator"CONTENT="Cricket Liu &amp; Paul Albitz"><METANAME="DC.publisher"CONTENT="O'Reilly &amp; Associates, Inc."><METANAME="DC.date"CONTENT="1999-01-06T18:29:11Z"><METANAME="DC.type"CONTENT="Text.Monograph"><METANAME="DC.format"CONTENT="text/html"SCHEME="MIME"><METANAME="DC.source"CONTENT="1-56592-512-2"SCHEME="ISBN"><METANAME="DC.language"CONTENT="en-US"><METANAME="generator"CONTENT="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><LINKREV="made"HREF="mailto:online-books@oreilly.com"TITLE="Online Books Comments"><LINKREL="up"HREF="ch06_01.htm"TITLE="6. Configuring Hosts"><LINKREL="prev"HREF="ch06_01.htm"TITLE="6.1 The Resolver"><LINKREL="next"HREF="ch06_03.htm"TITLE="6.3 Minimizing Pain and Suffering"></HEAD><BODYBGCOLOR="#FFFFFF"TEXT="#000000"><DIVCLASS="htmlnav"><H1><IMGSRC="gifs/smbanner.gif"ALT="DNS &amp; BIND"USEMAP="#srchmap"BORDER="0"></H1><MAPNAME="srchmap"><AREASHAPE="RECT"COORDS="0,0,466,65"HREF="index.htm"ALT="DNS &amp; BIND"><AREASHAPE="RECT"COORDS="467,0,514,18"HREF="../search/dsrch.htm"ALT="Search this book"></MAP><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch06_01.htm"TITLE="6.1 The Resolver"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 6.1 The Resolver"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><B><FONTFACE="ARIEL,HELVETICA,HELV,SANSERIF"SIZE="-1">Chapter 6<BR>Configuring Hosts</FONT></B></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch06_03.htm"TITLE="6.3 Minimizing Pain and Suffering"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 6.3 Minimizing Pain and Suffering"BORDER="0"></A></TD></TR></TABLE>&nbsp;<HRALIGN="LEFT"WIDTH="515"TITLE="footer"></DIV><DIVCLASS="SECT1"><H2CLASS="sect1"><ACLASS="title"NAME="AUTOID-5001">6.2 Sample Resolver Configurations</A></H2><PCLASS="para"><ACLASS="indexterm"NAME="DNS3-IDX-6-RESOLVERS-SAMPLE-CONFIGURATIONS"></A><ACLASS="indexterm"NAME="DNS3-IDX-6-CONFIGURING-RESOLVERS"></A>So much for the theory&nbsp;- let's go over what<ICLASS="filename">resolv.conf</I> files look like on realhosts. Resolver configuration needs vary depending on whether or not ahost runs a local name server, so we'll cover both cases: hosts withlocal name servers, and hosts with remote name servers.</P><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="AUTOID-5011">6.2.1 Resolver Only</A></H3><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-5014"></A><ACLASS="indexterm"NAME="AUTOID-5017"></A>We, as the administrators of <ICLASS="systemitem.sitename">movie.edu</I>, have just been asked toconfigure a professor's new standalone workstation, which doesn't runa name server. Deciding which domain the workstation belongs in iseasy&nbsp;- there's only <ICLASS="systemitem.sitename">movie.edu</I> to choose from. However, she<EMCLASS="emphasis">is</EM> working with researchers at Pixar on newshading algorithms, so perhaps it'd be wise to put <ICLASS="systemitem.sitename">pixar.com</I> in her workstation's search list.The <ICLASS="structfield">search</I> directive:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">search movie.edu pixar.com</PRE></BLOCKQUOTE><PCLASS="para">will put her workstation in the <ICLASS="systemitem.sitename">movie.edu</I> domain, and will search<ICLASS="systemitem.sitename">pixar.com</I> for names not foundin <ICLASS="systemitem.sitename">movie.edu</I>.</P><PCLASS="para">The new workstation is on the 192.249.249.0 network, so theclosest name servers are <ICLASS="systemitem.sitename">wormhole.movie.edu</I> (192.249.249.1) and<ICLASS="systemitem.sitename">terminator.movie.edu</I>(192.249.249.3). As a rule, you should configure hosts to use theclosest name server available first. (The closest possible name serveris a name server on the local host; the next closest is a name serveron the same network or subnet.) In this case, both name servers areequally close, but we know that <ICLASS="systemitem.sitename">wormhole</I> is bigger (it's a faster host,with more capacity). So the first<ICLASS="structfield">nameserver</I> directive in<ICLASS="filename">resolv.conf</I> should be:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">nameserver 192.249.249.1</PRE></BLOCKQUOTE><PCLASS="para">Since this particular professor is known to get awfully vocalwhen she has problems with her computer, we'll also add <ICLASS="systemitem.sitename">terminator.movie.edu</I> (192.249.249.3) as abackup name server. That way, if <ICLASS="systemitem.sitename">wormhole</I> is down for any reason, theprofessor's workstation can still get name service (assuming<ICLASS="systemitem.sitename">terminator</I> and the rest of thenetwork are up).</P><PCLASS="para">The <ICLASS="filename">resolv.conf</I> file ends up looking likethis:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">search movie.edu pixar.comnameserver 192.249.249.1nameserver 192.249.249.3</PRE></BLOCKQUOTE></DIV><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="AUTOID-5044">6.2.2 Local Name Server</A></H3><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-5047"></A><ACLASS="indexterm"NAME="AUTOID-5050"></A>Next, we have to configure the university mail hub, <ICLASS="systemitem.sitename">postmanrings2x</I>, to use domain nameservice. <ICLASS="systemitem.sitename">postmanrings2x</I> isshared by all groups in the <ICLASS="systemitem.sitename">movie.edu</I> domain.  We've recentlyconfigured a name server on the host to help cut down the load on theother name servers, so we should make sure the resolver queries thename server on the local host first.</P><PCLASS="para">The simplest resolver configuration for this case is noconfiguration at all: don't create a<ACLASS="indexterm"NAME="AUTOID-5057"></A><ICLASS="filename">resolv.conf</I> file, and let the resolver default tousing the local name server. The <KBDCLASS="command">hostname</KBD> should beset to the full domain name of the host, so the resolver can determinethe local domain.</P><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-5062"></A><ACLASS="indexterm"NAME="AUTOID-5065"></A>If we decide we need a backup name server&nbsp;- a prudentdecision&nbsp;- we can use <ICLASS="filename">resolv.conf</I>.  Whetheror not we configure a backup name server depends largely on thereliability of the local name server. A good implementation of the<SPANCLASS="acronym">DNS</SPAN> <KBDCLASS="command">named</KBD> will keep running forlonger than some operating systems, so there may be no need for abackup.  If the local name server has a history of problems,though&nbsp;- say it hangs occasionally and stops responding toqueries&nbsp;- it's prudent to add a backup name server.</P><PCLASS="para">To add a backup name server, just list the local name serverfirst in <ICLASS="filename">resolv.conf</I> (at the host's<SPANCLASS="acronym">IP</SPAN> address or the zero address,0.0.0.0&nbsp;- either will do), then one or two backup nameservers. Remember not to use the loopback address unless you know yoursystem's <SPANCLASS="acronym">TCP</SPAN>/<SPANCLASS="acronym">IP</SPAN> stack doesn'thave the problem we mentioned earlier.</P><PCLASS="para">Since we'd rather be safe than sorry, we're going to add twobackup name servers. <ICLASS="systemitem.sitename">postmanrings2x</I> is on the 192.249.249.0network, too, so <ICLASS="systemitem.sitename">terminator</I> and<ICLASS="systemitem.sitename">wormhole</I> are the closest nameservers to it (besides its own). We'll reverse the order in whichthey're tried from the previous resolver-only example, to help balancethe load between the two. The <ICLASS="filename">resolv.conf</I> fileends up looking like this:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">domain movie.edunameserver 0.0.0.0nameserver 192.249.249.3nameserver 192.249.249.1</PRE></BLOCKQUOTE><ACLASS="indexterm"NAME="AUTOID-5082"></A><ACLASS="indexterm"NAME="AUTOID-5083"></A></DIV></DIV><DIVCLASS="htmlnav"><P></P><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch06_01.htm"TITLE="6.1 The Resolver"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 6.1 The Resolver"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="book"HREF="index.htm"TITLE="DNS &amp; BIND"><IMGSRC="../gifs/txthome.gif"ALT="DNS &amp; BIND"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch06_03.htm"TITLE="6.3 Minimizing Pain and Suffering"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 6.3 Minimizing Pain and Suffering"BORDER="0"></A></TD></TR><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172">6.1 The Resolver</TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="index"HREF="index/idx_0.htm"TITLE="Book Index"><IMGSRC="../gifs/index.gif"ALT="Book Index"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172">6.3 Minimizing Pain and Suffering</TD></TR></TABLE><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><PCLASS="nav"><FONTSIZE="-1">[ <AHREF="../index.htm"TITLE="The Networking CD Bookshelf">Library Home</A> | <AHREF="index.htm"TITLE="DNS &amp; BIND">DNS &amp; BIND</A> | <AHREF="../tcpip/index.htm"TITLE="TCP/IP Network Administration">TCP/IP</A> | <AHREF="../sendmail/index.htm"TITLE="sendmail">sendmail</A> | <AHREF="../smdref/index.htm"TITLE="sendmail Desktop Reference">sendmail Reference</A> | <AHREF="../firewall/index.htm"TITLE="Building Internet Firewalls">Firewalls</A> | <AHREF="../puis/index.htm"TITLE="Practical UNIX &amp; Internet Security">Practical Security</A> ]</FONT></P></DIV></BODY></HTML>