<HTML><HEAD><TITLE>[Chapter 6] 6.4 Vendor-Specific Options</TITLE><METANAME="DC.title"CONTENT="DNS &amp; BIND"><METANAME="DC.creator"CONTENT="Cricket Liu &amp; Paul Albitz"><METANAME="DC.publisher"CONTENT="O'Reilly &amp; Associates, Inc."><METANAME="DC.date"CONTENT="1999-01-06T18:29:36Z"><METANAME="DC.type"CONTENT="Text.Monograph"><METANAME="DC.format"CONTENT="text/html"SCHEME="MIME"><METANAME="DC.source"CONTENT="1-56592-512-2"SCHEME="ISBN"><METANAME="DC.language"CONTENT="en-US"><METANAME="generator"CONTENT="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><LINKREV="made"HREF="mailto:online-books@oreilly.com"TITLE="Online Books Comments"><LINKREL="up"HREF="ch06_01.htm"TITLE="6. Configuring Hosts"><LINKREL="prev"HREF="ch06_03.htm"TITLE="6.3 Minimizing Pain and Suffering"><LINKREL="next"HREF="ch07_01.htm"TITLE="7. Maintaining BIND"></HEAD><BODYBGCOLOR="#FFFFFF"TEXT="#000000"><DIVCLASS="htmlnav"><H1><IMGSRC="gifs/smbanner.gif"ALT="DNS &amp; BIND"USEMAP="#srchmap"BORDER="0"></H1><MAPNAME="srchmap"><AREASHAPE="RECT"COORDS="0,0,466,65"HREF="index.htm"ALT="DNS &amp; BIND"><AREASHAPE="RECT"COORDS="467,0,514,18"HREF="../search/dsrch.htm"ALT="Search this book"></MAP><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch06_03.htm"TITLE="6.3 Minimizing Pain and Suffering"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 6.3 Minimizing Pain and Suffering"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><B><FONTFACE="ARIEL,HELVETICA,HELV,SANSERIF"SIZE="-1">Chapter 6<BR>Configuring Hosts</FONT></B></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="CHAPTER"HREF="ch07_01.htm"TITLE="7. Maintaining BIND"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 7. Maintaining BIND"BORDER="0"></A></TD></TR></TABLE>&nbsp;<HRALIGN="LEFT"WIDTH="515"TITLE="footer"></DIV><DIVCLASS="SECT1"><H2CLASS="sect1"><ACLASS="title"NAME="AUTOID-5347">6.4 Vendor-Specific Options</A></H2><PCLASS="para"><ACLASS="indexterm"NAME="DNS3-IDX-6-CONFIGURING-HOSTS-TO-USE-DNS-VENDOR-SPECIFIC-DIFFERENCES"></A><ACLASS="indexterm"NAME="DNS3-IDX-6-RESOLVERS-VENDOR-SPECIFIC-IMPLEMENTATIONS"></A><ACLASS="indexterm"NAME="DNS3-IDX-6-VENDOR-SPECIFIC-BIND-OPTIONS"></A><ACLASS="indexterm"NAME="DNS3-IDX-6-UNIX-VENDOR-SPECIFIC-BIND-IMPLEMENTATIONS"></A><ACLASS="indexterm"NAME="DNS3-IDX-6-HOSTS-CONFIGURING-TO-USE-DNS-VENDOR-SPECIFIC-UNIX-SYSTEMS"></A><SPANCLASS="acronym">UNIX</SPAN> is ostensibly a standard operating system, butthere are almost as many <SPANCLASS="acronym">UNIX</SPAN> standards as flavorsof <SPANCLASS="acronym">UNIX</SPAN>. Likewise, there are almost as manydifferent styles of resolver configuration as there are<SPANCLASS="acronym">UNIX</SPAN>es. Almost all support the original Berkeleysyntax, but most add nonstandard enhancements or variations,too. We'll cover as many of the major styles of resolver configurationas we can.</P><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="AUTOID-5369">6.4.1 Sun's Sun<SPANCLASS="acronym">OS</SPAN> 4.x</A></H3><PCLASS="para"><ACLASS="indexterm"NAME="DNS3-IDX-6-SUNOS-4.X"></A>Configuring a host running Sun<SPANCLASS="acronym">OS</SPAN> can be achallenge. The behavior of the Sun<SPANCLASS="acronym">OS</SPAN> resolver isarguably as different from that of standard <SPANCLASS="acronym">DNS</SPAN> asmajor vendors get&nbsp;- primarily because Sun<SPANCLASS="acronym">OS</SPAN>'sresolver is integrated with Sun's<ACLASS="indexterm"NAME="DNS3-IDX-6-NIS-NETWORK-INFORMATION-SERVICE"></A><ACLASS="indexterm"NAME="AUTOID-5381"></A>Network Information Service, or <SPANCLASS="acronym">NIS</SPAN> (née YellowPages).</P><PCLASS="para"><SPANCLASS="acronym">NIS</SPAN>, briefly, provides a mechanism forkeeping important files synchronized between hosts on a network.  Thisincludes not just <ICLASS="filename">/etc/hosts</I>, but also<ICLASS="filename">/etc/services</I>, <ICLASS="filename">/etc/passwd</I>,and others. Sun positions <SPANCLASS="acronym">DNS</SPAN> as a backup option to<SPANCLASS="acronym">NIS</SPAN>; if the <SPANCLASS="acronym">NIS</SPAN> resolver can'tfind a host name (or <SPANCLASS="acronym">IP</SPAN> address) in the<SPANCLASS="acronym">NIS</SPAN> hosts map, you can configure it to query a nameserver.</P><PCLASS="para">Note that the resolver functionality is implemented as part ofthe<ACLASS="indexterm"NAME="AUTOID-5396"></A><KBDCLASS="command">ypserv</KBD> program, which also handles other types of<SPANCLASS="acronym">NIS</SPAN> queries. So if <KBDCLASS="command">ypserv</KBD> isn'trunning, neither is your resolver! (Mercifully, the resolver inSolaris 2 doesn't require that you run <KBDCLASS="command">ypserv</KBD>.)One benefit of using <KBDCLASS="command">ypserv</KBD> to resolve all queriesis that you don't need to configure the resolvers on<SPANCLASS="acronym">NIS</SPAN> clients, only on <SPANCLASS="acronym">NIS</SPAN>servers.[9] The <SPANCLASS="acronym">NIS</SPAN> clients will query an<SPANCLASS="acronym">NIS</SPAN> server for host data, and the<SPANCLASS="acronym">NIS</SPAN> server will query <SPANCLASS="acronym">DNS</SPAN>, ifnecessary.</P><BLOCKQUOTECLASS="footnote"><PCLASS="para">[9] Actually, you also need to configure the resolver on hosts onwhich you use <KBDCLASS="command">sendmail.mx</KBD>, Sun's<SPANCLASS="acronym">MX</SPAN>-smart version of<KBDCLASS="command">sendmail</KBD>.</P></BLOCKQUOTE><PCLASS="para">If you run Sun<SPANCLASS="acronym">OS</SPAN> 4.X (Solaris 1), you can (1)follow the party line and configure your resolver to use<SPANCLASS="acronym">DNS</SPAN> as a backup to <SPANCLASS="acronym">NIS</SPAN>, (2)choose to run <SPANCLASS="acronym">NIS</SPAN> without host maps, or (3) buckconvention and recompile your resolver to use <SPANCLASS="acronym">DNS</SPAN>exclusively&nbsp;- or you can pick up free copies of modified resolverson the Internet. However, we must warn you that, according to oursources, Sun <EMCLASS="emphasis">will not support</EM> the modifiedresolver option.</P><PCLASS="para">If you run Solaris 2, you can simply configure the resolver likea normal human being. You also have control over the order in whichthe resolver consults various naming services via the<ICLASS="filename">nsswitch.conf</I> file.</P><DIVCLASS="sect3"><H4CLASS="sect3"><ACLASS="title"NAME="AUTOID-5423">6.4.1.1 Modified resolvers</A></H4><PCLASS="para">We won't go into much detail about this option here, primarilybecause this process is now well-documented and nearly automated inthe newest <SPANCLASS="acronym">DNS</SPAN> distribution.  The process itselfusually involves creating a new <ICLASS="filename">libc.so</I>&nbsp;- thestandard, shared C library&nbsp;- by pulling out routines that call<SPANCLASS="acronym">NIS</SPAN> and replacing them with pure<SPANCLASS="acronym">DNS</SPAN> versions. Although Sun generously provides thenecessary replacement routines, they don't support them. Worse, theroutines supplied with Sun<SPANCLASS="acronym">OS</SPAN> 4.1 were based on<SPANCLASS="acronym">DNS</SPAN> 4.8.1.</P><PCLASS="para">If you have the latest <SPANCLASS="acronym">DNS</SPAN> sourcedistribution, look for instructions on installing the<SPANCLASS="acronym">DNS</SPAN> 8.1.2 resolver routines underSun<SPANCLASS="acronym">OS</SPAN> in the package's<ICLASS="filename">src/port/sunos/shres</I> subdirectory, currently in afile called <ICLASS="filename">INSTALL</I>.</P><PCLASS="para">If you'd rather skip the potentially edifying experience ofcreating your own shared C library and leverage someone else'sefforts, you can check out<ACLASS="indexterm"NAME="AUTOID-5439"></A><KBDCLASS="command">resolv+</KBD>, based on the <SPANCLASS="acronym">DNS</SPAN> 4.8.3resolver.</P><PCLASS="para"><KBDCLASS="command">resolv+</KBD> is an enhanced version of the 4.8.3resolver routines for Sun<SPANCLASS="acronym">OS</SPAN>, written by Bill<ACLASS="indexterm"NAME="AUTOID-5446"></A>Wisner, which allows administrators to choose the order in which<SPANCLASS="acronym">NIS</SPAN> and <SPANCLASS="acronym">DNS</SPAN> are queried (muchlike the extensions other vendors have added to<SPANCLASS="acronym">UNIX</SPAN>, which we'll discuss later). The new routinesare available, with instructions on how to build them into<ICLASS="filename">libc.so</I>, from <ACLASS="systemitem.ftpserver"HREF="ftp://ftp.uu.net">ftp.uu.net</A> as the file <ACLASS="systemitem.url"HREF="ftp://ftp.uu.net/networking/ip/dns/resolv+2.1.1.tar.Z">/networking/ip/dns/resolv+2.1.1.tar.Z</A>.For more information on the functionality <KBDCLASS="command">resolv+</KBD>provides, see the Linux section later in this chapter.</P></DIV><DIVCLASS="sect3"><H4CLASS="sect3"><ACLASS="title"NAME="AUTOID-5455">6.4.1.2 Using <SPANCLASS="acronym">DNS</SPAN> with<SPANCLASS="acronym">NIS</SPAN></A></H4><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-5460"></A>If you go the socially acceptable route, though, you'll need tomake <SPANCLASS="acronym">NIS</SPAN> and <SPANCLASS="acronym">DNS</SPAN> coexistpeacefully. That's a little tricky, so we'll go over it in somedetail. We won't cover how to set up<SPANCLASS="acronym">NIS</SPAN>&nbsp;- that's already been covered in gorydetail in Hal Stern's <CITECLASS="citetitle">Managing <SPANCLASS="acronym">NFS</SPAN> and<SPANCLASS="acronym">NIS</SPAN></CITE> (O'Reilly &amp; Associates,1991). Note that these instructions only apply to versions ofSun<SPANCLASS="acronym">OS</SPAN> after 4.1. If you run an older version ofSun<SPANCLASS="acronym">OS</SPAN>, consider the replacement libraries on<ACLASS="systemitem.ftpserver"HREF="ftp://ftp.uu.net">ftp.uu.net</A>.</P><PCLASS="para">First, you'll need to modify the<ACLASS="indexterm"NAME="DNS3-IDX-6-MAKEFILE-NIS"></A><ICLASS="filename">Makefile</I> <SPANCLASS="acronym">NIS</SPAN> uses to build itsmaps&nbsp;- the files that it distributes to other hosts on thenetwork. You should make this modification on the master<SPANCLASS="acronym">NIS</SPAN> server, not on the slaves.</P><PCLASS="para">The <SPANCLASS="acronym">NIS</SPAN> <ICLASS="filename">Makefile</I> livesin <ICLASS="filename">/var/yp/Makefile</I> on a Sun<SPANCLASS="acronym">OS</SPAN>host. The change you need to make is simple: you need to uncomment oneline and comment another. Find the lines that read:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">#B=-bB=</PRE></BLOCKQUOTE><PCLASS="para">and change them to read:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">B=-b#B=</PRE></BLOCKQUOTE><PCLASS="para">Then rebuild your <SPANCLASS="acronym">NIS</SPAN> hosts map:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen"># <CODECLASS="userinput"><B>cd /var/yp</B></CODE># <CODECLASS="userinput"><B>rm hosts.time</B></CODE># <CODECLASS="userinput"><B>make hosts.time</B></CODE>updated hostspushed hosts</PRE></BLOCKQUOTE><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-5493"></A>This will insert a <SPANCLASS="quote">"magic cookie"</SPAN> into the hosts map thatinstructs <SPANCLASS="acronym">NIS</SPAN> to query <SPANCLASS="acronym">DNS</SPAN> if itcan't find a host name in the hosts map. Now, when the<KBDCLASS="command">ypserv</KBD> program looks up a name, it will check theappropriate hosts map for the local <SPANCLASS="acronym">NIS</SPAN><ICLASS="structfield">domainname</I>, and if it can't find the namethere, it will query a name server.  The search list<KBDCLASS="command">ypserv</KBD> uses when it queries the name server isderived from either the local <SPANCLASS="acronym">NIS</SPAN><ICLASS="structfield">domainname</I> or from the<ICLASS="structfield">domain</I> directive in<ICLASS="filename">resolv.conf</I>.</P><PCLASS="para">Next, you should create a <ICLASS="filename">resolv.conf</I> file,if you need one. The rules for configuring the resolver changeslightly with Sun<SPANCLASS="acronym">OS</SPAN>:</P><ULCLASS="itemizedlist"><LICLASS="listitem"><PCLASS="para">You <EMCLASS="emphasis">can't</EM> set the<KBDCLASS="command">hostname</KBD> to a domain name and have the resolverinfer the local domain.</P></LI><LICLASS="listitem"><PCLASS="para">You also can't use the <ICLASS="structfield">search</I>directive in <ICLASS="filename">resolv.conf</I>, since theSun<SPANCLASS="acronym">OS</SPAN> 4.1.1 resolver is based on<SPANCLASS="acronym">DNS</SPAN> 4.8.1. The resolver will silently ignoreit.</P></LI><LICLASS="listitem"><PCLASS="para">You <EMCLASS="emphasis">can</EM> set the <SPANCLASS="acronym">NIS</SPAN><ICLASS="structfield">domainname</I> to a domain name (you have toset it to the name of your <SPANCLASS="acronym">NIS</SPAN> domain if you'reusing <SPANCLASS="acronym">NIS</SPAN>), and the resolver will derive the nameof the local <SPANCLASS="acronym">DNS</SPAN> domain from it. However, thisdoesn't work quite the same way it does with <SPANCLASS="acronym">DNS</SPAN>;if you set <ICLASS="structfield">domainname</I> to <ICLASS="systemitem.sitename">fx.movie.edu</I>, for example, the search listwill only include <ICLASS="systemitem.sitename">movie.edu</I>.Why doesn't the search list include <ICLASS="systemitem.sitename">fx.movie.edu</I>?  Because<SPANCLASS="acronym">NIS</SPAN> assumes it's already checked an authoritativesource of <ICLASS="systemitem.sitename">fx.movie.edu</I> hostdata&nbsp;- the <ICLASS="systemitem.sitename">fx.movie.edu</I>hosts map.</P></LI><LICLASS="listitem"><PCLASS="para">If you want to set the default domain to the same name as your<SPANCLASS="acronym">NIS</SPAN> <ICLASS="structfield">domainname</I>, you canprepend a dot or a plus (<SPANCLASS="quote">"+"</SPAN>) to the<ACLASS="indexterm"NAME="AUTOID-5542"></A><ICLASS="structfield">domainname</I>. To set your default domain to<ICLASS="systemitem.sitename">fx.movie.edu</I>, you could set<ICLASS="structfield">domainname</I> to either <ICLASS="systemitem.sitename">+fx.movie.edu</I> or <ICLASS="systemitem.sitename">.fx.movie.edu</I>.</P></LI><LICLASS="listitem"><PCLASS="para">You can also override <SPANCLASS="acronym">NIS</SPAN>'s normal behaviorby setting the local domain with the<ICLASS="structfield">domain</I>directive in <ICLASS="filename">resolv.conf</I>.  So if you wanted toforce the resolver to include <ICLASS="systemitem.sitename">fx.movie.edu</I> in the search list, you couldadd domain <ICLASS="systemitem.sitename">fx.movie.edu</I> to <ICLASS="filename">resolv.conf</I>.</P></LI><LICLASS="listitem"><PCLASS="para">You can even set the <ICLASS="structfield">domain</I> directivein <ICLASS="filename">resolv.conf</I> to a <SPANCLASS="acronym">DNS</SPAN> domainname totally unrelated to your <SPANCLASS="acronym">NIS</SPAN><ICLASS="structfield">domainname</I>. In some unfortunate situations,the local <SPANCLASS="acronym">NIS</SPAN> <ICLASS="structfield">domainname</I>isn't the same as, or even similar to, the <SPANCLASS="acronym">DNS</SPAN>domain name. Say the Information Technology Department at MovieU. originally set up the <SPANCLASS="acronym">NIS</SPAN> domain <ICLASS="systemitem.sitename">it.dept.movieu</I>, and still uses it. Toprevent spurious <SPANCLASS="acronym">DNS</SPAN> queries in the nonexistent<ICLASS="systemitem.sitename">dept.movieu</I> domain, hosts inthis <SPANCLASS="acronym">NIS</SPAN> domain should be configured with domain<ICLASS="systemitem.sitename">movie.edu</I> (or something similar) in<ICLASS="filename">resolv.conf</I>.</P></LI></UL><PCLASS="para">Finally, Sun's <ICLASS="filename">resolv.conf</I> treats the<ACLASS="indexterm"NAME="AUTOID-5577"></A><ICLASS="structfield">nameserver</I> directive just as vanilla<SPANCLASS="acronym">DNS</SPAN> does. So once you're done inserting magiccookies and configuring your <SPANCLASS="acronym">NIS</SPAN><ICLASS="structfield">domainname</I> and possibly your<SPANCLASS="acronym">DNS</SPAN> domain, you can add any name servers to<ICLASS="filename">resolv.conf</I> and be done.</P></DIV><DIVCLASS="sect3"><H4CLASS="sect3"><ACLASS="title"NAME="AUTOID-5586">6.4.1.3 Ignoring <SPANCLASS="acronym">NIS</SPAN></A></H4><PCLASS="para">If you want to retain Sun's support but would rather not useicky <SPANCLASS="acronym">NIS</SPAN>, you still have an option: you can run<SPANCLASS="acronym">NIS</SPAN> with an empty hosts map. First, set up your<ICLASS="filename">resolv.conf</I> file, then insert the magic cookieinto the <SPANCLASS="acronym">NIS</SPAN> <ICLASS="filename">Makefile</I> as wedescribed in the preceding section, <SPANCLASS="quote">"Using<SPANCLASS="acronym">DNS</SPAN> with <SPANCLASS="acronym">NIS</SPAN>,"</SPAN> and createan empty hosts map. Creating an empty hosts map just requires movingthe <SPANCLASS="acronym">NIS</SPAN> master server's<ACLASS="indexterm"NAME="AUTOID-5599"></A><ACLASS="indexterm"NAME="AUTOID-5602"></A><ICLASS="filename">/etc/hosts</I> file aside temporarily, generatingyour hosts <SPANCLASS="acronym">NIS</SPAN> map, then replacing the<ICLASS="filename">/etc/hosts</I> file:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">% <CODECLASS="userinput"><B>mv /etc/hosts /etc/hosts.tmp</B></CODE>% <CODECLASS="userinput"><B>touch /etc/hosts # to keep make from complaining</B></CODE>% <CODECLASS="userinput"><B>cd /var/yp</B></CODE>% <CODECLASS="userinput"><B>make hosts.time</B></CODE>updated hostspushed hosts% <CODECLASS="userinput"><B>mv /etc/hosts.tmp /etc/hosts</B></CODE></PRE></BLOCKQUOTE><PCLASS="para">Now, when the resolver checks <SPANCLASS="acronym">NIS</SPAN>, it won'tfind anything, and will go directly to querying a domain nameserver.</P><PCLASS="para">If you periodically rebuild your <SPANCLASS="acronym">NIS</SPAN> maps,you should make sure the hosts map doesn't accidentally get rebuiltfrom <ICLASS="filename">/etc/hosts</I>.  The best way to do this is toremove the hosts target from the <SPANCLASS="acronym">NIS</SPAN><ICLASS="filename">Makefile</I>.  You can just comment out everything inthe <ICLASS="filename">Makefile</I> from the line that beginswith:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">hosts.time: $(DIR)/hosts</PRE></BLOCKQUOTE><PCLASS="para">to the next blank line.<ACLASS="indexterm"NAME="AUTOID-5624"></A></P><ACLASS="indexterm"NAME="AUTOID-5626"></A><ACLASS="indexterm"NAME="AUTOID-5627"></A><ACLASS="indexterm"NAME="AUTOID-5628"></A></DIV></DIV><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="AUTOID-5629">6.4.2 Sun's Solaris 2.x</A></H3><PCLASS="para"><ACLASS="indexterm"NAME="DNS3-IDX-6-SOLARIS-2.X"></A><ACLASS="indexterm"NAME="DNS3-IDX-6-SUN-S-SOLARIS-2.X"></A>The resolver in Solaris 2 through 2.5.1 is based on the<SPANCLASS="acronym">DNS</SPAN> 4.8.3 resolver, with extensions to give you theability to determine the order in which the resolver consults the<SPANCLASS="quote">"sources:"</SPAN> <SPANCLASS="acronym">DNS</SPAN>,<SPANCLASS="acronym">NIS</SPAN>, and <ICLASS="filename">/etc/hosts</I>.  Theresolver in Solaris 2.6 is based on the <SPANCLASS="acronym">DNS</SPAN> 4.9.3resolver, with the same extensions.[10] This service order is configured in a file called<ICLASS="filename">nsswitch.conf</I>, which lives in the<ICLASS="filename">/etc</I> directory.</P><BLOCKQUOTECLASS="footnote"><PCLASS="para">[10] You can get patches to update Solaris 2.5 and 2.5.1 to<SPANCLASS="acronym">DNS</SPAN> 4.9.3 via anonymous <KBDCLASS="command">ftp</KBD> from<ICLASS="systemitem.sitename">sunsolve1.sun.com</I> in<ICLASS="filename">/pub/patches</I>.  Check <ACLASS="systemitem.url"HREF="http://sunsolve.sun.com/sunsolve/pubpatches/patches.html">http://sunsolve.sun.com/sunsolve/pubpatches/patches.html</A>for the current patch numbers.</P></BLOCKQUOTE><PCLASS="para">Actually,<ACLASS="indexterm"NAME="AUTOID-5652"></A><ICLASS="filename">nsswitch.conf</I> is used to configure the order inwhich a number of different services are resolved. Individualservices, called <ICLASS="firstterm">databases</I> in Sun's parlance,are selected by a keyword. For naming services, the database name is<ICLASS="structfield">hosts</I>. The possible sources are<ICLASS="structname">dns</I>, <ICLASS="structname">nis</I>,<ICLASS="structname">nisplus</I>, and <ICLASS="structname">files</I>(which refers to <ICLASS="filename">/etc/hosts</I>, in thiscase). Configuring the order in which the sources are consulted is asimple matter of listing them after the database name in thatorder. For example:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">hosts:  dns files</PRE></BLOCKQUOTE><PCLASS="para">has the resolver try <SPANCLASS="acronym">DNS</SPAN> (i.e., query a nameserver) first, then check <ICLASS="filename">/etc/hosts</I>. By default,resolution moves from one source to the next (e.g., falls back to<ICLASS="filename">/etc/hosts</I> from <SPANCLASS="acronym">DNS</SPAN>) only ifthe first source isn't available. You can modify this behavior byusing several other criteria to determine when to move on to the nextsource. The possible criteria are:</P><DLCLASS="variablelist"><DTCLASS="term"><SPANCLASS="acronym">UNAVAIL</SPAN></DT><DDCLASS="listitem"><PCLASS="para">The service hasn't been configured (in <SPANCLASS="acronym">DNS</SPAN>'scase, there is no <ICLASS="filename">resolv.conf</I> file, and there isno name server running on the local host).</P></DD><DTCLASS="term"><SPANCLASS="acronym">NOTFOUND</SPAN></DT><DDCLASS="listitem"><PCLASS="para">The service can't find the name or address in question.</P></DD><DTCLASS="term"><SPANCLASS="acronym">TRYAGAIN</SPAN></DT><DDCLASS="listitem"><PCLASS="para">The service isn't currently available (for example, because theresolver has timed out while trying to look up a name).</P></DD><DTCLASS="term"><SPANCLASS="acronym">SUCCESS</SPAN></DT></DL><PCLASS="para">For each of these criteria, you can specify that the resolvershould either <ICLASS="firstterm">continue</I> or<ICLASS="firstterm">return</I>. For example, if you want the resolverto check <ICLASS="filename">/etc/hosts</I> if <SPANCLASS="acronym">DNS</SPAN>isn't configured or if <SPANCLASS="acronym">DNS</SPAN> can't find the name, youcan use:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">hosts:  dns [NOTFOUND=continue UNAVAIL=continue] files</PRE></BLOCKQUOTE><PCLASS="para">If you want a <SPANCLASS="acronym">DNS</SPAN> <SPANCLASS="acronym">NXDOMAIN</SPAN>(no such domain name) answer to halt the search for the name, you'duse:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">hosts:  dns [NOTFOUND=return]</PRE></BLOCKQUOTE><PCLASS="para">The default Solaris resolver behavior, by the way, is determinedby the answers you give SunInstall.</P><DIVCLASS="sect3"><H4CLASS="sect3"><ACLASS="title"NAME="AUTOID-5701">6.4.2.1 nscd</A></H4><PCLASS="para">In recent versions of Solaris 2.X, including 2.5 and later, Sunintroduced a name service cache daemon, called<ACLASS="indexterm"NAME="AUTOID-5704"></A><KBDCLASS="command">nscd</KBD>.  <KBDCLASS="command">nscd</KBD> caches<ACLASS="indexterm"NAME="AUTOID-5708"></A>the results of lookups in the <ICLASS="filename">passwd</I>, <ICLASS="filename">group</I>, and <ICLASS="filename">hosts</I> databases. Youcan think of <KBDCLASS="command">nscd</KBD> as very similar to a caching-onlyname server, except that it also works for information in <ICLASS="filename">passwd</I> and<ICLASS="filename">group</I> databases.  Sun's intent with <KBDCLASS="command">nscd</KBD> was tospeed up performance by caching frequently-looked-up names.Unfortunately, word on the street is that <KBDCLASS="command">nscd</KBD>sometimes slows <SPANCLASS="acronym">DNS</SPAN> lookups, and many peopledisable it.  Moreover, <KBDCLASS="command">nscd</KBD> interferes with roundrobin (<KBDCLASS="command">nscd</KBD> caches records in one order and doesn'trotate them).</P><PCLASS="para"><KBDCLASS="command">nscd</KBD> is started by default during a multiuserbootup, and reads the configuration file<ICLASS="filename">/etc/nscd.conf</I>.  Administrators can tune a numberof parameters in <ICLASS="filename">nscd.conf</I>.  The most importantof these are:</P><DLCLASS="variablelist"><DTCLASS="term">enable-cache hosts (yes | no)</DT><DDCLASS="listitem"><PCLASS="para">Determines whether or not <KBDCLASS="command">nscd</KBD> caches theresults of host lookups</P></DD><DTCLASS="term">positive-time-to-live hosts value</DT><DDCLASS="listitem"><PCLASS="para">Determines how long <KBDCLASS="command">nscd</KBD> caches positiveresults (e.g., addresses), in seconds</P></DD><DTCLASS="term">negative-time-to-live hosts value</DT><DDCLASS="listitem"><PCLASS="para">Determines how long <KBDCLASS="command">nscd</KBD> caches negativeresults (e.g., <SPANCLASS="acronym">NXDOMAIN</SPAN>), in seconds</P></DD></DL><PCLASS="para">If you're not convinced of <KBDCLASS="command">nscd</KBD>'s usefulness,at least with <SPANCLASS="acronym">DNS</SPAN> lookups, you can use:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">enable-cache hosts no</PRE></BLOCKQUOTE><PCLASS="para">to turn caching off for the hosts database.</P><ACLASS="indexterm"NAME="AUTOID-5747"></A><ACLASS="indexterm"NAME="AUTOID-5748"></A></DIV></DIV><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="AUTOID-5749">6.4.3 <SPANCLASS="acronym">HP</SPAN>'s <SPANCLASS="acronym">HP-UX</SPAN></A></H3><PCLASS="para"><ACLASS="indexterm"NAME="DNS3-IDX-6-HP-UX"></A><SPANCLASS="acronym">HP</SPAN>'s resolver implementation is basically straight<SPANCLASS="acronym">DNS</SPAN>; the <SPANCLASS="acronym">HP-UX</SPAN> 8.0 and 9.0resolvers are based on <SPANCLASS="acronym">DNS</SPAN> 4.8.3, and support thestandard <ICLASS="structfield">domain</I>,<ICLASS="structfield">nameserver</I>, and<ICLASS="structfield">search</I> directives. The order in which ahost consults <SPANCLASS="acronym">DNS</SPAN>, <SPANCLASS="acronym">NIS</SPAN>, and thehost table is hard-wired. The host will use <SPANCLASS="acronym">DNS</SPAN> if<SPANCLASS="acronym">DNS</SPAN> is configured. If <SPANCLASS="acronym">DNS</SPAN> isn'tconfigured, and <SPANCLASS="acronym">NIS</SPAN> is running, the host will use<SPANCLASS="acronym">NIS</SPAN>. If neither <SPANCLASS="acronym">DNS</SPAN> nor<SPANCLASS="acronym">NIS</SPAN> is running, the host will use the hosttable. The host only falls back to using the other services under thecircumstances described earlier in the chapter (i.e., the resolveronly uses one name server&nbsp;- either listed in<ICLASS="filename">resolv.conf</I> or on the local host bydefault&nbsp;- and four errors are received while contacting that nameserver).</P><PCLASS="para">The hard-wired algorithm is less flexible than what othervendors provide, but it's easy to troubleshoot. When you can consult<SPANCLASS="acronym">DNS</SPAN>, <SPANCLASS="acronym">NIS</SPAN>, and the host table inany order, diagnosing user problems can be awfully difficult.</P><PCLASS="para">The <SPANCLASS="acronym">HP-UX</SPAN> 10.30 resolver is based on<SPANCLASS="acronym">DNS</SPAN> 4.9.3, and patches are available for allversions of 10.X to upgrade the server and ancillary programs to<SPANCLASS="acronym">DNS</SPAN> 4.9.6.  To gain access to the patches, visitthe <SPANCLASS="acronym">HP-UX</SPAN> patch archive at <ACLASS="systemitem.url"HREF="http://us-support.external.hp.com/">http://us-support.external.hp.com/</A> and register.You can then search the patch database for the latest patches.</P><PCLASS="para"><SPANCLASS="acronym">HP-UX</SPAN> 10.0 introduced Solaris's<ACLASS="indexterm"NAME="AUTOID-5784"></A><ICLASS="filename">nsswitch.conf</I> functionality; that is, you can use<ICLASS="filename">nsswitch.conf</I> to control the order in which theresolver consults the various naming services.[11] The syntax is exactly the same as that used in Solaris's<ICLASS="filename">nsswitch.conf</I>.  The default settings for the<ICLASS="structname">hosts</I> database under <SPANCLASS="acronym">HP-UX</SPAN>are:</P><BLOCKQUOTECLASS="footnote"><PCLASS="para">[11] Before <SPANCLASS="acronym">HP-UX</SPAN> 10.10, you could only use<ICLASS="filename">nsswitch.conf</I> to configure order of resolutionfor the <ICLASS="structname">hosts</I> database. From 10.10 on, youcan also use <ICLASS="filename">nsswitch.conf</I> to configureresolution order for the <ICLASS="structname">services</I>,<ICLASS="structname">networks</I>, <ICLASS="structname">protocols</I>,<ICLASS="structname">rpc</I>, and <ICLASS="structname">netgroup</I>databases.</P></BLOCKQUOTE><BLOCKQUOTECLASS="screen"><PRECLASS="screen">hosts: dns nis files</PRE></BLOCKQUOTE><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-5804"></A>This functionality is also available in patches for<SPANCLASS="acronym">HP-UX</SPAN> 9.0. Check the web-based<SPANCLASS="acronym">HP-UX</SPAN> patch archive for these. You may need quite afew patches:</P><ULCLASS="itemizedlist"><LICLASS="listitem"><PCLASS="para">One for the standard, shared C library,<ICLASS="filename">libc.so</I>, which contains the resolver routines in<SPANCLASS="acronym">HP-UX</SPAN></P></LI><LICLASS="listitem"><PCLASS="para">One for the <KBDCLASS="command">mount</KBD> command, which isstatically linked</P></LI><LICLASS="listitem"><PCLASS="para">One for <KBDCLASS="command">nslookup</KBD></P></LI><LICLASS="listitem"><PCLASS="para">One for the <KBDCLASS="command">ifconfig</KBD> and<KBDCLASS="command">route</KBD> commands</P></LI><LICLASS="listitem"><PCLASS="para">One for <SPANCLASS="acronym">HP</SPAN>'s Visual User Environment(<SPANCLASS="acronym">VUE</SPAN>), which is shipped statically linked</P></LI></UL><PCLASS="para">The <SPANCLASS="acronym">HP-UX</SPAN> 10.30 resolver also supports the<SPANCLASS="acronym">DNS</SPAN> 4.9.3 search list behavior and the<ICLASS="structfield">options ndots</I> directive.</P><ACLASS="indexterm"NAME="AUTOID-5832"></A></DIV><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="AUTOID-5833">6.4.4 <SPANCLASS="acronym">IBM</SPAN>'s <SPANCLASS="acronym">AIX</SPAN></A></H3><PCLASS="para"><ACLASS="indexterm"NAME="DNS3-IDX-6-AIX"></A><ACLASS="indexterm"NAME="DNS3-IDX-6-IBM-S-AIX"></A>The resolver shipped with the current version of<SPANCLASS="acronym">AIX</SPAN>, 4.2.1, is also relatively standard. The codeis based on <SPANCLASS="acronym">DNS</SPAN> 4.9.3, so it understands the<ICLASS="structfield">domain</I>, <ICLASS="structfield">search</I>,<ICLASS="structfield">nameserver</I>,<ICLASS="structfield">options</I>, and<ICLASS="structfield">sortlist</I> directives; <SPANCLASS="acronym">AIX</SPAN>supports up to three <ICLASS="structfield">nameserver</I> directives.<SPANCLASS="acronym">AIX</SPAN> versions 4 and 4.1 were based on<SPANCLASS="acronym">DNS</SPAN> 4.8.3, so they handle all the directives<SPANCLASS="acronym">AIX</SPAN> 4.2.1's resolver does except<ICLASS="structfield">options</I> and<ICLASS="structfield">sortlist</I>.</P><PCLASS="para">One difference between <SPANCLASS="acronym">AIX</SPAN>'s behavior and thestock <SPANCLASS="acronym">BSD</SPAN> behavior is that <SPANCLASS="acronym">AIX</SPAN>uses the existence of the<ACLASS="indexterm"NAME="AUTOID-5860"></A><ICLASS="filename">resolv.conf</I> file to determine whether to query aname server. If <ICLASS="filename">resolv.conf</I> doesn't exist on thelocal host, the resolver reads <ICLASS="filename">/etc/hosts</I>.  Thismeans that on a host running a name server, you should create azero-length <ICLASS="filename">/etc/resolv.conf</I> file, even if youdon't intend to put any directives in it.</P><PCLASS="para"><SPANCLASS="acronym">IBM</SPAN> has also modified the resolver so that itchecks <SPANCLASS="acronym">NIS</SPAN> and then<ICLASS="filename">/etc/hosts</I>, even if <SPANCLASS="acronym">DNS</SPAN> claimsthere's no such domain name or no such data.  This gives you theability to add hosts to <ICLASS="filename">/etc/hosts</I> temporarily,before they make it into the name server, and will let you maintainyour own host-specific name-to-address mappings.</P><PCLASS="para"><SPANCLASS="acronym">AIX</SPAN> 4.2.1 also includes a mechanism tocontrol resolution order similar to Solaris's<ICLASS="filename">nsswitch.conf</I>. <SPANCLASS="acronym">AIX</SPAN> uses a filecalled<ACLASS="indexterm"NAME="AUTOID-5876"></A><ACLASS="indexterm"NAME="AUTOID-5878"></A><ICLASS="filename">/etc/netsvc.conf</I>.  Like<ICLASS="filename">nsswitch.conf</I>, <ICLASS="filename">netsvc.conf</I>calls the database <ICLASS="structname">hosts</I>, but uses an equalssign between the database name and the sources instead of a colon,uses commas between sources, uses <ICLASS="wordasword">bind</I> for<SPANCLASS="acronym">DNS</SPAN>, and uses <ICLASS="wordasword">local</I> for<ICLASS="filename">/etc/hosts</I>.  So:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">hosts = local,nis,bind</PRE></BLOCKQUOTE><PCLASS="para">has the <SPANCLASS="acronym">AIX</SPAN> resolver check the local<ICLASS="filename">/etc/hosts</I> first, then check the<SPANCLASS="acronym">NIS</SPAN> <ICLASS="structname">hosts</I> map, and finallytry <SPANCLASS="acronym">DNS</SPAN>. Individual users or processes can overridethe system-wide resolution order configured with<ICLASS="filename">netsvc.conf</I> by setting an environment variable,<ICLASS="envar">NSORDER</I>. <SPANCLASS="acronym">NSORDER</SPAN> uses the samesyntax <ICLASS="filename">netsvc.conf</I> does, minus the database nameand equal sign. So to change the resolution order for your user tocheck <SPANCLASS="acronym">DNS</SPAN> first and then<ICLASS="filename">/etc/hosts</I>, ignoring <SPANCLASS="acronym">NIS</SPAN>, youcould run:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">% <CODECLASS="userinput"><B>NSORDER=bind,local; export NSORDER</B></CODE></PRE></BLOCKQUOTE><PCLASS="para"><SPANCLASS="acronym">AIX</SPAN> 3.2's resolver was based on the<SPANCLASS="acronym">DNS</SPAN> 4.8.1 resolver, so it doesn't understand the<ICLASS="structfield">search</I> directive.  It exhibits the samepeculiarities with respect to the existence of<ICLASS="filename">resolv.conf</I> that the 4.1 resolver does.  Forthose of you with older <SPANCLASS="acronym">AIX</SPAN> 3.2 installations,there is a patch, <SPANCLASS="acronym">PTF</SPAN> U412845, that will let youshorten the resolver timeout so that <SPANCLASS="acronym">AIX</SPAN> will fallback to <ICLASS="filename">/etc/hosts</I> more quickly thannormal. There are also instructions on using Bill Wisner's<KBDCLASS="command">resolv+</KBD> package with <SPANCLASS="acronym">AIX</SPAN> in the<SPANCLASS="acronym">AIX</SPAN> <SPANCLASS="acronym">FAQ</SPAN>, posted periodically to<ACLASS="systemitem.newsgroup"HREF="news:comp.unix.aix">comp.unix.aix</A> and archivedon <ACLASS="systemitem.ftpserver"HREF="ftp://rtfm.mit.edu">rtfm.mit.edu</A> in <ACLASS="systemitem.url"HREF="ftp://rtfm.mit.edu/pub/usenet/news.answers/aix-faq/">/pub/usenet/news.answers/aix-faq/</A>.Use at your own risk. For more information on<KBDCLASS="command">resolv+</KBD>'s functionality, see the Linux sectionlater in this chapter.</P><PCLASS="para">We should also note that you can configure the resolver using<SPANCLASS="acronym">AIX</SPAN>'s System Management Interface Tool(<SPANCLASS="acronym">SMIT</SPAN>).<ACLASS="indexterm"NAME="AUTOID-5924"></A><ACLASS="indexterm"NAME="AUTOID-5925"></A></P></DIV><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="AUTOID-5926">6.4.5 Digital's Digital <SPANCLASS="acronym">UNIX</SPAN></A></H3><PCLASS="para"><ACLASS="indexterm"NAME="DNS3-IDX-6-DIGITAL-UNIX"></A>The resolver shipped with the most recent version of Digital<SPANCLASS="acronym">UNIX</SPAN>, 4.0D, is based on the <SPANCLASS="acronym">DNS</SPAN>4.9.3 resolver.  As such, it understands all five resolver directivescovered in this chapter.</P><PCLASS="para">Digital <SPANCLASS="acronym">UNIX</SPAN> allows you to configure theorder in which the resolver checks <SPANCLASS="acronym">NIS</SPAN>,<SPANCLASS="acronym">DNS</SPAN>, and the host table via a file called<ACLASS="indexterm"NAME="AUTOID-5938"></A><ICLASS="filename">svc.conf</I> (see the<ICLASS="filename">svc.conf</I>(5) manpage).[12] <ICLASS="filename">svc.conf</I> also allows you to configurewhich services are consulted for other <SPANCLASS="quote">"databases,"</SPAN>including mail aliases, authentication checks (mapping from<SPANCLASS="acronym">IP</SPAN> address to host or domain names), password andgroup information, and a slew of other things.</P><BLOCKQUOTECLASS="footnote"><PCLASS="para">[12] Digital's <SPANCLASS="quote">"other"</SPAN> <SPANCLASS="acronym">UNIX</SPAN> operatingsystem, Ultrix, also supports <ICLASS="filename">svc.conf</I>.</P></BLOCKQUOTE><PCLASS="para">To configure the resolver with <ICLASS="filename">svc.conf</I>,use the database name <ICLASS="structname">hosts</I>, followed by anequals sign and the keywords for the services you want checked,separated by commas, in the order you want them checked. The legalkeywords for <ICLASS="structname">hosts</I> are<ICLASS="wordasword">local</I> (the local host table),<ICLASS="wordasword">yp</I> (for <SPANCLASS="quote">"Yellow Pages,"</SPAN> the oldname for <SPANCLASS="acronym">NIS</SPAN>), and <ICLASS="wordasword">bind</I>(for <SPANCLASS="acronym">DNS</SPAN>). <ICLASS="wordasword">local</I> must bethe first service listed for <ICLASS="structname">hosts</I>. Don't useany whitespace on the line, except (optionally) after commas and atthe end of the line.</P><PCLASS="para">The line:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">hosts=local,bind</PRE></BLOCKQUOTE><PCLASS="para">instructs the resolver to check <ICLASS="filename">/etc/hosts</I>for host names first, and if no match is found, to use domain nameservice.  This is very useful when the host has a small local hosttable that includes the local host's domain name and<SPANCLASS="acronym">IP</SPAN> address, the host's default router, and anyother hosts referenced during startup. Checking the local host tablefirst avoids any problems using domain name service during startup,when networking and <KBDCLASS="command">named</KBD> may not havestarted.</P><PCLASS="para">Digital <SPANCLASS="acronym">UNIX</SPAN> also includes a utility called<ACLASS="indexterm"NAME="AUTOID-5970"></A><KBDCLASS="command">svcsetup</KBD> (see the <KBDCLASS="command">svcsetup</KBD>(8) manpage), which allows you to set up the <ICLASS="filename">svc.conf</I>file interactively, without the aid of an editor. Typing<KBDCLASS="command">svcsetup</KBD> will throw you into a mode where you canchoose the database you'd like to configure, and will prompt you forthe order of the services you want checked.<ACLASS="indexterm"NAME="AUTOID-5976"></A></P></DIV><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="AUTOID-5977">6.4.6 Silicon Graphics' <SPANCLASS="acronym">IRIX</SPAN></A></H3><PCLASS="para">As of<ACLASS="indexterm"NAME="AUTOID-5981"></A><ACLASS="indexterm"NAME="AUTOID-5983"></A><SPANCLASS="acronym">IRIX</SPAN> 6.2, <SPANCLASS="acronym">IRIX</SPAN> has a<SPANCLASS="acronym">DNS</SPAN> 4.9.3 name server, but the resolver is stillessentially 4.8.3. There are also patches available to bring theserver up to <SPANCLASS="acronym">DNS</SPAN> 4.9.4.  For the current patch numbers, see <ACLASS="systemitem.url"HREF="http://support.sgi.com/surfzone/patches/browse/index.html">http://support.sgi.com/surfzone/patches/browse/index.html</A>(you'll need to register if you aren'talready a SurfZone member).</P><PCLASS="para">The <SPANCLASS="acronym">IRIX</SPAN><ACLASS="indexterm"NAME="AUTOID-5992"></A><ICLASS="filename">resolv.conf</I> file, which lives in<ICLASS="filename">/usr/etc/resolv.conf</I>, adds a<ACLASS="indexterm"NAME="AUTOID-5996"></A><ICLASS="structfield">hostresorder</I> directive.  The<ICLASS="structfield">hostresorder</I> directive allows theadministrator to determine the order in which <SPANCLASS="acronym">NIS</SPAN>,<SPANCLASS="acronym">DNS</SPAN>, and the local host table aresearched. Individual users can set the environment variable<ACLASS="indexterm"NAME="AUTOID-6002"></A><ICLASS="envar">HOSTRESORDER</I> to determine the order in which theservices are used for their commands.</P><PCLASS="para"><ICLASS="structfield">hostresorder</I> takes one or more of thekeywords <ICLASS="wordasword">nis</I>, <ICLASS="wordasword">bind</I>,and <ICLASS="wordasword">local</I> as arguments. (The keywordscorrespond to the obvious services.) The keywords may be separated byeither whitespace or a slash. Whitespace indicates that the nextservice should be tried if the previous service doesn't return ananswer (e.g., the name isn't found in the host table, or the nameserver returns <SPANCLASS="quote">"no such domain"</SPAN>) or isn't available(e.g., the name server isn't running). A slash indicates that thepreceding service is authoritative, and if no answer is returned,resolution should stop. The next service is tried only if the previousisn't available.</P></DIV><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="AUTOID-6012">6.4.7 <SPANCLASS="acronym">SCO</SPAN>'s Open Server 5.0</A></H3><PCLASS="para">The newest release of <SPANCLASS="acronym">SCO</SPAN>'s<SPANCLASS="acronym">UNIX</SPAN> operating system,<ACLASS="indexterm"NAME="AUTOID-6018"></A><ACLASS="indexterm"NAME="AUTOID-6020"></A>Open Server 5.0.X, has a resolver based on the <SPANCLASS="acronym">DNS</SPAN>4.9.2 resolver. As a 4.9.2-derived resolver, it understands all of thenormal directives (including <ICLASS="structfield">sortlist</I> and<ICLASS="structfield">options</I>!) in<ICLASS="filename">resolv.conf</I> plus<ICLASS="structfield">hostresorder</I>. <ICLASS="structfield">hostresorder</I>works exactly the same way it does in <SPANCLASS="acronym">IRIX</SPAN> (see thesection on <SPANCLASS="acronym">IRIX</SPAN> immediately preceding thissection); the keywords are the same (<ICLASS="wordasword">bind</I>,<ICLASS="wordasword">nis</I>, and<ICLASS="wordasword">local</I>), and a slash, instead of aspace, indicates that the preceding service is authoritative and thesearch should return if that service doesn't find the name. Thedefault setting (without <ICLASS="structfield">hostresorder</I>configured) is equivalent to:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">hostresorder bind nis local</PRE></BLOCKQUOTE><PCLASS="para">Also, even if resolution order isn't explicitly configured, if<SPANCLASS="acronym">DNS</SPAN> and <SPANCLASS="acronym">NIS</SPAN> aren't available,the resolver will use <ICLASS="filename">/etc/hosts</I>.</P><PCLASS="para">You can override anything configured with<ICLASS="structfield">domain</I>, <ICLASS="structfield">options</I>,or <ICLASS="structfield">hostresorder</I> in<ICLASS="filename">resolv.conf</I> with the<ACLASS="indexterm"NAME="AUTOID-6045"></A><ACLASS="indexterm"NAME="AUTOID-6048"></A><ACLASS="indexterm"NAME="AUTOID-6051"></A>environment variables <ICLASS="envar">LOCALDOMAIN</I>,<ICLASS="envar">RES_OPTIONS</I>, and <ICLASS="envar">HOSTRESORDER</I>,respectively.  For example, to change resolution order to<SPANCLASS="acronym">DNS</SPAN>-only and the options to set<ICLASS="structfield">ndots</I> to 1 before starting sendmail, youcould run:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">% <CODECLASS="userinput"><B>HOSTRESORDER=&quot;dns&quot;; RES_OPTIONS=&quot;ndots:1&quot;</B></CODE>% <CODECLASS="userinput"><B>export HOSTRESORDER RES_OPTIONS</B></CODE>% <CODECLASS="userinput"><B>/usr/lib/sendmail -bd -q1h</B></CODE></PRE></BLOCKQUOTE></DIV><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="AUTOID-6063">6.4.8 Linux</A></H3><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-6066"></A>Since we first published this book, Linux has taken the computingworld by storm. A couple of the reasons are that Linux is freeware,and that it does a better job of keeping up with developments in the<SPANCLASS="acronym">UNIX</SPAN> and Internet communities than any vendor'sversion of <SPANCLASS="acronym">UNIX</SPAN>.  Attesting to that is the factthat RedHat Linux 5.1, the latest version of one of the predominantstrains of Linux, ships with a <SPANCLASS="acronym">DNS</SPAN> 4.9.6 resolverand server. The resolver also supports Sun's<ICLASS="filename">nsswitch.conf</I> file.</P><PCLASS="para">However, some older Linux resolvers are based on Bill Wisner's<ACLASS="indexterm"NAME="AUTOID-6073"></A><KBDCLASS="command">resolv+</KBD> library, which is in turn based on<SPANCLASS="acronym">DNS</SPAN> 4.8.3. Consequently, the<ICLASS="filename">resolv.conf</I> file can include any legit 4.8.3resolver directives (<ICLASS="structfield">domain</I>,<ICLASS="structfield">search</I>, and<ICLASS="structfield">nameserver</I>, but not<ICLASS="structfield">options</I>) and has the older default searchlist described in this chapter.</P><PCLASS="para"><KBDCLASS="command">resolv+</KBD>, as the name suggests, also providesseveral enhancements over the standard 4.8.3 resolver. They includethe ability to determine the order in which <SPANCLASS="acronym">DNS</SPAN>,<SPANCLASS="acronym">NIS</SPAN>, and <ICLASS="filename">/etc/hosts</I> areconsulted (replaced by the more standard<ICLASS="filename">nsswitch.conf</I> in newer versions), the ability todetect certain types of <SPANCLASS="acronym">DNS</SPAN> spoofing, and theability to reorder address records in replies to favor localsubnets.</P><PCLASS="para">All of these enhancements are controlled by the<ICLASS="filename">/etc/hosts.conf</I> file. The most interestingkeywords that <ICLASS="filename">hosts.conf</I> accepts are:</P><DLCLASS="variablelist"><DTCLASS="term"><ACLASS="indexterm"NAME="AUTOID-6095"></A>order</DT><DDCLASS="listitem"><PCLASS="para">Controls the order in which the various name services areconsulted; the valid arguments are <ICLASS="wordasword">bind</I>,<ICLASS="wordasword">hosts</I>, and <ICLASS="wordasword">nis</I>, atleast one of which must follow the keyword. Multiple arguments must beseparated by commas.</P></DD><DTCLASS="term"><ACLASS="indexterm"NAME="AUTOID-6104"></A>nospoof</DT><DDCLASS="listitem"><PCLASS="para">Takes the single argument <ICLASS="wordasword">on</I> or<ICLASS="wordasword">off</I>. <ICLASS="structfield">nospoof</I>instructs the resolver to check any reverse mapping(<SPANCLASS="acronym">PTR</SPAN>) information it gets from remote name serversby issuing a forward (address) query for the domain name in thereply. If the address returned by the address query isn't the same asthe address the resolver originally tried to reverse map, the<SPANCLASS="acronym">PTR</SPAN> record is ignored.</P></DD><DTCLASS="term"><ACLASS="indexterm"NAME="AUTOID-6115"></A>reorder</DT><DDCLASS="listitem"><PCLASS="para">Takes the single argument <ICLASS="wordasword">on</I> or<ICLASS="wordasword">off</I>.  With <ICLASS="structfield">reorder</I>on, the resolver sorts the addresses of multiply-homed hosts so thatany address on a local subnet appears first.</P></DD></DL></DIV><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="AUTOID-6122">6.4.9 Windows 95</A></H3><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-6125"></A><ACLASS="indexterm"NAME="AUTOID-6127"></A>Windows 95, the successor to the popular Windows operating system,includes its own <SPANCLASS="acronym">TCP</SPAN>/<SPANCLASS="acronym">IP</SPAN> stackwith a <SPANCLASS="acronym">DNS</SPAN> resolver. In fact, Windows 95 actuallyincludes two <SPANCLASS="acronym">TCP</SPAN>/<SPANCLASS="acronym">IP</SPAN> stacks: onefor <SPANCLASS="acronym">TCP</SPAN>/<SPANCLASS="acronym">IP</SPAN> over<SPANCLASS="acronym">LAN</SPAN>s, and another for<SPANCLASS="acronym">TCP</SPAN>/<SPANCLASS="acronym">IP</SPAN> over dialupconnections. Configuration of the resolver in Windows 95 is, naturallyenough, graphical. To get to the main <SPANCLASS="acronym">DNS</SPAN>configuration panel, start the Control Panel, then select<ICLASS="guiicon">Network</I>, then choose the<SPANCLASS="acronym">TCP</SPAN>/<SPANCLASS="acronym">IP</SPAN> protocol. This brings upa new dialog, which looks similar to the one in <ACLASS="xref"HREF="ch06_04.htm#DNS3-CHP-6-FIG-1"TITLE="Resolver configuration under Windows 95">Figure 6.1</A>. Choose thetab labeled <ICLASS="guilabel"><SPANCLASS="acronym">DNS</SPAN>Configuration</I>.</P><H4CLASS="figure"><ACLASS="title"NAME="DNS3-CHP-6-FIG-1">Figure 6.1: Resolver configuration under Windows 95</A></H4><IMGCLASS="graphic"SRC="figs/dns3_0601.gif"ALT="Figure 6.1"><PCLASS="para">Configuration using this panel is fairly self-explanatory: youcheck <ICLASS="guibutton">Enable <SPANCLASS="acronym">DNS</SPAN></I> to turn on<SPANCLASS="acronym">DNS</SPAN> resolution, then fill in the<SPANCLASS="acronym">PC</SPAN>'s hostname (in this case, the first label of itsdomain name) in the <ICLASS="guilabel">Host</I> field, and the localdomain (everything after the first dot) in the<ICLASS="guilabel">Domain</I> field.  You add the <SPANCLASS="acronym">IP</SPAN>addresses of the name servers you want to query, in the order in whichyou want to query them, under <ICLASS="guilabel"><SPANCLASS="acronym">DNS</SPAN> ServerSearch Order</I>. Finally, you fill in the domains in thesearch list under <ICLASS="guilabel">Domain Suffix Search Order</I> inthe order in which you want them applied.</P><PCLASS="para">One interesting note about the current version of Windows 95:you can configure a different set of name servers for each dial-upconnection you might have to an Internet service provider(<SPANCLASS="acronym">ISP</SPAN>) in the<ACLASS="indexterm"NAME="AUTOID-6162"></A><ACLASS="indexterm"NAME="AUTOID-6165"></A><ACLASS="indexterm"NAME="AUTOID-6167"></A>Dial-Up Networking (<SPANCLASS="acronym">DUN</SPAN>) configuration.  Toconfigure <SPANCLASS="acronym">DUN</SPAN>-specific resolver settings,double-click on the <ICLASS="guiicon">My Computer</I> icon on yourdesktop, then double-click on <ICLASS="guiicon">Dial-Up Networking</I>,right-click on the name of the connection whose resolver settingsyou'd like to configure, then select<ICLASS="guimenuitem">Properties</I>.  Select the <ICLASS="guilabel">ServerTypes</I> tab and click on<ICLASS="guilabel"><SPANCLASS="acronym">TCP</SPAN>/<SPANCLASS="acronym">IP</SPAN>Settings</I>.  You'll see the window shown in <ACLASS="xref"HREF="ch06_04.htm#DNS3-CHP-6-FIG-2"TITLE="DUN resolver configuration under Windows 95">Figure 6.2</A>.</P><H4CLASS="figure"><ACLASS="title"NAME="DNS3-CHP-6-FIG-2">Figure 6.2: DUN resolver configuration under Windows 95</A></H4><IMGCLASS="graphic"SRC="figs/dns3_0602.gif"ALT="Figure 6.2"><PCLASS="para">If you leave the <ICLASS="guibutton">Server assigned name serveraddresses</I> radio button checked, the resolver will retrievethe name servers it should query from the <SPANCLASS="acronym">DHCP</SPAN>server you dial into.  If you check <ICLASS="guibutton">Specify name serveraddresses</I> and specify the addresses of one or two nameservers, Windows 95 will try to use those name servers when the<SPANCLASS="acronym">DUN</SPAN> connection is active.</P><PCLASS="para">This is really useful if you use multiple<SPANCLASS="acronym">ISP</SPAN>s and each has its own name servers. However,configuring name servers in the<SPANCLASS="acronym">TCP</SPAN>/<SPANCLASS="acronym">IP</SPAN> Properties panel<EMCLASS="emphasis">overrides</EM> the <SPANCLASS="acronym">DUN</SPAN>-specificname servers. To use the <SPANCLASS="acronym">DUN</SPAN>-specific name serverfeature, you must leave the<SPANCLASS="acronym">TCP</SPAN>/<SPANCLASS="acronym">IP</SPAN> Properties panel blankexcept for enabling <SPANCLASS="acronym">DNS</SPAN> and specifying the localhostname. This limitation is probably just an oversight due to a lackof integration between the dial-up and <SPANCLASS="acronym">LAN</SPAN><SPANCLASS="acronym">TCP</SPAN>/<SPANCLASS="acronym">IP</SPAN> stacks, and should becorrected in a future release of Windows 95.</P><PCLASS="para">Lest you think this is the only idiosyncrasy in the way that<SPANCLASS="acronym">DNS</SPAN> resolution works on Windows 95, we'll point youto the Windows 95 Networking <SPANCLASS="acronym">FAQ</SPAN>, maintained byRich Graves, at <ACLASS="systemitem.url"HREF="http://www-leland.stanford.edu/~llurch/win95netbugs/faq.html">http://www-leland.stanford.edu/~llurch/win95netbugs/faq.html</A>.This <SPANCLASS="acronym">FAQ</SPAN> contains lots of valuable<SPANCLASS="acronym">DNS</SPAN> information, including how to change the orderin which the Win95 resolver uses the <SPANCLASS="acronym">LMHOSTS</SPAN> file,<SPANCLASS="acronym">WINS</SPAN>,<ACLASS="indexterm"NAME="AUTOID-6208"></A><ACLASS="indexterm"NAME="AUTOID-6210"></A>and <SPANCLASS="acronym">DNS</SPAN>.</P></DIV><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="AUTOID-6213">6.4.10 Windows <SPANCLASS="acronym">NT</SPAN></A></H3><PCLASS="para">In<ACLASS="indexterm"NAME="AUTOID-6217"></A><ACLASS="indexterm"NAME="AUTOID-6220"></A>Windows <SPANCLASS="acronym">NT</SPAN>, <SPANCLASS="acronym">LAN</SPAN> resolverconfiguration is done from a single panel that looks remarkablysimilar to Windows 95's now that <SPANCLASS="acronym">NT</SPAN>4.0&nbsp;- which includes the Windows 95<SPANCLASS="quote">"shell"</SPAN>&nbsp;- has been released. In fact, other than thepresence of handy little arrows that allow you to reorder name serversand elements of the search list, there's really no semantic differencebetween them, as shown in <ACLASS="xref"HREF="ch06_04.htm#DNS3-CHP-6-FIG-3"TITLE="Resolver configuration under Windows NT">Figure 6.3</A>.<ACLASS="indexterm"NAME="AUTOID-6228"></A><ACLASS="indexterm"NAME="AUTOID-6231"></A></P><H4CLASS="figure"><ACLASS="title"NAME="DNS3-CHP-6-FIG-3">Figure 6.3: Resolver configuration under Windows NT</A></H4><IMGCLASS="graphic"SRC="figs/dns3_0603.gif"ALT="Figure 6.3"><PCLASS="para">To get to the <SPANCLASS="acronym">DNS</SPAN> configuration panel, startthe Control Panel, click on <ICLASS="guiicon">Network</I>, and select the <ICLASS="guilabel">Protocols</I> tab.Double-click on <ICLASS="guilabel">TCP/IP Protocol</I>,then select the <ICLASS="guilabel">DNS</I> tab.</P><PCLASS="para">Windows <SPANCLASS="acronym">NT</SPAN> also allows the user to configureresolver settings specific to particular dialup networkingconnections.  To configure these, click on the <ICLASS="guiicon">My Computer</I> icon, start<ICLASS="guimenuitem">Dial Up Networking</I>, pull down the top selection box and choose thename of the <SPANCLASS="acronym">DUN</SPAN> connection whose resolver you'dlike to configure.  Then click on the <ICLASS="guimenuitem">More</I> pull-down and select <ICLASS="guimenuitem">EditEntry and Modem Properties</I>. Select the <ICLASS="guilabel">Server</I> tab on the resultingwindow, and click on the <ICLASS="guibutton">TCP/IPSettings</I> button.  You'll see the very same window you'd see in Windows95 (shown earlier).  If you leave the <ICLASS="guibutton">Server assigned name serveraddresses</I> radio button checked, the resolver will retrieve the nameservers it should query from the <SPANCLASS="acronym">DHCP</SPAN> server youdial into.  If you check <ICLASS="guibutton">Specify name server addresses</I> and specify theaddresses of one or two name servers, Windows <SPANCLASS="acronym">NT</SPAN>will use those name servers when the <SPANCLASS="acronym">DUN</SPAN> connectionis active.  When you drop the <SPANCLASS="acronym">DUN</SPAN> connection,<SPANCLASS="acronym">NT</SPAN> will revert to using the <SPANCLASS="acronym">LAN</SPAN>resolver's<ACLASS="indexterm"NAME="AUTOID-6260"></A><ACLASS="indexterm"NAME="AUTOID-6261"></A><ACLASS="indexterm"NAME="AUTOID-6262"></A><ACLASS="indexterm"NAME="AUTOID-6263"></A><ACLASS="indexterm"NAME="AUTOID-6264"></A>settings.<ACLASS="indexterm"NAME="AUTOID-6265"></A><ACLASS="indexterm"NAME="AUTOID-6266"></A><ACLASS="indexterm"NAME="AUTOID-6267"></A></P></DIV></DIV><DIVCLASS="htmlnav"><P></P><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch06_03.htm"TITLE="6.3 Minimizing Pain and Suffering"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 6.3 Minimizing Pain and Suffering"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="book"HREF="index.htm"TITLE="DNS &amp; BIND"><IMGSRC="../gifs/txthome.gif"ALT="DNS &amp; BIND"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="CHAPTER"HREF="ch07_01.htm"TITLE="7. Maintaining BIND"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 7. Maintaining BIND"BORDER="0"></A></TD></TR><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172">6.3 Minimizing Pain and Suffering</TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="index"HREF="index/idx_0.htm"TITLE="Book Index"><IMGSRC="../gifs/index.gif"ALT="Book Index"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172">7. Maintaining BIND</TD></TR></TABLE><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><PCLASS="nav"><FONTSIZE="-1">[ <AHREF="../index.htm"TITLE="The Networking CD Bookshelf">Library Home</A> | <AHREF="index.htm"TITLE="DNS &amp; BIND">DNS &amp; BIND</A> | <AHREF="../tcpip/index.htm"TITLE="TCP/IP Network Administration">TCP/IP</A> | <AHREF="../sendmail/index.htm"TITLE="sendmail">sendmail</A> | <AHREF="../smdref/index.htm"TITLE="sendmail Desktop Reference">sendmail Reference</A> | <AHREF="../firewall/index.htm"TITLE="Building Internet Firewalls">Firewalls</A> | <AHREF="../puis/index.htm"TITLE="Practical UNIX &amp; Internet Security">Practical Security</A> ]</FONT></P></DIV></BODY></HTML>