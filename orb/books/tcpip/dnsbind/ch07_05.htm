<HTML><HEAD><TITLE>[Chapter 7] 7.5 BIND 8 Logging</TITLE><METANAME="DC.title"CONTENT="DNS &amp; BIND"><METANAME="DC.creator"CONTENT="Cricket Liu &amp; Paul Albitz"><METANAME="DC.publisher"CONTENT="O'Reilly &amp; Associates, Inc."><METANAME="DC.date"CONTENT="1999-01-06T18:31:41Z"><METANAME="DC.type"CONTENT="Text.Monograph"><METANAME="DC.format"CONTENT="text/html"SCHEME="MIME"><METANAME="DC.source"CONTENT="1-56592-512-2"SCHEME="ISBN"><METANAME="DC.language"CONTENT="en-US"><METANAME="generator"CONTENT="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><LINKREV="made"HREF="mailto:online-books@oreilly.com"TITLE="Online Books Comments"><LINKREL="up"HREF="ch07_01.htm"TITLE="7. Maintaining BIND"><LINKREL="prev"HREF="ch07_04.htm"TITLE="7.4 Changing BIND 8 System File Locations"><LINKREL="next"HREF="ch07_06.htm"TITLE="7.6 Keeping Everything Running Smoothly"></HEAD><BODYBGCOLOR="#FFFFFF"TEXT="#000000"><DIVCLASS="htmlnav"><H1><IMGSRC="gifs/smbanner.gif"ALT="DNS &amp; BIND"USEMAP="#srchmap"BORDER="0"></H1><MAPNAME="srchmap"><AREASHAPE="RECT"COORDS="0,0,466,65"HREF="index.htm"ALT="DNS &amp; BIND"><AREASHAPE="RECT"COORDS="467,0,514,18"HREF="../search/dsrch.htm"ALT="Search this book"></MAP><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch07_04.htm"TITLE="7.4 Changing BIND 8 System File Locations"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 7.4 Changing BIND 8 System File Locations"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><B><FONTFACE="ARIEL,HELVETICA,HELV,SANSERIF"SIZE="-1">Chapter 7<BR>Maintaining <SPANCLASS="acronym">BIND</SPAN></FONT></B></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch07_06.htm"TITLE="7.6 Keeping Everything Running Smoothly"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 7.6 Keeping Everything Running Smoothly"BORDER="0"></A></TD></TR></TABLE>&nbsp;<HRALIGN="LEFT"WIDTH="515"TITLE="footer"></DIV><DIVCLASS="SECT1"><H2CLASS="sect1"><ACLASS="title"NAME="BIND8-LOGGING">7.5 <SPANCLASS="acronym">BIND</SPAN> 8 Logging</A></H2><PCLASS="para"><ACLASS="indexterm"NAME="DNS3-IDX-7-NAME-SERVERS-MAINTAINING-LOGGING-BIND-8"></A><ACLASS="indexterm"NAME="DNS3-IDX-7-ADMINISTRATION-NAME-SERVER-MAINTENANCE-LOGGING-BIND-8"></A><ACLASS="indexterm"NAME="DNS3-IDX-7-BIND-BERKELEY-INTERNET-NAME-DOMAIN-NAME-SERVER-MAINTAINENCE-LOGGING-BIND-8"></A><ACLASS="indexterm"NAME="DNS3-IDX-7-LOGGING-BIND-8"></A><SPANCLASS="acronym">BIND</SPAN> 4 had an extensive logging system,writing information to a debug file and sending information to syslog.But, <SPANCLASS="acronym">BIND</SPAN> 4 gave you limited control over thislogging process&nbsp;- you could turn debugging on to a certain level.That's it.  <SPANCLASS="acronym">BIND</SPAN> 8 has the same logging system as<SPANCLASS="acronym">BIND</SPAN> 4, but <SPANCLASS="acronym">BIND</SPAN> 8 gives youcontrol you didn't get with <SPANCLASS="acronym">BIND</SPAN> 4.</P><PCLASS="para">This control has its cost though&nbsp;- there's a lot to learnbefore you can be effective configuring this subsystem. If you don'thave some time you can spend to experiment with logging, use thedefaults and come back to this topic later.  Most of you do not needto change the default logging behavior.</P><PCLASS="para">Logging has two major topics you need to understand:<ACLASS="indexterm"NAME="DNS3-IDX-7-CHANNELS-LOGGING"></A><ACLASS="indexterm"NAME="DNS3-IDX-7-CATEGORIES-OF-DATA-LOGGING"></A>channels and categories.  A channel specifies where the logging datagoes: to syslog, to a file, to stderr, or to the bit bucket.  Acategory specifies what data is logged.</P><PCLASS="para">Each category of data can be sent to a single channel or tomultiple channels.  In <ACLASS="xref"HREF="ch07_05.htm#DNS3-CHP-7-FIG-1"TITLE="Logging categories to channels">Figure 7.1</A>, queries arelogged to a file, statistics data is logged to a file and logged tosyslog.</P><H4CLASS="figure"><ACLASS="title"NAME="DNS3-CHP-7-FIG-1">Figure 7.1: Logging categories to channels</A></H4><IMGCLASS="graphic"SRC="figs/dns3_0701.gif"ALT="Figure 7.1"><PCLASS="para">Channels allow you to filter by message<ACLASS="indexterm"NAME="AUTOID-7069"></A>severity.  Here is the list of severities:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">criticalerrorwarningnoticeinfodebug [level]dynamic</PRE></BLOCKQUOTE><PCLASS="para">The top five severities (critical, error, warning, notice, andinfo) are the familiar severity levels used by syslog.  The other two(debug and dynamic) are unique to <SPANCLASS="acronym">BIND</SPAN> 8.</P><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-7075"></A><CODECLASS="literal">debug</CODE> is name server debugging for which you canspecify a debug level.  If you omit the debug level, then the level isassumed to be one.  If you specify a debug level, you will seemessages of that level when name server debugging is turned on (i.e.,if you specify <SPANCLASS="quote">"debug 3"</SPAN>, then you will see level threedebugging messages even when you only send one<ACLASS="indexterm"NAME="AUTOID-7079"></A><SPANCLASS="acronym">USR</SPAN>1 signal to the name server).  If you specify<CODECLASS="literal">dynamic</CODE> severity, then the name server will logmessages that match its debug level (i.e., if you send one<SPANCLASS="acronym">USR</SPAN>1 signal to the name server, it will logmessages from level one.  If you send three <SPANCLASS="acronym">USR</SPAN>1signals to the name server, it will log messages from levels onethrough three.) The default severity is <CODECLASS="literal">info</CODE>, whichmeans you won't see debug messages unless you specify theseverity.</P><BLOCKQUOTECLASS="note"><PCLASS="para"><STRONG>NOTE:</STRONG> You can configure a channel to log both debug messages andsyslog messages to a file.  However the converse is not true&nbsp;- youcannot configure a channel to log both debug messages and syslogmessages with syslog&nbsp;- only syslog messages can be sent tosyslog.</P></BLOCKQUOTE><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-7089"></A>Let's configure a couple of channels to show you how this works.  Thefirst channel will go to syslog and will log with facility<CODECLASS="literal">daemon</CODE>, sending those messages of severity<CODECLASS="literal">info</CODE> and above.  The second channel will go to afile, logging debug messages at any level as well as syslog messages.Here is the <CODECLASS="literal">logging</CODE> statement for the<SPANCLASS="acronym">BIND</SPAN> 8 configuration file:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">logging {  channel my_syslog {     syslog daemon;     // Debug messages will not be sent to syslog, so     // there is no point to setting the severity to     // debug or dynamic; use the lowest syslog level: info.     severity info;  };  channel my_file {     file &quot;log.msgs&quot;;     // Set the severity to dynamic to see all the debug messages.     severity dynamic;  };};</PRE></BLOCKQUOTE><PCLASS="para">Now that we've configured a couple of channels, we have to tellthe name server exactly what to send to those channels.  Let'simplement what was pictured in <ACLASS="xref"HREF="ch07_05.htm#DNS3-CHP-7-FIG-1"TITLE="Logging categories to channels">Figure 7.1</A> withstatistics going to syslog and to the file, and queries going to thefile.  The category specification is part of the <CODECLASS="literal">logging</CODE> statement, sowe'll build on the previous <CODECLASS="literal">logging</CODE> statement:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">logging {  channel my_syslog {     syslog daemon;     severity info;  };  channel my_file {     file &quot;log.msgs&quot;;     severity dynamic;  };  category statistics { my_syslog; my_file; };  category queries { my_file; };};</PRE></BLOCKQUOTE><PCLASS="para">With this <CODECLASS="literal">logging</CODE> statement in your configuration file, startyour name server and send it a few queries.  But nothing is written to<ICLASS="filename">log.msgs</I>!  (Well, if you wait long enough, thename server's statistics will show up in<ICLASS="filename">log.msgs</I>.)  You had expected those queries to belogged.  Alas, you have to turn on name server debugging to getqueries logged:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen"># <CODECLASS="userinput"><B>kill -USR1 `cat /etc/named.pid`</B></CODE></PRE></BLOCKQUOTE><PCLASS="para">Now send your name server some queries and they are logged in<ICLASS="filename">log.msgs</I>.  But look around: there's a new filecalled<ACLASS="indexterm"NAME="AUTOID-7110"></A><ICLASS="filename">named.run</I>.  It has all the other debugginginformation written to it.  You didn't want all this other debugging,though; you just wanted the statistics and queries.  How do you getrid of <ICLASS="filename">named.run</I>?</P><PCLASS="para">There's a special category we haven't told you about:<ACLASS="indexterm"NAME="AUTOID-7115"></A><CODECLASS="literal">default</CODE>.  If you don't specify any channels for acategory, the <CODECLASS="literal">default</CODE> category is used.  Let'schange the <CODECLASS="literal">default</CODE> category to discard all loggingmessages (there's a channel called <CODECLASS="literal">null</CODE> for thispurpose):</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">logging {  channel my_syslog {     syslog daemon;     severity info;  };  channel my_file {     file &quot;log.msgs&quot;;     severity dynamic;  };  category default { null; };  category statistics { my_syslog; my_file; };  category queries { my_file; };};</PRE></BLOCKQUOTE><PCLASS="para">Now, start your server, turn on debugging to level one, and sendsome queries.  The queries end up in <ICLASS="filename">log.msgs</I> and<ICLASS="filename">named.run</I> was created but the file is empty.Great!  We're getting the hang of this after all.</P><PCLASS="para">A few days pass.  One of your co-workers notices that the nameserver is sending many fewer messages to syslog than it used to.  Infact, the only syslog messages are statistics messages.  The ones yourco-worker watched, the zone transfer messages, are gone.  Whathappened?</P><PCLASS="para">Well, the <CODECLASS="literal">default</CODE> category is set up, by default, to sendmessages to both syslog and to the debug file(<ICLASS="filename">named.run</I>).  When the <CODECLASS="literal">default</CODE> category wasconfigured to the <CODECLASS="literal">null</CODE> channel, the other syslog messages were turnedoff.  Here's what we should have used:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">category default { my_syslog; };</PRE></BLOCKQUOTE><PCLASS="para">This sends the syslog messages to syslog, but does not writedebug or syslog messages to a file.</P><PCLASS="para">Remember, we said you'd have to experiment for a while withlogging to get exactly what you want.  We hope this example gives youa clue what you might run into.  Now, let's go over the details oflogging.</P><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="AUTOID-7134">7.5.1 The Logging Statement</A></H3><PCLASS="para">Here's the syntax of the<ACLASS="indexterm"NAME="DNS3-IDX-7-LOGGING-BIND-8-LOGGING-STATEMENT"></A><CODECLASS="literal">logging</CODE> statement.  It's rather intimidating.We'll go over some more examples as we explain what each clausemeans:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">logging {  [ channel channel_name {    ( file path_name       [ versions ( number | unlimited ) ]       [ size size_spec ]     | syslog ( kern | user | mail | daemon | auth | syslog | lpr |                news | uucp | cron | authpriv | ftp |                local0 | local1 | local2 | local3 |                local4 | local5 | local6 | local7 )     | null );    [ severity ( critical | error | warning | notice |                 info  | debug [ level ] | dynamic ); ]    [ print-category yes_or_no; ]    [ print-severity yes_or_no; ]    [ print-time yes_or_no; ]  }; ]  [ category category_name {    channel_name; [ channel_name; ... ]  }; ]  ...};</PRE></BLOCKQUOTE><PCLASS="para">Here are the default channels.  The name server will make thesechannels even if you do not want them.  You cannot redefine thesechannels.  You can only add more channels:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">channel default_syslog {    syslog daemon;        // send to syslog's daemon facility    severity info;        // only send priority info and higher};channel default_debug {    file &quot;named.run&quot;;     // write to named.run in the                          // working directory    severity dynamic;     // log at the server's current debug level};channel default_stderr {  // writes to stderr    file &quot;&lt;stderr&gt;&quot;;      // this is illustrative only;                          // there's currently no way of                          // specifying an internal file                          // descriptor in the configuration language.    severity info;        // only send priority info and higher};channel null {    null;                 // toss anything sent to this channel};</PRE></BLOCKQUOTE><PCLASS="para">If you do not assign channels to the categories <CODECLASS="literal">default</CODE>, <CODECLASS="literal">panic</CODE>,<CODECLASS="literal">packet</CODE>, and <CODECLASS="literal">eventlib</CODE>, the name server will assign these channels bydefault:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">logging {    category default { default_syslog; default_debug; };    category panic { default_syslog; default_stderr; };    category packet { default_debug; };    category eventlib { default_debug; };};</PRE></BLOCKQUOTE><PCLASS="para">As we mentioned earlier, the <CODECLASS="literal">default</CODE> category logs to bothsyslog and to the debug file (which by default is<ICLASS="filename">named.run</I>).  This means that all syslog messagesof severity <CODECLASS="literal">info</CODE> and above are sent to syslog, and when debugging isturned on, the syslog messages and debug messages are written to<ICLASS="filename">named.run</I>.  This more or less matches the<SPANCLASS="acronym">BIND</SPAN> 4 behavior.<ACLASS="indexterm"NAME="AUTOID-7156"></A><ACLASS="indexterm"NAME="AUTOID-7157"></A></P></DIV><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="AUTOID-7158">7.5.2 Channel Details</A></H3><PCLASS="para">A channel may be defined to go to a file, to syslog, or tonull.</P><DIVCLASS="sect3"><H4CLASS="sect3"><ACLASS="title"NAME="AUTOID-7161">7.5.2.1 File channels </A></H4><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-7164"></A>If a channel goes to a file, you must specify the file's path name.Optionally, you can specify how many versions of the file can exist atone time and how big the file may grow.</P><PCLASS="para">If you specify that there can be three versions,<SPANCLASS="acronym">BIND</SPAN> 8 will keep around <ICLASS="filename">file</I>,<ICLASS="filename">file.0</I>, <ICLASS="filename">file.1</I>, and<ICLASS="filename">file.2</I>.  After the name server starts or after itis restarted by a <SPANCLASS="acronym">HUP</SPAN> signal, it will move<ICLASS="filename">file.1</I> to <ICLASS="filename">file.2</I>,<ICLASS="filename">file.0</I> to <ICLASS="filename">file.1</I>,<ICLASS="filename">file</I> to <ICLASS="filename">file.0</I>, and start anew copy of <ICLASS="filename">file</I>.  If you specify unlimitedversions, <SPANCLASS="acronym">BIND</SPAN> 8.1.2 will keep 99 versions.</P><PCLASS="para">If you specify a maximum file size, <SPANCLASS="acronym">BIND</SPAN> 8will stop writing to the file after it reaches the specified size.Unlike the versions clause (mentioned in the last paragraph), the filewill not be rolled over and a new file opened when the specified sizeis reached.  The name server just stops writing to the file.  If youdo not specify a file size, the file will grow indefinitely.</P><PCLASS="para">Here is an example file channel using the <CODECLASS="literal">versions</CODE> and <CODECLASS="literal">size</CODE>clauses:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">logging{  channel my_file {     file &quot;log.msgs&quot; versions 3 size 10k;     severity dynamic;  };};</PRE></BLOCKQUOTE><PCLASS="para">The size can include a scaling factor as in the example.  <CODECLASS="literal">K</CODE> or <CODECLASS="literal">k</CODE>is kilobytes.  <CODECLASS="literal">M</CODE> or <CODECLASS="literal">m</CODE> is megabytes.  <CODECLASS="literal">G</CODE> or <CODECLASS="literal">g</CODE> is gigabytes.</P><PCLASS="para">It's important to specify the severity as either <CODECLASS="literal">debug</CODE> or<CODECLASS="literal">dynamic</CODE> if you want to see debug messages.  The default severity is<CODECLASS="literal">info</CODE>, which will only show you syslog messages.</P></DIV><DIVCLASS="sect3"><H4CLASS="sect3"><ACLASS="title"NAME="AUTOID-7198">7.5.2.2 Syslog channels</A></H4><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-7201"></A>If a channel goes to syslog, you can specify the facility to be any ofthe following: <CODECLASS="literal">kern</CODE>, <CODECLASS="literal">user</CODE>,<CODECLASS="literal">mail</CODE>, <CODECLASS="literal">daemon</CODE>,<CODECLASS="literal">auth</CODE>, <CODECLASS="literal">syslog</CODE>,<CODECLASS="literal">lpr</CODE>, <CODECLASS="literal">news</CODE>,<CODECLASS="literal">uucp</CODE>, <CODECLASS="literal">cron</CODE>,<CODECLASS="literal">authpriv</CODE>, <CODECLASS="literal">ftp</CODE>,<CODECLASS="literal">local0</CODE>, <CODECLASS="literal">local1</CODE>,<CODECLASS="literal">local2</CODE>, <CODECLASS="literal">local3</CODE>,<CODECLASS="literal">local4</CODE>, <CODECLASS="literal">local5</CODE>,<CODECLASS="literal">local6</CODE>, <CODECLASS="literal">local7</CODE>.  The default is<CODECLASS="literal">daemon</CODE>.  We recommend that you use thedefault.</P><PCLASS="para">Here's an example syslog channel using the facility <CODECLASS="literal">local0</CODE>instead of <CODECLASS="literal">daemon</CODE>:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">logging {    channel my_syslog {        syslog local0;        // send to syslog's local0 facility        severity info;        // only send priority info and higher    };};</PRE></BLOCKQUOTE></DIV><DIVCLASS="sect3"><H4CLASS="sect3"><ACLASS="title"NAME="AUTOID-7228">7.5.2.3 Null channel</A></H4><PCLASS="para">There is a predefined channel called<ACLASS="indexterm"NAME="AUTOID-7231"></A><CODECLASS="literal">null</CODE> for those messages you want to throwaway.</P></DIV><DIVCLASS="sect3"><H4CLASS="sect3"><ACLASS="title"NAME="AUTOID-7234">7.5.2.4 Stderr channel</A></H4><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-7237"></A><ACLASS="indexterm"NAME="AUTOID-7239"></A>There is a predefined channel called <CODECLASS="literal">default_stderr</CODE>for any messages you'd like written to the <ICLASS="filename">stderr</I>file descriptor of the name server.  You cannot configure any otherfile descriptors.</P></DIV><DIVCLASS="sect3"><H4CLASS="sect3"><ACLASS="title"NAME="AUTOID-7243">7.5.2.5 Data formatting for all channels</A></H4><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-7246"></A>The <SPANCLASS="acronym">BIND</SPAN> 8 logging facility also allows yousome control over the formatting of messages.  You can add to themessages: a time stamp, the category, or the severity.</P><PCLASS="para">Here's an example debug message that has all the extragoodies:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">01-Feb-1998 13:19:18.889 config: debug 1: source = db.127.0.0</PRE></BLOCKQUOTE><PCLASS="para">The category for this message is <CODECLASS="literal">config</CODE> and the severity is<CODECLASS="literal">debug</CODE> level one.</P><PCLASS="para">Here's an example channel configuration that includes all threeadditions:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">logging {  channel my_file {     file &quot;log.msgs&quot;;     severity debug;     print-category yes;     print-severity yes;     print-time yes;  };};</PRE></BLOCKQUOTE><PCLASS="para">There is not much point in adding the time stamp for messages toa syslog channel since syslog adds the time and date itself.<ACLASS="indexterm"NAME="AUTOID-7258"></A></P></DIV></DIV><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="AUTOID-7259">7.5.3 Category Details</A></H3><PCLASS="para"><ACLASS="indexterm"NAME="DNS3-IDX-7-CATEGORIES-OF-DATA-LOGGING-2"></A>There are lots of categories&nbsp;- lots!  We'll list them here so youcan see them all.  Rather than trying to figure out which you want tosee, we recommend that you configure your name server to print out allof its log messages, with their category and severity, and then pickout the ones you want to see.  We'll show you how to do this aftertelling you about the categories:</P><DLCLASS="variablelist"><DTCLASS="term">default</DT><DDCLASS="listitem"><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-7269"></A>If you don't specify any channels for a category, the<CODECLASS="literal">default</CODE> category is used instead.  In that sense,<CODECLASS="literal">default</CODE> is synonymous with all categories.However, there are some messages that didn't end up in a category. So,even if you specify channels for each category individually, you'llstill want to specify a channel for the <CODECLASS="literal">default</CODE>category for all the uncategorized messages.</P><PCLASS="para">If you do not specify a channel for the <CODECLASS="literal">default</CODE> category, onewill be specified for you:</P></DD></DL><BLOCKQUOTECLASS="screen"><PRECLASS="screen">        category default { default_syslog; default_debug; };</PRE></BLOCKQUOTE><DLCLASS="variablelist"><DTCLASS="term">cname</DT><DDCLASS="listitem"><PCLASS="para"><SPANCLASS="acronym">CNAME</SPAN> errors (e.g., <SPANCLASS="quote">"... has<SPANCLASS="acronym">CNAME</SPAN> and other data"</SPAN>)<ACLASS="indexterm"NAME="AUTOID-7285"></A></P></DD><DTCLASS="term">config</DT><DDCLASS="listitem"><PCLASS="para">Configuration file processing<ACLASS="indexterm"NAME="AUTOID-7291"></A></P></DD><DTCLASS="term">db</DT><DDCLASS="listitem"><PCLASS="para">Database operations<ACLASS="indexterm"NAME="AUTOID-7297"></A></P></DD><DTCLASS="term">eventlib</DT><DDCLASS="listitem"><PCLASS="para">System events; must point to a file channel<ACLASS="indexterm"NAME="AUTOID-7303"></A></P></DD><DTCLASS="term">insist</DT><DDCLASS="listitem"><PCLASS="para">Internal consistency check failures<ACLASS="indexterm"NAME="AUTOID-7309"></A></P></DD><DTCLASS="term">lame-servers</DT><DDCLASS="listitem"><PCLASS="para">Detection of bad delegation<ACLASS="indexterm"NAME="AUTOID-7315"></A></P></DD><DTCLASS="term">load</DT><DDCLASS="listitem"><PCLASS="para">Zone loading messages<ACLASS="indexterm"NAME="AUTOID-7321"></A></P></DD><DTCLASS="term">maintenance</DT><DDCLASS="listitem"><PCLASS="para">Maintenance events (e.g., system queries)<ACLASS="indexterm"NAME="AUTOID-7327"></A></P></DD><DTCLASS="term">ncache</DT><DDCLASS="listitem"><PCLASS="para">Negative caching events<ACLASS="indexterm"NAME="AUTOID-7333"></A></P></DD><DTCLASS="term">notify</DT><DDCLASS="listitem"><PCLASS="para">Asynchronous change notifications<ACLASS="indexterm"NAME="AUTOID-7339"></A></P></DD><DTCLASS="term">os</DT><DDCLASS="listitem"><PCLASS="para">Problems with the operating system<ACLASS="indexterm"NAME="AUTOID-7345"></A></P></DD><DTCLASS="term">packet</DT><DDCLASS="listitem"><PCLASS="para">Decodes of packets received and sent; must point to a filechannel<ACLASS="indexterm"NAME="AUTOID-7351"></A></P></DD><DTCLASS="term">panic</DT><DDCLASS="listitem"><PCLASS="para">Problems that cause the shutdown of the server<ACLASS="indexterm"NAME="AUTOID-7357"></A></P></DD><DTCLASS="term">parser</DT><DDCLASS="listitem"><PCLASS="para">Parsing of the configuration file<ACLASS="indexterm"NAME="AUTOID-7363"></A></P></DD><DTCLASS="term">queries</DT><DDCLASS="listitem"><PCLASS="para">Analogous to <SPANCLASS="acronym">BIND</SPAN> 4's query logging<ACLASS="indexterm"NAME="AUTOID-7370"></A></P></DD><DTCLASS="term">response-checks</DT><DDCLASS="listitem"><PCLASS="para">Malformed responses, unrelated additional information,etc.<ACLASS="indexterm"NAME="AUTOID-7376"></A></P></DD><DTCLASS="term">security</DT><DDCLASS="listitem"><PCLASS="para">Approved/unapproved requests<ACLASS="indexterm"NAME="AUTOID-7382"></A></P></DD><DTCLASS="term">statistics</DT><DDCLASS="listitem"><PCLASS="para">Periodic reports of activities<ACLASS="indexterm"NAME="AUTOID-7388"></A></P></DD><DTCLASS="term">update</DT><DDCLASS="listitem"><PCLASS="para">Dynamic update events<ACLASS="indexterm"NAME="AUTOID-7394"></A></P></DD><DTCLASS="term">xfer-in</DT><DDCLASS="listitem"><PCLASS="para">Zone transfers from remote name servers to the local nameserver<ACLASS="indexterm"NAME="AUTOID-7400"></A></P></DD><DTCLASS="term">xfer-out</DT><DDCLASS="listitem"><PCLASS="para">Zone transfers from the local name server to remote nameservers<ACLASS="indexterm"NAME="AUTOID-7406"></A></P></DD></DL><DIVCLASS="sect3"><H4CLASS="sect3"><ACLASS="title"NAME="AUTOID-7408">7.5.3.1 Viewing all category messages</A></H4><PCLASS="para">A good activity to start your foray into logging is to configureyour name server to log all of its messages to a file, with thecategory and severity, and then pick out which messages you areinterested in.</P><PCLASS="para">Earlier we listed the categories that are configured bydefault:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">logging {    category default { default_syslog; default_debug; };    category panic { default_syslog; default_stderr; };    category packet { default_debug; };    category eventlib { default_debug; };};</PRE></BLOCKQUOTE><PCLASS="para">By default, the category and severity are not included withmessages written to the <CODECLASS="literal">default_debug</CODE> channel.  In order for you tosee all the log messages, with their category and severity, you'llhave to configure each of these categories yourself.</P><PCLASS="para">Here is a logging statement that does just that:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">logging {  channel my_file {     file &quot;log.msgs&quot;;     severity dynamic;     print-category yes;     print-severity yes;  };  category default  { default_syslog; my_file; };  category panic    { default_syslog; my_file; };  category packet   { my_file; };  category eventlib { my_file; };  category queries  { my_file; };};</PRE></BLOCKQUOTE><PCLASS="para">Notice that we've defined each category to include the channel<CODECLASS="literal">my_file</CODE>.  We also added one category that wasn't in the defaultlogging statement above&nbsp;- <CODECLASS="literal">queries</CODE>.  Queries aren't printed unless youconfigure the <CODECLASS="literal">queries</CODE> category.</P><PCLASS="para">Start your server and turn on debugging to level one.  You'llsee messages in <ICLASS="filename">log.msgs</I> that look like thefollowing:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">queries: info: XX /192.253.253.4/foo.movie.edu/Adefault: debug 1: req: nlookup(foo.movie.edu) id 4 type=1 class=1default: debug 1: req: found 'foo.movie.edu' as 'foo.movie.edu' (cname=0)default: debug 1: ns_req: answer -&gt; [192.253.253.4].2338 fd=20 id=4 size=87</PRE></BLOCKQUOTE><PCLASS="para">Once you see the messages that interest you, configure yourserver to log only those messages.<ACLASS="indexterm"NAME="AUTOID-7425"></A><ACLASS="indexterm"NAME="AUTOID-7426"></A><ACLASS="indexterm"NAME="AUTOID-7427"></A><ACLASS="indexterm"NAME="AUTOID-7428"></A><ACLASS="indexterm"NAME="AUTOID-7429"></A></P></DIV></DIV></DIV><DIVCLASS="htmlnav"><P></P><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch07_04.htm"TITLE="7.4 Changing BIND 8 System File Locations"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 7.4 Changing BIND 8 System File Locations"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="book"HREF="index.htm"TITLE="DNS &amp; BIND"><IMGSRC="../gifs/txthome.gif"ALT="DNS &amp; BIND"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch07_06.htm"TITLE="7.6 Keeping Everything Running Smoothly"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 7.6 Keeping Everything Running Smoothly"BORDER="0"></A></TD></TR><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172">7.4 Changing BIND 8 System File Locations</TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="index"HREF="index/idx_0.htm"TITLE="Book Index"><IMGSRC="../gifs/index.gif"ALT="Book Index"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172">7.6 Keeping Everything Running Smoothly</TD></TR></TABLE><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><PCLASS="nav"><FONTSIZE="-1">[ <AHREF="../index.htm"TITLE="The Networking CD Bookshelf">Library Home</A> | <AHREF="index.htm"TITLE="DNS &amp; BIND">DNS &amp; BIND</A> | <AHREF="../tcpip/index.htm"TITLE="TCP/IP Network Administration">TCP/IP</A> | <AHREF="../sendmail/index.htm"TITLE="sendmail">sendmail</A> | <AHREF="../smdref/index.htm"TITLE="sendmail Desktop Reference">sendmail Reference</A> | <AHREF="../firewall/index.htm"TITLE="Building Internet Firewalls">Firewalls</A> | <AHREF="../puis/index.htm"TITLE="Practical UNIX &amp; Internet Security">Practical Security</A> ]</FONT></P></DIV></BODY></HTML>