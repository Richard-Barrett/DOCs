<HTML><HEAD><TITLE>[Chapter 9] 9.5 Subdomains of in-addr.arpa Domains</TITLE><METANAME="DC.title"CONTENT="DNS &amp; BIND"><METANAME="DC.creator"CONTENT="Cricket Liu &amp; Paul Albitz"><METANAME="DC.publisher"CONTENT="O'Reilly &amp; Associates, Inc."><METANAME="DC.date"CONTENT="1999-01-06T18:35:06Z"><METANAME="DC.type"CONTENT="Text.Monograph"><METANAME="DC.format"CONTENT="text/html"SCHEME="MIME"><METANAME="DC.source"CONTENT="1-56592-512-2"SCHEME="ISBN"><METANAME="DC.language"CONTENT="en-US"><METANAME="generator"CONTENT="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><LINKREV="made"HREF="mailto:online-books@oreilly.com"TITLE="Online Books Comments"><LINKREL="up"HREF="ch09_01.htm"TITLE="9. Parenting"><LINKREL="prev"HREF="ch09_04.htm"TITLE="9.4 How to Become a Parent: Creating Subdomains"><LINKREL="next"HREF="ch09_06.htm"TITLE="9.6 Good Parenting"></HEAD><BODYBGCOLOR="#FFFFFF"TEXT="#000000"><DIVCLASS="htmlnav"><H1><IMGSRC="gifs/smbanner.gif"ALT="DNS &amp; BIND"USEMAP="#srchmap"BORDER="0"></H1><MAPNAME="srchmap"><AREASHAPE="RECT"COORDS="0,0,466,65"HREF="index.htm"ALT="DNS &amp; BIND"><AREASHAPE="RECT"COORDS="467,0,514,18"HREF="../search/dsrch.htm"ALT="Search this book"></MAP><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch09_04.htm"TITLE="9.4 How to Become a Parent: Creating Subdomains"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 9.4 How to Become a Parent: Creating Subdomains"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><B><FONTFACE="ARIEL,HELVETICA,HELV,SANSERIF"SIZE="-1">Chapter 9<BR>Parenting</FONT></B></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch09_06.htm"TITLE="9.6 Good Parenting"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 9.6 Good Parenting"BORDER="0"></A></TD></TR></TABLE>&nbsp;<HRALIGN="LEFT"WIDTH="515"TITLE="footer"></DIV><DIVCLASS="SECT1"><H2CLASS="sect1"><ACLASS="title"NAME="AUTOID-9764">9.5 Subdomains of in-addr.arpa Domains</A></H2><PCLASS="para"><ACLASS="indexterm"NAME="DNS3-IDX-9-IN-ADDR.ARPA-DOMAIN-SUBDOMAINS-OF"></A><ACLASS="indexterm"NAME="DNS3-IDX-9-DOMAINS-IN-ADDR.ARPA-SUBDOMAINS-OF"></A><ACLASS="indexterm"NAME="DNS3-IDX-9-PARENTING-SUBDOMAINS-OF-IN-ADDR.ARPA-DOMAINS"></A>Forward mapping domains aren't the only domains you can divide intosubdomains and delegate. If your <ICLASS="systemitem.sitename">in-addr.arpa</I> name space is large enough,you may need to divide it, too. Typically, you divide the domain thatcorresponds to your network number into subdomains to correspond toyour subnets. How that works depends on the type of network you haveand on your network's subnet mask.</P><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="AUTOID-9778">9.5.1 Subnetting on an Octet Boundary</A></H3><PCLASS="para"><ACLASS="indexterm"NAME="DNS3-IDX-9-OCTETS-SUBNETTING-ON-OFF-OCTET-BOUNDARIES"></A><ACLASS="indexterm"NAME="DNS3-IDX-9-SUBNETTING-NETWORKS-ON-OFF-OCTET-BOUNDARIES"></A><ACLASS="indexterm"NAME="DNS3-IDX-9-NETWORKS-SUBNETTING-ON-OFF-OCTET-BOUNDARIES"></A><ACLASS="indexterm"NAME="DNS3-IDX-9-DELEGATION-OCTET-BOUNDARIES-AND"></A>Since Movie U. just has three /24 (class C-sized) network numbers, oneper segment, there's no particular need to subnet thosenetworks. However, our sister university, Altered State, has a classB-sized network, 172.20/16. Their network is subnetted between thethird and fourth octet of the <SPANCLASS="acronym">IP</SPAN> address; that is,their subnet mask is 255.255.255.0. They've already created a numberof subdomains of their domain, <ICLASS="systemitem.sitename">altered.edu</I>, including <ICLASS="systemitem.sitename">fx.altered.edu</I> (okay, we copied them),<ICLASS="systemitem.sitename">makeup.altered.edu</I>, and<ICLASS="systemitem.sitename">foley.altered.edu</I>.  Sinceeach of these departments also runs its own subnet (their specialeffects department runs subnet 172.20.2.0, makeup runs 172.20.15.0,and foley runs 172.20.25.0), they'd like to divvy up their <ICLASS="systemitem.sitename">in-addr.arpa</I> namespace appropriately,too.</P><PCLASS="para">Delegating <ICLASS="systemitem.sitename">in-addr.arpa</I>subdomains is no different from delegating subdomains offorward-mapping domains.  Within their <ICLASS="filename">db.172.20</I>file, they need to add <SPANCLASS="acronym">NS</SPAN> records likethese:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">  2     86400    IN    NS    gump.fx.altered.edu.  2     86400    IN    NS    toystory.fx.altered.edu.  15    86400    IN    NS    prettywoman.makeup.altered.edu.  15    86400    IN    NS    priscilla.makeup.altered.edu.  25    86400    IN    NS    blowup.foley.altered.edu.  25    86400    IN    NS    muppetshow.foley.altered.edu.</PRE></BLOCKQUOTE><PCLASS="para">delegating the subdomain that corresponds to each subnet to thecorrect name server in each subdomain.</P><PCLASS="para">Two important reminders: the Altered States administrators needed to usethe fully qualified domain names of the name servers in the<SPANCLASS="acronym">NS</SPAN> records, because the default origin in this fileis <ICLASS="systemitem.sitename">20.172.in-addr.arpa</I>, andthey <EMCLASS="emphasis">didn't</EM> need glue address records, since thenames of the name servers they delegated the zone to weren't in thezone.</P></DIV><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="AUTOID-9810">9.5.2 Subnetting on a Non-Octet Boundary</A></H3><PCLASS="para"><ACLASS="indexterm"NAME="DNS3-IDX-9-NON-OCTET-BOUNDARIES-SUBNETTING-ON"></A>What do you do about networks that aren't subnetted neatly on octetboundaries, like subnetted /24 (class C-sized) networks? In thesecases, you can't delegate along lines that match the subnets. Thisforces you into one of two situations: you have multiple subnets per<ICLASS="systemitem.sitename">in-addr.arpa</I> subdomain, oryou have multiple <ICLASS="systemitem.sitename">in-addr.arpa</I> subdomains persubnet. Neither is particularly pleasing.</P><DIVCLASS="sect3"><H4CLASS="sect3"><ACLASS="title"NAME="AUTOID-9817">9.5.2.1 Class A and B networks</A></H4><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-9820"></A>Let's take the case of the /8 (class A-sized) network 15.0.0.0,subnetted with the subnet mask 255.255.248.0 (a thirteen-bit subnetfield and an eleven-bit host field, or 8192 subnets of 2048 hosts). Inthis case, the subnet 15.1.200.0, for example, extends from 15.1.200.0to 15.1.207.255. Therefore, the delegation for that single subdomainin <ICLASS="filename">db.15</I>, the zone database file for <ICLASS="systemitem.sitename">15.in-addr.arpa</I>, looks like this:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">200.1.15.in-addr.arpa.    86400    IN    NS    ns-1.cns.hp.com.200.1.15.in-addr.arpa.    86400    IN    NS    ns-2.cns.hp.com.201.1.15.in-addr.arpa.    86400    IN    NS    ns-1.cns.hp.com.201.1.15.in-addr.arpa.    86400    IN    NS    ns-2.cns.hp.com.202.1.15.in-addr.arpa.    86400    IN    NS    ns-1.cns.hp.com.202.1.15.in-addr.arpa.    86400    IN    NS    ns-2.cns.hp.com.203.1.15.in-addr.arpa.    86400    IN    NS    ns-1.cns.hp.com.203.1.15.in-addr.arpa.    86400    IN    NS    ns-2.cns.hp.com.204.1.15.in-addr.arpa.    86400    IN    NS    ns-1.cns.hp.com.204.1.15.in-addr.arpa.    86400    IN    NS    ns-2.cns.hp.com.205.1.15.in-addr.arpa.    86400    IN    NS    ns-1.cns.hp.com.205.1.15.in-addr.arpa.    86400    IN    NS    ns-2.cns.hp.com.206.1.15.in-addr.arpa.    86400    IN    NS    ns-1.cns.hp.com.206.1.15.in-addr.arpa.    86400    IN    NS    ns-2.cns.hp.com.207.1.15.in-addr.arpa.    86400    IN    NS    ns-1.cns.hp.com.207.1.15.in-addr.arpa.    86400    IN    NS    ns-2.cns.hp.com.</PRE></BLOCKQUOTE><PCLASS="para">That's a lot of delegation for one subnet!</P></DIV><DIVCLASS="sect3"><H4CLASS="sect3"><ACLASS="title"NAME="AUTOID-9826">9.5.2.2 /24 (class C-sized) networks</A></H4><PCLASS="para">In the case of a subnetted /24 (class<ACLASS="indexterm"NAME="DNS3-IDX-9-CLASS-C-NETWORKS-SUBNETTING"></A><ACLASS="indexterm"NAME="DNS3-IDX-9-24-NETWORK-SUBNETTING"></A>C-sized) network, say 192.253.254.0, subnetted with the mask255.255.255.192, you have a single <ICLASS="systemitem.sitename">in-addr.arpa</I> zone, <ICLASS="systemitem.sitename">254.253.192.in-addr.arpa</I>, thatcorresponds to subnets 192.253.254.0/26, 192.253.254.64/26,192.253.254.128/26, and 192.253.254.192/26. You can solve this one ofthree ways, none of them pretty.</P>Solution 1<PCLASS="para">The first is to administer the <ICLASS="systemitem.sitename">254.253.192.in-addr.arpa</I> zone as a singleentity and not even try to delegate. This requires either cooperationbetween the administrators of the four subnets involved or the use ofa tool like <SPANCLASS="acronym">MIT</SPAN>'s Web<SPANCLASS="acronym">DNS</SPAN>(<ACLASS="systemitem.url"HREF="http://hem.passagen.se/hno/webdns/">http://hem.passagen.se/hno/webdns/</A>) toallow each of the four administrators to take care of their own data.</P>Solution 2<PCLASS="para">The second is to delegate at the <EMCLASS="emphasis">fourth</EM>octet. That's even nastier than the /8 delegation we justshowed. You'll need at least a couple of <SPANCLASS="acronym">NS</SPAN> recordsper <EMCLASS="emphasis"><SPANCLASS="acronym">IP</SPAN> address</EM> in the file<ICLASS="filename">db.192.253.254</I>, like this:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">1.254.253.192.in-addr.arpa.    86400    IN    NS    ns1.foo.com.1.254.253.192.in-addr.arpa.    86400    IN    NS    ns2.foo.com.2.254.253.192.in-addr.arpa.    86400    IN    NS    ns1.foo.com.2.254.253.192.in-addr.arpa.    86400    IN    NS    ns2.foo.com....65.254.253.192.in-addr.arpa.    86400    IN    NS    relay.bar.com.65.254.253.192.in-addr.arpa.    86400    IN    NS    gw.bar.com.66.254.253.192.in-addr.arpa.    86400    IN    NS    relay.bar.com.66.254.253.192.in-addr.arpa.    86400    IN    NS    gw.bar.com....129.254.253.192.in-addr.arpa.    86400    IN    NS    mail.baz.com.130.254.253.192.in-addr.arpa.    86400    IN    NS    www.baz.com.194.254.253.192.in-addr.arpa.    86400    IN    NS    mail.baz.com.194.254.253.192.in-addr.arpa.    86400    IN    NS    www.baz.com.</PRE></BLOCKQUOTE><PCLASS="para">and so on, all the way down to <ICLASS="systemitem.sitename">254.254.253.192.in-addr.arpa</I>.  Of course,in <ICLASS="systemitem.sitename">ns1.foo.com</I>'s<ICLASS="filename">named.conf</I>, you'd also expect to see:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">zone &quot;1.254.253.192.in-addr.arpa&quot; {                type master;                file &quot;db.192.253.254.1&quot;;};zone &quot;2.254.253.192.in-addr.arpa&quot; {                type master;                file &quot;db.192.253.254.2&quot;;};</PRE></BLOCKQUOTE><PCLASS="para">Or, if <ICLASS="systemitem.sitename">ns1.foo.com</I> wererunning <SPANCLASS="acronym">BIND</SPAN> 4, you'd expect to see thesedirectives in <ICLASS="filename">named.boot</I>:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">primary    1.254.253.192.in-addr.arpa    db.192.253.254.1primary    2.254.253.192.in-addr.arpa    db.192.253.254.2</PRE></BLOCKQUOTE><PCLASS="para">and in <ICLASS="filename">db.192.253.254.1</I>, just the one<SPANCLASS="acronym">PTR</SPAN> record:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">@    IN    SOA    ns1.foo.com.    root.ns1.foo.com.    (                         1        ; Serial                         10800    ; Refresh                         3600     ; Retry                         608400   ; Expire                         86400    ; Default TTL    IN    NS    ns1.foo.com.    IN    NS    ns2.foo.com.    IN    PTR    thereitis.foo.com.</PRE></BLOCKQUOTE><PCLASS="para">Note that the <SPANCLASS="acronym">PTR</SPAN> record is attached to thezone's domain name, since the zone's domain name corresponds to justone <SPANCLASS="acronym">IP</SPAN> address.  Now, when a <ICLASS="systemitem.sitename">254.253.192.in-addr.arpa</I> name serverreceives a query for the <SPANCLASS="acronym">PTR</SPAN> record for <ICLASS="systemitem.sitename">1.254.253.192.in-addr.arpa</I>, it will referthe querier to <ICLASS="systemitem.sitename">ns1.foo.com</I>and <ICLASS="systemitem.sitename">ns2.foo.com</I>, which willrespond with the one <SPANCLASS="acronym">PTR</SPAN> record in the zone.</P>Solution 3<PCLASS="para">Finally, there's a clever technique that obviates the need tomaintain a separate zone data file for each <SPANCLASS="acronym">IP</SPAN>address.[3] The organization responsible for the overall /24 networkcreates <SPANCLASS="acronym">CNAME</SPAN> records for each of the domain namesin the zone, pointing to domain names in new subdomains, called<ICLASS="systemitem.sitename">0-63</I>, <ICLASS="systemitem.sitename">64-127</I>, <ICLASS="systemitem.sitename">128-191</I>, and <ICLASS="systemitem.sitename">192-255</I>, which are then delegated to theproper servers. Each subdomain will contain only the<SPANCLASS="acronym">PTR</SPAN> records in the range the subdomain is namedfor.</P><BLOCKQUOTECLASS="footnote"><PCLASS="para">[3] We first saw this explained by Glen Herrmansfeldt at CalTech inthe newsgroup <ACLASS="systemitem.newsgroup"HREF="news:comp.protocols.tcp-ip.domains">comp.protocols.tcp-ip.domains</A>.  It's nowcodified as <SPANCLASS="acronym">RFC</SPAN> 2317.</P></BLOCKQUOTE><PCLASS="para">Partial contents of file <ICLASS="systemitem.sitename">254.253.192.in-addr.arpa.dns</I>:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">1.254.253.192.in-addr.arpa.  IN  CNAME  1.0-63.254.253.192.in-addr.arpa.2.254.253.192.in-addr.arpa.  IN  CNAME  2.0-63.254.253.192.in-addr.arpa....0-63.254.253.192.in-addr.arpa.    86400    IN    NS    ns1.foo.com.0-63.254.253.192.in-addr.arpa.    86400    IN    NS    ns2.foo.com.65.254.253.192.in-addr.arpa. IN  CNAME 65.64-127.254.253.192.in-addr.arpa.66.254.253.192.in-addr.arpa. IN  CNAME 66.64-127.254.253.192.in-addr.arpa....64-127.254.253.192.in-addr.arpa.    86400    IN    NS    relay.bar.com.64-127.254.253.192.in-addr.arpa.    86400    IN    NS    gw.bar.com.129.254.253.192.in-addr.arpa.  IN  CNAME  129.128-191.254.253.192.in-addr.arpa.130.254.253.192.in-addr.arpa.  IN  CNAME  130.128-191.254.253.192.in-addr.arpa....128-191.254.253.192.in-addr.arpa.    86400    IN    NS    mail.baz.com.128-191.254.253.192.in-addr.arpa.    86400    IN    NS    www.baz.com.</PRE></BLOCKQUOTE><PCLASS="para">The zone data file for <ICLASS="systemitem.sitename">0-63.254.253.192.in-addr.arpa</I>,<ICLASS="filename">0-63.254.253.192.in-addr.arpa.dns</I>, can containjust <SPANCLASS="acronym">PTR</SPAN> records for <SPANCLASS="acronym">IP</SPAN>addresses 192.253.254.1 through 192.253.254.63.</P><PCLASS="para">Partial contents of file<ICLASS="filename">0-63.254.253.192.in-addr.arpa</I>:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">@    IN    soa    ns1.foo.com.    root.ns1.foo.com.    (                          1       ; Serial                          10800   ; Refresh                          3600    ; Retry                          608400  ; Expire                          86400 ) ; Default TTL    in    NS    ns1.foo.com.    in    NS    ns2.foo.com.1    IN    PTR    thereitis.foo.com.2    IN    PTR    setter.foo.com.3    IN    PTR    mouse.foo.com....</PRE></BLOCKQUOTE><ACLASS="indexterm"NAME="AUTOID-9899"></A><ACLASS="indexterm"NAME="AUTOID-9900"></A><PCLASS="para">When a resolver requests the <SPANCLASS="acronym">PTR</SPAN> record for<ICLASS="systemitem.sitename">1.254.253.192.in-addr.arpa</I>, a<ICLASS="systemitem.sitename">254.253.192.in-addr.arpa</I> nameserver will transparently (to the resolver) map this to a request forthe <SPANCLASS="acronym">PTR</SPAN> record for <ICLASS="systemitem.sitename">1.0-63.254.253.192.in-addr.arpa</I>.  Thisrequest will wind up at one of the <ICLASS="systemitem.sitename">0-63.254.253.192.in-addr.arpa</I> nameservers, run by the organization that runs the low<ACLASS="indexterm"NAME="AUTOID-9908"></A>(addresses 0-63)<ACLASS="indexterm"NAME="AUTOID-9909"></A><ACLASS="indexterm"NAME="AUTOID-9910"></A><ACLASS="indexterm"NAME="AUTOID-9911"></A><ACLASS="indexterm"NAME="AUTOID-9912"></A>subnet.<ACLASS="indexterm"NAME="AUTOID-9913"></A><ACLASS="indexterm"NAME="AUTOID-9914"></A><ACLASS="indexterm"NAME="AUTOID-9915"></A></P></DIV></DIV></DIV><DIVCLASS="htmlnav"><P></P><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch09_04.htm"TITLE="9.4 How to Become a Parent: Creating Subdomains"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 9.4 How to Become a Parent: Creating Subdomains"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="book"HREF="index.htm"TITLE="DNS &amp; BIND"><IMGSRC="../gifs/txthome.gif"ALT="DNS &amp; BIND"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch09_06.htm"TITLE="9.6 Good Parenting"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 9.6 Good Parenting"BORDER="0"></A></TD></TR><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172">9.4 How to Become a Parent: Creating Subdomains</TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="index"HREF="index/idx_0.htm"TITLE="Book Index"><IMGSRC="../gifs/index.gif"ALT="Book Index"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172">9.6 Good Parenting</TD></TR></TABLE><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><PCLASS="nav"><FONTSIZE="-1">[ <AHREF="../index.htm"TITLE="The Networking CD Bookshelf">Library Home</A> | <AHREF="index.htm"TITLE="DNS &amp; BIND">DNS &amp; BIND</A> | <AHREF="../tcpip/index.htm"TITLE="TCP/IP Network Administration">TCP/IP</A> | <AHREF="../sendmail/index.htm"TITLE="sendmail">sendmail</A> | <AHREF="../smdref/index.htm"TITLE="sendmail Desktop Reference">sendmail Reference</A> | <AHREF="../firewall/index.htm"TITLE="Building Internet Firewalls">Firewalls</A> | <AHREF="../puis/index.htm"TITLE="Practical UNIX &amp; Internet Security">Practical Security</A> ]</FONT></P></DIV></BODY></HTML>