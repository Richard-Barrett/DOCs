<HTML><HEAD><TITLE>[Chapter 10] 10.6 Preferring Name Servers on Certain Networks</TITLE><METANAME="DC.title"CONTENT="DNS &amp; BIND"><METANAME="DC.creator"CONTENT="Cricket Liu &amp; Paul Albitz"><METANAME="DC.publisher"CONTENT="O'Reilly &amp; Associates, Inc."><METANAME="DC.date"CONTENT="1999-01-06T18:36:25Z"><METANAME="DC.type"CONTENT="Text.Monograph"><METANAME="DC.format"CONTENT="text/html"SCHEME="MIME"><METANAME="DC.source"CONTENT="1-56592-512-2"SCHEME="ISBN"><METANAME="DC.language"CONTENT="en-US"><METANAME="generator"CONTENT="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><LINKREV="made"HREF="mailto:online-books@oreilly.com"TITLE="Online Books Comments"><LINKREL="up"HREF="ch10_01.htm"TITLE="10. Advanced Features and Security"><LINKREL="prev"HREF="ch10_05.htm"TITLE="10.5 Name Server Address Sorting"><LINKREL="next"HREF="ch10_07.htm"TITLE="10.7 Building Up a Large Site-wide Cache with Forwarders"></HEAD><BODYBGCOLOR="#FFFFFF"TEXT="#000000"><DIVCLASS="htmlnav"><H1><IMGSRC="gifs/smbanner.gif"ALT="DNS &amp; BIND"USEMAP="#srchmap"BORDER="0"></H1><MAPNAME="srchmap"><AREASHAPE="RECT"COORDS="0,0,466,65"HREF="index.htm"ALT="DNS &amp; BIND"><AREASHAPE="RECT"COORDS="467,0,514,18"HREF="../search/dsrch.htm"ALT="Search this book"></MAP><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch10_05.htm"TITLE="10.5 Name Server Address Sorting"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 10.5 Name Server Address Sorting"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><B><FONTFACE="ARIEL,HELVETICA,HELV,SANSERIF"SIZE="-1">Chapter 10<BR>Advanced Features and Security</FONT></B></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch10_07.htm"TITLE="10.7 Building Up a Large Site-wide Cache with Forwarders"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 10.7 Building Up a Large Site-wide Cache with Forwarders"BORDER="0"></A></TD></TR></TABLE>&nbsp;<HRALIGN="LEFT"WIDTH="515"TITLE="footer"></DIV><DIVCLASS="SECT1"><H2CLASS="sect1"><ACLASS="title"NAME="AUTOID-11099">10.6 Preferring Name Servers on Certain Networks</A></H2><PCLASS="para"><ACLASS="indexterm"NAME="CH10.PREFERENCES"></A><ACLASS="indexterm"NAME="CH10.PREFERENCES2"></A><ACLASS="indexterm"NAME="CH10.PREFERENCES3"></A><SPANCLASS="acronym">BIND</SPAN> 8's topology feature is somewhat similarto <ICLASS="filename">sortlist</I>, but it only applies to the processof choosing name servers.  We described how <SPANCLASS="acronym">BIND</SPAN>chooses between a number of name servers that are authoritative forthe same zone earlier in the book&nbsp;- by selecting the name serverwith the lowest roundtrip time.  But we lied&nbsp;- a little.<SPANCLASS="acronym">BIND</SPAN> 8 actually places remote name servers in 64millisecond bands when comparing <SPANCLASS="acronym">RTT</SPAN>.  The firstband is actually only 32 milliseconds wide (there!  We did it again),from zero to 32 milliseconds.  The next extends from 33 to 96milliseconds, and so on.  The bands are designed so that name serverson different continents will always be in different bands.</P><PCLASS="para">The idea is to favor name servers in lower bands but to treatservers in the same band as equivalent.  If a name server compares tworemote servers' <SPANCLASS="acronym">RTT</SPAN>s and one is in a lower band,the name server will choose to send the query to the name server inthe lower band.  But if the remote servers are in the same band, thename server will check to see whether one of the remote servers istopologically closer.</P><PCLASS="para">Topology lets you introduce yet another element of fudge intothe process of choosing a name server to query.  Topology lets youfavor name servers on certain networks over others.  Topology takes asan argument an address match list, where the entries are networks,listed in the order in which the local name server should prefer them(highest to lowest).  Therefore:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">topology {                15/8;                172.88/16;};</PRE></BLOCKQUOTE><PCLASS="para">tells the local name server to prefer name servers on thenetwork 15.0.0.0 over other name servers, and name servers on thenetwork 172.88.0.0 over name servers on networks other than network15.0.0.0.  So if the name server has a choice between a name server onnetwork 15.0.0.0, a name server on 172.88.0.0, and a name server on192.168.1.0, assuming all three have <SPANCLASS="acronym">RTT</SPAN> values inthe same band, it will choose to query the name server on15.0.0.0.</P><PCLASS="para">You can also negate entries in the topology address match listto penalize name servers on certain networks.  The higher in theaddress match list the negated entry matches, the greater thepenalty.</P><ACLASS="indexterm"NAME="AUTOID-11121"></A><ACLASS="indexterm"NAME="AUTOID-11122"></A><ACLASS="indexterm"NAME="AUTOID-11123"></A></DIV><DIVCLASS="htmlnav"><P></P><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch10_05.htm"TITLE="10.5 Name Server Address Sorting"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 10.5 Name Server Address Sorting"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="book"HREF="index.htm"TITLE="DNS &amp; BIND"><IMGSRC="../gifs/txthome.gif"ALT="DNS &amp; BIND"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch10_07.htm"TITLE="10.7 Building Up a Large Site-wide Cache with Forwarders"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 10.7 Building Up a Large Site-wide Cache with Forwarders"BORDER="0"></A></TD></TR><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172">10.5 Name Server Address Sorting</TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="index"HREF="index/idx_0.htm"TITLE="Book Index"><IMGSRC="../gifs/index.gif"ALT="Book Index"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172">10.7 Building Up a Large Site-wide Cache with Forwarders</TD></TR></TABLE><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><PCLASS="nav"><FONTSIZE="-1">[ <AHREF="../index.htm"TITLE="The Networking CD Bookshelf">Library Home</A> | <AHREF="index.htm"TITLE="DNS &amp; BIND">DNS &amp; BIND</A> | <AHREF="../tcpip/index.htm"TITLE="TCP/IP Network Administration">TCP/IP</A> | <AHREF="../sendmail/index.htm"TITLE="sendmail">sendmail</A> | <AHREF="../smdref/index.htm"TITLE="sendmail Desktop Reference">sendmail Reference</A> | <AHREF="../firewall/index.htm"TITLE="Building Internet Firewalls">Firewalls</A> | <AHREF="../puis/index.htm"TITLE="Practical UNIX &amp; Internet Security">Practical Security</A> ]</FONT></P></DIV></BODY></HTML>