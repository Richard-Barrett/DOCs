<HTML><HEAD><TITLE>[Chapter 10] 10.7 Building Up a Large Site-wide Cache with Forwarders</TITLE><METANAME="DC.title"CONTENT="DNS &amp; BIND"><METANAME="DC.creator"CONTENT="Cricket Liu &amp; Paul Albitz"><METANAME="DC.publisher"CONTENT="O'Reilly &amp; Associates, Inc."><METANAME="DC.date"CONTENT="1999-01-06T18:36:26Z"><METANAME="DC.type"CONTENT="Text.Monograph"><METANAME="DC.format"CONTENT="text/html"SCHEME="MIME"><METANAME="DC.source"CONTENT="1-56592-512-2"SCHEME="ISBN"><METANAME="DC.language"CONTENT="en-US"><METANAME="generator"CONTENT="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><LINKREV="made"HREF="mailto:online-books@oreilly.com"TITLE="Online Books Comments"><LINKREL="up"HREF="ch10_01.htm"TITLE="10. Advanced Features and Security"><LINKREL="prev"HREF="ch10_06.htm"TITLE="10.6 Preferring Name Servers on Certain Networks"><LINKREL="next"HREF="ch10_08.htm"TITLE="10.8 A More Restricted Name Server"></HEAD><BODYBGCOLOR="#FFFFFF"TEXT="#000000"><DIVCLASS="htmlnav"><H1><IMGSRC="gifs/smbanner.gif"ALT="DNS &amp; BIND"USEMAP="#srchmap"BORDER="0"></H1><MAPNAME="srchmap"><AREASHAPE="RECT"COORDS="0,0,466,65"HREF="index.htm"ALT="DNS &amp; BIND"><AREASHAPE="RECT"COORDS="467,0,514,18"HREF="../search/dsrch.htm"ALT="Search this book"></MAP><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch10_06.htm"TITLE="10.6 Preferring Name Servers on Certain Networks"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 10.6 Preferring Name Servers on Certain Networks"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><B><FONTFACE="ARIEL,HELVETICA,HELV,SANSERIF"SIZE="-1">Chapter 10<BR>Advanced Features and Security</FONT></B></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch10_08.htm"TITLE="10.8 A More Restricted Name Server"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 10.8 A More Restricted Name Server"BORDER="0"></A></TD></TR></TABLE>&nbsp;<HRALIGN="LEFT"WIDTH="515"TITLE="footer"></DIV><DIVCLASS="SECT1"><H2CLASS="sect1"><ACLASS="title"NAME="AUTOID-11124">10.7 Building Up a Large Site-wide Cache with Forwarders</A></H2><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-11127"></A><ACLASS="indexterm"NAME="AUTOID-11129"></A><ACLASS="indexterm"NAME="AUTOID-11132"></A>Certain network connections discourage sending large volumes oftraffic off-site, either because the network connection ispay-per-packet or because the network connection is a slow link with ahigh delay, like a remote office's satellite connection to thecompany's network.  In these situations, you'll want to limit theoff-site <SPANCLASS="acronym">DNS</SPAN> traffic to the bareminimum. <SPANCLASS="acronym">BIND</SPAN> provides a mechanism to do this:<ICLASS="firstterm">forwarders</I>.</P><PCLASS="para">If you designate one or more servers at your site as forwarders,all the off-site queries are sent to the forwarders first. The idea isthat the forwarders handle all the off-site queries generated at thesite, building up a rich cache of information. For any given query ina remote domain, there is a high probability that the forwarder cananswer the query from its cache, avoiding the need for the otherservers to send packets off-site. Nothing special is done to theseservers to make them forwarders; you modify all the <EMCLASS="emphasis">otherservers</EM> at your site to direct their queries through theforwarders.</P><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-11141"></A><ACLASS="indexterm"NAME="AUTOID-11144"></A>A primary master or slave name server's mode of operationchanges slightly when it is directed to use a forwarder. If therequested information is already in its database of authoritative dataand cache data, it answers with this information; this part of theoperation hasn't changed. However, if the information is not in itsdatabase, the name server will send the query to a forwarder and waita short period for an answer before resuming normal operation andcontacting the remote servers itself. What the name server is doingthat's different is sending a<ACLASS="indexterm"NAME="AUTOID-11147"></A><ACLASS="indexterm"NAME="AUTOID-11150"></A><ACLASS="indexterm"NAME="AUTOID-11152"></A><ACLASS="indexterm"NAME="AUTOID-11154"></A><ACLASS="indexterm"NAME="AUTOID-11156"></A><ICLASS="firstterm">recursive</I> query to the forwarder, expecting itto find the answer. At all other times, the name server sends out<ICLASS="firstterm">nonrecursive</I> queries to other name servers anddeals with responses that only refer to other name servers.</P><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-11162"></A>For example, here is the <ICLASS="structfield">forwarders</I>conf file statement&nbsp;- and the equivalent <SPANCLASS="acronym">BIND</SPAN> 4boot file directive&nbsp;- for name servers in the <ICLASS="systemitem.sitename">movie.edu</I> domain. Both <ICLASS="systemitem.sitename">wormhole</I> and <ICLASS="systemitem.sitename">terminator</I> are the site forwarders. This<ICLASS="structfield">forwarders</I> statement is added to every nameserver conf file <EMCLASS="emphasis">except</EM> the conf files for theforwarders, <ICLASS="systemitem.sitename">wormhole</I> and<ICLASS="systemitem.sitename">terminator</I>:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">options {                forwarders { 192.249.249.1; 192.249.249.3; };};</PRE></BLOCKQUOTE><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-11176"></A>The equivalent <SPANCLASS="acronym">BIND</SPAN> 4 directive is:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">forwarders 192.249.249.1 192.249.249.3</PRE></BLOCKQUOTE><PCLASS="para">When you use forwarders, try to keep your site configurationsimple. You <EMCLASS="emphasis">can</EM> end up with configurations thatare really twisted.</P><PCLASS="para">Avoid having <SPANCLASS="quote">"mid-level"</SPAN> servers forward packets(i.e., avoid having a <ICLASS="structfield">forwarders</I> line inyour mid-level name server's conf file). Mid-level servers mostlyrefer name servers to subdomain name servers. If they have beenconfigured to forward packets, do they refer to subdomain name serversor do they contact the subdomain name server to find out the answer?Whichever way it works, you're probably making your site configurationtoo hard for mere mortals (and subdomain administrators) tounderstand.</P><BLOCKQUOTECLASS="note"><PCLASS="para"><STRONG>NOTE:</STRONG> Avoid chaining your forwarders. Don't configure server A toforward to server B, and configure server B to forward to server C (orworse yet, back to server A).</P></BLOCKQUOTE></DIV><DIVCLASS="htmlnav"><P></P><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch10_06.htm"TITLE="10.6 Preferring Name Servers on Certain Networks"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 10.6 Preferring Name Servers on Certain Networks"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="book"HREF="index.htm"TITLE="DNS &amp; BIND"><IMGSRC="../gifs/txthome.gif"ALT="DNS &amp; BIND"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch10_08.htm"TITLE="10.8 A More Restricted Name Server"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 10.8 A More Restricted Name Server"BORDER="0"></A></TD></TR><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172">10.6 Preferring Name Servers on Certain Networks</TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="index"HREF="index/idx_0.htm"TITLE="Book Index"><IMGSRC="../gifs/index.gif"ALT="Book Index"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172">10.8 A More Restricted Name Server</TD></TR></TABLE><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><PCLASS="nav"><FONTSIZE="-1">[ <AHREF="../index.htm"TITLE="The Networking CD Bookshelf">Library Home</A> | <AHREF="index.htm"TITLE="DNS &amp; BIND">DNS &amp; BIND</A> | <AHREF="../tcpip/index.htm"TITLE="TCP/IP Network Administration">TCP/IP</A> | <AHREF="../sendmail/index.htm"TITLE="sendmail">sendmail</A> | <AHREF="../smdref/index.htm"TITLE="sendmail Desktop Reference">sendmail Reference</A> | <AHREF="../firewall/index.htm"TITLE="Building Internet Firewalls">Firewalls</A> | <AHREF="../puis/index.htm"TITLE="Practical UNIX &amp; Internet Security">Practical Security</A> ]</FONT></P></DIV></BODY></HTML>