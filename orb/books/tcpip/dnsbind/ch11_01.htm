<HTML><HEAD><TITLE>[Chapter 11] nslookup</TITLE><METANAME="DC.title"CONTENT="DNS &amp; BIND"><METANAME="DC.creator"CONTENT="Cricket Liu &amp; Paul Albitz"><METANAME="DC.publisher"CONTENT="O'Reilly &amp; Associates, Inc."><METANAME="DC.date"CONTENT="1999-01-06T18:37:22Z"><METANAME="DC.type"CONTENT="Text.Monograph"><METANAME="DC.format"CONTENT="text/html"SCHEME="MIME"><METANAME="DC.source"CONTENT="1-56592-512-2"SCHEME="ISBN"><METANAME="DC.language"CONTENT="en-US"><METANAME="generator"CONTENT="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><LINKREV="made"HREF="mailto:online-books@oreilly.com"TITLE="Online Books Comments"><LINKREL="up"HREF="index.htm"TITLE="DNS &amp; BIND"><LINKREL="prev"HREF="ch10_12.htm"TITLE="10.12 Load Sharing Between Mirrored Servers"><LINKREL="next"HREF="ch11_02.htm"TITLE="11.2 Interactive Versus Noninteractive"></HEAD><BODYBGCOLOR="#FFFFFF"TEXT="#000000"><DIVCLASS="htmlnav"><H1><IMGSRC="gifs/smbanner.gif"ALT="DNS &amp; BIND"USEMAP="#srchmap"BORDER="0"></H1><MAPNAME="srchmap"><AREASHAPE="RECT"COORDS="0,0,466,65"HREF="index.htm"ALT="DNS &amp; BIND"><AREASHAPE="RECT"COORDS="467,0,514,18"HREF="../search/dsrch.htm"ALT="Search this book"></MAP><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch10_12.htm"TITLE="10.12 Load Sharing Between Mirrored Servers"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 10.12 Load Sharing Between Mirrored Servers"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><B><FONTFACE="ARIEL,HELVETICA,HELV,SANSERIF"SIZE="-1">Chapter 11</FONT></B></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch11_02.htm"TITLE="11.2 Interactive Versus Noninteractive"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 11.2 Interactive Versus Noninteractive"BORDER="0"></A></TD></TR></TABLE>&nbsp;<HRALIGN="LEFT"WIDTH="515"TITLE="footer"></DIV><DIVCLASS="CHAPTER"><H1CLASS="chapter"><ACLASS="title"NAME="DNS3-CHP-11">11. nslookup</A></H1><DIVCLASS="htmltoc"><P><B>Contents:</B><BR><ACLASS="sect1"HREF="#AUTOID-11840"TITLE="11.1 Is nslookup a Good Tool?">Is nslookup a Good Tool?</A><BR><ACLASS="sect1"HREF="ch11_02.htm"TITLE="11.2 Interactive Versus Noninteractive">Interactive Versus Noninteractive</A><BR><ACLASS="sect1"HREF="ch11_03.htm"TITLE="11.3 Option Settings">Option Settings</A><BR><ACLASS="sect1"HREF="ch11_04.htm"TITLE="11.4 Avoiding the Search List">Avoiding the Search List</A><BR><ACLASS="sect1"HREF="ch11_05.htm"TITLE="11.5 Common Tasks">Common Tasks</A><BR><ACLASS="sect1"HREF="ch11_06.htm"TITLE="11.6 Less Common Tasks">Less Common Tasks</A><BR><ACLASS="sect1"HREF="ch11_07.htm"TITLE="11.7 Troubleshooting nslookup Problems">Troubleshooting nslookup Problems</A><BR><ACLASS="sect1"HREF="ch11_08.htm"TITLE="11.8 Best of the Net">Best of the Net</A></P><P></P></DIV><DIVCLASS="epigraph"><PCLASS="para"ALIGN="right"><I><SPANCLASS="quote">"Don't stand chattering to yourself like that,"</SPAN>Humpty Dumpty said, looking at her for the first time, <SPANCLASS="quote">"but tellme your name and your business."</SPAN></I></P><PCLASS="para"ALIGN="right"><I><SPANCLASS="quote">"My name is Alice, but&nbsp;- "</SPAN></I></P><PCLASS="para"ALIGN="right"><I><SPANCLASS="quote">"It's a stupid name enough!"</SPAN> Humpty Dumptyinterrupted impatiently. <SPANCLASS="quote">"What does it mean?"</SPAN></I></P><PCLASS="para"ALIGN="right"><I><SPANCLASS="quote">"Must a name mean something?"</SPAN> Alice askeddoubtfully.</I></P><PCLASS="para"ALIGN="right"><I><SPANCLASS="quote">"Of course it must,"</SPAN> Humpty Dumpty said with ashort laugh...</I></P></DIV><PCLASS="para"><ACLASS="indexterm"NAME="CH11.NSLOOKUP"></A>To be proficient at troubleshooting name server problems, you'll needa special tool to make <SPANCLASS="acronym">DNS</SPAN> queries, one that givesyou complete control. We'll cover <KBDCLASS="command">nslookup</KBD> in thischapter because it's distributed with <SPANCLASS="acronym">BIND</SPAN> and withmany vendors' systems.  If you're the explorer type, you might alsocheck out <KBDCLASS="command">dig</KBD>; it provides similar functionality,and some people like its user interface better. You can pick up sourcefor <KBDCLASS="command">dig</KBD> from the <ICLASS="filename">tools</I>directory (<SPANCLASS="acronym">BIND</SPAN> 4) or <ICLASS="filename">src/bin</I>directory (<SPANCLASS="acronym">BIND</SPAN> 8) of the <SPANCLASS="acronym">BIND</SPAN>distribution.</P><PCLASS="para">Note that this chapter isn't comprehensive; there are aspects of<KBDCLASS="command">nslookup</KBD>&nbsp;- mostly obscure andseldom used&nbsp;- that we won't cover. You can always consult themanual pages for those.</P><DIVCLASS="sect1"><H2CLASS="sect1"><ACLASS="title"NAME="AUTOID-11840">11.1 Is nslookup a Good Tool?</A></H2><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-11843"></A>Much of the time you'll use <KBDCLASS="command">nslookup</KBD> to makequeries, in the same way the resolver makes them. Sometimes, though,you'll use <KBDCLASS="command">nslookup</KBD> to query other name servers asa name server would, instead. Which one you emulate will depend on theproblem you're trying to debug. You might wonder, <SPANCLASS="quote">"Howaccurately does <KBDCLASS="command">nslookup</KBD> emulate a resolver or aname server? Does <KBDCLASS="command">nslookup</KBD> actually use the<SPANCLASS="acronym">BIND</SPAN> resolver library routines?"</SPAN> No,<KBDCLASS="command">nslookup</KBD> uses its own routines for querying nameservers, but those routines are based on the resolverroutines. Consequently, <KBDCLASS="command">nslookup</KBD>'s behavior is verysimilar to the resolver's behavior, but it does differ slightly. We'llpoint out some of those differences. As for emulating name serverbehavior, <KBDCLASS="command">nslookup</KBD> allows us to query anotherserver with the same query packet that a name server would use, butthe retransmission scheme is quite different.  Like a name server,though, <KBDCLASS="command">nslookup</KBD> can pull a copy of the zonedata. So <KBDCLASS="command">nslookup</KBD> does not exactly emulate eitherthe resolver or the name server, but it does emulate them well enoughto make a good troubleshooting tool. Let's delve into thosedifferences we alluded to.</P><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="AUTOID-11857">11.1.1 Multiple Servers</A></H3><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-11860"></A><KBDCLASS="command">nslookup</KBD><ACLASS="indexterm"NAME="AUTOID-11864"></A>only talks to one name server at a time. This is the biggestdifference between <KBDCLASS="command">nslookup</KBD>'s behavior and theresolver's behavior. The resolver makes use of each<ICLASS="structfield">nameserver</I> entry in<ICLASS="filename">resolv.conf</I>. If there are two<ICLASS="structfield">nameserver</I> lines in<ICLASS="filename">resolv.conf</I>, the resolver tries the first nameserver, then the second, then the first, then the second, until itreceives a response or it gives up. The resolver does this for everyquery. On the other hand, <KBDCLASS="command">nslookup</KBD> tries the firstname server in <ICLASS="filename">resolv.conf</I> and keeps retryinguntil it finally gives up on the first name server and tries thesecond. Once it gets a response, it locks onto that server and doesn'ttry the other. But, you <EMCLASS="emphasis">want</EM> your troubleshootingtool to talk only with one name server, so you can reduce the numberof variables when analyzing a problem. If <KBDCLASS="command">nslookup</KBD>used more than one name server, you wouldn't have as much control overyour troubleshooting session. So, talking to only one server is theright thing for a troubleshooting tool to do.</P></DIV><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="AUTOID-11876">11.1.2 Timeouts</A></H3><PCLASS="para">The <KBDCLASS="command">nslookup</KBD><ACLASS="indexterm"NAME="AUTOID-11880"></A> timeouts match the resolver timeouts when the resolver is onlyquerying one name server. A name server's timeouts, however, are basedon how quickly the remote server answered the last query, a dynamicmeasure.  <KBDCLASS="command">nslookup</KBD> will never match name servertimeouts, but that's not a problem either. When you're querying remotename servers with <KBDCLASS="command">nslookup</KBD>, you probably only care<EMCLASS="emphasis">what</EM> the response was, not how long ittook.</P></DIV><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="AUTOID-11886">11.1.3 Domain Searches</A></H3><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-11889"></A><ACLASS="indexterm"NAME="AUTOID-11892"></A><KBDCLASS="command">nslookup</KBD> implements the search list just as theresolver code does. Name servers don't implement search lists, so, toact like a name server, the <KBDCLASS="command">nslookup</KBD> searchfunction must be turned off&nbsp;- more on that later.</P></DIV><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="AUTOID-11897">11.1.4 Zone Transfers</A></H3><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-11900"></A><ACLASS="indexterm"NAME="AUTOID-11903"></A><KBDCLASS="command">nslookup</KBD> will do zone transfers just like a nameserver. Unlike the name server, <KBDCLASS="command">nslookup</KBD> does notcheck <SPANCLASS="acronym">SOA</SPAN> serial numbers before pulling the zonedata; you'll have to do that manually, if you want to.</P></DIV><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="AUTOID-11909">11.1.5 Using <SPANCLASS="acronym">NIS</SPAN> and /etc/hosts</A></H3><PCLASS="para">This last point doesn't compare <KBDCLASS="command">nslookup</KBD> tothe resolver or name server but to ways of looking up names ingeneral. <KBDCLASS="command">nslookup</KBD>, as distributed from the InternetSoftware Consortium, only uses <SPANCLASS="acronym">DNS</SPAN>; it won't use<ACLASS="indexterm"NAME="AUTOID-11916"></A><ACLASS="indexterm"NAME="AUTOID-11920"></A><SPANCLASS="acronym">NIS</SPAN> or <ICLASS="filename">/etc/hosts</I>.  Mostapplications will use <SPANCLASS="acronym">DNS</SPAN>, <SPANCLASS="acronym">NIS</SPAN>,or <ICLASS="filename">/etc/hosts</I>.  Don't look to<KBDCLASS="command">nslookup</KBD> to help you find your lookup problemunless your host is really configured to use name servers.</P></DIV></DIV></DIV><DIVCLASS="htmlnav"><P></P><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch10_12.htm"TITLE="10.12 Load Sharing Between Mirrored Servers"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 10.12 Load Sharing Between Mirrored Servers"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="book"HREF="index.htm"TITLE="DNS &amp; BIND"><IMGSRC="../gifs/txthome.gif"ALT="DNS &amp; BIND"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch11_02.htm"TITLE="11.2 Interactive Versus Noninteractive"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 11.2 Interactive Versus Noninteractive"BORDER="0"></A></TD></TR><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172">10.12 Load Sharing Between Mirrored Servers</TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="index"HREF="index/idx_0.htm"TITLE="Book Index"><IMGSRC="../gifs/index.gif"ALT="Book Index"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172">11.2 Interactive Versus Noninteractive</TD></TR></TABLE><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><PCLASS="nav"><FONTSIZE="-1">[ <AHREF="../index.htm"TITLE="The Networking CD Bookshelf">Library Home</A> | <AHREF="index.htm"TITLE="DNS &amp; BIND">DNS &amp; BIND</A> | <AHREF="../tcpip/index.htm"TITLE="TCP/IP Network Administration">TCP/IP</A> | <AHREF="../sendmail/index.htm"TITLE="sendmail">sendmail</A> | <AHREF="../smdref/index.htm"TITLE="sendmail Desktop Reference">sendmail Reference</A> | <AHREF="../firewall/index.htm"TITLE="Building Internet Firewalls">Firewalls</A> | <AHREF="../puis/index.htm"TITLE="Practical UNIX &amp; Internet Security">Practical Security</A> ]</FONT></P></DIV></BODY></HTML>