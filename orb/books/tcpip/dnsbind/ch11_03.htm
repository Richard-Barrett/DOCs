<HTML><HEAD><TITLE>[Chapter 11] 11.3 Option Settings</TITLE><METANAME="DC.title"CONTENT="DNS &amp; BIND"><METANAME="DC.creator"CONTENT="Cricket Liu &amp; Paul Albitz"><METANAME="DC.publisher"CONTENT="O'Reilly &amp; Associates, Inc."><METANAME="DC.date"CONTENT="1999-01-06T18:37:26Z"><METANAME="DC.type"CONTENT="Text.Monograph"><METANAME="DC.format"CONTENT="text/html"SCHEME="MIME"><METANAME="DC.source"CONTENT="1-56592-512-2"SCHEME="ISBN"><METANAME="DC.language"CONTENT="en-US"><METANAME="generator"CONTENT="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><LINKREV="made"HREF="mailto:online-books@oreilly.com"TITLE="Online Books Comments"><LINKREL="up"HREF="ch11_01.htm"TITLE="11. nslookup"><LINKREL="prev"HREF="ch11_02.htm"TITLE="11.2 Interactive Versus Noninteractive"><LINKREL="next"HREF="ch11_04.htm"TITLE="11.4 Avoiding the Search List"></HEAD><BODYBGCOLOR="#FFFFFF"TEXT="#000000"><DIVCLASS="htmlnav"><H1><IMGSRC="gifs/smbanner.gif"ALT="DNS &amp; BIND"USEMAP="#srchmap"BORDER="0"></H1><MAPNAME="srchmap"><AREASHAPE="RECT"COORDS="0,0,466,65"HREF="index.htm"ALT="DNS &amp; BIND"><AREASHAPE="RECT"COORDS="467,0,514,18"HREF="../search/dsrch.htm"ALT="Search this book"></MAP><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch11_02.htm"TITLE="11.2 Interactive Versus Noninteractive"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 11.2 Interactive Versus Noninteractive"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><B><FONTFACE="ARIEL,HELVETICA,HELV,SANSERIF"SIZE="-1">Chapter 11<BR>nslookup</FONT></B></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch11_04.htm"TITLE="11.4 Avoiding the Search List"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 11.4 Avoiding the Search List"BORDER="0"></A></TD></TR></TABLE>&nbsp;<HRALIGN="LEFT"WIDTH="515"TITLE="footer"></DIV><DIVCLASS="SECT1"><H2CLASS="sect1"><ACLASS="title"NAME="AUTOID-11957">11.3 Option Settings</A></H2><PCLASS="para"><ACLASS="indexterm"NAME="CH11.NSLOOKUPOPTIONS"></A><KBDCLASS="command">nslookup</KBD> has its own set of dials and knobs, calledoption settings. All of the option settings can be changed. We'lldiscuss here what each of the options means. We'll use the rest of thechapter to show you how to use them.</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">% <CODECLASS="userinput"><B>nslookup</B></CODE>Default Server:  bladerunner.fx.movie.eduAddress:  0.0.0.0&gt; <CODECLASS="userinput"><B>set all</B></CODE>Default Server:  bladerunner.fx.movie.eduAddress:  0.0.0.0Set options:  nodebug         defname         search          recurse  nod2            novc            noignoretc      port=53  querytype=A     class=IN        timeout=5       retry=4  root=a.root-servers.net.  domain=fx.movie.edu  srchlist=fx.movie.edu&gt; <CODECLASS="userinput"><B>^D</B></CODE></PRE></BLOCKQUOTE><PCLASS="para">Before we get into the options, we need to cover theintroductory lines. The default name server is <ICLASS="systemitem.sitename">bladerunner.fx.movie.edu</I>.  This meansthat every query sent by <KBDCLASS="command">nslookup</KBD> is going to besent to <ICLASS="systemitem.sitename">bladerunner</I>. Theaddress 0.0.0.0 means <SPANCLASS="quote">"this host."</SPAN> When<KBDCLASS="command">nslookup</KBD> is using address 0.0.0.0 or 127.0.0.1 asits server, it is using the name server running on the localsystem&nbsp;- in this case, <ICLASS="systemitem.sitename">bladerunner</I>.</P><PCLASS="para">The options come in two flavors: <ICLASS="type">Boolean</I> and<ICLASS="type">value</I>.  The options that do not have an equals sign afterthem are<ACLASS="indexterm"NAME="AUTOID-11978"></A>Boolean options. They have the interesting property of being either<SPANCLASS="quote">"on"</SPAN> or <SPANCLASS="quote">"off."</SPAN> The value options can take ondifferent, well, values. How can we tell which Boolean options are onand which are off? The option is <EMCLASS="emphasis">off</EM> when a<SPANCLASS="quote">"no"</SPAN> precedes the option'sname. <EMCLASS="emphasis">nodebug</EM> means that debugging is off. As youmight guess, the option <EMCLASS="emphasis">search</EM> is on.</P><PCLASS="para">How you change Boolean or value options depends on whether youare using <KBDCLASS="command">nslookup</KBD> interactively or not.  In aninteractive session, you change an option with the<ACLASS="indexterm"NAME="AUTOID-11988"></A><KBDCLASS="command">set</KBD> command, as in <KBDCLASS="command">set debug</KBD> or<KBDCLASS="command">set domain=classics.movie.edu</KBD>.  From the commandline, you omit the word <KBDCLASS="command">set</KBD> and precede the optionwith a hyphen, as in <KBDCLASS="command">nslookup -debug</KBD> or<KBDCLASS="command">nslookup -domain=classics.movie.edu</KBD>. The optionscan be abbreviated to their shortest unique string&nbsp;- e.g.,<ICLASS="option">nodeb</I> for <ICLASS="option">nodebug</I>. In addition toits abbreviation, the <ICLASS="option">querytype</I> option can also becalled simply <ICLASS="option">type</I>.</P><PCLASS="para">Let's go through each of the options:</P><DLCLASS="variablelist"><DTCLASS="term"><ICLASS="function">[no]debug</I></DT><DDCLASS="listitem"><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-12007"></A><ACLASS="indexterm"NAME="AUTOID-12009"></A><ACLASS="indexterm"NAME="AUTOID-12011"></A>Debugging is turned off by default. If it is turned on, the nameserver shows timeouts and displays the response packets. See<ICLASS="option">[no]d2</I> for a discussion of debug level 2.</P></DD><DTCLASS="term"><ICLASS="function">[no]defname</I></DT><DDCLASS="listitem"><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-12020"></A><ACLASS="indexterm"NAME="AUTOID-12022"></A>By default, <KBDCLASS="command">nslookup</KBD> adds the default domain nameto names without a dot in them. Before search lists existed, the<SPANCLASS="acronym">BIND</SPAN> resolver code would only add the defaultdomain to names without <EMCLASS="emphasis">any</EM> dots in them; thisoption reflects that behavior. <KBDCLASS="command">nslookup</KBD> canimplement the pre-search list behavior (with <ICLASS="option">search</I>off and <ICLASS="option">defname</I> on), or it can implement the searchlist behavior (with <ICLASS="option">search</I> on).</P></DD><DTCLASS="term"><ICLASS="option">[no]search</I></DT><DDCLASS="listitem"><PCLASS="para">The<ACLASS="indexterm"NAME="AUTOID-12036"></A><ACLASS="indexterm"NAME="AUTOID-12038"></A>search option <SPANCLASS="quote">"overshadows"</SPAN> the default domain name(<ICLASS="option">defname</I>) option. That is, <ICLASS="option">defname</I>only applies if <ICLASS="option">search</I> is turned off. By default,<KBDCLASS="command">nslookup</KBD> appends the domains in the search list(<ICLASS="option">srchlist</I>) to names that don't end in a dot.</P></DD><DTCLASS="term"><ICLASS="function">[no]recurse</I></DT><DDCLASS="listitem"><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-12051"></A><ACLASS="indexterm"NAME="AUTOID-12053"></A><KBDCLASS="command">nslookup</KBD> requests recursive service bydefault. This turns on the recursion-desired bit in query packets. The<SPANCLASS="acronym">BIND</SPAN> resolver sends recursive queries in the sameway. Name servers, however, send out nonrecursive queries to othername servers.</P></DD><DTCLASS="term"><ICLASS="option">[no]d2</I></DT><DDCLASS="listitem"><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-12062"></A><ACLASS="indexterm"NAME="AUTOID-12064"></A>Debugging at level 2 is turned off by default. If it is turned on, yousee the query packets sent out in addition to the regular debuggingoutput.  Turning on <ICLASS="option">d2</I> also turns on<ICLASS="option">debug</I>.  Turning off <ICLASS="option">d2</I> turns off<ICLASS="option">d2</I> only; <ICLASS="option">debug</I> is left on. Turningoff <ICLASS="option">debug</I> turns off both <ICLASS="option">debug</I> and<ICLASS="option">d2</I>.</P></DD><DTCLASS="term"><ICLASS="option">[no]vc</I></DT><DDCLASS="listitem"><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-12079"></A><ACLASS="indexterm"NAME="AUTOID-12081"></A><ACLASS="indexterm"NAME="AUTOID-12083"></A><ACLASS="indexterm"NAME="AUTOID-12085"></A><ACLASS="indexterm"NAME="AUTOID-12087"></A><ACLASS="indexterm"NAME="AUTOID-12090"></A>By default, <KBDCLASS="command">nslookup</KBD> makes queries using<SPANCLASS="acronym">UDP</SPAN> packets instead of over a<EMCLASS="emphasis">v</EM>irtual<EMCLASS="emphasis">c</EM>ircuit (<SPANCLASS="acronym">TCP</SPAN>). Most<SPANCLASS="acronym">BIND</SPAN> resolver queries are made with<SPANCLASS="acronym">UDP</SPAN>, so the default <KBDCLASS="command">nslookup</KBD>behavior matches the resolver. As the resolver can be instructed touse <SPANCLASS="acronym">TCP</SPAN>, so can <KBDCLASS="command">nslookup</KBD>.</P></DD><DTCLASS="term"><ICLASS="function">[no]ignoretc</I></DT><DDCLASS="listitem"><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-12108"></A><ACLASS="indexterm"NAME="AUTOID-12110"></A><ACLASS="indexterm"NAME="AUTOID-12112"></A>By default, <KBDCLASS="command">nslookup</KBD> <EMCLASS="emphasis">doesn't</EM>ignore truncated packets. If a packet is received that has the<SPANCLASS="quote">"truncated"</SPAN> bit set&nbsp;- indicating that the name servercouldn't fit all the important information in the<SPANCLASS="acronym">UDP</SPAN> responsepacket&nbsp;- <KBDCLASS="command">nslookup</KBD> doesn't ignore it; it retriesthe query using a <SPANCLASS="acronym">TCP</SPAN> connection instead of<SPANCLASS="acronym">UDP</SPAN>. Again, this matches the<SPANCLASS="acronym">BIND</SPAN> resolver behavior. The reason for retrying thequery using a <SPANCLASS="acronym">TCP</SPAN> connection is that<SPANCLASS="acronym">TCP</SPAN> responses can be twice as large as<SPANCLASS="acronym">UDP</SPAN> responses. <SPANCLASS="acronym">TCP</SPAN> responses<EMCLASS="emphasis">could</EM> be many times the size of a<SPANCLASS="acronym">UDP</SPAN> response (a <SPANCLASS="acronym">TCP</SPAN> connectioncan carry much more data than a single <SPANCLASS="acronym">UDP</SPAN> packet),but the buffers <SPANCLASS="acronym">BIND</SPAN> uses for a<SPANCLASS="acronym">TCP</SPAN> query are only twice as large as the<SPANCLASS="acronym">UDP</SPAN> buffers.</P></DD><DTCLASS="term"><ICLASS="function">port=53</I></DT><DDCLASS="listitem"><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-12138"></A>The <SPANCLASS="acronym">DNS</SPAN> service is on port 53. You can start a nameserver on another port&nbsp;- for debugging purposes, forexample&nbsp;- and <KBDCLASS="command">nslookup</KBD> can be directed to usethat port.</P></DD><DTCLASS="term"><ICLASS="function">querytype=A</I></DT><DDCLASS="listitem"><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-12147"></A>By default, <KBDCLASS="command">nslookup</KBD> looks up A (address) resourcerecord types. In addition, if you type in an <SPANCLASS="acronym">IP</SPAN>address (and the <KBDCLASS="command">nslookup</KBD> query type is address orpointer), then <KBDCLASS="command">nslookup</KBD> will invert the address,append <ICLASS="systemitem.sitename">in-addr.arpa</I>, and lookup <SPANCLASS="acronym">PTR</SPAN> (pointer) data instead.</P></DD><DTCLASS="term"><ICLASS="function">class=IN</I></DT><DDCLASS="listitem"><PCLASS="para">The only<ACLASS="indexterm"NAME="AUTOID-12160"></A>class that matters is <ICLASS="wordasword">Internet</I>. Well, thereis the <ICLASS="wordasword">Hesiod</I> (<SPANCLASS="acronym">HS</SPAN>) classtoo, if you are an <SPANCLASS="acronym">MIT</SPAN>er or run Ultrix.</P></DD><DTCLASS="term"><ICLASS="function">timeout=5</I></DT><DDCLASS="listitem"><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-12172"></A>If the name server doesn't respond within 5 seconds,<KBDCLASS="command">nslookup</KBD> resends the query and doubles the timeout(to 10, 20, and then 40 seconds).  The <SPANCLASS="acronym">BIND</SPAN>resolver uses the same timeouts when querying a single nameserver.</P></DD><DTCLASS="term"><ICLASS="function">retry=4</I></DT><DDCLASS="listitem"><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-12182"></A>Send the query four times before giving up. After each retry, thetimeout value is doubled. Again, this matches the<SPANCLASS="acronym">BIND</SPAN> resolver behavior.</P></DD><DTCLASS="term"><ICLASS="function">root=a.root-servers.net.</I></DT><DDCLASS="listitem"><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-12190"></A><ACLASS="indexterm"NAME="AUTOID-12192"></A><ACLASS="indexterm"NAME="AUTOID-12195"></A>There is a convenience command called <KBDCLASS="command">root</KBD>, whichswitches your default server to the server named here. Executing the<KBDCLASS="command">root</KBD> command from a modern<KBDCLASS="command">nslookup</KBD>'s prompt is equivalent to executing<KBDCLASS="command">server a.root-servers.net</KBD>. Older versions use<ICLASS="systemitem.sitename">nic.ddn.mil</I> (old) or even<ICLASS="systemitem.sitename">sri-nic.arpa</I> (ancient) as thedefault root name server. You can change the default<SPANCLASS="quote">"root"</SPAN> server with <KBDCLASS="command">setroot=server</KBD>.</P></DD><DTCLASS="term"><ICLASS="function">domain=fx.movie.edu</I></DT><DDCLASS="listitem"><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-12211"></A><ACLASS="indexterm"NAME="AUTOID-12214"></A>This is the default domain appended if the <ICLASS="option">defname</I>option is on.</P></DD><DTCLASS="term"><ICLASS="function">srchlist=fx.movie.edu</I></DT><DDCLASS="listitem"><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-12223"></A>If <ICLASS="option">search</I> is on, these are the domains appended tonames that do not end in a dot. The domains are listed in the orderthat they are tried, separated by a slash. (The 4.8.3 search listdefaulted to <ICLASS="systemitem.sitename">fx.movie.edu</I>/<ICLASS="systemitem.sitename">movie.edu</I>.  At 4.9.3, you have toexplicitly set the search list in<ICLASS="filename">/etc/resolv.conf</I> to get both <ICLASS="systemitem.sitename">fx.movie.edu</I> and <ICLASS="systemitem.sitename">movie.edu</I>.)</P></DD></DL><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="AUTOID-12231">11.3.1 The .nslookuprc File</A></H3><PCLASS="para">You can set up new default <KBDCLASS="command">nslookup</KBD> optionsin an<ACLASS="indexterm"NAME="AUTOID-12235"></A><ICLASS="filename">.nslookuprc</I> file. <KBDCLASS="command">nslookup</KBD>will look for an <ICLASS="filename">.nslookuprc</I> file in your homedirectory when it starts up, in both interactive and noninteractivemodes.  The <ICLASS="filename">.nslookuprc</I> file can contain anylegal <KBDCLASS="command">set</KBD> commands, one per line. This is useful,for example, if your old <KBDCLASS="command">nslookup</KBD> still thinks<ICLASS="systemitem.sitename">sri-nic.arpa</I> is a root nameserver.  You can set the default root name server to a real root witha line like this in your <ICLASS="filename">.nslookuprc</I> file:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">set root=a.root-servers.net.</PRE></BLOCKQUOTE><PCLASS="para">You might also use <ICLASS="filename">.nslookuprc</I> to set yoursearch list to something other than your host's default search list,or to change the timeouts <KBDCLASS="command">nslookup</KBD> uses.</P></DIV><ACLASS="indexterm"NAME="AUTOID-12249"></A></DIV><DIVCLASS="htmlnav"><P></P><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch11_02.htm"TITLE="11.2 Interactive Versus Noninteractive"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 11.2 Interactive Versus Noninteractive"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="book"HREF="index.htm"TITLE="DNS &amp; BIND"><IMGSRC="../gifs/txthome.gif"ALT="DNS &amp; BIND"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch11_04.htm"TITLE="11.4 Avoiding the Search List"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 11.4 Avoiding the Search List"BORDER="0"></A></TD></TR><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172">11.2 Interactive Versus Noninteractive</TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="index"HREF="index/idx_0.htm"TITLE="Book Index"><IMGSRC="../gifs/index.gif"ALT="Book Index"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172">11.4 Avoiding the Search List</TD></TR></TABLE><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><PCLASS="nav"><FONTSIZE="-1">[ <AHREF="../index.htm"TITLE="The Networking CD Bookshelf">Library Home</A> | <AHREF="index.htm"TITLE="DNS &amp; BIND">DNS &amp; BIND</A> | <AHREF="../tcpip/index.htm"TITLE="TCP/IP Network Administration">TCP/IP</A> | <AHREF="../sendmail/index.htm"TITLE="sendmail">sendmail</A> | <AHREF="../smdref/index.htm"TITLE="sendmail Desktop Reference">sendmail Reference</A> | <AHREF="../firewall/index.htm"TITLE="Building Internet Firewalls">Firewalls</A> | <AHREF="../puis/index.htm"TITLE="Practical UNIX &amp; Internet Security">Practical Security</A> ]</FONT></P></DIV></BODY></HTML>