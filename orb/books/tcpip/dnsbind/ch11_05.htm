<HTML><HEAD><TITLE>[Chapter 11] 11.5 Common Tasks</TITLE><METANAME="DC.title"CONTENT="DNS &amp; BIND"><METANAME="DC.creator"CONTENT="Cricket Liu &amp; Paul Albitz"><METANAME="DC.publisher"CONTENT="O'Reilly &amp; Associates, Inc."><METANAME="DC.date"CONTENT="1999-01-06T18:37:31Z"><METANAME="DC.type"CONTENT="Text.Monograph"><METANAME="DC.format"CONTENT="text/html"SCHEME="MIME"><METANAME="DC.source"CONTENT="1-56592-512-2"SCHEME="ISBN"><METANAME="DC.language"CONTENT="en-US"><METANAME="generator"CONTENT="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><LINKREV="made"HREF="mailto:online-books@oreilly.com"TITLE="Online Books Comments"><LINKREL="up"HREF="ch11_01.htm"TITLE="11. nslookup"><LINKREL="prev"HREF="ch11_04.htm"TITLE="11.4 Avoiding the Search List"><LINKREL="next"HREF="ch11_06.htm"TITLE="11.6 Less Common Tasks"></HEAD><BODYBGCOLOR="#FFFFFF"TEXT="#000000"><DIVCLASS="htmlnav"><H1><IMGSRC="gifs/smbanner.gif"ALT="DNS &amp; BIND"USEMAP="#srchmap"BORDER="0"></H1><MAPNAME="srchmap"><AREASHAPE="RECT"COORDS="0,0,466,65"HREF="index.htm"ALT="DNS &amp; BIND"><AREASHAPE="RECT"COORDS="467,0,514,18"HREF="../search/dsrch.htm"ALT="Search this book"></MAP><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch11_04.htm"TITLE="11.4 Avoiding the Search List"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 11.4 Avoiding the Search List"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><B><FONTFACE="ARIEL,HELVETICA,HELV,SANSERIF"SIZE="-1">Chapter 11<BR>nslookup</FONT></B></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch11_06.htm"TITLE="11.6 Less Common Tasks"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 11.6 Less Common Tasks"BORDER="0"></A></TD></TR></TABLE>&nbsp;<HRALIGN="LEFT"WIDTH="515"TITLE="footer"></DIV><DIVCLASS="SECT1"><H2CLASS="sect1"><ACLASS="title"NAME="AUTOID-12260">11.5 Common Tasks</A></H2><PCLASS="para"><ACLASS="indexterm"NAME="CH11.ADMIN1"></A><ACLASS="indexterm"NAME="CH11.ADMIN2"></A>There are little chores you'll come to use<KBDCLASS="command">nslookup</KBD> for almost every day: finding the<SPANCLASS="acronym">IP</SPAN> address or <SPANCLASS="acronym">MX</SPAN> records for agiven domain name, or querying a particular name server for data.We'll cover these first, before moving on to the more occasionalstuff.</P><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="AUTOID-12272">11.5.1 Looking Up Different Data Types</A></H3><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-12275"></A>By default, <KBDCLASS="command">nslookup</KBD> looks up the address fora name, or the name for an address. You can look up any data type bychanging the<ACLASS="indexterm"NAME="AUTOID-12278"></A><ICLASS="option">querytype</I>, as we will show in this example:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">% <CODECLASS="userinput"><B>nslookup</B></CODE>Default Server:  terminator.movie.eduAddress:  0.0.0.0&gt; <CODECLASS="userinput"><B>misery</B></CODE>                 <ICLASS="lineannotation">&nbsp;- Look up address</I>Server:  terminator.movie.eduAddress:  0.0.0.0Name:    misery.movie.eduAddress:  192.253.253.2&gt; <CODECLASS="userinput"><B>192.253.253.2</B></CODE>          <ICLASS="lineannotation">&nbsp;- Look up name</I>Server:  terminator.movie.eduAddress:  0.0.0.0Name:    misery.movie.eduAddress:  192.253.253.2&gt; <CODECLASS="userinput"><B>set q=mx</B></CODE>               <ICLASS="lineannotation">&nbsp;- Look up <SPANCLASS="acronym">MX</SPAN> data</I>&gt; <CODECLASS="userinput"><B>wormhole</B></CODE>Server:  terminator.movie.eduAddress:  0.0.0.0wormhole.movie.edu      preference = 10, mail exchanger = wormhole.movie.eduwormhole.movie.edu      internet address = 192.249.249.1wormhole.movie.edu      internet address = 192.253.253.1&gt; <CODECLASS="userinput"><B>set q=any</B></CODE>              <ICLASS="lineannotation">&nbsp;- Look up data of any type</I>&gt; <CODECLASS="userinput"><B>diehard</B></CODE>Server:  terminator.movie.eduAddress:  0.0.0.0diehard.movie.edu       internet address = 192.249.249.4diehard.movie.edu       preference = 10, mail exchanger = diehard.movie.edudiehard.movie.edu       internet address = 192.249.249.4</PRE></BLOCKQUOTE><PCLASS="para">These are only a few of the valid <SPANCLASS="acronym">DNS</SPAN> datatypes, of course.  For the complete list, see <ACLASS="xref"HREF="appa_01.htm"TITLE="DNS Message Format and Resource Records">Appendix A, <CITECLASS="appendix">DNS Message Format and ResourceRecords</CITE></A>.</P></DIV><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="AUTOID-12297">11.5.2 Authoritative Versus Nonauthoritative Answers</A></H3><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-12300"></A><ACLASS="indexterm"NAME="AUTOID-12303"></A><ACLASS="indexterm"NAME="AUTOID-12305"></A>If you've used <KBDCLASS="command">nslookup</KBD> before, you might havenoticed something peculiar&nbsp;- the first time you look up a remotename, the answer is authoritative, but the second time you look up thesame name it is nonauthoritative. Here's an example:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">% <CODECLASS="userinput"><B>nslookup</B></CODE>Default Server:  relay.hp.comAddress:  15.255.152.2&gt; <CODECLASS="userinput"><B>slate.mines.colorado.edu.</B></CODE>Server:  relay.hp.comAddress:  15.255.152.2Name:     slate.mines.colorado.eduAddress:  138.67.1.3&gt; <CODECLASS="userinput"><B>slate.mines.colorado.edu.</B></CODE>Server:  relay.hp.comAddress:  15.255.152.2Non-authoritative answer:Name:    slate.mines.colorado.eduAddress:  138.67.1.3</PRE></BLOCKQUOTE><PCLASS="para">While this looks odd, it really isn't. What is happening is thatthe first time the local name server looks up <ICLASS="systemitem.sitename">slate</I>, it contacts the name server for<ICLASS="systemitem.sitename">mines.colorado.edu</I>, and the<ICLASS="systemitem.sitename">mines.colorado.edu</I> serverresponds with an authoritative answer. The local name server, ineffect, passes the authoritative response directly back to<KBDCLASS="command">nslookup</KBD>.  It also caches the response. The secondtime you look up <ICLASS="systemitem.sitename">slate</I>, thename server answers out of its cache, which results in the answer<SPANCLASS="quote">"nonauthoritative."</SPAN></P><PCLASS="para">Notice that we ended the domain name with a trailing dot eachtime we looked it up. The response would have been the same had weleft the trailing dot off. There are times when it is critical thatyou use the trailing dot while debugging, and times when it isnot. Rather than stopping to decide if <EMCLASS="emphasis">this</EM> nameneeds a trailing dot, we always add one if we know the name is fullyqualified, except, of course, for the example where we turn off thesearch list.</P></DIV><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="AUTOID-12322">11.5.3 Switching Servers</A></H3><PCLASS="para">Sometimes you want to query another name serverdirectly&nbsp;- you may think it is misbehaving, for example. You canswitch servers with <KBDCLASS="command">nslookup</KBD> by using the<ACLASS="indexterm"NAME="AUTOID-12326"></A><ACLASS="indexterm"NAME="AUTOID-12328"></A><ACLASS="indexterm"NAME="AUTOID-12331"></A><ACLASS="indexterm"NAME="AUTOID-12333"></A><ACLASS="indexterm"NAME="AUTOID-12335"></A><ACLASS="indexterm"NAME="AUTOID-12338"></A><KBDCLASS="command">server</KBD> or <KBDCLASS="command">lserver</KBD> command.  Thedifference between <KBDCLASS="command">server</KBD> and<KBDCLASS="command">lserver</KBD> is that <KBDCLASS="command">lserver</KBD> queriesyour <SPANCLASS="quote">"local"</SPAN> server&nbsp;- the one you started outwith&nbsp;- to get the address of the server you want to switch to;<KBDCLASS="command">server</KBD> uses the default server instead of the localserver. This difference is important to know because the server youjust switched to may not be responding, as we'll show in thisexample:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">% <CODECLASS="userinput"><B>nslookup</B></CODE>Default Server:  relay.hp.comAddress:  15.255.152.2</PRE></BLOCKQUOTE><PCLASS="para">When we start up, our first server, <ICLASS="systemitem.sitename">relay.hp.com</I>, becomes ourlserver. This will matter later on in this session.</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">&gt; <CODECLASS="userinput"><B>server galt.cs.purdue.edu.</B></CODE>Default Server:  galt.cs.purdue.eduAddress:  128.10.2.39&gt; <CODECLASS="userinput"><B>cs.purdue.edu.</B></CODE>Server:  galt.cs.purdue.eduAddress:  128.10.2.39*** galt.cs.purdue.edu can't find cs.purdue.edu.: No response from server</PRE></BLOCKQUOTE><PCLASS="para">At this point we try to switch back to our original nameserver. But there is no name server running on galt to look up relay'saddress.</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">&gt; <CODECLASS="userinput"><B>server relay.hp.com.</B></CODE>*** Can't find address for server relay.hp.com.: No response from server</PRE></BLOCKQUOTE><PCLASS="para"><EMCLASS="emphasis">Instead of being stuck</EM>, though, we use the <KBDCLASS="command">lserver</KBD> command tohave our local server look up <ICLASS="systemitem.sitename">relay</I>'s address:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">&gt; <CODECLASS="userinput"><B>lserver relay.hp.com.</B></CODE>Default Server:  relay.hp.comAddress:  15.255.152.2&gt; <CODECLASS="userinput"><B>^D</B></CODE></PRE></BLOCKQUOTE><PCLASS="para">Since the server on <ICLASS="systemitem.sitename">galt</I> did not respond&nbsp;- it's not evenrunning a name server&nbsp;- it wasn't possible to look up the addressof <ICLASS="systemitem.sitename">relay</I> to switch back tousing <ICLASS="systemitem.sitename">relay</I>'s nameserver. Here's where <KBDCLASS="command">lserver</KBD> comes to the rescue:the local name server, <ICLASS="systemitem.sitename">relay</I>,was still responding, so we used it. Instead of using<KBDCLASS="command">lserver</KBD>, we could have recovered by using<ICLASS="systemitem.sitename">relay</I>'s <SPANCLASS="acronym">IP</SPAN>address directly&nbsp;- <KBDCLASS="command">server 15.255.152.2</KBD>.</P><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-12376"></A>You can even change servers on a per-query basis. To specifythat you'd like <KBDCLASS="command">nslookup</KBD> to query a particularserver for information about a given domain name, you can specify theserver as the second argument on the line, after the domain name tolook up&nbsp;- like so:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">% <CODECLASS="userinput"><B>nslookup</B></CODE>Default Server:  relay.hp.comAddress:  15.255.152.2&gt; <CODECLASS="userinput"><B>saturn.sun.com. ns.sun.com.</B></CODE>Name Server:  ns.sun.comAddress:  192.9.9.3Name:    saturn.sun.comAddresses: 192.9.25.2&gt; <CODECLASS="userinput"><B>^D</B></CODE></PRE></BLOCKQUOTE><PCLASS="para">And, of course, you can change servers from the command line.You can specify the server to query as the argument after the domainname to look up, like this:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">% <CODECLASS="userinput"><B>nslookup -type=mx fisherking.movie.edu. terminator.movie.edu.</B></CODE></PRE></BLOCKQUOTE><PCLASS="para">This instructs <KBDCLASS="command">nslookup</KBD> to query <ICLASS="systemitem.sitename">terminator.movie.edu</I> for<SPANCLASS="acronym">MX</SPAN> records for <ICLASS="systemitem.sitename">fisherking.movie.edu</I>.</P><PCLASS="para">Finally, to specify an alternate default server and enterinteractive mode, you can use a hyphen in place of the domain name tolook up:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">% <CODECLASS="userinput"><B>nslookup - terminator.movie.edu.</B></CODE></PRE></BLOCKQUOTE></DIV><ACLASS="indexterm"NAME="AUTOID-12395"></A><ACLASS="indexterm"NAME="AUTOID-12396"></A></DIV><DIVCLASS="htmlnav"><P></P><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch11_04.htm"TITLE="11.4 Avoiding the Search List"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 11.4 Avoiding the Search List"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="book"HREF="index.htm"TITLE="DNS &amp; BIND"><IMGSRC="../gifs/txthome.gif"ALT="DNS &amp; BIND"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch11_06.htm"TITLE="11.6 Less Common Tasks"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 11.6 Less Common Tasks"BORDER="0"></A></TD></TR><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172">11.4 Avoiding the Search List</TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="index"HREF="index/idx_0.htm"TITLE="Book Index"><IMGSRC="../gifs/index.gif"ALT="Book Index"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172">11.6 Less Common Tasks</TD></TR></TABLE><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><PCLASS="nav"><FONTSIZE="-1">[ <AHREF="../index.htm"TITLE="The Networking CD Bookshelf">Library Home</A> | <AHREF="index.htm"TITLE="DNS &amp; BIND">DNS &amp; BIND</A> | <AHREF="../tcpip/index.htm"TITLE="TCP/IP Network Administration">TCP/IP</A> | <AHREF="../sendmail/index.htm"TITLE="sendmail">sendmail</A> | <AHREF="../smdref/index.htm"TITLE="sendmail Desktop Reference">sendmail Reference</A> | <AHREF="../firewall/index.htm"TITLE="Building Internet Firewalls">Firewalls</A> | <AHREF="../puis/index.htm"TITLE="Practical UNIX &amp; Internet Security">Practical Security</A> ]</FONT></P></DIV></BODY></HTML>