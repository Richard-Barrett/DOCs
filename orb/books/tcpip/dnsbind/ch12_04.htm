<HTML><HEAD><TITLE>[Chapter 12] 12.4 The Resolver Search Algorithm and Negative Caching</TITLE><METANAME="DC.title"CONTENT="DNS &amp; BIND"><METANAME="DC.creator"CONTENT="Cricket Liu &amp; Paul Albitz"><METANAME="DC.publisher"CONTENT="O'Reilly &amp; Associates, Inc."><METANAME="DC.date"CONTENT="1999-01-06T18:38:37Z"><METANAME="DC.type"CONTENT="Text.Monograph"><METANAME="DC.format"CONTENT="text/html"SCHEME="MIME"><METANAME="DC.source"CONTENT="1-56592-512-2"SCHEME="ISBN"><METANAME="DC.language"CONTENT="en-US"><METANAME="generator"CONTENT="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><LINKREV="made"HREF="mailto:online-books@oreilly.com"TITLE="Online Books Comments"><LINKREL="up"HREF="ch12_01.htm"TITLE="12. Reading BIND Debugging Output"><LINKREL="prev"HREF="ch12_03.htm"TITLE="12.3 Reading Debugging Output"><LINKREL="next"HREF="ch12_05.htm"TITLE="12.5 Tools"></HEAD><BODYBGCOLOR="#FFFFFF"TEXT="#000000"><DIVCLASS="htmlnav"><H1><IMGSRC="gifs/smbanner.gif"ALT="DNS &amp; BIND"USEMAP="#srchmap"BORDER="0"></H1><MAPNAME="srchmap"><AREASHAPE="RECT"COORDS="0,0,466,65"HREF="index.htm"ALT="DNS &amp; BIND"><AREASHAPE="RECT"COORDS="467,0,514,18"HREF="../search/dsrch.htm"ALT="Search this book"></MAP><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch12_03.htm"TITLE="12.3 Reading Debugging Output"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 12.3 Reading Debugging Output"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><B><FONTFACE="ARIEL,HELVETICA,HELV,SANSERIF"SIZE="-1">Chapter 12<BR>Reading <SPANCLASS="acronym">BIND</SPAN> Debugging Output</FONT></B></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch12_05.htm"TITLE="12.5 Tools"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 12.5 Tools"BORDER="0"></A></TD></TR></TABLE>&nbsp;<HRALIGN="LEFT"WIDTH="515"TITLE="footer"></DIV><DIVCLASS="SECT1"><H2CLASS="sect1"><ACLASS="title"NAME="AUTOID-13256">12.4 The Resolver Search Algorithm and Negative Caching</A></H2><PCLASS="para"><ACLASS="indexterm"NAME="DNS3-IDX-12-CACHING-NEGATIVE"></A><ACLASS="indexterm"NAME="DNS3-IDX-12-NEGATIVE-CACHING"></A><ACLASS="indexterm"NAME="DNS3-IDX-12-RESOLVERS-SEARCH-ALGORITHM"></A><ACLASS="indexterm"NAME="DNS3-IDX-12-SEARCH-ALGORITHM-RESOLVER"></A>In this trace, we'll show you the <SPANCLASS="acronym">BIND</SPAN> 4.9 and<SPANCLASS="acronym">BIND</SPAN> 8 search algorithm and the impact of negativecaching. We could look up <ICLASS="systemitem.sitename">galt.cs.purdue.edu</I> like the last trace,but it wouldn't show you the search algorithm. Instead, we will lookup <ICLASS="systemitem.sitename">foo.bar</I>, a name thatdoesn't exist. In fact, we will look it up twice:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">1)  datagram from cujo.horror.movie.edu 1109, fd 6, len 252)  req: nlookup(foo.bar) id 19220 type=1 class=13)  req: found 'foo.bar' as '' (cname=0)4)  forw: forw -&gt; D.ROOT-SERVERS.NET 53 ds=7 nsid=2532 id=19220                                             0ms retry 4sec5)6)  datagram from D.ROOT-SERVERS.NET 53, fd 5, len 257)  ncache: dname foo.bar, type 1, class 18)  send_msg -&gt; cujo.horror.movie.edu 1109 (UDP 6) id=192209)10) datagram from cujo.horror.movie.edu 1110, fd 6, len 4211) req: nlookup(foo.bar.horror.movie.edu) id 19221 type=1 class=112) req: found 'foo.bar.horror.movie.edu' as 'horror.movie.edu'                                             (cname=0)13) forw: forw -&gt; carrie.horror.movie.edu 53 ds=7 nsid=2533                                      id=19221 0ms retry 4sec14) datagram from carrie.horror.movie.edu 53, fd 5, len 4215) ncache: dname foo.bar.horror.movie.edu, type 1, class 116) send_msg -&gt; cujo.horror.movie.edu 1110 (UDP 6) id=19221</PRE></BLOCKQUOTE><PCLASS="para">Look up <ICLASS="systemitem.sitename">foo.bar</I>again:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">17) datagram from cujo.horror.movie.edu 1111, fd 6, len 2518) req: nlookup(foo.bar) id 15541 type=1 class=119) req: found 'foo.bar' as 'foo.bar' (cname=0)20) ns_req: answer -&gt; cujo.horror.movie.edu 1111 fd=6 id=15541                                                size=25 Local21)22) datagram from cujo.horror.movie.edu 1112, fd 6, len 4223) req: nlookup(foo.bar.horror.movie.edu) id 15542 type=1 class=124) req: found 'foo.bar.horror.movie.edu' as                           'foo.bar.horror.movie.edu' (cname=0)25) ns_req: answer -&gt; cujo.horror.movie.edu 1112 fd=6 id=15542                                                  size=42 Local</PRE></BLOCKQUOTE><PCLASS="para">Let's look at the resolver search algorithm.  The first namelooked up (line 2) is exactly the name we typed in. Since the name hadat least one dot, it is looked up without modification.  When thatname lookup failed, <ICLASS="systemitem.sitename">horror.movie.edu</I> was appended to the nameand looked up.  (Resolvers before <SPANCLASS="acronym">BIND</SPAN> 4.9 wouldtry appending both <ICLASS="systemitem.sitename">horror.movie.edu</I> and <ICLASS="systemitem.sitename">movie.edu</I>.)</P><PCLASS="para">Line 7 shows caching the <EMCLASS="emphasis">negative</EM> answer(<CODECLASS="literal">ncache</CODE>). If the same name is looked up again inthe next few minutes (line 19), the name server still has the negativeresponse in its cache, so the server can answer immediately that thename doesn't exist. (If you don't believe this hand waving, comparelines 3 and 19. On line 3, nothing was found for <ICLASS="systemitem.sitename">foo.bar</I>, but line 19 shows the whole namebeing found.)<ACLASS="indexterm"NAME="AUTOID-13286"></A><ACLASS="indexterm"NAME="AUTOID-13287"></A><ACLASS="indexterm"NAME="AUTOID-13288"></A><ACLASS="indexterm"NAME="AUTOID-13289"></A></P></DIV><DIVCLASS="htmlnav"><P></P><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch12_03.htm"TITLE="12.3 Reading Debugging Output"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 12.3 Reading Debugging Output"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="book"HREF="index.htm"TITLE="DNS &amp; BIND"><IMGSRC="../gifs/txthome.gif"ALT="DNS &amp; BIND"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch12_05.htm"TITLE="12.5 Tools"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 12.5 Tools"BORDER="0"></A></TD></TR><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172">12.3 Reading Debugging Output</TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="index"HREF="index/idx_0.htm"TITLE="Book Index"><IMGSRC="../gifs/index.gif"ALT="Book Index"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172">12.5 Tools</TD></TR></TABLE><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><PCLASS="nav"><FONTSIZE="-1">[ <AHREF="../index.htm"TITLE="The Networking CD Bookshelf">Library Home</A> | <AHREF="index.htm"TITLE="DNS &amp; BIND">DNS &amp; BIND</A> | <AHREF="../tcpip/index.htm"TITLE="TCP/IP Network Administration">TCP/IP</A> | <AHREF="../sendmail/index.htm"TITLE="sendmail">sendmail</A> | <AHREF="../smdref/index.htm"TITLE="sendmail Desktop Reference">sendmail Reference</A> | <AHREF="../firewall/index.htm"TITLE="Building Internet Firewalls">Firewalls</A> | <AHREF="../puis/index.htm"TITLE="Practical UNIX &amp; Internet Security">Practical Security</A> ]</FONT></P></DIV></BODY></HTML>