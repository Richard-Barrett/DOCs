<HTML><HEAD><TITLE>[Chapter 13] Troubleshooting DNS and BIND</TITLE><METANAME="DC.title"CONTENT="DNS &amp; BIND"><METANAME="DC.creator"CONTENT="Cricket Liu &amp; Paul Albitz"><METANAME="DC.publisher"CONTENT="O'Reilly &amp; Associates, Inc."><METANAME="DC.date"CONTENT="1999-01-06T18:38:41Z"><METANAME="DC.type"CONTENT="Text.Monograph"><METANAME="DC.format"CONTENT="text/html"SCHEME="MIME"><METANAME="DC.source"CONTENT="1-56592-512-2"SCHEME="ISBN"><METANAME="DC.language"CONTENT="en-US"><METANAME="generator"CONTENT="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><LINKREV="made"HREF="mailto:online-books@oreilly.com"TITLE="Online Books Comments"><LINKREL="up"HREF="index.htm"TITLE="DNS &amp; BIND"><LINKREL="prev"HREF="ch12_05.htm"TITLE="12.5 Tools"><LINKREL="next"HREF="ch13_02.htm"TITLE="13.2 Troubleshooting Tools and Techniques"></HEAD><BODYBGCOLOR="#FFFFFF"TEXT="#000000"><DIVCLASS="htmlnav"><H1><IMGSRC="gifs/smbanner.gif"ALT="DNS &amp; BIND"USEMAP="#srchmap"BORDER="0"></H1><MAPNAME="srchmap"><AREASHAPE="RECT"COORDS="0,0,466,65"HREF="index.htm"ALT="DNS &amp; BIND"><AREASHAPE="RECT"COORDS="467,0,514,18"HREF="../search/dsrch.htm"ALT="Search this book"></MAP><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch12_05.htm"TITLE="12.5 Tools"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 12.5 Tools"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><B><FONTFACE="ARIEL,HELVETICA,HELV,SANSERIF"SIZE="-1">Chapter 13</FONT></B></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch13_02.htm"TITLE="13.2 Troubleshooting Tools and Techniques"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 13.2 Troubleshooting Tools and Techniques"BORDER="0"></A></TD></TR></TABLE>&nbsp;<HRALIGN="LEFT"WIDTH="515"TITLE="footer"></DIV><DIVCLASS="CHAPTER"><H1CLASS="chapter"><ACLASS="title"NAME="DNS3-CHP-13">13. Troubleshooting <SPANCLASS="acronym">DNS</SPAN> and<SPANCLASS="acronym">BIND</SPAN></A></H1><DIVCLASS="htmltoc"><P><B>Contents:</B><BR><ACLASS="sect1"HREF="#AUTOID-13331"TITLE="13.1 Is NIS Really Your Problem?">Is <SPANCLASS="acronym">NIS</SPAN> Really Your Problem?</A><BR><ACLASS="sect1"HREF="ch13_02.htm"TITLE="13.2 Troubleshooting Tools and Techniques">Troubleshooting Tools and Techniques</A><BR><ACLASS="sect1"HREF="ch13_03.htm"TITLE="13.3 Potential Problem List">Potential Problem List</A><BR><ACLASS="sect1"HREF="ch13_04.htm"TITLE="13.4 Transition Problems">Transition Problems</A><BR><ACLASS="sect1"HREF="ch13_05.htm"TITLE="13.5 Interoperability and Version Problems">Interoperability and Version Problems</A><BR><ACLASS="sect1"HREF="ch13_06.htm"TITLE="13.6 Problem Symptoms">Problem Symptoms</A></P><P></P></DIV><DIVCLASS="epigraph"><PCLASS="para"ALIGN="right"><I><SPANCLASS="quote">"Of course not,"</SPAN> said the Mock Turtle. <SPANCLASS="quote">"Why,if a fish came to me, and told me he was going on a journey, I shouldsay, <SPANCLASS="quote">'With what porpoise?'</SPAN>"</SPAN></I></P><PCLASS="para"ALIGN="right"><I><SPANCLASS="quote">"Don't you mean <SPANCLASS="quote">'purpose'</SPAN>?"</SPAN> saidAlice.</I></P><PCLASS="para"ALIGN="right"><I><SPANCLASS="quote">"I mean what I say,"</SPAN> the Mock Turtle replied, in anoffended tone. And the Gryphon added, <SPANCLASS="quote">"Come, let's hear some ofyour adventures."</SPAN></I></P></DIV><PCLASS="para">In the last two chapters,we've demonstrated how to use <KBDCLASS="command">nslookup</KBD> and how to read the nameserver's debugging information. In this chapter, we'll show youhow to use these tools&nbsp;- plus traditional <SPANCLASS="acronym">UNIX</SPAN> networking tools liketrusty ol' <KBDCLASS="command">ping</KBD>&nbsp;- to troubleshoot real-life problems with <SPANCLASS="acronym">DNS</SPAN> and <SPANCLASS="acronym">BIND</SPAN>.<ACLASS="indexterm"NAME="CH13.TROUBLE"></A></P><PCLASS="para">Troubleshooting, by its nature, is a tough subject to teach.You start with any of a world of symptoms and try to work your wayback to the cause. We can't cover the whole gamut of problems youmay encounter on the Internet, but we will certainly do our bestto show you how to diagnose the most common of them. And along theway, we hope to teach you troubleshooting techniques that will bevaluable in tracking down more obscure problems that we don't document.</P><DIVCLASS="sect1"><H2CLASS="sect1"><ACLASS="title"NAME="AUTOID-13331">13.1 Is <SPANCLASS="acronym">NIS</SPAN> Really Your Problem?</A></H2><PCLASS="para"><ACLASS="indexterm"NAME="CH13.NIS1"></A><ACLASS="indexterm"NAME="CH13.NIS2"></A>Before we launchinto a discussion of how to troubleshoot a <SPANCLASS="acronym">DNS</SPAN> or <SPANCLASS="acronym">BIND</SPAN> problem,we should make sure you know how to tell whether a problem is causedby <SPANCLASS="acronym">DNS</SPAN>, not by <SPANCLASS="acronym">NIS</SPAN>. On hosts running <SPANCLASS="acronym">NIS</SPAN>, figuring out whether theculprit is <SPANCLASS="acronym">DNS</SPAN> or <SPANCLASS="acronym">NIS</SPAN> can be difficult. The stock <SPANCLASS="acronym">BSD</SPAN> <KBDCLASS="command">nslookup</KBD>,for example, doesn't pay any attention to <SPANCLASS="acronym">NIS</SPAN>. You can run <KBDCLASS="command">nslookup</KBD> ona Sun and query the name server 'til the cows come home, while allthe other services are using <SPANCLASS="acronym">NIS</SPAN>.</P><PCLASS="para">How do you know whereto put the blame? Some vendors have modified <KBDCLASS="command">nslookup</KBD> touse <SPANCLASS="acronym">NIS</SPAN> for name service if <SPANCLASS="acronym">NIS</SPAN> is configured. The <SPANCLASS="acronym">HP-UX</SPAN> <KBDCLASS="command">nslookup</KBD>,for example, will report that it's querying an <SPANCLASS="acronym">NIS</SPAN> server when itstarts up:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">% <CODECLASS="userinput"><B>nslookup</B></CODE>Default <SPANCLASS="acronym">NIS</SPAN> Server:  terminator.movie.eduAddress:  192.249.249.3&gt;</PRE></BLOCKQUOTE><PCLASS="para">On hosts with vanilla versions of <KBDCLASS="command">nslookup</KBD>,you can often use<ACLASS="indexterm"NAME="AUTOID-13365"></A><KBDCLASS="command">ypmatch</KBD> to determine whether you're using <SPANCLASS="acronym">DNS</SPAN>or <SPANCLASS="acronym">NIS</SPAN>. <KBDCLASS="command">ypmatch</KBD> will print a blank line afterthe host information if it received the data from a name server.So in this example, the answer came from <SPANCLASS="acronym">NIS</SPAN>:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">% <CODECLASS="userinput"><B>ypmatch ruby hosts</B></CODE>140.186.65.25   ruby ruby.ora.com%</PRE></BLOCKQUOTE><PCLASS="para">Whereas in this example the answer came from a nameserver:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">% <CODECLASS="userinput"><B>ypmatch harvard.harvard.edu hosts</B></CODE>128.103.1.1     harvard.harvard.edu%</PRE></BLOCKQUOTE><PCLASS="para">Note that this works now (with Sun<SPANCLASS="acronym">OS</SPAN> 4.1.1), butis not guaranteed to work on every future version of Sun<SPANCLASS="acronym">OS</SPAN>. Forall we know, this is a bug-<ICLASS="foreignphrase">cum</I>-feature thatmay disappear in the next release.</P><PCLASS="para">A more surefireway to decide whether an answer came from <SPANCLASS="acronym">NIS</SPAN> is to use<ACLASS="indexterm"NAME="AUTOID-13383"></A><KBDCLASS="command">ypcat</KBD> to listthe hosts database. For example, to find out whether <ICLASS="systemitem.sitename">andrew.cmu.edu</I> isin your <SPANCLASS="acronym">NIS</SPAN> hosts map, you could execute:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">% <CODECLASS="userinput"><B>ypcat hosts | grep andrew.cmu.edu</B></CODE></PRE></BLOCKQUOTE><PCLASS="para">If you find the answer in <SPANCLASS="acronym">NIS</SPAN> (and you know <SPANCLASS="acronym">NIS</SPAN> isbeing consulted first), you've found the cause of the problem.</P><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-13394"></A>Finally, in the versions of <SPANCLASS="acronym">UNIX</SPAN> that use the <ICLASS="filename">nsswitch.conf</I> file,you can determine the order in which the different name servicesare used by referring to the entry for the <ICLASS="structfield">hosts</I> sourcein the file. An entry like this, for example, indicates that <SPANCLASS="acronym">NIS</SPAN>is being checked first:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">hosts:    nis dns files</PRE></BLOCKQUOTE><PCLASS="para">while this entry has the name resolver querying <SPANCLASS="acronym">DNS</SPAN>first:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">hosts:    dns nis files</PRE></BLOCKQUOTE><PCLASS="para">For more detailed information on the syntax and semanticsof the <ICLASS="filename">nsswitch.conf</I> file, see <ACLASS="xref"HREF="ch06_01.htm"TITLE="Configuring Hosts">Chapter 6, <CITECLASS="chapter">Configuring Hosts</CITE></A>.</P><PCLASS="para">These hints should help you identify the guilty party, orat least exonerate one suspect. If you narrow down the suspects,and <SPANCLASS="acronym">DNS</SPAN> is still implicated, you'll just have to read this chapter.</P><ACLASS="indexterm"NAME="AUTOID-13409"></A><ACLASS="indexterm"NAME="AUTOID-13410"></A></DIV></DIV><DIVCLASS="htmlnav"><P></P><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch12_05.htm"TITLE="12.5 Tools"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 12.5 Tools"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="book"HREF="index.htm"TITLE="DNS &amp; BIND"><IMGSRC="../gifs/txthome.gif"ALT="DNS &amp; BIND"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch13_02.htm"TITLE="13.2 Troubleshooting Tools and Techniques"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 13.2 Troubleshooting Tools and Techniques"BORDER="0"></A></TD></TR><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172">12.5 Tools</TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="index"HREF="index/idx_0.htm"TITLE="Book Index"><IMGSRC="../gifs/index.gif"ALT="Book Index"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172">13.2 Troubleshooting Tools and Techniques</TD></TR></TABLE><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><PCLASS="nav"><FONTSIZE="-1">[ <AHREF="../index.htm"TITLE="The Networking CD Bookshelf">Library Home</A> | <AHREF="index.htm"TITLE="DNS &amp; BIND">DNS &amp; BIND</A> | <AHREF="../tcpip/index.htm"TITLE="TCP/IP Network Administration">TCP/IP</A> | <AHREF="../sendmail/index.htm"TITLE="sendmail">sendmail</A> | <AHREF="../smdref/index.htm"TITLE="sendmail Desktop Reference">sendmail Reference</A> | <AHREF="../firewall/index.htm"TITLE="Building Internet Firewalls">Firewalls</A> | <AHREF="../puis/index.htm"TITLE="Practical UNIX &amp; Internet Security">Practical Security</A> ]</FONT></P></DIV></BODY></HTML>