<HTML><HEAD><TITLE>[Chapter 3] Security Strategies</TITLE><METANAME="DC.title"CONTENT="Building Internet Firewalls"><METANAME="DC.creator"CONTENT="D. Brent Chapman &amp; Elizabeth D. Zwicky"><METANAME="DC.publisher"CONTENT="O'Reilly &amp; Associates, Inc."><METANAME="DC.date"CONTENT="1999-02-04T00:09:37Z"><METANAME="DC.type"CONTENT="Text.Monograph"><METANAME="DC.format"CONTENT="text/html"SCHEME="MIME"><METANAME="DC.source"CONTENT="1-56592-124-0"SCHEME="ISBN"><METANAME="DC.language"CONTENT="en-US"><METANAME="generator"CONTENT="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><LINKREV="made"HREF="mailto:online-books@oreilly.com"TITLE="Online Books Comments"><LINKREL="up"HREF="part01.htm"TITLE="I. Network Security"><LINKREL="prev"HREF="ch02_14.htm"TITLE="2.14 Printing Systems"><LINKREL="next"HREF="ch03_02.htm"TITLE="3.2 Defense in Depth"></HEAD><BODYBGCOLOR="#FFFFFF"TEXT="#000000"><DIVCLASS="htmlnav"><H1><IMGSRC="gifs/smbanner.gif"ALT="Building Internet Firewalls"USEMAP="#srchmap"BORDER="0"></H1><MAPNAME="srchmap"><AREASHAPE="RECT"COORDS="0,0,466,65"HREF="index.htm"ALT="Building Internet Firewalls"><AREASHAPE="RECT"COORDS="467,0,514,18"HREF="../search/fsrch.htm"ALT="Search this book"></MAP><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch02_14.htm"TITLE="2.14 Printing Systems"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 2.14 Printing Systems"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><B><FONTFACE="ARIEL,HELVETICA,HELV,SANSERIF"SIZE="-1">Chapter 3</FONT></B></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch03_02.htm"TITLE="3.2 Defense in Depth"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 3.2 Defense in Depth"BORDER="0"></A></TD></TR></TABLE>&nbsp;<HRALIGN="LEFT"WIDTH="515"TITLE="footer"></DIV><DIVCLASS="CHAPTER"><H1CLASS="chapter"><ACLASS="title"NAME="FIRE-03-CHP">3. Security Strategies</A></H1><DIVCLASS="htmltoc"><P><B>Contents:</B><BR><ACLASS="SECT1"HREF="#FIRE-03-S1-1"TITLE="3.1 Least Privilege">Least Privilege</A><BR><ACLASS="SECT1"HREF="ch03_02.htm"TITLE="3.2 Defense in Depth">Defense in Depth</A><BR><ACLASS="SECT1"HREF="ch03_03.htm"TITLE="3.3 Choke Point">Choke Point</A><BR><ACLASS="SECT1"HREF="ch03_04.htm"TITLE="3.4 Weakest Link">Weakest Link</A><BR><ACLASS="SECT1"HREF="ch03_05.htm"TITLE="3.5 Fail-Safe Stance">Fail-Safe Stance</A><BR><ACLASS="SECT1"HREF="ch03_06.htm"TITLE="3.6 Universal Participation">Universal Participation</A><BR><ACLASS="SECT1"HREF="ch03_07.htm"TITLE="3.7 Diversity of Defense">Diversity of Defense</A><BR><ACLASS="SECT1"HREF="ch03_08.htm"TITLE="3.8 Simplicity">Simplicity</A></P><P></P></DIV><PCLASS="para"><ACLASS="indexterm"NAME="CH03SECSTRAT"></A><ACLASS="indexterm"NAME="AUTOID-1378"></A>Before we discuss the details of firewalls, it's important tounderstand some of the basic strategies employed in building firewallsand in enforcing security at your site. These are not staggeringrevelations; they are straightforward approaches. They're presentedhere so that you can keep them in mind as you put together a firewallsolution for your site.</P><DIVCLASS="sect1"><H2CLASS="sect1"><ACLASS="title"NAME="FIRE-03-S1-1">3.1 Least Privilege</A></H2><PCLASS="para"><ACLASS="indexterm"NAME="CH03LEAST"></A><ACLASS="indexterm"NAME="CH03ACCESSLEAST"></A>Perhaps the most fundamental principle of security(any kind of security, not just computer andnetwork security) is that of <EMCLASS="emphasis">least privilege</EM>. Basically, the principle of least privilege means that any object (user,administrator, program, system, whatever) should have only theprivileges the object needs to perform its assigned tasks&nbsp;- and nomore. Least privilege is an important principle for limiting yourexposure to attacks and for limiting the damage caused by particularattacks. </P><PCLASS="para">Some car manufacturers set up their locks so that one key works thedoors and the ignition, and a different key works the glove compartmentand the trunk; that way, you can enforce least privilege by giving aparking lot attendant the ability to park the car without the ability toget at things stored in the trunk. Many people use splittable keychains, for the same reason. You can enforce least privilege by givingsomeone the key to your car, but not the key to your house as well.</P><PCLASS="para">In the Internet context, the examples are endless. Every user probablydoesn't need to access every Internet service. Every userprobably doesn't need to modify (or even read) every file onyour system. Every user probably doesn't need to know the machine'sroot password. Every system administrator probably doesn't need to knowthe root passwords for all systems. Every system probably doesn't needto access every other system's files.</P><PCLASS="para">Applying the principle of least privilege suggests that you shouldexplore ways to reduce the privileges required for various operations. For example:<ULCLASS="itemizedlist"><LICLASS="listitem"><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-1397"></A>Don't give a user the root password for a system if all she needs todo is reset the print system. Instead, write a privileged program theuser can run that resets the print system.</P></LI><LICLASS="listitem"><PCLASS="para">Don't make a program run <EMCLASS="emphasis">setuid</EM>to root if all it needs to do is write to one protected file. Instead,make the file group-writable to some group and make the program run<EMCLASS="emphasis">setgid</EM> to that group rather than<EMCLASS="emphasis">setuid</EM> to root.</P></LI><LICLASS="listitem"><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-1406"></A>Don't have your internal systems trust one of your firewallmachines just so it can do backups. Instead, make the firewall machinetrust the internal system, or, better yet, put a local tape drive on thefirewall machine so that it can do its own backups.</P></LI></UL></P><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-1409"></A> Many of the commonsecurity problems on the Internet can be viewed as failures to followthe principle of least privilege. For example, there have been andcontinue to be any number of security problems discovered in Sendmail,which is a big, complex program; any such program is going to havebugs in it. The problem is that Sendmail runs (at least some of thetime) <EMCLASS="emphasis">setuid</EM> to root; many of the attacks againstSendmail take advantage of this. Because it runs as root, Sendmail isa high-value target that gets a lot of attention from attackers; thefact that it's a complex program just makes their jobs easier. Thisimplies both that privileged programs should be as simple as possibleand that, if a complex program requires privileges, you should lookfor ways to separate and isolate the pieces that need privileges fromthe complex parts.[1]</P><BLOCKQUOTECLASS="footnote"><PCLASS="para">[1] It's important to realize that Sendmail is farfrom the only example we could cite; you can find similar problems inalmost any large, complex, privileged piece of software.</P></BLOCKQUOTE><PCLASS="para">Many of the solutions you'll employ in protecting your site aretactics for enforcing the strategy of least privilege. For example, apacket filtering system is designed to allow in packets for theservices you want. Running insecure programs in an environment whereonly the privileges the programs absolutely need are available to them(e.g., a machine that's been stripped down in one way or another) isanother example; this is the essence of a bastion host.</P><PCLASS="para">There are two problems with trying to enforce least privilege. First,it can be complex to implement when it isn't already a design feature ofthe programs and protocols you're using. Trying to add it on may be verydifficult to get right. Some of the cars that try to implement leastprivilege with separate keys for the trunk and the ignition have remotetrunk release buttons that are accessible without the keys, or fold-downrear seats that allow you to access the trunk without opening it thetraditional way at all. You need to be very careful to be sure thatyou've actually succeeded in implementing least privilege.</P><PCLASS="para">Second, you may end up implementing something less than least privilege.Some cars have the gas cap release in the glove compartment. That'sintended to keep parking lot attendants from siphoning off your gas, butif you lend a friend your car, you probably want them to be able to fillit up with gas. If you give your friend only the ignition key, you'regiving them less than the minimum privilege you want them to have(because they won't be able to fill up the gas tank), but adding the keyto the trunk and the glove compartment may give them more privilege thanyou want them to have.</P><PCLASS="para">You may find similar effects with computer implementations of leastprivilege. Trying to enforce least privilege on people, rather thanprograms, can be particularly dangerous. You can predict fairly wellwhat permissions Sendmail is going to need to do its job; human beingsare less predictable, and more likely to become annoyed and dangerous ifthey can't do what they want to. Be very careful to avoid turning yourusers into your enemies.<ACLASS="indexterm"NAME="AUTOID-1418"></A><ACLASS="indexterm"NAME="AUTOID-1419"></A></P></DIV></DIV><DIVCLASS="htmlnav"><P></P><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch02_14.htm"TITLE="2.14 Printing Systems"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 2.14 Printing Systems"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="book"HREF="index.htm"TITLE="Building Internet Firewalls"><IMGSRC="../gifs/txthome.gif"ALT="Building Internet Firewalls"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch03_02.htm"TITLE="3.2 Defense in Depth"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 3.2 Defense in Depth"BORDER="0"></A></TD></TR><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172">2.14 Printing Systems</TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="index"HREF="index/idx_a.htm"TITLE="Book Index"><IMGSRC="../gifs/index.gif"ALT="Book Index"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172">3.2 Defense in Depth</TD></TR></TABLE><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><PCLASS="nav"><FONTSIZE="-1">[ <AHREF="../index.htm"TITLE="The Networking CD Bookshelf">Library Home</A> | <AHREF="../dnsbind/index.htm"TITLE="DNS &amp; BIND">DNS &amp; BIND</A> | <AHREF="../tcpip/index.htm"TITLE="TCP/IP Network Administration">TCP/IP</A> | <AHREF="../sendmail/index.htm"TITLE="sendmail">sendmail</A> | <AHREF="../smdref/index.htm"TITLE="sendmail Desktop Reference">sendmail Reference</A> | <AHREF="index.htm"TITLE="Building Internet Firewalls">Firewalls</A> | <AHREF="../puis/index.htm"TITLE="Practical UNIX &amp; Internet Security">Practical Security</A> ]</FONT></P></DIV></BODY></HTML>