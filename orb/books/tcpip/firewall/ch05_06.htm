<HTML><HEAD><TITLE>[Chapter 5] 5.6 Selecting Services Provided by the Bastion Host</TITLE><METANAME="DC.title"CONTENT="Building Internet Firewalls"><METANAME="DC.creator"CONTENT="D. Brent Chapman &amp; Elizabeth D. Zwicky"><METANAME="DC.publisher"CONTENT="O'Reilly &amp; Associates, Inc."><METANAME="DC.date"CONTENT="1999-02-04T00:14:20Z"><METANAME="DC.type"CONTENT="Text.Monograph"><METANAME="DC.format"CONTENT="text/html"SCHEME="MIME"><METANAME="DC.source"CONTENT="1-56592-124-0"SCHEME="ISBN"><METANAME="DC.language"CONTENT="en-US"><METANAME="generator"CONTENT="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><LINKREV="made"HREF="mailto:online-books@oreilly.com"TITLE="Online Books Comments"><LINKREL="up"HREF="ch05_01.htm"TITLE="5. Bastion Hosts"><LINKREL="prev"HREF="ch05_05.htm"TITLE="5.5 Locating the Bastion Host on the Network"><LINKREL="next"HREF="ch05_07.htm"TITLE="5.7 Don't Allow User Accounts on the Bastion Host"></HEAD><BODYBGCOLOR="#FFFFFF"TEXT="#000000"><DIVCLASS="htmlnav"><H1><IMGSRC="gifs/smbanner.gif"ALT="Building Internet Firewalls"USEMAP="#srchmap"BORDER="0"></H1><MAPNAME="srchmap"><AREASHAPE="RECT"COORDS="0,0,466,65"HREF="index.htm"ALT="Building Internet Firewalls"><AREASHAPE="RECT"COORDS="467,0,514,18"HREF="../search/fsrch.htm"ALT="Search this book"></MAP><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch05_05.htm"TITLE="5.5 Locating the Bastion Host on the Network"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 5.5 Locating the Bastion Host on the Network"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><B><FONTFACE="ARIEL,HELVETICA,HELV,SANSERIF"SIZE="-1">Chapter 5<BR>Bastion Hosts</FONT></B></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch05_07.htm"TITLE="5.7 Don't Allow User Accounts on the Bastion Host"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 5.7 Don't Allow User Accounts on the Bastion Host"BORDER="0"></A></TD></TR></TABLE>&nbsp;<HRALIGN="LEFT"WIDTH="515"TITLE="footer"></DIV><DIVCLASS="SECT1"><H2CLASS="sect1"><ACLASS="title"NAME="FIRE-05-S1-6">5.6 Selecting Services Provided by theBastion Host</A></H2><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-2743"></A><ACLASS="indexterm"NAME="AUTOID-2746"></A>The bastion host provides any services your site needs to access theInternet, or wants to offer to the Internet&nbsp;- services you don'tfeel secure providing directly via packet filtering. (<ACLASS="xref"HREF="ch05_06.htm#FIRE-05-FIG-1"TITLE="The bastion host may run a variety of Internet services">Figure 5.1</A> shows a typical set.) You should not put anyservices on the bastion host not intended to be used to or from theInternet. For example, it shouldn't provide booting services forinternal hosts (unless, for some reason, you intend to provide bootingservices for hosts on the Internet). You have to assume that thebastion host will be compromised, and that all services on it will beavailable to the Internet.</P><H4CLASS="figure"><ACLASS="title"NAME="FIRE-05-FIG-1">Figure 5.1: The bastion host may run a variety of Internet services</A></H4><IMGCLASS="graphic"SRC="figs/fire0501.gif"ALT="Figure 5.1"><PCLASS="para">You can divide services into four classes:</P><DLCLASS="variablelist"><DTCLASS="term"><EMCLASS="emphasis">Services that are secure</EM></DT><DDCLASS="listitem"><PCLASS="para">Services in this category can be provided via packetfiltering, if you're using this approach. (In a pure-proxy firewall,<EMCLASS="emphasis">everything</EM> must be provided on the bastion hostor not provided at all.)</P></DD><DTCLASS="term"><EMCLASS="emphasis">Services that are insecure as normally provided but can besecured</EM></DT><DDCLASS="listitem"><PCLASS="para">Services in this category can be provided on thebastion host.</P></DD><DTCLASS="term"><EMCLASS="emphasis">Services that are insecure as normally provided and can't besecured</EM></DT><DDCLASS="listitem"><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-2771"></A><ACLASS="indexterm"NAME="AUTOID-2773"></A>These will have to be disabled and provided on avictim host (discussed above) if you absolutely need them.</P></DD><DTCLASS="term"><EMCLASS="emphasis">Services that you don't use, or that you don't use inconjunction with the Internet</EM></DT><DDCLASS="listitem"><PCLASS="para">You must disable services inthis category.</P></DD></DL><PCLASS="para">We'll discuss individual services in detail in <ACLASS="xref"HREF="ch08_01.htm"TITLE="Configuring Internet Services">Chapter 8, <CITECLASS="chapter">Configuring Internet Services</CITE></A>, but here we cover the most commonly providedand denied services for bastion hosts.</P><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-2785"></A><ACLASS="indexterm"NAME="AUTOID-2787"></A>Electronic mail (<SPANCLASS="acronym">SMTP</SPAN>) is the most basic of theservices bastion hosts normally provide. You may also want to accessor provide information services such as:</P><ULCLASS="itemizedlist"><LICLASS="listitem"><PCLASS="para"><SPANCLASS="acronym">FTP</SPAN>&nbsp;- file transfer</P></LI><LICLASS="listitem"><PCLASS="para">Gopher&nbsp;- menu-based information retrieval</P></LI><LICLASS="listitem"><PCLASS="para"><SPANCLASS="acronym">WAIS</SPAN>&nbsp;- keyword-search information retrieval</P></LI><LICLASS="listitem"><PCLASS="para"><SPANCLASS="acronym">HTTP</SPAN>&nbsp;- hypertext-driven information retrieval (the World WideWeb)</P></LI><LICLASS="listitem"><PCLASS="para"><SPANCLASS="acronym">NNTP</SPAN>&nbsp;- Usenet news</P></LI></UL><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-2806"></A>In order to support any of these services (including<SPANCLASS="acronym">SMTP</SPAN>), you must access and provide domain nameservice (<SPANCLASS="acronym">DNS</SPAN>). <SPANCLASS="acronym">DNS</SPAN> is seldomused directly, but it underlies all the other protocols by providingthe means to translate hostnames to <SPANCLASS="acronym">IP</SPAN> addressesand vice versa, as well as providing other distributed informationabout sites and hosts.</P><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-2813"></A>You may also want to provide some version of the<EMCLASS="emphasis">finger</EM> service, to provide information about yoursite and the people at it. However, you should decide what informationyou want people to have, and use a modified<EMCLASS="emphasis">finger</EM> daemon that provides only that. It isgenerally not desirable to tell the world which accounts are availableon the bastion host and which are in use. Not only is this informationuseful to attackers, it's useless to genuine inquirers, who want toknow information about your site as a whole, not about the bastionhost in particular. The section on <EMCLASS="emphasis">finger</EM> in<ACLASS="xref"HREF="ch08_01.htm"TITLE="Configuring Internet Services">Chapter 8</A> discusses some possible modified<EMCLASS="emphasis">finger</EM> daemons.</P><PCLASS="para">The book <CITECLASS="citetitle">Managing Internet InformationServices</CITE>, referenced above, has a good chapter onproviding information services through <EMCLASS="emphasis">finger</EM>,<EMCLASS="emphasis">inetd</EM>, and Telnet. One particular techniquedescribed, that of creating &quot;captured&quot; or&quot;no-break&quot; shells, creates site-specificmodified-procedure proxy services fairly easily. These services are away for users within your network to be able to run<ACLASS="indexterm"NAME="AUTOID-2824"></A><ACLASS="indexterm"NAME="AUTOID-2826"></A><EMCLASS="emphasis">ping</EM> or <EMCLASS="emphasis">traceroute</EM> againstexternal hosts, from a captured shell on the bastion host.</P><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-2831"></A><ACLASS="indexterm"NAME="AUTOID-2833"></A>Many <SPANCLASS="acronym">LAN</SPAN>-oriented services include vulnerabilitiesthat attackers can exploit from outside, and all of them areopportunities for an attacker who has succeeded in compromising thebastion host. Basically, you should disable anything that you aren'tgoing to use, and you should choose what to use very carefully.</P></DIV><DIVCLASS="htmlnav"><P></P><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch05_05.htm"TITLE="5.5 Locating the Bastion Host on the Network"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 5.5 Locating the Bastion Host on the Network"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="book"HREF="index.htm"TITLE="Building Internet Firewalls"><IMGSRC="../gifs/txthome.gif"ALT="Building Internet Firewalls"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch05_07.htm"TITLE="5.7 Don't Allow User Accounts on the Bastion Host"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 5.7 Don't Allow User Accounts on the Bastion Host"BORDER="0"></A></TD></TR><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172">5.5 Locating the Bastion Host on the Network</TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="index"HREF="index/idx_a.htm"TITLE="Book Index"><IMGSRC="../gifs/index.gif"ALT="Book Index"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172">5.7 Don't Allow User Accounts on the Bastion Host</TD></TR></TABLE><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><PCLASS="nav"><FONTSIZE="-1">[ <AHREF="../index.htm"TITLE="The Networking CD Bookshelf">Library Home</A> | <AHREF="../dnsbind/index.htm"TITLE="DNS &amp; BIND">DNS &amp; BIND</A> | <AHREF="../tcpip/index.htm"TITLE="TCP/IP Network Administration">TCP/IP</A> | <AHREF="../sendmail/index.htm"TITLE="sendmail">sendmail</A> | <AHREF="../smdref/index.htm"TITLE="sendmail Desktop Reference">sendmail Reference</A> | <AHREF="index.htm"TITLE="Building Internet Firewalls">Firewalls</A> | <AHREF="../puis/index.htm"TITLE="Practical UNIX &amp; Internet Security">Practical Security</A> ]</FONT></P></DIV></BODY></HTML>