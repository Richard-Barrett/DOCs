<HTML><HEAD><TITLE>[Chapter 5] 5.10 Protecting the Machine and Backups</TITLE><METANAME="DC.title"CONTENT="Building Internet Firewalls"><METANAME="DC.creator"CONTENT="D. Brent Chapman &amp; Elizabeth D. Zwicky"><METANAME="DC.publisher"CONTENT="O'Reilly &amp; Associates, Inc."><METANAME="DC.date"CONTENT="1999-02-04T00:15:33Z"><METANAME="DC.type"CONTENT="Text.Monograph"><METANAME="DC.format"CONTENT="text/html"SCHEME="MIME"><METANAME="DC.source"CONTENT="1-56592-124-0"SCHEME="ISBN"><METANAME="DC.language"CONTENT="en-US"><METANAME="generator"CONTENT="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><LINKREV="made"HREF="mailto:online-books@oreilly.com"TITLE="Online Books Comments"><LINKREL="up"HREF="ch05_01.htm"TITLE="5. Bastion Hosts"><LINKREL="prev"HREF="ch05_09.htm"TITLE="5.9 Operating the Bastion Host "><LINKREL="next"HREF="ch06_01.htm"TITLE="6. Packet Filtering"></HEAD><BODYBGCOLOR="#FFFFFF"TEXT="#000000"><DIVCLASS="htmlnav"><H1><IMGSRC="gifs/smbanner.gif"ALT="Building Internet Firewalls"USEMAP="#srchmap"BORDER="0"></H1><MAPNAME="srchmap"><AREASHAPE="RECT"COORDS="0,0,466,65"HREF="index.htm"ALT="Building Internet Firewalls"><AREASHAPE="RECT"COORDS="467,0,514,18"HREF="../search/fsrch.htm"ALT="Search this book"></MAP><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch05_09.htm"TITLE="5.9 Operating the Bastion Host "><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 5.9 Operating the Bastion Host "BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><B><FONTFACE="ARIEL,HELVETICA,HELV,SANSERIF"SIZE="-1">Chapter 5<BR>Bastion Hosts</FONT></B></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="CHAPTER"HREF="ch06_01.htm"TITLE="6. Packet Filtering"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 6. Packet Filtering"BORDER="0"></A></TD></TR></TABLE>&nbsp;<HRALIGN="LEFT"WIDTH="515"TITLE="footer"></DIV><DIVCLASS="SECT1"><H2CLASS="sect1"><ACLASS="title"NAME="AUTOID-3968">5.10 Protecting the Machine and Backups</A></H2><PCLASS="para"><ACLASS="indexterm"NAME="CH05BACKUPS"></A><ACLASS="indexterm"NAME="CH05BASTHOSTBACK"></A><ACLASS="indexterm"NAME="CH05SECBACK"></A>Once the bastion host has been fully configured and is in operation,protect the physical machine and make sure that its backups areprotected from theft or other compromise.</P><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="AUTOID-3979">5.10.1 Watch Reboots Carefully </A></H3><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-3982"></A><ACLASS="indexterm"NAME="AUTOID-3984"></A><ACLASS="indexterm"NAME="AUTOID-3986"></A><ACLASS="indexterm"NAME="AUTOID-3989"></A>How will you know if someone has breached security? Sometimes, it'spainfully obvious. But sometimes, you'll have to draw conclusionsfrom the behavior of the system. Unexplained reboots or downtime onthe system may be a clue. Many attacks, e.g., modifying akernel, can't succeed unless the system is rebooted.</P><PCLASS="para">On the bastion host, crashes and reboots should be rareoccurrences. Once the bastion host has been fully configured and is inproduction, it should be a very stable system, often running for weeksor months at a stretch without a crash or a reboot. If a crash or areboot does occur, investigate it immediately to determine whether itwas caused by some legitimate problem or might have been the result ofsome kind of attack.</P><PCLASS="para">You might want to consider configuring the bastion host so that itdoesn't bring itself up automatically after an attempted reboot. Thatway, if someone does manage to crash or force a reboot of the machine,you'll know about it: the machine will sit there waiting for you toreboot it. The machine won't be able to come back up until you decideto do so. Even if your machine does not appear to allow you to disableautobooting, you can usually cause autoboots to fail by configuringthe machine to autoboot from a nonexistent disk.</P></DIV><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="AUTOID-3994">5.10.2 Do Secure Backups</A></H3><PCLASS="para">Backups on a bastion host are tricky because of trust issues. Who canyou trust?</P><PCLASS="para">You definitely don't want internal machines to trust the bastion hostenough for it to dump to their tape drives. If the bastion host hassomehow been compromised, this could be disastrous. You also don'twant the bastion host to trust the internal machines; this could leadto subversion of the bastion host by (well-intentioned) internalusers, or to attack from some host pretending to be an internalsystem.</P><PCLASS="para">Common remote dump mechanisms (for example, those used by the<SPANCLASS="acronym">BSD</SPAN> <EMCLASS="emphasis">dump</EM> and<EMCLASS="emphasis">rdump</EM> programs) will probably be blocked bypacket filtering between the bastion host and the internal systemsanyway (we discuss this issue in <ACLASS="xref"HREF="ch06_01.htm"TITLE="Packet Filtering">Chapter 6, <CITECLASS="chapter">Packet Filtering</CITE></A>). Therefore, you will normally want to dobackups to a tape device attached directly to the bastion host. Underno circumstances should you rely on backing up the bastion host todisks that remain attached to the bastion host. You must do backupsthat are removed from the bastion host so they cannot be accessed byan attacker who compromises it.</P><PCLASS="para">Fortunately, because the bastion host is an infrequently changingmachine, you won't have to do frequent backups. Once the bastion hostis fully configured and in production, it should be very stable. Aweekly or even monthly manual backup will probably be sufficient.</P><PCLASS="para">Backups of the bastion host aren't done just to guard against normalsystem catastrophes like disk crashes.  They're also a tool that youcan use later to investigate a break-in or some other securityincident. They give you a way to compare what's currently on thebastion host's disk with what was there before the incident.</P><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-4006"></A><ACLASS="indexterm"NAME="AUTOID-4009"></A>If you're only doing weekly or monthly backups, how you handle loggingbecomes an issue. If the bastion host is not being backed up daily,you <EMCLASS="emphasis">must </EM>do your logging to some system otherthan the bastion host itself. If an incident does occur, the logs aregoing to be critical in reconstructing what happened. If it turns outthat your only copy of the logs was on the (compromised) bastion host,and backups of the logs haven't been done for three weeks, you'regoing to be severely hampered in your investigative efforts.</P><PCLASS="para">As with all backups on all systems, you need to guard your bastion hostbackups as carefully as you guard the machine itself. The bastion hostbackups contain all the configuration information for the bastion host. An attacker who gets access to these backups would be able to analyzethe security of your bastion host without ever touching it. With theinformation these backups provide, he may possibly find a way to breakin without setting off any of the alarms on the bastion host.<ACLASS="indexterm"NAME="AUTOID-4014"></A><ACLASS="indexterm"NAME="AUTOID-4015"></A><ACLASS="indexterm"NAME="AUTOID-4016"></A><ACLASS="indexterm"NAME="AUTOID-4017"></A></P></DIV></DIV><DIVCLASS="htmlnav"><P></P><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch05_09.htm"TITLE="5.9 Operating the Bastion Host "><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 5.9 Operating the Bastion Host "BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="book"HREF="index.htm"TITLE="Building Internet Firewalls"><IMGSRC="../gifs/txthome.gif"ALT="Building Internet Firewalls"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="CHAPTER"HREF="ch06_01.htm"TITLE="6. Packet Filtering"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 6. Packet Filtering"BORDER="0"></A></TD></TR><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172">5.9 Operating the Bastion Host </TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="index"HREF="index/idx_a.htm"TITLE="Book Index"><IMGSRC="../gifs/index.gif"ALT="Book Index"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172">6. Packet Filtering</TD></TR></TABLE><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><PCLASS="nav"><FONTSIZE="-1">[ <AHREF="../index.htm"TITLE="The Networking CD Bookshelf">Library Home</A> | <AHREF="../dnsbind/index.htm"TITLE="DNS &amp; BIND">DNS &amp; BIND</A> | <AHREF="../tcpip/index.htm"TITLE="TCP/IP Network Administration">TCP/IP</A> | <AHREF="../sendmail/index.htm"TITLE="sendmail">sendmail</A> | <AHREF="../smdref/index.htm"TITLE="sendmail Desktop Reference">sendmail Reference</A> | <AHREF="index.htm"TITLE="Building Internet Firewalls">Firewalls</A> | <AHREF="../puis/index.htm"TITLE="Practical UNIX &amp; Internet Security">Practical Security</A> ]</FONT></P></DIV></BODY></HTML>