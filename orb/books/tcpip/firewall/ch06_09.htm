<HTML><HEAD><TITLE>[Chapter 6] 6.9 Where to Do Packet Filtering</TITLE><METANAME="DC.title"CONTENT="Building Internet Firewalls"><METANAME="DC.creator"CONTENT="D. Brent Chapman &amp; Elizabeth D. Zwicky"><METANAME="DC.publisher"CONTENT="O'Reilly &amp; Associates, Inc."><METANAME="DC.date"CONTENT="1999-02-04T00:18:11Z"><METANAME="DC.type"CONTENT="Text.Monograph"><METANAME="DC.format"CONTENT="text/html"SCHEME="MIME"><METANAME="DC.source"CONTENT="1-56592-124-0"SCHEME="ISBN"><METANAME="DC.language"CONTENT="en-US"><METANAME="generator"CONTENT="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><LINKREV="made"HREF="mailto:online-books@oreilly.com"TITLE="Online Books Comments"><LINKREL="up"HREF="ch06_01.htm"TITLE="6. Packet Filtering"><LINKREL="prev"HREF="ch06_08.htm"TITLE="6.8 Choosing a Packet Filtering Router"><LINKREL="next"HREF="ch06_10.htm"TITLE="6.10 Putting It All Together"></HEAD><BODYBGCOLOR="#FFFFFF"TEXT="#000000"><DIVCLASS="htmlnav"><H1><IMGSRC="gifs/smbanner.gif"ALT="Building Internet Firewalls"USEMAP="#srchmap"BORDER="0"></H1><MAPNAME="srchmap"><AREASHAPE="RECT"COORDS="0,0,466,65"HREF="index.htm"ALT="Building Internet Firewalls"><AREASHAPE="RECT"COORDS="467,0,514,18"HREF="../search/fsrch.htm"ALT="Search this book"></MAP><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch06_08.htm"TITLE="6.8 Choosing a Packet Filtering Router"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 6.8 Choosing a Packet Filtering Router"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><B><FONTFACE="ARIEL,HELVETICA,HELV,SANSERIF"SIZE="-1">Chapter 6<BR>Packet Filtering</FONT></B></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch06_10.htm"TITLE="6.10 Putting It All Together"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 6.10 Putting It All Together"BORDER="0"></A></TD></TR></TABLE>&nbsp;<HRALIGN="LEFT"WIDTH="515"TITLE="footer"></DIV><DIVCLASS="SECT1"><H2CLASS="sect1"><ACLASS="title"NAME="FIRE-06-S1-9">6.9 Where to Do Packet Filtering</A></H2><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-6365"></A>If you look at the various firewall architectures outlined in <ACLASS="xref"HREF="ch04_01.htm"TITLE="Firewall Design">Chapter 4</A>, you see that there are a variety of placesyou might perform packet filtering. Where should you do it? Theanswer is simple: anywhere you can.</P><PCLASS="para">Many of the architectures (e.g., the screened hostarchitecture or the single-router screened subnet architecture)involve only one router. In those cases, that one router is the onlyplace where you could do packet filtering, so there's notmuch of a decision to be made.</P><PCLASS="para">However, other architectures, such as the two-router screened subnetarchitecture, and some of the architectural variations, involve multiplerouters. You might do packet filtering on any or all of these routers.</P><PCLASS="para">Our recommendation is to do whatever packet filtering you can whereveryou can. This is an application of the principle of least privilege(described in <ACLASS="xref"HREF="ch03_01.htm"TITLE="Security Strategies">Chapter 3</A>). For each router that is part ofyour firewall, figure out what types of packets should legitimately beflowing through it, and set up filters to allow only those packets andno more. You may also want to put packet filters on destination hosts,using <EMCLASS="emphasis">screend</EM>, <EMCLASS="emphasis">ipfilterd</EM>, or <SPANCLASS="acronym">TCP</SPAN> Wrapper. This ishighly advisable for bastion hosts.</P><PCLASS="para">This may lead to duplication of some filters on multiple routers; inother words, you may filter out the same thing in more than one place.That's good; it's redundancy, and it may save you some day if you everhave a problem with one of your routers&nbsp;- for example, if something wassupposed to be done, but wasn't (because of improper configuration,bugs, enemy action, or whatever). It provides defense in depth, andgives you the opportunity to fail safely&nbsp;- other strategies we outlinedin <ACLASS="xref"HREF="ch03_01.htm"TITLE="Security Strategies">Chapter 3</A>.</P><PCLASS="para">If filtering is such a good idea, why not filter on all routers, notjust those that are part of the firewall? Basically, because ofperformance and maintenance issues. We discuss above what &quot;fastenough&quot; means for a packet filtering system on the perimeter ofyour network. However, what's fast enough at the edge of your network(where the real bottleneck is probably the speed of the lineconnecting you to the Internet) is probably not fast enough withinyour network (where you've probably got many busy<SPANCLASS="acronym">LAN</SPAN>s of Ethernet, <SPANCLASS="acronym">FDDI</SPAN>, orperhaps something even faster). Further, if you put filters on allyour routers, you're going to have to maintain all those filterlists. Maintaining filter lists is a manageable problem if you'retalking about one or a handful of routers that are part of a firewall,but it gets out of hand in a hurry as the number of routersincreases. This problem is worsened if some of the routers are purelyinternal. Why? Because you probably want to allow more services withinyour network than you allow between your network and theInternet. This is either going to make your filter sets longer (andthus harder to maintain), or make you switch from a &quot;defaultdeny&quot; stance to a &quot;default permit&quot; stance on thoseinternal filters (which is going to seriously undermine the securitythey provide anyway). You often reach a point of diminishing returnsfairly quickly when you try to apply filtering widely within a<SPANCLASS="acronym">LAN</SPAN>, rather than just at its perimeter.</P><PCLASS="para">You may still have internal packet filtering routers at boundarieswithin the <SPANCLASS="acronym">LAN</SPAN> (between networks with differentsecurity policies, or networks that belong to differentorganizations). As long as they're at clearly defined boundaries, andthey're up to the performance requirements, that's not aproblem. Whether or not you duplicate the external rules on theseinternal packet filters is going to depend on how much you trust theexternal packet filters, and how much complexity and overhead theexternal rules are going to add.<ACLASS="indexterm"NAME="AUTOID-6384"></A><ACLASS="indexterm"NAME="AUTOID-6385"></A><ACLASS="indexterm"NAME="AUTOID-6386"></A></P></DIV><DIVCLASS="htmlnav"><P></P><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch06_08.htm"TITLE="6.8 Choosing a Packet Filtering Router"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 6.8 Choosing a Packet Filtering Router"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="book"HREF="index.htm"TITLE="Building Internet Firewalls"><IMGSRC="../gifs/txthome.gif"ALT="Building Internet Firewalls"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch06_10.htm"TITLE="6.10 Putting It All Together"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 6.10 Putting It All Together"BORDER="0"></A></TD></TR><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172">6.8 Choosing a Packet Filtering Router</TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="index"HREF="index/idx_a.htm"TITLE="Book Index"><IMGSRC="../gifs/index.gif"ALT="Book Index"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172">6.10 Putting It All Together</TD></TR></TABLE><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><PCLASS="nav"><FONTSIZE="-1">[ <AHREF="../index.htm"TITLE="The Networking CD Bookshelf">Library Home</A> | <AHREF="../dnsbind/index.htm"TITLE="DNS &amp; BIND">DNS &amp; BIND</A> | <AHREF="../tcpip/index.htm"TITLE="TCP/IP Network Administration">TCP/IP</A> | <AHREF="../sendmail/index.htm"TITLE="sendmail">sendmail</A> | <AHREF="../smdref/index.htm"TITLE="sendmail Desktop Reference">sendmail Reference</A> | <AHREF="index.htm"TITLE="Building Internet Firewalls">Firewalls</A> | <AHREF="../puis/index.htm"TITLE="Practical UNIX &amp; Internet Security">Practical Security</A> ]</FONT></P></DIV></BODY></HTML>