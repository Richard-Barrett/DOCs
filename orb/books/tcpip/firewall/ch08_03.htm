<HTML><HEAD><TITLE>[Chapter 8] 8.3 Terminal Access (Telnet)</TITLE><METANAME="DC.title"CONTENT="Building Internet Firewalls"><METANAME="DC.creator"CONTENT="D. Brent Chapman &amp; Elizabeth D. Zwicky"><METANAME="DC.publisher"CONTENT="O'Reilly &amp; Associates, Inc."><METANAME="DC.date"CONTENT="1999-02-04T00:22:14Z"><METANAME="DC.type"CONTENT="Text.Monograph"><METANAME="DC.format"CONTENT="text/html"SCHEME="MIME"><METANAME="DC.source"CONTENT="1-56592-124-0"SCHEME="ISBN"><METANAME="DC.language"CONTENT="en-US"><METANAME="generator"CONTENT="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><LINKREV="made"HREF="mailto:online-books@oreilly.com"TITLE="Online Books Comments"><LINKREL="up"HREF="ch08_01.htm"TITLE="8. Configuring Internet Services"><LINKREL="prev"HREF="ch08_02.htm"TITLE="8.2 File Transfer"><LINKREL="next"HREF="ch08_04.htm"TITLE="8.4 Remote Command Execution"></HEAD><BODYBGCOLOR="#FFFFFF"TEXT="#000000"><DIVCLASS="htmlnav"><H1><IMGSRC="gifs/smbanner.gif"ALT="Building Internet Firewalls"USEMAP="#srchmap"BORDER="0"></H1><MAPNAME="srchmap"><AREASHAPE="RECT"COORDS="0,0,466,65"HREF="index.htm"ALT="Building Internet Firewalls"><AREASHAPE="RECT"COORDS="467,0,514,18"HREF="../search/fsrch.htm"ALT="Search this book"></MAP><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch08_02.htm"TITLE="8.2 File Transfer"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 8.2 File Transfer"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><B><FONTFACE="ARIEL,HELVETICA,HELV,SANSERIF"SIZE="-1">Chapter 8<BR>Configuring Internet Services</FONT></B></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch08_04.htm"TITLE="8.4 Remote Command Execution"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 8.4 Remote Command Execution"BORDER="0"></A></TD></TR></TABLE>&nbsp;<HRALIGN="LEFT"WIDTH="515"TITLE="footer"></DIV><DIVCLASS="SECT1"><H2CLASS="sect1"><ACLASS="title"NAME="FIRE-08-S1-3">8.3 Terminal Access (Telnet)</A></H2><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-9785"></A><ACLASS="indexterm"NAME="CH08CONFTELNET"></A><ACLASS="indexterm"NAME="CH08TELNET"></A>Telnet allows a user to remotely access a command shell on anothercomputer. Telnet is supported by most platforms on the Internet, evensome <SPANCLASS="acronym">MS-DOS</SPAN> and Microsoft Windows systems (whichprovide access to a <SPANCLASS="acronym">DOS</SPAN> shell via a Telnetserver). The major exception is the Macintosh operating system,which doesn't have a command-line-oriented shell to give users accessto, regardless of whether they're local or not; if MacOS did have ashell, however, somebody would probably create a Telnet server to giveremote access to it. (And, having written this, we're sure someonewill tell us that there <EMCLASS="emphasis">is</EM> a Telnet server forMac<SPANCLASS="acronym">OS</SPAN> which we simply didn't know about.)</P><PCLASS="para">Although remote terminal access is the most common use of Telnet, mostTelnet clients support the specification of arbitrary port numbers toaccess text-based <SPANCLASS="acronym">TCP</SPAN> services at other ports.This is useful if you have a service for which you don't want todistribute a dedicated client, for example, it's often used to giveaccess to <SPANCLASS="acronym">MUD</SPAN>s (Multi-User Domains) and<SPANCLASS="acronym">MOO</SPAN>s (Multi-user domains, Object Oriented), whichare multiuser environments for games, collaborative work environments,or chat areas. Telnet clients are also used fairly often for debuggingprotocols that are normally accessed by dedicated clients. Forexample, people will check <SPANCLASS="acronym">SMTP</SPAN> servers or verifyuser names by using <EMCLASS="emphasis">telnet hostname 25</EM> to connectto the <SPANCLASS="acronym">SMTP</SPAN> server directly on port 25 and type<SPANCLASS="acronym">SMTP</SPAN> commands at it. It's important to understandthat, although you may be using the program named<EMCLASS="emphasis">telnet</EM> for these purposes, all it's doing isopening a simple <SPANCLASS="acronym">TCP</SPAN> connection to the specifiedport number. The <EMCLASS="emphasis">telnet</EM> program doesn't use theTelnet protocol (which provides for things like option negotiationbetween client and server, line-at-a-time and character-at-a-timemodes, and so on) unless it is talking to a server on the standardTelnet port (port 23). This section discusses only the use of Telnetclients to access Telnet servers.</P><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-9810"></A>Incoming and outgoing Telnet have very different securityimplications. Most sites want to allow their users access to outgoingTelnet service, so their users can get to command shells andinformation services provided via Telnet on remote systems on theInternet. (<ACLASS="xref"HREF="ch08_03.htm#FIRE-08-FIG-8"TITLE="Outbound Telnet">Figure 8.8</A> illustrates outbound Telnet.)On the other hand, most sites don't want to allow (or want to allowbut very strictly control) incoming Telnet access to their site. <ACLASS="xref"HREF="ch10_01.htm"TITLE="Authentication and Inbound Services">Chapter 10</A> describes reasons for, and ways of, controllingincoming access, so we won't discuss these in any detail here.</P><H4CLASS="figure"><ACLASS="title"NAME="FIRE-08-FIG-8">Figure 8.8: Outbound Telnet</A></H4><IMGCLASS="graphic"SRC="figs/fire0808.gif"ALT="Figure 8.8"><PCLASS="para">Regardless of whether the access is incoming or outgoing, Telnet is acleartext protocol (just like most others). Whatever information yourusers access or provide over a Telnet session (for example, accessingsensitive data, or providing their passwords for other systems) isgoing to be visible to someone snooping on the Telnetconnection. Encrypting versions of Telnet are starting to becomeavailable, but none are widely used yet. As these tools become morecapable and more widely supported, they should become more useful. Thebest place to see what's currently available would be one of thegeneral Internet security Web pages (such as the<SPANCLASS="acronym">COAST</SPAN> Web page) discussed in <ACLASS="xref"HREF="appa_01.htm"TITLE="Resources">Appendix A</A>.</P><PCLASS="para">Users should be warned to use different passwords on external hostsfrom those they use on your hosts. When they make outgoing Telnetconnections, their passwords may be sniffed.</P><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="FIRE-08-S2-8">8.3.1 Packet Filtering Characteristics ofTelnet</A></H3><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-9825"></A>Telnet is a <SPANCLASS="acronym">TCP</SPAN>-based service. Telnet serversnormally use port 23 (they can be set to use any port number, but veryrarely use any port but 23). Telnet clients use ports above 1023.(Telnet is used as an example in <ACLASS="xref"HREF="ch06_01.htm"TITLE="Packet Filtering">Chapter 6</A> so itsfiltering characteristics are discussed in more detail there.) </P><TABLECLASS="informaltable"><THEADCLASS="thead"><TRCLASS="row"VALIGN="TOP"><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Direc-</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Source</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Dest.</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Pro-</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Source</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Dest.</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">ACK</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1"></TH></TR><TRCLASS="row"VALIGN="TOP"><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">tion</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Addr.</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Addr.</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">tocol</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Port</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Port</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Set</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Notes</TH></TR></THEAD><TBODYCLASS="tbody"><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">In</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Ext</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Int</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><SPANCLASS="acronym">TCP</SPAN></P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">&gt;1023</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">23</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">[13]</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Incoming session, client to server</P></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Out</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Int</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Ext</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><SPANCLASS="acronym">TCP</SPAN></P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">23</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">&gt;1023</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Yes</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Incoming session, server to client</P></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Out</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Int</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Ext</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><SPANCLASS="acronym">TCP</SPAN></P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">&gt;1023</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">23</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">[13]</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Outgoing session, client to server</P></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">In</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Ext</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Int</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><SPANCLASS="acronym">TCP</SPAN></P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">23</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">&gt;1023</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Yes</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Outgoing session, server to client</P></TD></TR></TBODY></TABLE><BLOCKQUOTECLASS="footnote"><PCLASS="para">[13] <SPANCLASS="acronym">ACK</SPAN> is not set on the first packet of this type(establishing connection) but will be set on the rest.</P></BLOCKQUOTE></DIV><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="FIRE-08-S2-9">8.3.2 Proxying Characteristics of Telnet</A></H3><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-9940"></A>Telnet is well-supported by proxies. <SPANCLASS="acronym">SOCKS</SPAN> providesa modified <SPANCLASS="acronym">UNIX</SPAN> Telnet client; modifying clientson other platforms is relatively trivial. The <SPANCLASS="acronym">TIS</SPAN><SPANCLASS="acronym">FWTK</SPAN> provides a Telnet proxy server that requiresmodified user procedures. The <SPANCLASS="acronym">SOCKS</SPAN> proxies shouldallow you to connect to ports other than the standard Telnet port, if suchconnections are <SPANCLASS="acronym">OK</SPAN> according to your<SPANCLASS="acronym">SOCKS</SPAN> server configuration file. Almost any commercialproxying package will probably provide Telnet proxying, because Telnetis such a commonly used protocol on the Internet.</P></DIV><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="FIRE-08-S2-10">8.3.3 Summary of Telnet Recommendations</A></H3><ULCLASS="itemizedlist"><LICLASS="listitem"><PCLASS="para">Restrict incoming Telnet as far as possible; most sites have little orno need for it. Whatever you're going to allow, follow the authentication guidelinesin <ACLASS="xref"HREF="ch10_01.htm"TITLE="Authentication and Inbound Services">Chapter 10</A>.</P></LI><LICLASS="listitem"><PCLASS="para">Outgoing Telnet can safely be allowed via packet filtering orproxying.</P></LI><LICLASS="listitem"><PCLASS="para">If you're concerned about the sensitivity of the data accessed overTelnet sessions, consider using an encrypting version of Telnet; checkone of the general Internet security Web pages (such as the<SPANCLASS="acronym">COAST</SPAN> page)to see what tools are currently available.</P></LI></UL><ACLASS="indexterm"NAME="AUTOID-9962"></A><ACLASS="indexterm"NAME="AUTOID-9963"></A></DIV></DIV><DIVCLASS="htmlnav"><P></P><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch08_02.htm"TITLE="8.2 File Transfer"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 8.2 File Transfer"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="book"HREF="index.htm"TITLE="Building Internet Firewalls"><IMGSRC="../gifs/txthome.gif"ALT="Building Internet Firewalls"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch08_04.htm"TITLE="8.4 Remote Command Execution"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 8.4 Remote Command Execution"BORDER="0"></A></TD></TR><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172">8.2 File Transfer</TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="index"HREF="index/idx_a.htm"TITLE="Book Index"><IMGSRC="../gifs/index.gif"ALT="Book Index"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172">8.4 Remote Command Execution</TD></TR></TABLE><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><PCLASS="nav"><FONTSIZE="-1">[ <AHREF="../index.htm"TITLE="The Networking CD Bookshelf">Library Home</A> | <AHREF="../dnsbind/index.htm"TITLE="DNS &amp; BIND">DNS &amp; BIND</A> | <AHREF="../tcpip/index.htm"TITLE="TCP/IP Network Administration">TCP/IP</A> | <AHREF="../sendmail/index.htm"TITLE="sendmail">sendmail</A> | <AHREF="../smdref/index.htm"TITLE="sendmail Desktop Reference">sendmail Reference</A> | <AHREF="index.htm"TITLE="Building Internet Firewalls">Firewalls</A> | <AHREF="../puis/index.htm"TITLE="Practical UNIX &amp; Internet Security">Practical Security</A> ]</FONT></P></DIV></BODY></HTML>