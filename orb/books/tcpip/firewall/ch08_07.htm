<HTML><HEAD><TITLE>[Chapter 8] 8.7 Other Information Services</TITLE><METANAME="DC.title"CONTENT="Building Internet Firewalls"><METANAME="DC.creator"CONTENT="D. Brent Chapman &amp; Elizabeth D. Zwicky"><METANAME="DC.publisher"CONTENT="O'Reilly &amp; Associates, Inc."><METANAME="DC.date"CONTENT="1999-02-04T00:24:40Z"><METANAME="DC.type"CONTENT="Text.Monograph"><METANAME="DC.format"CONTENT="text/html"SCHEME="MIME"><METANAME="DC.source"CONTENT="1-56592-124-0"SCHEME="ISBN"><METANAME="DC.language"CONTENT="en-US"><METANAME="generator"CONTENT="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><LINKREV="made"HREF="mailto:online-books@oreilly.com"TITLE="Online Books Comments"><LINKREL="up"HREF="ch08_01.htm"TITLE="8. Configuring Internet Services"><LINKREL="prev"HREF="ch08_06.htm"TITLE="8.6 World Wide Web (WWW) and HTTP"><LINKREL="next"HREF="ch08_08.htm"TITLE="8.8 Information Lookup Services"></HEAD><BODYBGCOLOR="#FFFFFF"TEXT="#000000"><DIVCLASS="htmlnav"><H1><IMGSRC="gifs/smbanner.gif"ALT="Building Internet Firewalls"USEMAP="#srchmap"BORDER="0"></H1><MAPNAME="srchmap"><AREASHAPE="RECT"COORDS="0,0,466,65"HREF="index.htm"ALT="Building Internet Firewalls"><AREASHAPE="RECT"COORDS="467,0,514,18"HREF="../search/fsrch.htm"ALT="Search this book"></MAP><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch08_06.htm"TITLE="8.6 World Wide Web (WWW) and HTTP"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 8.6 World Wide Web (WWW) and HTTP"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><B><FONTFACE="ARIEL,HELVETICA,HELV,SANSERIF"SIZE="-1">Chapter 8<BR>Configuring Internet Services</FONT></B></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch08_08.htm"TITLE="8.8 Information Lookup Services"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 8.8 Information Lookup Services"BORDER="0"></A></TD></TR></TABLE>&nbsp;<HRALIGN="LEFT"WIDTH="515"TITLE="footer"></DIV><DIVCLASS="SECT1"><H2CLASS="sect1"><ACLASS="title"NAME="FIRE-08-S1-7">8.7 Other Information Services</A></H2><PCLASS="para">In addition to the World Wide Web services described in the previoussection, there are a number of other popular information services aswell, including Gopher, <SPANCLASS="acronym">WAIS</SPAN>, and Archie.</P><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="FIRE-08-S2-25">8.7.1 Gopher</A></H3><PCLASS="para"><ACLASS="indexterm"NAME="CH08GOPHER"></A><ACLASS="indexterm"NAME="CH08CONFGOPH"></A>Gopher is a menu-driven text-based tool for browsing through files anddirectories across the Internet. When a user selects a Gopher menuitem, Gopher retrieves the specified file and displays itappropriately. This means that if a file is compressed, Gopherautomatically uncompresses it; if it's a <SPANCLASS="acronym">GIF</SPAN> image,Gopher automatically runs a <SPANCLASS="acronym">GIF</SPAN> viewer.</P><PCLASS="para">The security concerns for Gopher are essentially the same&nbsp;- from both aserver and a client point of view&nbsp;- as those described in the precedingsection for<SPANCLASS="acronym">HTTP</SPAN> servers and clients.</P><PCLASS="para">For servers, you have to worry about what a malicious client can trickyou into running. Like <SPANCLASS="acronym">HTTP</SPAN> servers, some Gopherservers use auxiliary programs to generate Gopher pages on thefly. Gopher servers are therefore susceptible to the same kinds ofproblems as <SPANCLASS="acronym">HTTP</SPAN> servers:</P><ULCLASS="itemizedlist"><LICLASS="listitem"><PCLASS="para">Can an attacker trick the auxiliary program?</P></LI><LICLASS="listitem"><PCLASS="para">Can the attacker upload his own auxiliary program and cause it to berun?</P></LI></UL><PCLASS="para">For clients, you have to worry about what a malicious server can trickyou into doing. Gopher uses the same kinds of extensible data type andauxiliary program mechanisms as <SPANCLASS="acronym">HTTP</SPAN>, so theconcerns are similar to those described for <SPANCLASS="acronym">HTTP</SPAN>.</P><PCLASS="para">Like <SPANCLASS="acronym">HTTP</SPAN> servers, Gopher servers also sometimeslive on nonstandard ports, so those concerns are similar to<SPANCLASS="acronym">HTTP</SPAN> as well. Some Gopher clients supporttransparent proxying (via <SPANCLASS="acronym">SOCKS</SPAN> or othermechanisms), but many don't.</P><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-11527"></A><ACLASS="indexterm"NAME="AUTOID-11531"></A>Most of the common <SPANCLASS="acronym">WWW</SPAN> browsers such as Mosaic andNetscape Navigator are Gopher clients as well as being<SPANCLASS="acronym">HTTP</SPAN> clients. These browsers generally support theproxying of Gopher via <SPANCLASS="acronym">SOCKS</SPAN> or via transparent<SPANCLASS="acronym">HTTP</SPAN> proxy servers such as the CERN<SPANCLASS="acronym">HTTP</SPAN> server described in the precedingsection. Even if you can't find a dedicated Gopher client that doesproxying, you can probably use one of these <SPANCLASS="acronym">WWW</SPAN>browsers (and an appropriate proxy server) instead. Your users mayeven prefer this approach to using a separate Gopher client, becauseit means they only have one application&nbsp;- a client for<SPANCLASS="acronym">HTTP</SPAN>, Gopher, and several other protocols&nbsp;- to learnand configure, rather than a separate application for each protocol.</P><DIVCLASS="sect3"><H4CLASS="sect3"><ACLASS="title"NAME="FIRE-08-S3-43">8.7.1.1 Packet filtering characteristics ofGopher</A></H4><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-11546"></A>Gopher is a <SPANCLASS="acronym">TCP</SPAN>-based service. Gopher clients useports above 1023. Most Gopher servers use port 70, but some don't;see the discussion of nonstandard server ports above, in the sectioncalled &quot;Packet Filtering Characteristics of<SPANCLASS="acronym">HTTP</SPAN>.&quot;</P><TABLECLASS="informaltable"><THEADCLASS="thead"><TRCLASS="row"VALIGN="TOP"><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Direc-</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Source</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Dest.</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Pro-</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Source</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Dest.</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">ACK</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1"></TH></TR><TRCLASS="row"VALIGN="TOP"><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">tion</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Addr.</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Addr.</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">tocol</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Port</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Port</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Set</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Notes</TH></TR></THEAD><TBODYCLASS="tbody"><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">In</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Ext</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Int</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><SPANCLASS="acronym">TCP</SPAN></P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">&gt;1023</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">70[21]</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">[22]</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Incoming session, client to server</P></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Out</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Int</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Ext</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><SPANCLASS="acronym">TCP</SPAN></P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">70[21] </P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">&gt;1023</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Yes</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Incoming session, server to client</P></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Out</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Int</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Ext</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><SPANCLASS="acronym">TCP</SPAN></P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">&gt;1023</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">70[21] </P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">[22]</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Outgoing session, client to server</P></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">In</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Ext</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Int</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><SPANCLASS="acronym">TCP</SPAN></P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">70[21] </P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">&gt;1023</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Yes</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Outgoing session, server to client</P></TD></TR></TBODY></TABLE><BLOCKQUOTECLASS="footnote"><PCLASS="para">[21] 70 is the standard port number for Gopher servers, but some serversrun on different port numbers.</P><PCLASS="para">[22] <SPANCLASS="acronym">ACK</SPAN> is not set on the first packet of this type(establishing connection) but will be set on the rest.</P></BLOCKQUOTE></DIV><DIVCLASS="sect3"><H4CLASS="sect3"><ACLASS="title"NAME="FIRE-08-S3-44">8.7.1.2 Proxying characteristics of Gopher</A></H4><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-11666"></A>The <SPANCLASS="acronym">TIS FWTK</SPAN> <EMCLASS="emphasis">http-gw</EM> proxyserver can serve Gopher as well as<SPANCLASS="acronym">HTTP</SPAN>. <SPANCLASS="acronym">SOCKS</SPAN> does not include amodified Gopher client, but Gopher clients are, in general, notdifficult to modify to use <SPANCLASS="acronym">SOCKS</SPAN>; many of theGopher clients freely available on the Internet support<SPANCLASS="acronym">SOCKS</SPAN> as either a compile-time or run-timeoption. Using a Web browser that supports proxying, like NetscapeNavigator or Mosaic, will give you proxy support for Gopherautomatically.</P></DIV><DIVCLASS="sect3"><H4CLASS="sect3"><ACLASS="title"NAME="FIRE-08-S3-45">8.7.1.3 Summary of Gopherrecommendations</A></H4><PCLASS="para">These recommendations are basically the same as for<SPANCLASS="acronym">HTTP</SPAN>:</P><ULCLASS="itemizedlist"><LICLASS="listitem"><PCLASS="para">If you're going to run a Gopher server, use a dedicated bastionhost if possible. </P></LI><LICLASS="listitem"><PCLASS="para">If you're going to run a Gopher server, carefully configure the Gopherserver to control what it has access to; in particular, watch out forways that someone could upload a program to Gopher system somehow (viamail or <SPANCLASS="acronym">FTP</SPAN>, for example), and then execute it viathe Gopher server.</P></LI><LICLASS="listitem"><PCLASS="para">Carefully control the external programs your Gopher server canaccess.</P></LI><LICLASS="listitem"><PCLASS="para">You can't allow internal hosts to access all Gopher servers withoutallowing them to access all <SPANCLASS="acronym">TCP</SPAN> ports, because someGopher servers use nonstandard port numbers. If you don't mindallowing your users access to all <SPANCLASS="acronym">TCP</SPAN> ports, youcan use packet filtering to examine the <SPANCLASS="acronym">ACK</SPAN> bit toallow outgoing connections to those ports (but not incomingconnections from those ports). If you do mind, then either restrictyour users to servers on the standard port (70), or use proxying.</P></LI><LICLASS="listitem"><PCLASS="para">Configure your Gopher clients carefully, and warn your users not toreconfigure them based on external advice.</P></LI><LICLASS="listitem"><PCLASS="para">If possible, use a Web browser such as Mosaic or Netscape Navigatorfor your Gopher client, rather than a dedicated client. Your users areprobably going to demand <SPANCLASS="acronym">WWW</SPAN> access before Gopheraccess anyway, so you might as well only have to figure out and secureone application.</P></LI></UL><ACLASS="indexterm"NAME="AUTOID-11698"></A><ACLASS="indexterm"NAME="AUTOID-11699"></A></DIV></DIV><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="FIRE-08-S2-26">8.7.2 Wide Area Information Servers(<SPANCLASS="acronym">WAIS</SPAN>)</A></H3><PCLASS="para"><ACLASS="indexterm"NAME="CH08WAIS"></A><ACLASS="indexterm"NAME="CH08CONFWAIS"></A><SPANCLASS="acronym">WAIS</SPAN> indexes large text databases so that they canbe searched efficiently by simple keyword or more complicated Booleanexpressions. For example, you can ask for all the documents thatmention &quot;firewalls&quot; or all the documents that mention&quot;firewalls&quot; but don't mention &quot;firemarshals&quot;. (You might do this to make sure you don't get documents about literalfirewalls.) <SPANCLASS="acronym">WAIS</SPAN> was originally developed atThinking Machines as a prototype information service, and is nowwidely used on the Internet for things like mailing-list archives andcatalogs of various text-based information (library card catalogs, forexample).</P><PCLASS="para"><SPANCLASS="acronym">WAIS</SPAN> servers present the same basic securityconcerns as the servers for all of the other common Internet services,such as <SPANCLASS="acronym">FTP</SPAN> and <SPANCLASS="acronym">HTTP</SPAN>: Can anattacker use this server to access something he shouldn't?</P><PCLASS="para">You address this problem just as you do with other servers: Secure andrestrict the environment the server runs in. In this way, you ensurethat even if the attacker gets out of the server, there's nothing elseof interest to be found on the machine. Further, nothing else shouldtrust the machine enough to significantly facilitate furtherbreak-ins.</P><PCLASS="para">Generally, <SPANCLASS="acronym">WAIS</SPAN> servers do not run auxiliaryprograms the way <SPANCLASS="acronym">HTTP</SPAN> and Gopher servers do,so with <SPANCLASS="acronym">WAIS</SPAN>, you don't need to worry thatattackers will trick your servers or upload auxiliary programs as theycan with the <SPANCLASS="acronym">HTTP</SPAN> and Gopher servers. Because<SPANCLASS="acronym">WAIS</SPAN> clients are not generally extensible with newdata types and auxiliary programs, as <SPANCLASS="acronym">HTTP</SPAN> andGopher clients are, you also don't have that can of worms to worryabout.</P><PCLASS="para"><SPANCLASS="acronym">WAIS</SPAN> servers do share one characteristic of<SPANCLASS="acronym">HTTP</SPAN> and Gopher servers, however: while there is astandard port number for <SPANCLASS="acronym">WAIS</SPAN> servers(<SPANCLASS="acronym">TCP</SPAN> port 210), not all of them use it. See thediscussion of this in the section on <SPANCLASS="acronym">HTTP</SPAN> above foran understanding of the problems this can cause.</P><PCLASS="para"><SPANCLASS="acronym">WAIS</SPAN> clients are generally standaloneprograms. They help you find <SPANCLASS="acronym">WAIS</SPAN> servers, submitqueries to those servers, display the results, submit follow-on queriesbased on previous results, and so on. <SPANCLASS="acronym">WAIS</SPAN>information is generally text-based, so <SPANCLASS="acronym">WAIS</SPAN>clients generally don't have the problems that <SPANCLASS="acronym">HTTP</SPAN>and Gopher clients do regarding the safety of the data they retrieve.</P><PCLASS="para">Some <SPANCLASS="acronym">WWW</SPAN> browsers include limited<SPANCLASS="acronym">WAIS</SPAN> client support.</P><DIVCLASS="sect3"><H4CLASS="sect3"><ACLASS="title"NAME="FIRE-08-S3-46">8.7.2.1 Packet filtering characteristics of<SPANCLASS="acronym">WAIS</SPAN></A></H4><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-11743"></A><SPANCLASS="acronym">WAIS</SPAN> is a <SPANCLASS="acronym">TCP</SPAN>-basedservice. <SPANCLASS="acronym">WAIS</SPAN> clients use random ports above 1023.<SPANCLASS="acronym">WAIS</SPAN> servers usually use port 210, but sometimesdon't; see the discussion of nonstandard server ports above, in thesection about <SPANCLASS="acronym">HTTP</SPAN>.</P><TABLECLASS="informaltable"><THEADCLASS="thead"><TRCLASS="row"VALIGN="TOP"><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Direc-</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Source</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Dest.</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Pro-</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Source</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Dest.</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">ACK</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1"></TH></TR><TRCLASS="row"VALIGN="TOP"><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">tion</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Addr.</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Addr.</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">tocol</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Port</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Port</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Set</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Notes</TH></TR></THEAD><TBODYCLASS="tbody"><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">In</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Ext</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Int</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><SPANCLASS="acronym">TCP</SPAN></P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">&gt;1023</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">210[23]</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">[24] </P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Incoming session, client to server</P></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Out</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Int</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Ext</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><SPANCLASS="acronym">TCP</SPAN></P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">210[23] </P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">&gt;1023</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Yes</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Incoming session, server to client</P></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Out</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Int</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Ext</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><SPANCLASS="acronym">TCP</SPAN></P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">&gt;1023</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">210[23] </P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">[24]</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Outgoing session, client to server</P></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">In</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Ext</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Int</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><SPANCLASS="acronym">TCP</SPAN></P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">210[23] </P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">&gt;1023</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Yes</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Outgoing session, server to client</P></TD></TR></TBODY></TABLE><BLOCKQUOTECLASS="footnote"><PCLASS="para">[23] 210 is the standard port number for <SPANCLASS="acronym">WAIS</SPAN>servers, but some servers run on different port numbers.</P><PCLASS="para">[24] <SPANCLASS="acronym">ACK</SPAN> is not set on the first packet of this type (establishing connection) but will be set on the rest.</P></BLOCKQUOTE></DIV><DIVCLASS="sect3"><H4CLASS="sect3"><ACLASS="title"NAME="FIRE-08-S3-47">8.7.2.2 Proxying characteristics of<SPANCLASS="acronym">WAIS</SPAN></A></H4><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-11868"></A>If you use a proxying Web browser like Netscape Navigator or Mosaic toaccess <SPANCLASS="acronym">WAIS</SPAN>, you automatically get clientsupport. As a straightforward single-connection protocol with plentyof user-specified information, <SPANCLASS="acronym">WAIS</SPAN> lends itself toboth modified-client and modified-procedureproxying. <SPANCLASS="acronym">SOCKS</SPAN> support is commonly available instandalone <SPANCLASS="acronym">WAIS</SPAN> clients.</P></DIV><DIVCLASS="sect3"><H4CLASS="sect3"><ACLASS="title"NAME="FIRE-08-S3-48">8.7.2.3 Gateways to <SPANCLASS="acronym">WAIS</SPAN></A></H4><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-11880"></A>A number of sites on the Internet provide <SPANCLASS="acronym">WAIS</SPAN>gateways for <SPANCLASS="acronym">HTTP</SPAN> clients, allowing people using<SPANCLASS="acronym">WWW</SPAN> browsers to access <SPANCLASS="acronym">WAIS</SPAN>servers indirectly. Gateways include:</P><BLOCKQUOTECLASS="literallayout"><PCLASS="literallayout"><ACLASS="systemitem.url"HREF="http://www.ai.mit.edu/the-net/wais.html">http://www.ai.mit.edu/the-net/wais.html</A><BR><ACLASS="systemitem.url"HREF="http://www.wais.com/">http://www.wais.com/</A></P></BLOCKQUOTE></DIV><DIVCLASS="sect3"><H4CLASS="sect3"><ACLASS="title"NAME="FIRE-08-S3-49">8.7.2.4 Summary of <SPANCLASS="acronym">WAIS</SPAN> recommendations</A></H4><ULCLASS="itemizedlist"><LICLASS="listitem"><PCLASS="para">If you want to run a <SPANCLASS="acronym">WAIS</SPAN> server, run it on abastion host and on the standard port for <SPANCLASS="acronym">WAIS</SPAN>(<SPANCLASS="acronym">TCP</SPAN> port 210). Carefully configure the server tocontrol what information it has access to.</P></LI><LICLASS="listitem"><PCLASS="para">You can't allow internal hosts to access all <SPANCLASS="acronym">WAIS</SPAN>servers without allowing them to access all <SPANCLASS="acronym">TCP</SPAN>ports, because some <SPANCLASS="acronym">WAIS</SPAN> servers use nonstandardport numbers. If you don't mind allowing your users access to all<SPANCLASS="acronym">TCP</SPAN> ports, you can use packet filtering to examinethe <SPANCLASS="acronym">ACK</SPAN> bit to allow outgoing connections to thoseports (but not incoming connections from those ports). If you do mind,then either restrict your users to servers on the standard port(<SPANCLASS="acronym">TCP</SPAN> port 210) or use proxying.</P></LI><LICLASS="listitem"><PCLASS="para">If possible, use a Web browser such as Mosaic or Netscape Navigatorfor your <SPANCLASS="acronym">WAIS</SPAN> client, rather than a dedicatedclient. Your users are probably going to demand <SPANCLASS="acronym">WWW</SPAN>access before <SPANCLASS="acronym">WAIS</SPAN> access anyway, so you might aswell figure out and secure just one application.</P></LI></UL><ACLASS="indexterm"NAME="AUTOID-11912"></A><ACLASS="indexterm"NAME="AUTOID-11913"></A></DIV></DIV><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="FIRE-08-S2-91">8.7.3 Archie</A></H3><PCLASS="para"><ACLASS="indexterm"NAME="CH08ARCHIE"></A><ACLASS="indexterm"NAME="CH08CONFARCHIE"></A>Archie is an Internet service that lets users search through indexesof anonymous <SPANCLASS="acronym">FTP</SPAN> servers for strings or regularexpressions that match file and directory names in the<SPANCLASS="acronym">FTP</SPAN> archives. Archie continually polls publicanonymous <SPANCLASS="acronym">FTP</SPAN> servers to keep up to date withwhat's available at the sites.</P><DIVCLASS="sect3"><H4CLASS="sect3"><ACLASS="title"NAME="FIRE-08-S3-50">8.7.3.1 Packet filtering characteristics ofArchie</A></H4><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-11929"></A>Archie is a <SPANCLASS="acronym">UDP</SPAN>-based service. Dedicated Archieclients use ports above 1023; Archie servers use port 1525. As wediscuss in <ACLASS="xref"HREF="ch06_01.htm"TITLE="Packet Filtering">Chapter 6</A>, <SPANCLASS="acronym">UDP</SPAN>-basedservices in general are a problem for packet filteringfirewalls. Alternative ways to access Archie (other than directly viathe Archie protocol) are discussed in the sections below.</P><TABLECLASS="informaltable"><THEADCLASS="thead"><TRCLASS="row"VALIGN="TOP"><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Direc-</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Source</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Dest.</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Pro-</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Source</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Dest.</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">ACK</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1"></TH></TR><TRCLASS="row"VALIGN="TOP"><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">tion</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Addr.</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Addr.</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">tocol</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Port</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Port</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Set</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Notes</TH></TR></THEAD><TBODYCLASS="tbody"><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Out</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Int</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Ext[25] </P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><SPANCLASS="acronym">UDP</SPAN></P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">&gt;1023</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">1525</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">[26]</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Outgoing query, client to server</P></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">In</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Ext[25]</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Int</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><SPANCLASS="acronym">UDP</SPAN></P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">1525</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">&gt;1023</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">[26]</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Incoming response, server to client</P></TD></TR></TBODY></TABLE><BLOCKQUOTECLASS="footnote"><PCLASS="para">[25] The external address should be one of the well-known Archie servers.</P><PCLASS="para">[26] <SPANCLASS="acronym">UDP</SPAN> packets do not have <SPANCLASS="acronym">ACK</SPAN> bits.</P></BLOCKQUOTE><PCLASS="para">Most sites with packet filtering systems typically filter out all<SPANCLASS="acronym">UDP</SPAN> traffic, and then open specific, restrictedpeepholes between their internal hosts and their bastion host(<EMCLASS="emphasis">not</EM> the whole outside world) for key<SPANCLASS="acronym">UDP</SPAN>-based services.</P></DIV><DIVCLASS="sect3"><H4CLASS="sect3"><ACLASS="title"NAME="FIRE-08-S3-51">8.7.3.2 Proxying characteristics ofArchie</A></H4><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-12017"></A>Because Archie is a <SPANCLASS="acronym">UDP</SPAN>-based service, it is notsupported by <SPANCLASS="acronym">SOCKS</SPAN>; however, it can be proxied by the<SPANCLASS="acronym">UDP</SPAN> Packet Relayer. <SPANCLASS="acronym">TIS FWTK</SPAN> does notprovide an Archie proxy server and does not provide a generic proxyserver for <SPANCLASS="acronym">UDP</SPAN> (<EMCLASS="emphasis">plug-gw</EM>supports only <SPANCLASS="acronym">TCP</SPAN>). Using one of the<SPANCLASS="acronym">HTTP</SPAN>-Archie gateways (discussed below) gives youthe proxying of your Web browser, and provides a better user interfacethan many dedicated Archie clients.</P></DIV><DIVCLASS="sect3"><H4CLASS="sect3"><ACLASS="title"NAME="FIRE-08-S3-52">8.7.3.3 Providing Archie service to yourusers</A></H4><PCLASS="para">There are several ways to let your users access Archie servers,including Telnet, email, and <SPANCLASS="acronym">WWW</SPAN> gateways, and thededicated Archie protocol. Sites running Archie servers generallyprefer people to access them via the dedicated Archie protocol (or via<SPANCLASS="acronym">WWW</SPAN> gateways, which in turn access the Archieservers via the dedicated Archie protocol) because this is moreefficient for them and allows them to serve a greater number of users.</P>Archie access via Telnet<PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-12037"></A><ACLASS="indexterm"NAME="AUTOID-12040"></A>If you allow outgoing Telnet, Archie servers can be accessed byopening a Telnet session to the machine and logging in as&quot;archie&quot; (no password required). This will give youaccess to a command-line-oriented Archie query program. Now you caneither capture a log of the Telnet session to save your results ortell the server to email you the results after you're done. Issue thecommand &quot;help&quot; to get started with a description ofthe server's command language.</P>Archie access via email<PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-12046"></A><ACLASS="indexterm"NAME="AUTOID-12049"></A>Generally, Archie servers can also be accessed by email. If you sendan email message to &quot;archie&quot; at one of the Archiesites (e.g., <EMCLASS="emphasis">archie@archie.ans.net</EM>), itwill treat the mail as a query to be processed and will email back theresults. Send the query &quot;help&quot; to find out how to usethe service.</P>Archie access via WWW gateways<PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-12056"></A><ACLASS="indexterm"NAME="AUTOID-12059"></A>Like many services, Archie servers can also be accessed via avariety of <SPANCLASS="acronym">WWW</SPAN> gateways; simply point your Webbrowser at one of the following:</P><BLOCKQUOTECLASS="literallayout"><PCLASS="literallayout"><ACLASS="systemitem.url"HREF="http://www.lerc.nasa.gov/Doc/archieplex-httpd.html">http://www.lerc.nasa.gov/Doc/archieplex-httpd.html</A><BR><ACLASS="systemitem.url"HREF="http://hoohoo.ncsa.uiuc.edu/archie.html">http://hoohoo.ncsa.uiuc.edu/archie.html</A><BR><ACLASS="systemitem.url"HREF="http://www.nexor.co.uk/archie.html">http://www.nexor.co.uk/archie.html</A></P></BLOCKQUOTE>Archie access via packet filteringand the dedicated Archie protocol<PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-12070"></A><ACLASS="indexterm"NAME="AUTOID-12073"></A>Archie servers can be accessed directly with dedicated Archie clients.The problem is, as we've discussed above, Archie is<SPANCLASS="acronym">UDP</SPAN>-based, and most sites block all but a veryrestricted set of <SPANCLASS="acronym">UDP</SPAN> packets through theirfirewall in order to avoid security problems with<SPANCLASS="acronym">RPC</SPAN>-based services like <SPANCLASS="acronym">NFS</SPAN> and<SPANCLASS="acronym">NIS/YP</SPAN>. </P><PCLASS="para">What makes it possible to provide direct Archie access via packetfiltering is that there are so few Archie servers. Many sitesconsider it safe enough to open a peephole in the packet filtering forArchie to the well-known Archie servers their users are likely touse. There are several reasons for this:</P><ULCLASS="itemizedlist"><LICLASS="listitem"><PCLASS="para">The list of servers is small and fairly stable. </P></LI><LICLASS="listitem"><PCLASS="para">In order to be attacked through this peephole, the attack would haveto come (or at least convincingly appear to come) from one of thesesites. Given that these are all well-known and very heavily usedsites, any break-in to them is probably going to be noticed veryquickly, particularly if it takes down the Archie server in order touse its port to attack some other site. Even forging packets is likelyto result in widespread service outages and quick detection.</P></LI><LICLASS="listitem"><PCLASS="para">Even if someone did break into one of the Archie servers, what arethe chances that the attacker would then go after your site in particular?</P></LI></UL><PCLASS="para">You may also decide that you are willing to take a chance and open yourpacket filtering sufficiently to allow your users to access the handfulof major Archie servers in the world, or at least the default serversyou've configured into the client you're distributing.</P></DIV><DIVCLASS="sect3"><H4CLASS="sect3"><ACLASS="title"NAME="FIRE-08-S3-53">8.7.3.4 Running an Archie server</A></H4><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-12093"></A><ACLASS="indexterm"NAME="AUTOID-12096"></A>Providing an Archie server is a major undertaking, requiring thededication of a fairly substantial amount of computing power, diskspace, and network bandwidth. Because of this, there are only about 20Archie servers in the world; telling you how to become the 21st isbeyond the scope of this book. In any case, it's unlikely to bebeneficial to the world for you to do it. If there are too manyservers, they are more likely to be incomplete or out of date and toconsume bandwidth people need to access the FTP servers.</P></DIV><DIVCLASS="sect3"><H4CLASS="sect3"><ACLASS="title"NAME="FIRE-08-S3-54">8.7.3.5 Summary of Archie recommendations</A></H4><ULCLASS="itemizedlist"><LICLASS="listitem"><PCLASS="para">Don't run an Archie server.</P></LI><LICLASS="listitem"><PCLASS="para">Teach your users to access Archie via <SPANCLASS="acronym">WWW</SPAN> gateways.</P></LI></UL><ACLASS="indexterm"NAME="AUTOID-12107"></A><ACLASS="indexterm"NAME="AUTOID-12108"></A></DIV></DIV></DIV><DIVCLASS="htmlnav"><P></P><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch08_06.htm"TITLE="8.6 World Wide Web (WWW) and HTTP"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 8.6 World Wide Web (WWW) and HTTP"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="book"HREF="index.htm"TITLE="Building Internet Firewalls"><IMGSRC="../gifs/txthome.gif"ALT="Building Internet Firewalls"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch08_08.htm"TITLE="8.8 Information Lookup Services"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 8.8 Information Lookup Services"BORDER="0"></A></TD></TR><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172">8.6 World Wide Web (WWW) and HTTP</TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="index"HREF="index/idx_a.htm"TITLE="Book Index"><IMGSRC="../gifs/index.gif"ALT="Book Index"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172">8.8 Information Lookup Services</TD></TR></TABLE><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><PCLASS="nav"><FONTSIZE="-1">[ <AHREF="../index.htm"TITLE="The Networking CD Bookshelf">Library Home</A> | <AHREF="../dnsbind/index.htm"TITLE="DNS &amp; BIND">DNS &amp; BIND</A> | <AHREF="../tcpip/index.htm"TITLE="TCP/IP Network Administration">TCP/IP</A> | <AHREF="../sendmail/index.htm"TITLE="sendmail">sendmail</A> | <AHREF="../smdref/index.htm"TITLE="sendmail Desktop Reference">sendmail Reference</A> | <AHREF="index.htm"TITLE="Building Internet Firewalls">Firewalls</A> | <AHREF="../puis/index.htm"TITLE="Practical UNIX &amp; Internet Security">Practical Security</A> ]</FONT></P></DIV></BODY></HTML>