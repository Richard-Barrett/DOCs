<HTML><HEAD><TITLE>[Chapter 9] 9.2 Screened Host Architecture</TITLE><METANAME="DC.title"CONTENT="Building Internet Firewalls"><METANAME="DC.creator"CONTENT="D. Brent Chapman &amp; Elizabeth D. Zwicky"><METANAME="DC.publisher"CONTENT="O'Reilly &amp; Associates, Inc."><METANAME="DC.date"CONTENT="1999-02-04T00:28:18Z"><METANAME="DC.type"CONTENT="Text.Monograph"><METANAME="DC.format"CONTENT="text/html"SCHEME="MIME"><METANAME="DC.source"CONTENT="1-56592-124-0"SCHEME="ISBN"><METANAME="DC.language"CONTENT="en-US"><METANAME="generator"CONTENT="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><LINKREV="made"HREF="mailto:online-books@oreilly.com"TITLE="Online Books Comments"><LINKREL="up"HREF="ch09_01.htm"TITLE="9. Two Sample Firewalls"><LINKREL="prev"HREF="ch09_01.htm"TITLE="9.1 Screened Subnet Architecture"><LINKREL="next"HREF="ch10_01.htm"TITLE="10. Authentication and Inbound Services"></HEAD><BODYBGCOLOR="#FFFFFF"TEXT="#000000"><DIVCLASS="htmlnav"><H1><IMGSRC="gifs/smbanner.gif"ALT="Building Internet Firewalls"USEMAP="#srchmap"BORDER="0"></H1><MAPNAME="srchmap"><AREASHAPE="RECT"COORDS="0,0,466,65"HREF="index.htm"ALT="Building Internet Firewalls"><AREASHAPE="RECT"COORDS="467,0,514,18"HREF="../search/fsrch.htm"ALT="Search this book"></MAP><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch09_01.htm"TITLE="9.1 Screened Subnet Architecture"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 9.1 Screened Subnet Architecture"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><B><FONTFACE="ARIEL,HELVETICA,HELV,SANSERIF"SIZE="-1">Chapter 9<BR>Two Sample Firewalls</FONT></B></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="CHAPTER"HREF="ch10_01.htm"TITLE="10. Authentication and Inbound Services"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 10. Authentication and Inbound Services"BORDER="0"></A></TD></TR></TABLE>&nbsp;<HRALIGN="LEFT"WIDTH="515"TITLE="footer"></DIV><DIVCLASS="SECT1"><H2CLASS="sect1"><ACLASS="title"NAME="FIRE-09-S1-2">9.2 Screened Host Architecture</A></H2><PCLASS="para"><ACLASS="indexterm"NAME="CH09SHA"></A><ACLASS="indexterm"NAME="CH09HAS"></A>The screened host architecture, described in <ACLASS="xref"HREF="ch04_01.htm"TITLE="Firewall Design">Chapter 4</A> and shown in <ACLASS="xref"HREF="ch09_02.htm#FIRE-09-FIG-2"TITLE="Screened host architecture">Figure 9.2</A>, is a lower-security, lower-cost alternativeto the screened subnet architecture discussed in the previoussections. The screened host architecture is often used by very smallsites that are facing significant cost constraints.</P><H4CLASS="figure"><ACLASS="title"NAME="FIRE-09-FIG-2">Figure 9.2: Screened host architecture</A></H4><IMGCLASS="graphic"SRC="figs/fire0902.gif"ALT="Figure 9.2"><PCLASS="para">In a screened host architecture, there is no perimeter net, no interiorrouter, and often no bastion host per se. (Obviously, there is a hostthat the outside world talks to, but this host is often not dedicatedsolely to that task.) What you have instead is a single router (mostanalogous to the exterior router in the dual-router screened subnetarchitecture) and a services host that provides Internet services tointernal and external clients (and is often used for other tasks aswell).</P><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-19225"></A>The router is there to protect and control access to the internal net,and the services host is there to interact with the outside world,much like a bastion host. We call it a <EMCLASS="emphasis">services host,</EM> rather than a bastion host, because it's often fulfillingmany other roles. For example, it's probably the mail server, Usenetnews server, and <SPANCLASS="acronym">DNS</SPAN> server for the site; it mightpossibly be a file server, print server, and so on, as well; it mighteven be the only machine the site has.</P><PCLASS="para">In this example, we're going to assume:<ULCLASS="itemizedlist"><LICLASS="listitem"><PCLASS="para">That the services host is the site's mail server, news server, and<SPANCLASS="acronym">DNS</SPAN> server, but that it's not the only machine at the site.</P></LI><LICLASS="listitem"><PCLASS="para">As in the previous example, that internal users are trusted not toactively try to circumvent the firewall, and that we have no particularneed to monitor or log their Internet activities.</P></LI><LICLASS="listitem"><PCLASS="para">Also as in the previous example, that you're using proper <SPANCLASS="acronym">IP</SPAN>addresses: addresses that have been properly assigned to yoursite and that are being properly routed and advertised to the rest ofthe Internet by your service provider.</P></LI></UL></P><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="FIRE-09-S2-6">9.2.1 Service Configuration</A></H3><PCLASS="para">How do we provide the basic Internet services with a screened hostarchitecture?</P><DIVCLASS="sect3"><H4CLASS="sect3"><ACLASS="title"NAME="FIRE-09-S3-16">9.2.1.1 Telnet</A></H4><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-19245"></A><ACLASS="indexterm"NAME="AUTOID-19249"></A>Telnet can be safely and conveniently provided through packet filtering. For this example, that's what we're going to do. We've discussed in theprevious sections how proxying Telnet is usually too expensive for itsbenefits in a larger configuration; it's that much sillier here in thescreened host architecture. Similarly, providing incoming Telnet isdifficult in the larger configuration, and verges on the suicidal here,where compromising the services host instantly compromises the entirenetwork. Therefore, we will not provide incoming Telnet service.</P></DIV><DIVCLASS="sect3"><H4CLASS="sect3"><ACLASS="title"NAME="FIRE-09-S3-17">9.2.1.2 <SPANCLASS="acronym">FTP</SPAN></A></H4><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-19257"></A><ACLASS="indexterm"NAME="AUTOID-19261"></A>As in the screened subnet architecture, <SPANCLASS="acronym">FTP</SPAN> can besafely and conveniently provided via packet filtering if our internal<SPANCLASS="acronym">FTP</SPAN> clients support <SPANCLASS="acronym">FTP</SPAN>'spassive mode. We'll need to set up an <SPANCLASS="acronym">FTP</SPAN> proxyserver on the services host if we wish to support clients that can'tuse passive mode. We can support both passive- and normal-mode<SPANCLASS="acronym">FTP</SPAN> clients, if needed, but doing so is not aslikely at a smaller site. At smaller sites, it's better to do one orthe other, rather than try to keep track of both. In this example,we'll do only passive mode.</P><PCLASS="para">Be aware that in order to use an <SPANCLASS="acronym">FTP</SPAN> proxy server onyour services host, your filtering router would have to allow<SPANCLASS="acronym">TCP</SPAN> connections from port 20 on external systems toports above 1023 on your services host. For a regular bastion host,this wouldn't be a problem, because nothing should be usingsuch ports. For a services host that's also serving other purposes,however, that may not be true.</P><PCLASS="para">Incoming user <SPANCLASS="acronym">FTP</SPAN> goes the same way as incomingTelnet in any configuration. Because we've already decided to denyincoming Telnet, we'll deny incoming user <SPANCLASS="acronym">FTP</SPAN> aswell.</P><PCLASS="para">As we've seen with the screened subnet architecture, incominganonymous <SPANCLASS="acronym">FTP</SPAN> is an acceptable risk when it's goingto a bastion host. However, it's not an acceptable risk going to theservices host, with confidential data and full access to the internalnetwork right there.  We will therefore deny it.</P></DIV><DIVCLASS="sect3"><H4CLASS="sect3"><ACLASS="title"NAME="FIRE-09-S3-18">9.2.1.3 <SPANCLASS="acronym">SMTP</SPAN></A></H4><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-19282"></A><ACLASS="indexterm"NAME="AUTOID-19286"></A>In this architecture, there is probably only one good way to set up<SPANCLASS="acronym">SMTP</SPAN>. Incoming mail should be directed (via<SPANCLASS="acronym">DNS</SPAN> <SPANCLASS="acronym">MX</SPAN> records) to the serviceshost, and outgoing mail should go out via the services host.  Therereally is no feasible alternative. As we've discussed above, it'snever advisable to let incoming mail go directly to all of yourinternal machines. Also, once you're directing incoming mail through asingle point, it's actually easier&nbsp;- not to mention safer&nbsp;- to routeoutgoing mail through there than to send it direct.</P></DIV><DIVCLASS="sect3"><H4CLASS="sect3"><ACLASS="title"NAME="FIRE-09-S3-19">9.2.1.4 <SPANCLASS="acronym">NNTP</SPAN></A></H4><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-19297"></A><ACLASS="indexterm"NAME="AUTOID-19301"></A>As with <SPANCLASS="acronym">SMTP</SPAN>, there is probably only one good wayto set up <SPANCLASS="acronym">NNTP</SPAN> in the screened host architecture,and that is to make another internal machine aUsenet news server and allow<SPANCLASS="acronym">NNTP</SPAN> directly to it. We could, if forced to do so,make the services host a news server. However, it might be better toforgo news altogether, given how much of a load news places on amachine and how critical the services host is.</P></DIV><DIVCLASS="sect3"><H4CLASS="sect3"><ACLASS="title"NAME="FIRE-09-S3-20">9.2.1.5 <SPANCLASS="acronym">HTTP</SPAN></A></H4><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-19312"></A><ACLASS="indexterm"NAME="AUTOID-19316"></A>As we've discussed in the previous example, <SPANCLASS="acronym">HTTP</SPAN>can be provided directly via packet filtering or indirectly via aproxy server.  However, it makes the most sense to provide<SPANCLASS="acronym">HTTP</SPAN> indirectly via a caching proxy server such asthe <SPANCLASS="acronym">CERN HTTP</SPAN> server. There is one good reason forthis: better performance due to caching.</P><PCLASS="para">For this example, we're going to assume we're providing<SPANCLASS="acronym">HTTP</SPAN> service via a <SPANCLASS="acronym">CERN</SPAN> proxyserver running on the services host. Once again, we decide to denyservice to external clients due to the risks (which are furthercompounded by the sensitive position of the services host).</P></DIV><DIVCLASS="sect3"><H4CLASS="sect3"><ACLASS="title"NAME="FIRE-09-S3-21">9.2.1.6 <SPANCLASS="acronym">DNS</SPAN></A></H4><ACLASS="indexterm"NAME="AUTOID-19329"></A><ACLASS="indexterm"NAME="AUTOID-19333"></A><PCLASS="para">As with most of the other services, there is really only one goodplace to put the <SPANCLASS="acronym">DNS</SPAN> server in the screened hostarchitecture: on the services host. For this example, we're going toassume that:<ULCLASS="itemizedlist"><LICLASS="listitem"><PCLASS="para">The services host is your primary <SPANCLASS="acronym">DNS</SPAN> server.</P></LI><LICLASS="listitem"><PCLASS="para">You have an external <SPANCLASS="acronym">DNS</SPAN> secondary server for yourdomain, e.g., one of your service provider's machines.</P></LI><LICLASS="listitem"><PCLASS="para">You're not going to do any <SPANCLASS="acronym">DNS</SPAN> informationhiding: you can't if the services host is your internal and external primary server.</P></LI></UL></P></DIV></DIV><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="FIRE-09-S2-7">9.2.2 Packet Filtering Rules</A></H3><PCLASS="para"><ACLASS="indexterm"NAME="CH09PFER"></A>Let's look at the packet filtering rules necessary to support thescreened host configuration we've described in the previous sections. As in the earlier example of the screened subnet architecture, we'regoing to assume an &quot;ideal&quot; router. The router needs thefollowing rules to support the configuration we've outlined.</P><PCLASS="para"></P><TABLECLASS="informaltable"><THEADCLASS="thead"><TRCLASS="row"VALIGN="TOP"><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1"></TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Direc-</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Source</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Dest.</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Pro-</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Source</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Dest.</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1"><SPANCLASS="acronym">ACK</SPAN></TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1"></TH></TR><TRCLASS="row"VALIGN="TOP"><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Rule</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">tion</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Address</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Address</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">tocol</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Port</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Port</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Set</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Action</TH></TR></THEAD><TBODYCLASS="tbody"><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Spoof</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">In</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Internal </P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Any</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Any</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Any</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Any</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Any</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Deny</P></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Telnet-1</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Out</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Internal</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Any</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><SPANCLASS="acronym">TCP</SPAN></P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">&gt;1023</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">23</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Any</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Permit</P></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Telnet-2</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">In</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Any</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Internal</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><SPANCLASS="acronym">TCP</SPAN></P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">23</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">&gt;1023</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Yes</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Permit</P></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><SPANCLASS="acronym">FTP</SPAN>-1</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Out</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Internal</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Any</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><SPANCLASS="acronym">TCP</SPAN></P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">&gt;1023</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">21</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Any</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Permit</P></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><SPANCLASS="acronym">FTP</SPAN>-2</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">In</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Any</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Internal</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><SPANCLASS="acronym">TCP</SPAN></P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">21</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">&gt;1023</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Yes</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Permit</P></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><SPANCLASS="acronym">FTP</SPAN>-3</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Out</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Internal</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Any</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><SPANCLASS="acronym">TCP</SPAN></P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">&gt;1023</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">&gt;1023</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Any</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Permit</P></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><SPANCLASS="acronym">FTP</SPAN>-4</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">In</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Any</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Internal</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><SPANCLASS="acronym">TCP</SPAN></P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">&gt;1023</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">&gt;1023</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Yes</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Permit</P></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><SPANCLASS="acronym">SMTP</SPAN>-1</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Out</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Services</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Any</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><SPANCLASS="acronym">TCP</SPAN></P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">&gt;1023</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">25</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Any</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Permit</P></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><SPANCLASS="acronym">SMTP</SPAN>-2</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">In</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Any</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Services</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><SPANCLASS="acronym">TCP</SPAN></P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">25</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">&gt;1023</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Yes</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Permit</P></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><SPANCLASS="acronym">SMTP</SPAN>-3</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">In</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Any</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Services</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><SPANCLASS="acronym">TCP</SPAN></P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">&gt;1023</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">25</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Any</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Permit</P></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><SPANCLASS="acronym">SMTP</SPAN>-4</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Out</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Services</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Any</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><SPANCLASS="acronym">TCP</SPAN></P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">25</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">&gt;1023</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Yes</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Permit</P></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><SPANCLASS="acronym">NNTP</SPAN>-1</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Out</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">News server</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><SPANCLASS="acronym">NNTP</SPAN> feed server</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><SPANCLASS="acronym">TCP</SPAN></P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">&gt;1023</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">119</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Any</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Permit</P></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><SPANCLASS="acronym">NNTP</SPAN>-2</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">In</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><SPANCLASS="acronym">NNTP</SPAN> feed server</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">News server</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><SPANCLASS="acronym">TCP</SPAN></P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">119</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">&gt;1023</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Yes</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Permit</P></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><SPANCLASS="acronym">NNTP</SPAN>-3</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">In</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><SPANCLASS="acronym">NNTP</SPAN> feed server</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">News server</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><SPANCLASS="acronym">TCP</SPAN></P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">&gt;1023</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">119</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Any</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Permit</P></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><SPANCLASS="acronym">NNTP</SPAN>-4</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Out</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">News server</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><SPANCLASS="acronym">NNTP</SPAN> feed server</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><SPANCLASS="acronym">TCP</SPAN></P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">119</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">&gt;1023</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Yes</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Permit</P></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><SPANCLASS="acronym">HTTP</SPAN>-1</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Out</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Services</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Any</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><SPANCLASS="acronym">TCP</SPAN></P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">&gt;1023</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Any</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Any</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Permit</P></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><SPANCLASS="acronym">HTTP</SPAN>-2</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">In</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Any</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Services</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><SPANCLASS="acronym">TCP</SPAN></P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Any</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">&gt;1023</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Yes</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Permit</P></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><SPANCLASS="acronym">DNS</SPAN>-1</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Out</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Services</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Any</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><SPANCLASS="acronym">UDP</SPAN></P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">53</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">53</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">[3]</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Permit</P></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><SPANCLASS="acronym">DNS</SPAN>-2</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">In</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Any</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Services</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><SPANCLASS="acronym">UDP</SPAN></P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">53</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">53</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">[3]</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Permit</P></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><SPANCLASS="acronym">DNS</SPAN>-3</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">In</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Any</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Services</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><SPANCLASS="acronym">UDP</SPAN></P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Any</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">53</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">[3]</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Permit</P></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><SPANCLASS="acronym">DNS</SPAN>-4</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Out</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Services</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Any</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><SPANCLASS="acronym">UDP</SPAN></P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">53</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Any</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">[3]</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Permit</P></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><SPANCLASS="acronym">DNS</SPAN>-5</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Out</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Services</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Any</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><SPANCLASS="acronym">TCP</SPAN></P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">&gt;1023</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">53</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Any</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Permit</P></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><SPANCLASS="acronym">DNS</SPAN>-6</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">In</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Any</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Services</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><SPANCLASS="acronym">TCP</SPAN></P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">53</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">&gt;1023</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Yes</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Permit</P></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><SPANCLASS="acronym">DNS</SPAN>-7</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">In</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Any</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Services</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><SPANCLASS="acronym">TCP</SPAN></P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">&gt;1023</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">53</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Any</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Permit</P></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><SPANCLASS="acronym">DNS</SPAN>-8</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Out</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Services</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Any</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><SPANCLASS="acronym">TCP</SPAN></P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">53</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">&gt;1023</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Yes</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Permit</P></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Default-1</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Out</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Any</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Any</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Any</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Any</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Any</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Any</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Deny</P></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Default-2</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">In</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Any</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Any</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Any</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Any</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Any</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Any</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Deny</P></TD></TR></TBODY></TABLE><BLOCKQUOTECLASS="footnote"><PCLASS="para">[3] <SPANCLASS="acronym">UDP</SPAN> packets do nothave <SPANCLASS="acronym">ACK</SPAN> bits.</P></BLOCKQUOTE><PCLASS="para">Here is some additional information about each set of rules in thistable:<DLCLASS="variablelist"><DTCLASS="term"><EMCLASS="emphasis">Spoof</EM></DT><DDCLASS="listitem"><PCLASS="para">Blocks incoming packets that claim to have internal<SPANCLASS="acronym">IP</SPAN> addresses, that is, forged packets, presumablysent by an attacker.</P></DD><DTCLASS="term"><EMCLASS="emphasis">Telnet-1 and Telnet-2</EM></DT><DDCLASS="listitem"><PCLASS="para">Allow outgoing Telnet connections.</P></DD><DTCLASS="term"><EMCLASS="emphasis"><SPANCLASS="acronym">FTP</SPAN>-1 through <SPANCLASS="acronym">FTP</SPAN>-4</EM></DT><DDCLASS="listitem"><PCLASS="para">Allow outgoing passive-mode <SPANCLASS="acronym">FTP</SPAN> connections. The<SPANCLASS="acronym">FTP</SPAN>-1 and <SPANCLASS="acronym">FTP</SPAN>-2 rules allow thecommand channel, and the <SPANCLASS="acronym">FTP</SPAN>-3 and<SPANCLASS="acronym">FTP</SPAN>-4 rules allow the data channel. In fact,<SPANCLASS="acronym">FTP</SPAN>-3 and <SPANCLASS="acronym">FTP</SPAN>-4 allow any<SPANCLASS="acronym">TCP</SPAN> connection to be opened from the services hostto any host on the Internet, as long as the port numbers used on bothends are above 1023.</P></DD><DTCLASS="term"><EMCLASS="emphasis"><SPANCLASS="acronym">SMTP</SPAN>-1 and <SPANCLASS="acronym">SMTP</SPAN>-2</EM></DT><DDCLASS="listitem"><PCLASS="para">Allow outgoing mail from the services host to the outside world.</P></DD><DTCLASS="term"><EMCLASS="emphasis"><SPANCLASS="acronym">SMTP</SPAN>-3 and <SPANCLASS="acronym">SMTP</SPAN>-4</EM></DT><DDCLASS="listitem"><PCLASS="para">Allow incoming mail from the outside world to the services host.</P></DD><DTCLASS="term"><EMCLASS="emphasis"><SPANCLASS="acronym">NNTP</SPAN>-1 to <SPANCLASS="acronym">NNTP</SPAN>-4</EM></DT><DDCLASS="listitem"><PCLASS="para">Allow Usenet news both ways between your newsserver and your service provider's news server.</P></DD><DTCLASS="term"><EMCLASS="emphasis"><SPANCLASS="acronym">HTTP</SPAN>-1 and <SPANCLASS="acronym">HTTP</SPAN>-2</EM></DT><DDCLASS="listitem"><PCLASS="para">Allow the services host <SPANCLASS="acronym">HTTP</SPAN> proxy server toconnect to the <SPANCLASS="acronym">HTTP</SPAN> servers on any machine on theInternet. Actually, these rules allow any <SPANCLASS="acronym">TCP</SPAN>client program on the services host using a port above 1023 to contactany server program on any host on the Internet using any port. This isdone so that the <SPANCLASS="acronym">HTTP</SPAN> proxy server can contact<SPANCLASS="acronym">HTTP</SPAN> servers on nonstandard port numbers (i.e.,other than port 80). As broad as these rules are, it's important thatthese rules allow only outgoing connections; they can do this byexamining the <SPANCLASS="acronym">ACK</SPAN> bit. Note the overlap betweenthese rules and rules <SPANCLASS="acronym">FTP</SPAN>-3 and<SPANCLASS="acronym">FTP</SPAN>-4; removing either set would stillallow both <SPANCLASS="acronym">FTP</SPAN> and <SPANCLASS="acronym">HTTP</SPAN> clientsaccess to most servers.</P></DD><DTCLASS="term"><EMCLASS="emphasis"><SPANCLASS="acronym">DNS</SPAN>-1</EM></DT><DDCLASS="listitem"><PCLASS="para">Allows <SPANCLASS="acronym">UDP</SPAN>-based <SPANCLASS="acronym">DNS</SPAN> queries andanswers from the services host <SPANCLASS="acronym">DNS</SPAN> server to<SPANCLASS="acronym">DNS</SPAN> servers in the outside world.</P></DD><DTCLASS="term"><EMCLASS="emphasis"><SPANCLASS="acronym">DNS</SPAN>-2</EM></DT><DDCLASS="listitem"><PCLASS="para">Allows <SPANCLASS="acronym">UDP</SPAN>-based <SPANCLASS="acronym">DNS</SPAN> queries andanswers from Internet <SPANCLASS="acronym">DNS</SPAN> servers to the serviceshost <SPANCLASS="acronym">DNS</SPAN> server.</P></DD><DTCLASS="term"><EMCLASS="emphasis"><SPANCLASS="acronym">DNS</SPAN>-3 and <SPANCLASS="acronym">DNS</SPAN>-4</EM></DT><DDCLASS="listitem"><PCLASS="para">Allow external <SPANCLASS="acronym">UDP</SPAN>-based <SPANCLASS="acronym">DNS</SPAN>clients to query the <SPANCLASS="acronym">DNS</SPAN> server on the serviceshost, and it to answer them.</P></DD><DTCLASS="term"><EMCLASS="emphasis"><SPANCLASS="acronym">DNS</SPAN>-5 and <SPANCLASS="acronym">DNS</SPAN>-6</EM></DT><DDCLASS="listitem"><PCLASS="para">Allow <SPANCLASS="acronym">TCP</SPAN>-based <SPANCLASS="acronym">DNS</SPAN> queries fromthe services host to <SPANCLASS="acronym">DNS</SPAN> servers on the Internet,as well as answers to those queries. Also allow zone transfers in which theservices host <SPANCLASS="acronym">DNS</SPAN> server is the secondary serverand an external <SPANCLASS="acronym">DNS</SPAN> server is the primary server.</P></DD><DTCLASS="term"><EMCLASS="emphasis"><SPANCLASS="acronym">DNS</SPAN>-7 and <SPANCLASS="acronym">DNS</SPAN>-8</EM></DT><DDCLASS="listitem"><PCLASS="para">Allow <SPANCLASS="acronym">TCP</SPAN>-based <SPANCLASS="acronym">DNS</SPAN> queries fromthe outside world to the services host <SPANCLASS="acronym">DNS</SPAN> server,as well as answers to those queries. Also allow zone transfers in which theservices host <SPANCLASS="acronym">DNS</SPAN> server is the primary server andan external <SPANCLASS="acronym">DNS</SPAN> server is the secondary server.</P></DD><DTCLASS="term"><EMCLASS="emphasis">Default-1 and Default-2</EM></DT><DDCLASS="listitem"><PCLASS="para">Block all packets not specifically allowed by one of the precedingrules.</P></DD></DL><ACLASS="indexterm"NAME="AUTOID-20085"></A></P></DIV><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="FIRE-09-S2-8">9.2.3 Analysis</A></H3><PCLASS="para">Just how good a firewall is this? The shortanswer is, &quot;not very.&quot; Let's consider it in relation tothe strategies and principles discussed in <ACLASS="xref"HREF="ch03_01.htm"TITLE="Security Strategies">Chapter 3</A>, and in comparison to the screened subnetarchitecture we configured in the first example.</P><DIVCLASS="sect3"><H4CLASS="sect3"><ACLASS="title"NAME="FIRE-09-S3-22">9.2.3.1 Least privilege</A></H4><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-20093"></A><ACLASS="indexterm"NAME="AUTOID-20096"></A>You can see the principle of least privilege in action in some placesin this setup. For example, configuring <SPANCLASS="acronym">SMTP</SPAN> sothat outgoing mail goes out via the services host rather than directlyto remote systems is an application of least privilege. Why? Becauseit lets you control more tightly how internal systems connect toexternal systems. (In this case, it makes it unnecessary for internalsystems to talk directly to external systems in order to provide thisservice.)</P><PCLASS="para">On the other hand, having the services host fulfill so many roles (andthus requiring it to have the aggregate set of privileges required forall those roles) is definitely not in accord with the principle of leastprivilege. The services host has far too much privilege for most of theservices it needs to provide.</P><PCLASS="para">The screened subnet architecture we described earlier in this chapterdoes a somewhat better job of applying the principle of least privilegethan the screened host architecture described in this section.</P></DIV><DIVCLASS="sect3"><H4CLASS="sect3"><ACLASS="title"NAME="FIRE-09-S3-23">9.2.3.2 Defense in depth</A></H4><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-20104"></A><ACLASS="indexterm"NAME="AUTOID-20106"></A>The principle of defense in depth is almost completely missing fromthis setup. Internal hosts are protected from the outside world by thefiltering router and the services host, but nothing protects them fromthe services host if it is compromised. The filtering router and theservices host are providing separate protection, not backing eachother up. If either one is compromised, the entire site iscompromised.</P><PCLASS="para">The screened subnet architecture we described earlier in this chapterdoes a much better job of applying the principle of defense in depth.</P></DIV><DIVCLASS="sect3"><H4CLASS="sect3"><ACLASS="title"NAME="FIRE-09-S3-24">9.2.3.3 Choke point</A></H4><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-20113"></A><ACLASS="indexterm"NAME="AUTOID-20115"></A>The principle of a choke point is clearly applied in this example of ascreened host architecture, because everything between internal clientsand the Internet comes through at least the filtering router. Further,much of it comes through the services host, via proxies.</P><PCLASS="para">The screened subnet architecture described earlier in the chapter doesa slightly better job of applying the principle of a choke point, butnot by much.</P></DIV><DIVCLASS="sect3"><H4CLASS="sect3"><ACLASS="title"NAME="FIRE-09-S3-25">9.2.3.4 Weakest link</A></H4><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-20122"></A><ACLASS="indexterm"NAME="AUTOID-20124"></A>The obvious weak link to attack in the screened host architecture is theservices host. A compromised services host is going to severely affectthe security of the rest of the internal hosts, because it's on the samenetwork as these internal hosts and because there is nothing to protectthem from it. With the screened subnet architecture, on the other hand,the interior router protects the internal hosts from the bastion host. </P><PCLASS="para">Further, because of the multitude of services being provided by theservices host, it's more likely an attacker will be able tofind a way to break in than with the bastion host in the screened subnetexample.</P><PCLASS="para">All in all, the screened subnet architecture presents a much stronger&quot;weakest link&quot; to an attacker.</P></DIV><DIVCLASS="sect3"><H4CLASS="sect3"><ACLASS="title"NAME="FIRE-09-S3-26">9.2.3.5 Fail-safe stance</A></H4><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-20132"></A><ACLASS="indexterm"NAME="AUTOID-20134"></A>You can see the principle of a fail-safe stance applied through thepacket filtering rules specified for the screened host architecture. Ingeneral, the rules specify what you're going to allow, and denyeverything else by default. This is a fail-safe approach, because ifsomething unanticipated comes along (for example, a new service), itwon't be allowed through your firewall, unless, of course, it mimicsor is tunneled through some other service that you do allow.</P><PCLASS="para">However, the design of the screened host architecture itself is notfail-safe. If the services host is compromised, your whole site'ssecurity is severely compromised. The screened subnet architecture ismuch better about this.</P></DIV><DIVCLASS="sect3"><H4CLASS="sect3"><ACLASS="title"NAME="FIRE-09-S3-27">9.2.3.6 Universal participation</A></H4><PCLASS="para">If this is your site's only connection to the Internet, you've gotinvoluntary universal participation: everybody has to go through thefirewall to get to the Internet. Voluntary universal participationwould be better, but that would require some user education concerningthe goals of and the need for your security measures. </P><PCLASS="para">In terms of the universal participation principle, there really isn'tmuch difference between the screened subnet and screened hostarchitectures.</P></DIV><DIVCLASS="sect3"><H4CLASS="sect3"><ACLASS="title"NAME="FIRE-09-S3-28">9.2.3.7 Diversity of defense</A></H4><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-20145"></A>There are few opportunities here to apply the principle ofdiversity of defense, because you pretty much have only one ofeverything: there is only one router on which to set up filtering andonly one services host. </P><PCLASS="para">This is another area in which the screened subnet architecture issuperior to the screened host architecture.</P></DIV></DIV><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="FIRE-09-S2-9">9.2.4 Conclusions</A></H3><PCLASS="para">The screened host architecture may be cheaper to implement than thescreened subnet architecture, but it's much less secure. There islittle or no redundancy in the design, and it's not really fail-safe. Even so, it is providing fewer services than the screened subnetarchitecture, and it can't increase either the security or the services.</P><PCLASS="para">To do a screened host architecture right, you pretty much need todedicate a machine to being the services host and nothing else; youessentially need a bastion host. At that point, if you compare theequipment between a screened subnet architecture and a screened hostarchitecture, you see that the only difference in equipment is either:<ULCLASS="itemizedlist"><LICLASS="listitem"><PCLASS="para">For a two-router screened subnet architecture&nbsp;- a second router.</P></LI><LICLASS="listitem"><PCLASS="para">For a one-router screened subnet architecture&nbsp;- a third interfaceon your single router.</P></LI></UL></P><PCLASS="para">The cost of a suitable second router really isn't that much: a coupleof thousand dollars. The cost of an additional interface for a routeris often much less: a few hundred dollars difference in price betweena two-interface and a three-interface model of the same router. Theincremental cost might actually be nothing if you already have asuitable spare <SPANCLASS="acronym">PC</SPAN> lying around, and if you can useone of the <SPANCLASS="acronym">PC</SPAN>-based filtering packages freelyavailable off the Internet (such as Drawbridge or KarlBridge,described in <ACLASS="xref"HREF="appb_01.htm"TITLE="Tools">Appendix B, <CITECLASS="appendix">Tools</CITE></A>).</P><PCLASS="para">The difference between the screened subnet architecture and the screenedhost architecture is gigantic in terms of security, scalability, andservices. You can't reasonably offer inbound services of even the mostlimited type in a screened host architecture. You can't increaseanything, even the number of supportable machines, without making anarchitecture change.<ACLASS="indexterm"NAME="AUTOID-20163"></A><ACLASS="indexterm"NAME="AUTOID-20164"></A><ACLASS="indexterm"NAME="AUTOID-20165"></A></P></DIV></DIV><DIVCLASS="htmlnav"><P></P><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch09_01.htm"TITLE="9.1 Screened Subnet Architecture"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 9.1 Screened Subnet Architecture"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="book"HREF="index.htm"TITLE="Building Internet Firewalls"><IMGSRC="../gifs/txthome.gif"ALT="Building Internet Firewalls"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="CHAPTER"HREF="ch10_01.htm"TITLE="10. Authentication and Inbound Services"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 10. Authentication and Inbound Services"BORDER="0"></A></TD></TR><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172">9.1 Screened Subnet Architecture</TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="index"HREF="index/idx_a.htm"TITLE="Book Index"><IMGSRC="../gifs/index.gif"ALT="Book Index"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172">10. Authentication and Inbound Services</TD></TR></TABLE><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><PCLASS="nav"><FONTSIZE="-1">[ <AHREF="../index.htm"TITLE="The Networking CD Bookshelf">Library Home</A> | <AHREF="../dnsbind/index.htm"TITLE="DNS &amp; BIND">DNS &amp; BIND</A> | <AHREF="../tcpip/index.htm"TITLE="TCP/IP Network Administration">TCP/IP</A> | <AHREF="../sendmail/index.htm"TITLE="sendmail">sendmail</A> | <AHREF="../smdref/index.htm"TITLE="sendmail Desktop Reference">sendmail Reference</A> | <AHREF="index.htm"TITLE="Building Internet Firewalls">Firewalls</A> | <AHREF="../puis/index.htm"TITLE="Practical UNIX &amp; Internet Security">Practical Security</A> ]</FONT></P></DIV></BODY></HTML>