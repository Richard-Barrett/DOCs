<HTML><HEAD><TITLE>[Chapter 12] 12.2 Monitoring Your System</TITLE><METANAME="DC.title"CONTENT="Building Internet Firewalls"><METANAME="DC.creator"CONTENT="D. Brent Chapman &amp; Elizabeth D. Zwicky"><METANAME="DC.publisher"CONTENT="O'Reilly &amp; Associates, Inc."><METANAME="DC.date"CONTENT="1999-02-04T00:29:30Z"><METANAME="DC.type"CONTENT="Text.Monograph"><METANAME="DC.format"CONTENT="text/html"SCHEME="MIME"><METANAME="DC.source"CONTENT="1-56592-124-0"SCHEME="ISBN"><METANAME="DC.language"CONTENT="en-US"><METANAME="generator"CONTENT="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><LINKREV="made"HREF="mailto:online-books@oreilly.com"TITLE="Online Books Comments"><LINKREL="up"HREF="ch12_01.htm"TITLE="12. Maintaining Firewalls"><LINKREL="prev"HREF="ch12_01.htm"TITLE="12.1 Housekeeping"><LINKREL="next"HREF="ch12_03.htm"TITLE="12.3 Keeping Up to Date"></HEAD><BODYBGCOLOR="#FFFFFF"TEXT="#000000"><DIVCLASS="htmlnav"><H1><IMGSRC="gifs/smbanner.gif"ALT="Building Internet Firewalls"USEMAP="#srchmap"BORDER="0"></H1><MAPNAME="srchmap"><AREASHAPE="RECT"COORDS="0,0,466,65"HREF="index.htm"ALT="Building Internet Firewalls"><AREASHAPE="RECT"COORDS="467,0,514,18"HREF="../search/fsrch.htm"ALT="Search this book"></MAP><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch12_01.htm"TITLE="12.1 Housekeeping"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 12.1 Housekeeping"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><B><FONTFACE="ARIEL,HELVETICA,HELV,SANSERIF"SIZE="-1">Chapter 12<BR>Maintaining Firewalls</FONT></B></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch12_03.htm"TITLE="12.3 Keeping Up to Date"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 12.3 Keeping Up to Date"BORDER="0"></A></TD></TR></TABLE>&nbsp;<HRALIGN="LEFT"WIDTH="515"TITLE="footer"></DIV><DIVCLASS="SECT1"><H2CLASS="sect1"><ACLASS="title"NAME="FIRE-12-S1-2">12.2 Monitoring Your System</A></H2><PCLASS="para"><ACLASS="indexterm"NAME="CH12SYSMON"></A><ACLASS="indexterm"NAME="CH12MONSYS"></A>Another important aspect of firewall maintenance involves monitoringyour system. Monitoring is intended to tell you several things:<ULCLASS="itemizedlist"><LICLASS="listitem"><PCLASS="para">Has your firewall been compromised?</P></LI><LICLASS="listitem"><PCLASS="para">What kinds of attacks are being tried against your firewall?</P></LI><LICLASS="listitem"><PCLASS="para">Is your firewall in working order?</P></LI><LICLASS="listitem"><PCLASS="para">Is your firewall able to provide the service your users need?</P></LI></UL></P><PCLASS="para">In order to answer these questions, you'll need to know what the normalpattern of usage is.</P><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="FIRE-12-S2-4">12.2.1 Special-Purpose Monitoring Devices</A></H3><PCLASS="para">You'll do most of your monitoring using the tools and the loggingprovided by the existing parts of your firewall, but you may find itconvenient to have some dedicated monitoring devices as well. Forexample, you may want to put a monitoring station on your perimeter netso you can be sure only the packets you expect are goingacross it. You can use a general-purpose computer with network snoopingsoftware on it, or you can use a special-purpose network sniffer. </P><PCLASS="para">How can you make certain that this monitoring machine can't be used byan intruder? In fact, you'd prefer that an intruder not even detect itsexistence. On some network hardware, you can disable transmission in thenetwork interface (with sufficient expertise and a pair of wirecutters), which will make the machine impossible to detect and extremelydifficult for an intruder to use (because it can't reply). If you havesource for your operating system, you can always disable transmissionthere; however, in this case, it's much harder to be certain you'vebeen successful. In most cases, you'll have to settle for extremelycautious configuration of the machine. Treat it like a bastion host thatneeds to do less and be more secure.</P></DIV><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="FIRE-12-S2-5">12.2.2 What Should You Watch For?</A></H3><PCLASS="para"><ACLASS="indexterm"NAME="CH12LOGSWHAT"></A>In a perfect world, you'd like to know absolutely everything that goesthrough your firewall&nbsp;- every packet dropped or accepted, everyconnection requested. In the real world, neither the firewall nor yourbrain can cope with that much information. To come up with apractical compromise, you'll want to turn on the most verbose loggingthat doesn't slow down your machines too much and that doesn't fill upyour disks too fast; then, you'll want to summarize the logs that areproduced.</P><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-21292"></A><ACLASS="indexterm"NAME="AUTOID-21295"></A>You can improve the disk space problem by writing verbose logs tohigh-capacity tapes. <SPANCLASS="acronym">DAT</SPAN> and 8mm tapes are cheap,and they hold a lot of data, but they have some drawbacks. They're notparticularly fast; they rarely can write at more than 800K a second, underthe best circumstances, and log entries are generally too short toachieve maximum performance. They're also annoying to read datafrom. If you're interested in using them, write summary logs to disk,and write everything to tape. If you find a situation where you needmore data, you can go back to the tape for it. A tape drive canprobably keep up with the packets on an average Internet connection,but it won't keep up with an internal connection at full<SPANCLASS="acronym">LAN</SPAN> speeds or even with a T-1 connection to theInternet that's at close to its maximum performance.</P><PCLASS="para">In particular, you want to log the following cases:<ULCLASS="itemizedlist"><LICLASS="listitem"><PCLASS="para">All dropped packets, denied connections, and rejected attempts</P></LI><LICLASS="listitem"><PCLASS="para">At least the time, protocol, and user name for every successfulconnection to or through your bastion host</P></LI><LICLASS="listitem"><PCLASS="para">All error messages from your routers, your bastion host, and anyproxying programs</P></LI></UL></P><BLOCKQUOTECLASS="note"><PCLASS="para"><STRONG>NOTE:</STRONG> For security reasons, some information should never be logged where anintruder could possibly be able to read it. For example, althoughyou should log failed login attempts, you should not log the passwordthat was used in the failed attempt. Users frequently mistype their ownpasswords, and logging these mistyped passwords would make it easier fora computer cracker to break into a user's account.</P><PCLASS="para">Some system administrators believe that the account name should also notbe logged on failed login attempts, especially when the account typed bythe user is nonexistent. The reason is that users occasionally typetheir passwords when they are prompted for their user names. If invalidaccounts are logged, it might be possible for an attacker to usethose logs to infer people's passwords.</P></BLOCKQUOTE><PCLASS="para"><ACLASS="indexterm"NAME="CH12SYSLOG"></A>What are you watching for? You want to know what your usual patternis (and what trends there are in it), and you want to be alerted toany exceptions to that pattern. To recognize when things are goingwrong, you have to understand what happens when things are goingright. It's important to know what messagesyou get when everything is working. Most systems produce errormessages that sound peculiar and threatening even when they're workingperfectly well. For example, in the sample <EMCLASS="emphasis">syslog</EM> output in <ACLASS="xref"HREF="ch12_02.htm#FIRE-12-EX-1"TITLE="A Sample syslog File (Line Numbers Added)">Example 12.1</A>, messages 10, 14,and 17 all look vaguely threatening, but are in fact perfectly<SPANCLASS="acronym">OK</SPAN>.[1](See the section in <ACLASS="xref"HREF="ch05_01.htm"TITLE="Bastion Hosts">Chapter 5</A> called &quot;SettingUp System Logs.&quot;) If you see those messages for the first timewhen you're trying to debug a problem, you're likely to leap to theconclusion that the messages have something to do with your problemand get thoroughly sidetracked. Even if you never do figure out whatthe messages are and why they're appearing, just knowing that certainmessages appear even when things are working fine will save you time.</P><BLOCKQUOTECLASS="footnote"><PCLASS="para">[1] Message 10 is a common network failure that will result in a retry,and how good do you expect your connection to Cameroon to be? 14 is<EMCLASS="emphasis">traceroute</EM> running. 17 says there are no synonymsdefined, which you presumably already know.</P></BLOCKQUOTE><DIVCLASS="example"><H4CLASS="example"><ACLASS="title"NAME="FIRE-12-EX-1">Example 12.1: A Sample syslog File (Line Numbers Added)</A></H4><PRECLASS="programlisting"></PRE></DIV><PCLASS="para">Most of your logging will probably be done via the<SPANCLASS="acronym">UNIX</SPAN> <EMCLASS="emphasis"> syslog</EM> facility or someother similar file-based log mechanism. You'll need to developlog-scanning scripts to analyze each of these log files on a regularbasis. Some firewall packages, such as the <SPANCLASS="acronym">TIS FWTK</SPAN>, come with scripts to analyze and summarize their ownlogs. You could use these scripts as templates for your own logging,or you could write your own scripts from scratch in <EMCLASS="emphasis">awk,perl</EM>, or some other suitable language. <ACLASS="xref"HREF="ch05_01.htm"TITLE="Bastion Hosts">Chapter 5</A> discusses a package named<SPANCLASS="acronym">SWATCH</SPAN>, often used for log monitoring andanalysis.</P><PCLASS="para">As you can see, the log file is verbose and not particularlyreadable (even with better linebreaks inserted!). An unimportant errorcondition on a distant host (the server name mismatch on<EMCLASS="emphasis">nhs-relay.ac.cv</EM>) is producing multiple errormessages (11, 12, and 13, in this highly condensed version). The logfile is also in chronological order, which is not particularly the orderof importance. <ACLASS="xref"HREF="ch12_02.htm#FIRE-12-EX-2"TITLE="A Report Based on a syslog File">Example 12.2</A> shows a report based on alog file, with messages arranged in a more useful order, and somewhatsummarized.</P><DIVCLASS="example"><H4CLASS="example"><ACLASS="title"NAME="FIRE-12-EX-2">Example 12.2: A Report Based on a syslog File</A></H4><PRECLASS="programlisting"></PRE></DIV><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-21341"></A>In general, it's safer to write scripts to filter out messages to beignored (leaving unusual stuff), rather than writing scripts to identifythe unusual stuff directly. The reason for this is that you seldom knowall of the different messages your firewall might produce. It's easierto ignore the benign messages than to recognize the dangerous ones. </P><PCLASS="para">Log messages fall into three categories:<ULCLASS="itemizedlist"><LICLASS="listitem"><PCLASS="para"><EMCLASS="emphasis">Known to be <SPANCLASS="acronym">OK</SPAN></EM> (e.g.,&quot;login succeeded for user smith&quot;): Youwould like to ignore these. Message 3 is clearly in this category.</P></LI><LICLASS="listitem"><PCLASS="para"><EMCLASS="emphasis">Known to be dangerous</EM> (e.g.,&quot;bad disk block at location 0x47c7a8&quot;):You would like these to cause some action to happen; this may beanything from sending someone email, to submitting a trouble ticket,to paging you.</P></LI><LICLASS="listitem"><PCLASS="para"><EMCLASS="emphasis">Unknown</EM>: You would like these to be sent off fora human to examine. Message 18 is one of these; why is someone sending<SPANCLASS="acronym">UDP</SPAN> packets from port 20 to an arbitrary port above1024? That doesn't match any common protocol.</P></LI></UL></P><PCLASS="para">Setting up the criteria is an iterative process; once a human hasexamined a mystery message, future examples of that message canprobably be classified as either <SPANCLASS="acronym">OK</SPAN> or dangerouswithout being examined again. You'll change the rules as time goeson.</P><PCLASS="para">Often, log entries must be considered in context. A message that'smildly mysterious if it occurs once is cause for serious worry if itoccurs every minute. For example, &quot;login succeeded for usersmith&quot; is good, unless it's preceded by three &quot;loginfailed&quot; messages for every user above &quot;smith&quot; inyour password file; in that case, it's very bad indeed. In the<EMCLASS="emphasis">syslog</EM> example, message 9 shows an unexceptionaloutbound TCP connection, logged just on general principles. Itwouldn't be at all worrying if it weren't preceded by messages 6through 8. In context, you know that someone made three failed triesat logging in as &quot;admin,&quot; finally succeeded, and thenimmediately started up an outbound connection. This looks extremelysuspicious. Message 7 doesn't mean anything at all without context.<ACLASS="indexterm"NAME="AUTOID-21359"></A></P></DIV><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="FIRE-12-S2-6">12.2.3 The Good, the Bad, and the Ugly</A></H3><PCLASS="para">Once you go beyond the obvious (for example, it's<SPANCLASS="acronym">OK</SPAN> for users to log in; it's not<SPANCLASS="acronym">OK</SPAN> for the disk to be bad) how can you tell whenyou're in trouble? Some rules of thumb:<DLCLASS="variablelist"><DTCLASS="term"><EMCLASS="emphasis">Once is an accident; twice is coincidence; three timesis enemy action</EM></DT><DDCLASS="listitem"><PCLASS="para">One user who tries to log in at 2 <SPANCLASS="acronym">A.M.</SPAN> and fails isup too late and can't type. Two users who try to log in at 2<SPANCLASS="acronym">A.M.</SPAN> may have been at the same party, but you'recertainly going to be curious about the incident. Three or moreattempts to log in at 2 <SPANCLASS="acronym">A.M.</SPAN>, and someone is tryingto break in. This rule of thumb applies mostly to attempts on separateaccounts; stubborn repeated attempts by the same user to do the samething that doesn't work probably merely indicates that the user issingle-minded&nbsp;- and wrong.</P></DD><DTCLASS="term"><EMCLASS="emphasis">Accidents don't try to cover themselves up</EM></DT><DDCLASS="listitem"><PCLASS="para">If your log files are missing, if entries have been deleted, or if thereis any other evidence that somebody has been covering his tracks, youprobably have a break-in. If not, you have some other serious problem.(Either something is broken, or somebody administering the machine isdeleting things inappropriately.)</P></DD><DTCLASS="term"><EMCLASS="emphasis">Most mysteries don't mean anything</EM></DT><DDCLASS="listitem"><PCLASS="para">For everybody who sets out to track down a mysterious problem or astrange log entry, and finds an intruder, there are 99 people who setout to track down a mysterious problem or a strange log entry, and findan annoying but trivial bug. You should still try to track these thingsdown, but there's no need to panic.</P></DD><DTCLASS="term"><EMCLASS="emphasis">Straightforward explanations are usuallycorrect</EM></DT><DDCLASS="listitem"><PCLASS="para">It's possible that you were broken into at the same time you hadanother known problem, but it's not likely. If you know that you had ahardware failure, or a person wandering around doing misguided things, you'll want to spend some time ruling out side effects of theknown problem before you decide that you also have an intruder. On theother hand, if your files are mysteriously disappearing and there'snothing apparently wrong with your disk, somebody is probably deletingthem, and you'll want to spend a very long time ruling out an intruderbefore you decide that your filesystem code is buggy. </P></DD></DL></P><PCLASS="para">You're going to end up classifying suspicious events into severalcategories:<ULCLASS="itemizedlist"><LICLASS="listitem"><PCLASS="para">You know what caused it, and it's not a security problem.</P></LI><LICLASS="listitem"><PCLASS="para">You don't know what caused it, you're probably never going to knowwhat caused it, but whatever it was, it's not happening anymore.</P></LI><LICLASS="listitem"><PCLASS="para">Somebody was trying to break in, but not very hard; this is aprobe.</P></LI><LICLASS="listitem"><PCLASS="para">Somebody made a serious attempt to get in; this is an attack.</P></LI><LICLASS="listitem"><PCLASS="para">Somebody actually broke in.</P></LI></UL></P><PCLASS="para">The boundaries between these categories are vague. Unless you'redealing with messages from the first category (i.e., a knownnonproblem), it's going to come down to a judgment call most of thetime. It's impossible to provide an exhaustive list of the symptoms ofany of these situations, but here are some generalizations that mayhelp.</P><PCLASS="para">You should suspect that someone's been probing your site if you see:<ULCLASS="itemizedlist"><LICLASS="listitem"><PCLASS="para">A few attempts to access services at insecure ports (e.g.,attempts to contact <EMCLASS="emphasis">portmapper</EM> or an X server).</P></LI><LICLASS="listitem"><PCLASS="para">Attempts to log in with common account names (e.g.,<EMCLASS="emphasis">guest</EM> or <EMCLASS="emphasis">lp</EM>; most attemptsto log in as &quot;anonymous&quot; are mistakes).</P></LI><LICLASS="listitem"><PCLASS="para">Requests to <EMCLASS="emphasis">tftp</EM> files or to transfer<SPANCLASS="acronym">NIS</SPAN> maps.</P></LI><LICLASS="listitem"><PCLASS="para">Somebody feeding the <EMCLASS="emphasis">debug</EM> command to your<SPANCLASS="acronym">SMTP</SPAN> server.</P></LI></UL></P><PCLASS="para">You should be more concerned if you see any of the following; anattack may be going on:<ULCLASS="itemizedlist"><LICLASS="listitem"><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-21423"></A>Multiple failed attempts to log in to valid accounts on yourmachines, particularly accounts that are used across the Internet, orattempts on accounts in the order in which they appear in your passwordfile.</P></LI><LICLASS="listitem"><PCLASS="para">Unusual accepted packets or commands whose purpose you don'tunderstand. </P></LI><LICLASS="listitem"><PCLASS="para">Packets sent to every port in a range.</P></LI><LICLASS="listitem"><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-21432"></A>Successful logins from an unexpected site.</P></LI></UL></P><PCLASS="para">You should suspect a successful break-in if you see:<ULCLASS="itemizedlist"><LICLASS="listitem"><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-21439"></A>Deleted or modified log files.</P></LI><LICLASS="listitem"><PCLASS="para">Programs that suddenly omit expected information (this suggests thatthey have been replaced with versions that ignore the intruder's filesand programs). On <SPANCLASS="acronym">UNIX</SPAN> machines, the most frequentvictims are <EMCLASS="emphasis">ls</EM>, <EMCLASS="emphasis">ps</EM>, and<EMCLASS="emphasis">ifconfig</EM>.</P></LI><LICLASS="listitem"><PCLASS="para">New log files containing password information or packet tracesthat you can't explain.</P></LI><LICLASS="listitem"><PCLASS="para"> Directories that contain more administrative entriesthan they should. For example, on <SPANCLASS="acronym">UNIX</SPAN> machines,directories should contain two entries with names made out of periods(&quot;.&quot; and &quot;..&quot;, indicating &quot;thisdirectory&quot; and &quot;parent directory&quot;), but there shouldnot be more than two such entries (for instance, &quot;...&quot; or&quot;.. &quot;). If it looks as if there is more than one entry foreach, the extra entry probably has spaces in it and is being used toconceal the file or directory from casual observation.</P></LI><LICLASS="listitem"><PCLASS="para">Unexpected logins as privileged users (for example, root) orunexpected users who are suddenly able to become privileged users.</P></LI><LICLASS="listitem"><PCLASS="para">Apparent probes or attacks coming from your own machines. </P></LI><LICLASS="listitem"><PCLASS="para">Extra processes with names that are variants of common systemprocesses (e.g., both <EMCLASS="emphasis">sendmail</EM> and<EMCLASS="emphasis">Sendmail</EM> are running, or <EMCLASS="emphasis">init</EM> and <EMCLASS="emphasis">initd</EM>; this is another trick forsneaking things in where you won't notice them).</P></LI><LICLASS="listitem"><PCLASS="para">An unexpected change in the login prompt for your machine, or forother machines you reach from yours. This indicatesthe program that displays the prompt has been modified.</P></LI></UL></P></DIV><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="FIRE-12-S2-7">12.2.4 Responding to Probes</A></H3><PCLASS="para"><ACLASS="indexterm"NAME="CH12FWRESP"></A><ACLASS="indexterm"NAME="CH12PROBES"></A>Inevitably, you're going to detect apparent probes of yourfirewall&nbsp;- packets sent to services you don't offer to theInternet, attempts to log in to nonexistent accounts, and soon. Probes are the Internet equivalent of someone walking down a lineof doors and checking every door knob to see if it's locked. Probersgenerally try one or two things, and, if they don't get an interestingresponse, they move on.  If you're inclined to do so, you can spend alot of time chasing down incidents like this, attempting to figure outwhere the probes are coming from and who is behind them. However, inmost situations, it probably isn't worth the effort. The novelty ofchasing down probes of this kind fades quickly. If you're gettingpersistent probes from some site, you might contact the management ofthat site to let them know what's going on, but that's usually aboutas far as folks need to go in responding to these probes.</P><PCLASS="para">It's unfortunate that on the Internet today, probes are so frequent thatthe laissez faire attitude we've described is often an appropriate one.In good neighborhoods, people don't get away with trying doorknobs. Youhave a right to be unhappy with people who behave this way, and tryingto get them to stop is perfectly reasonable. However, you do need todecide where you're going to spend your energy. Save extreme responsesfor extreme situations. Treating probers with maximum harshness is justgoing to convince people that you are unreasonable. </P><PCLASS="para">Some people amuse themselves by setting up firewall machines to leadon people who try common probes. For example, they put a passwordfile in the anonymous <SPANCLASS="acronym">FTP</SPAN> area that appears tocontain user account data. However, if the prober breaks theencrypted passwords, he sees a snide message. This is a harmless wayto spend your spare time, and it provides a satisfactory feeling ofrevenge, but it doesn't actually improve your security much. Itsimply annoys attackers, and doing so may cause them to take apersonal interest in breaking into your site.</P><PCLASS="para">Different sites have different opinions about what constitutes aprobe, and what constitutes a full-fledged attack. Most people callsomething a probe as long as they know it's not going to work, even ifit is determined and drawn out. For example, somebody whodeterminedly tries every possible combination of lowercase alphabeticcharacters as your root password is not going to succeed, and canprobably be ignored as a probe until you get tired of reading the logmessages. (That kind of attack won't succeed, no matter howmany combinations are tried.) However, if you have the time and theenergy, it's probably worth pursuing people who are making determinedattempts, even when you know they'll fail.</P><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-21478"></A>There are several freely available packages that probe for knownvulnerabilities in a system. The most famous one these days is<SPANCLASS="acronym">SATAN</SPAN>, developed by Dan Farmer and WietseVenema. <SPANCLASS="acronym">SATAN</SPAN>, as distributed, does nothing butprobe; it does not take advantage of the vulnerabilities it looksfor.[2] On the other hand, there is no benign reason for anybodybut you to be running <SPANCLASS="acronym">SATAN</SPAN> against your site. Theprogram is highly configurable, and, therefore, it might have beenconfigured to probe for more obscurevulnerabilities. <SPANCLASS="acronym">SATAN</SPAN>'s probes will be detected bynormal firewall logging, either by packet filters rejecting thepackets or by the servers on the bastion host doing thesame. Specialized <SPANCLASS="acronym">SATAN</SPAN> detectors are nowavailable, but most of them rely on the ability to start up promiscuousmode on an Ethernet interface (which you should have disabled on yourbastion hosts). These detectors also distinguish<SPANCLASS="acronym">SATAN</SPAN> from random attempts by timing, which iseasily modified. If you already have reasonable logging turned on,running a <SPANCLASS="acronym">SATAN</SPAN> detector will not increase your security.</P><BLOCKQUOTECLASS="footnote"><PCLASS="para">[2] These are well-known vulnerabilities that you will be protectedagainst if you follow this book's advice and keep up with<SPANCLASS="acronym">CERT-CC</SPAN> advisories.</P></BLOCKQUOTE><PCLASS="para">Because <SPANCLASS="acronym">SATAN</SPAN> is widely available and does not posea threat to a firewalled site, it is reasonable to regard people whorun it as merely probing your system, rather than mounting adetermined attack. They have expended little effort and have littlechance of success. Probes based on the use of <SPANCLASS="acronym">SATAN</SPAN>will appear in your logs like any other probe&nbsp;- as a cluster ofrejected packets from the same source.<ACLASS="indexterm"NAME="AUTOID-21493"></A><ACLASS="indexterm"NAME="AUTOID-21494"></A></P></DIV><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="FIRE-12-S2-8">12.2.5 Responding to Attacks</A></H3><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-21498"></A>If your logs show that someone is making a determined attack againstyour system (see the rules of thumb we presented in &quot;The Good,the Bad, and the Ugly,&quot; earlier in this chapter), you probablywant to do a little more than sit back and watch. <ACLASS="xref"HREF="ch13_01.htm"TITLE="Responding to Security Incidents">Chapter 13</A> describes in detail how you should respond to areal security incident.</P></DIV><ACLASS="indexterm"NAME="AUTOID-21502"></A><ACLASS="indexterm"NAME="AUTOID-21503"></A></DIV><DIVCLASS="htmlnav"><P></P><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch12_01.htm"TITLE="12.1 Housekeeping"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 12.1 Housekeeping"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="book"HREF="index.htm"TITLE="Building Internet Firewalls"><IMGSRC="../gifs/txthome.gif"ALT="Building Internet Firewalls"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch12_03.htm"TITLE="12.3 Keeping Up to Date"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 12.3 Keeping Up to Date"BORDER="0"></A></TD></TR><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172">12.1 Housekeeping</TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="index"HREF="index/idx_a.htm"TITLE="Book Index"><IMGSRC="../gifs/index.gif"ALT="Book Index"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172">12.3 Keeping Up to Date</TD></TR></TABLE><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><PCLASS="nav"><FONTSIZE="-1">[ <AHREF="../index.htm"TITLE="The Networking CD Bookshelf">Library Home</A> | <AHREF="../dnsbind/index.htm"TITLE="DNS &amp; BIND">DNS &amp; BIND</A> | <AHREF="../tcpip/index.htm"TITLE="TCP/IP Network Administration">TCP/IP</A> | <AHREF="../sendmail/index.htm"TITLE="sendmail">sendmail</A> | <AHREF="../smdref/index.htm"TITLE="sendmail Desktop Reference">sendmail Reference</A> | <AHREF="index.htm"TITLE="Building Internet Firewalls">Firewalls</A> | <AHREF="../puis/index.htm"TITLE="Practical UNIX &amp; Internet Security">Practical Security</A> ]</FONT></P></DIV></BODY></HTML>