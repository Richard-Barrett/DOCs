<HTML><HEAD><TITLE>[Chapter 13] 13.3 Pursuing and Capturing the Intruder</TITLE><METANAME="DC.title"CONTENT="Building Internet Firewalls"><METANAME="DC.creator"CONTENT="D. Brent Chapman &amp; Elizabeth D. Zwicky"><METANAME="DC.publisher"CONTENT="O'Reilly &amp; Associates, Inc."><METANAME="DC.date"CONTENT="1999-02-04T00:29:57Z"><METANAME="DC.type"CONTENT="Text.Monograph"><METANAME="DC.format"CONTENT="text/html"SCHEME="MIME"><METANAME="DC.source"CONTENT="1-56592-124-0"SCHEME="ISBN"><METANAME="DC.language"CONTENT="en-US"><METANAME="generator"CONTENT="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><LINKREV="made"HREF="mailto:online-books@oreilly.com"TITLE="Online Books Comments"><LINKREL="up"HREF="ch13_01.htm"TITLE="13. Responding to Security Incidents"><LINKREL="prev"HREF="ch13_02.htm"TITLE="13.2 What To Do After an Incident"><LINKREL="next"HREF="ch13_04.htm"TITLE="13.4 Planning Your Response"></HEAD><BODYBGCOLOR="#FFFFFF"TEXT="#000000"><DIVCLASS="htmlnav"><H1><IMGSRC="gifs/smbanner.gif"ALT="Building Internet Firewalls"USEMAP="#srchmap"BORDER="0"></H1><MAPNAME="srchmap"><AREASHAPE="RECT"COORDS="0,0,466,65"HREF="index.htm"ALT="Building Internet Firewalls"><AREASHAPE="RECT"COORDS="467,0,514,18"HREF="../search/fsrch.htm"ALT="Search this book"></MAP><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch13_02.htm"TITLE="13.2 What To Do After an Incident"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 13.2 What To Do After an Incident"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><B><FONTFACE="ARIEL,HELVETICA,HELV,SANSERIF"SIZE="-1">Chapter 13<BR>Responding to Security Incidents</FONT></B></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch13_04.htm"TITLE="13.4 Planning Your Response"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 13.4 Planning Your Response"BORDER="0"></A></TD></TR></TABLE>&nbsp;<HRALIGN="LEFT"WIDTH="515"TITLE="footer"></DIV><DIVCLASS="SECT1"><H2CLASS="sect1"><ACLASS="title"NAME="FIRE-13-S1-3">13.3 Pursuing and Capturing theIntruder</A></H2><PCLASS="para"><ACLASS="indexterm"NAME="CH13INTPUR"></A><ACLASS="indexterm"NAME="CH13PURS"></A><ACLASS="indexterm"NAME="CH13CAPT"></A>If you discover a security incident&nbsp;- particularly one inprogress&nbsp;- you're going to be tempted to go gunning for the bad guyswho are invading your system.</P><PCLASS="para">Going after the bad guys has a certain emotional appeal, but it'sgenerally not very practical. There are a variety of approaches you cantake, but there are also a variety of technical and legal hurdles.</P><PCLASS="para">For an appreciation of the problems involved in hunting down anintruder, see Cliff Stoll's book, <EMCLASS="emphasis">The Cuckoo'sEgg</EM>. In the late 1980s, Cliff was a system manager atLawrence Berkeley Labs. While tracking down a minor inconsistency inthe accounting system <SPANCLASS="acronym">LBL</SPAN> used for computer timebilling, he discovered evidence that an intruder had broken in overthe Internet. He spent the next many months on an odyssey trying tochase down the attackers. Although Cliff succeeded admirably (andwrote an entertaining and useful book to boot), few of us are going tobe able to emulate his feats. Most sites just don't have the time andresources to track their attackers the way Cliff did; most are goingto have to be satisfied with simply getting them off their systems.</P><PCLASS="para">There are two main problems in tracking down intruders; one istechnical and the other is legal.</P><PCLASS="para">The first problem is that tracking an attack back to its ultimatesource is usually technically difficult. It's usually easy to tellwhat site an attack came from (simply by looking at the<SPANCLASS="acronym">IP</SPAN> addresses the attacker's packets are comingfrom), but once you find the apparent source of the attack, youusually find out that the attack isn't really being carried out by auser from that site. Instead, it's very likely that the site hasitself been broken into, and it's being used as a base by the personwho attacked you.</P><PCLASS="para">If that site traces its own break-in, it will usually discover thesame thing: the attacker isn't wherever the attacks appear to becoming from. Moreover, where the attacks appear to be coming from issimply another site in the chain that's been broken into. Each link inthe chain between the attacker and you involves more sites and morepeople.  There is a practical limit to how far back you can tracesomeone in a reasonable period of time. Eventually, you're probablygoing to run into a site in the chain that you can't get in touchwith, or that doesn't have the time or expertise to pursue the matter,or that simply doesn't care about the attack or about you. As <ACLASS="xref"HREF="ch13_03.htm#FIRE-13-FIG-1"TITLE="A network connection has many links">Figure 13.1</A> illustrates, these are many links in anynetwork connection.</P><H4CLASS="figure"><ACLASS="title"NAME="FIRE-13-FIG-1">Figure 13.1: A network connection has many links</A></H4><IMGCLASS="graphic"SRC="figs/fire1301.gif"ALT="Figure 13.1"><PCLASS="para">Furthermore, at some link in the chain, you are likely to discover thatthe attacker is coming in over a telephone line, and tracing telephonecalls involves whole new realms of technical and legal problems.</P><PCLASS="para">You may well find the same attacker coming in from multiple sites. Inone incident, responders kept correcting each other, until theyrealized that nobody was confused; one set of people was referring to<SPANCLASS="acronym">SFU</SPAN> (Simon Fraser University, inCanada) and the other to <SPANCLASS="acronym">FSU</SPAN> (FloridaState University). The similarity of the abbreviations had momentarilyconcealed the fact that there were two separate sites, physicallydistant from each other, being concurrently used by the sameattacker. The attacker had not started from either of them, and when<SPANCLASS="acronym">SFU</SPAN> and <SPANCLASS="acronym">FSU</SPAN> closed down access,identical attacks starting occurring from other sites.</P><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-21903"></A>Be wary when using email or voicemail to contact administrators atother sites when tracking down an intruder. How do you know it'sreally the administrator that's receiving and responding to yourmessages and not the intruder? Even if you're sure that you'retalking to the administrator of a site, maybe the intruder<EMCLASS="emphasis">is</EM> the administrator.</P><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-21908"></A>The second problem is legal. You might contemplate leaving your site&quot;open,&quot; even after you're aware of the attacker, in hopesof tracking him down while he's using your site. This may seem like aclever idea; after all, if you shut down your system or disconnect itfrom the Internet, the attacker will know he's been discovered,and it will be much harder for you to track him down.</P><PCLASS="para">The problem is this: leaving your site open doesn't just risk furtherloss or damage at your own site. What the attacker is probably doingat your site is using it as a base to attack other sites. If you'reaware of this, and do nothing to prevent it, those other sites mighthave grounds to sue you and your organization for negligence or foraiding the attacker.</P><PCLASS="para">If you're dealing with someone who's attacking your systemunsuccessfully, there's less risk. It's polite to inform the site thatthe attacker is apparently coming from, so the system administratorsthere can do their own checking. It also lets you straighten outpeople who aren't really trying to break in, but are just veryconfused.  For example, attempts to log in as&quot;anonymous&quot;, even extremely persistent ones, usuallycome from people who have confused <SPANCLASS="acronym">FTP</SPAN> with Telnetand simply need better advice. Most sites are grateful to be told thatthere are attacks coming from them, but don't be surprised ifuniversities seem somewhat bored to hear the news. Although they willusually follow up, large universities see these incidents all thetime.</P><PCLASS="para">You'll also find that the occasional site is uninterested, hostile, orincapable of figuring out what you're talking about, and it's notworth your time to worry about them unless the attacks from them arepersistent, determined, and technically competent enough to have achance of succeeding. In this case, you should enlist the assistanceof a response team.<ACLASS="indexterm"NAME="AUTOID-21915"></A><ACLASS="indexterm"NAME="AUTOID-21916"></A><ACLASS="indexterm"NAME="AUTOID-21917"></A></P></DIV><DIVCLASS="htmlnav"><P></P><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch13_02.htm"TITLE="13.2 What To Do After an Incident"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 13.2 What To Do After an Incident"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="book"HREF="index.htm"TITLE="Building Internet Firewalls"><IMGSRC="../gifs/txthome.gif"ALT="Building Internet Firewalls"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch13_04.htm"TITLE="13.4 Planning Your Response"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 13.4 Planning Your Response"BORDER="0"></A></TD></TR><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172">13.2 What To Do After an Incident</TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="index"HREF="index/idx_a.htm"TITLE="Book Index"><IMGSRC="../gifs/index.gif"ALT="Book Index"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172">13.4 Planning Your Response</TD></TR></TABLE><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><PCLASS="nav"><FONTSIZE="-1">[ <AHREF="../index.htm"TITLE="The Networking CD Bookshelf">Library Home</A> | <AHREF="../dnsbind/index.htm"TITLE="DNS &amp; BIND">DNS &amp; BIND</A> | <AHREF="../tcpip/index.htm"TITLE="TCP/IP Network Administration">TCP/IP</A> | <AHREF="../sendmail/index.htm"TITLE="sendmail">sendmail</A> | <AHREF="../smdref/index.htm"TITLE="sendmail Desktop Reference">sendmail Reference</A> | <AHREF="index.htm"TITLE="Building Internet Firewalls">Firewalls</A> | <AHREF="../puis/index.htm"TITLE="Practical UNIX &amp; Internet Security">Practical Security</A> ]</FONT></P></DIV></BODY></HTML>