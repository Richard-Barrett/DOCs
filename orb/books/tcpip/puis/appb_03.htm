<HTML><HEAD><TITLE>[Appendix B] B.3 SUID and SGID Files</TITLE><METANAME="DC.title"CONTENT="Practical UNIX &amp; Internet Security"><METANAME="DC.creator"CONTENT="Simson Garfinkel &amp; Gene Spafford"><METANAME="DC.publisher"CONTENT="O'Reilly &amp; Associates, Inc."><METANAME="DC.date"CONTENT="1999-02-04T00:21:55Z"><METANAME="DC.type"CONTENT="Text.Monograph"><METANAME="DC.format"CONTENT="text/html"SCHEME="MIME"><METANAME="DC.source"CONTENT="1-56592-148-8"SCHEME="ISBN"><METANAME="DC.language"CONTENT="en-US"><METANAME="generator"CONTENT="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><LINKREV="made"HREF="mailto:online-books@oreilly.com"TITLE="Online Books Comments"><LINKREL="up"HREF="appb_01.htm"TITLE="B. Important Files"><LINKREL="prev"HREF="appb_02.htm"TITLE="B.2 Important Files in Your Home Directory"><LINKREL="next"HREF="appc_01.htm"TITLE="C. UNIX Processes"></HEAD><BODYBGCOLOR="#FFFFFF"TEXT="#000000"><DIVCLASS="htmlnav"><H1><IMGSRC="gifs/smbanner.gif"ALT="Practical UNIX &amp; Internet Security"USEMAP="#srchmap"BORDER="0"></H1><MAPNAME="srchmap"><AREASHAPE="RECT"COORDS="0,0,466,65"HREF="index.htm"ALT="Practical UNIX &amp; Internet Security"><AREASHAPE="RECT"COORDS="467,0,514,18"HREF="../search/psrch.htm"ALT="Search this book"></MAP><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="appb_02.htm"TITLE="B.2 Important Files in Your Home Directory"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: B.2 Important Files in Your Home Directory"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><B><FONTFACE="ARIEL,HELVETICA,HELV,SANSERIF"SIZE="-1">Appendix B<BR>Important Files</FONT></B></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="APPENDIX"HREF="appc_01.htm"TITLE="C. UNIX Processes"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: C. UNIX Processes"BORDER="0"></A></TD></TR></TABLE>&nbsp;<HRALIGN="LEFT"WIDTH="515"TITLE="footer"></DIV><DIVCLASS="SECT1"><H2CLASS="sect1"><ACLASS="title"NAME="PUIS-APP-B-SECT-3">B.3 SUID and SGID Files</A></H2><PCLASS="para">To run a secure computer, you must know of every <SPANCLASS="acronym">SUID</SPAN>and <SPANCLASS="acronym">SGID</SPAN> file on the system and be sure thateach file has the proper permissions for which it was designed.</P><PCLASS="para">Unfortunately, <ACLASS="indexterm"NAME="AUTOID-38504"></A><ACLASS="indexterm"NAME="AUTOID-38507"></A><ACLASS="indexterm"NAME="AUTOID-38509"></A>there is a hugeamount of variation among <SPANCLASS="acronym">UNIX</SPAN> vendors in theuse of <SPANCLASS="acronym">SUID</SPAN> and <SPANCLASS="acronym">SGID</SPAN>. Somemanufacturers use <SPANCLASS="acronym">SUID</SPAN> <ICLASS="filename"><ICLASS="filename">root</I> </I>forall privilege-requiring programs, while some create special groupsfor controlling terminals (group <KBDCLASS="command">tty</KBD>), or disks (group <ICLASS="filename">operator</I>),or memory (group <ICLASS="filename">kmem</I>). Some vendors use a variety of approaches.Most change their approaches to <SPANCLASS="acronym">SUID</SPAN> and <SPANCLASS="acronym">SGID</SPAN>from software release to software release. As a result, any attemptto list <SPANCLASS="acronym">SUID</SPAN> and <SPANCLASS="acronym">SGID</SPAN> fileson a system that is not constrained to a particular release is likelyto be incomplete.</P><PCLASS="para">You may also receive <SPANCLASS="acronym">SUID</SPAN> or <SPANCLASS="acronym">SGID</SPAN>files as part of third-party software that you may purchase or downloadfrom the net. Many of these third-party programs require <SPANCLASS="acronym">SUID</SPAN><ICLASS="filename">root</I> permission because they modify devices or do things on behalfof users. If you choose to use these programs, you should seek assurancefrom the vendor that superuser privileges are confined to the smallestpossible region of the program, and that, in general, rules suchas those contained in <ACLASS="xref"HREF="ch23_01.htm"TITLE="Writing Secure SUID and Network Programs">Chapter 23, <CITECLASS="chapter">Writing Secure SUID and Network Programs</CITE></A>, have been followedin coding the software. You may also wish to obtain written representationsfrom the vendor that the security of the computer system will notbe compromised as a result of <SPANCLASS="acronym">SUID/SGID</SPAN> programs,and that, in the event that the system is compromised, the vendorwill pay for damages.</P><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="PUIS-APP-B-SECT-3.1">B.3.1 SUID/SGID Files in Solaris 2.4 (SVR4)</A></H3><PCLASS="para">This section contains a list of the <SPANCLASS="acronym">SUID</SPAN>and <SPANCLASS="acronym">SGID</SPAN> files found in Solaris 2.4, which isrepresentative of System V Release 4 systems in general. Ratherthan simply presenting a complete list of files, we have annotatedthe reason that <SPANCLASS="acronym">SUID</SPAN> or <SPANCLASS="acronym">SGID</SPAN>permissions are set. Our goal is to teach you how to recognize the<SPANCLASS="acronym">SUID/SGID</SPAN> files on your system, and make yourown decision as to whether the privilege is justified, or whethersome lesser privilege would suffice.</P><PCLASS="para">You can generate your own list of <SPANCLASS="acronym">SUID</SPAN>files by using the command:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen"># find / -type f -perm -04000 -ls</PRE></BLOCKQUOTE><PCLASS="para">You can generate a list of <SPANCLASS="acronym">SGID</SPAN> files byusing the command:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen"># find / -type f -perm -02000 -ls</PRE></BLOCKQUOTE><DIVCLASS="sect3"><H4CLASS="sect3"><ACLASS="title"NAME="PUIS-APP-B-SECT-3.1.1">B.3.1.1 SUID files</A></H4><BLOCKQUOTECLASS="screen"><PRECLASS="screen">-r-sr-xr-x   1 root     sys       610480 Aug  3  1994 /sbin/su-r-sr-xr-x   1 root     bin       559968 Aug  3  1994 /sbin/sulogin-r-sr-xr-x   1 root     sys        15156 Jul 16  1994 /usr/bin/su</PRE></BLOCKQUOTE><PCLASS="para">The<ICLASS="filename"> su</I> command is <SPANCLASS="acronym">SUID</SPAN><ICLASS="filename">root</I> so it can alter the process's effective <SPANCLASS="acronym">UID</SPAN>.We don't understand why <KBDCLASS="command">sulogin</KBD> needs to be <SPANCLASS="acronym">SUID</SPAN><ICLASS="filename">root</I>, because it is only run when the system boots in single-usermode (and, presumably, it is already running as <ICLASS="filename">root</I>). The <ICLASS="filename">/sbin/su</I>program is statically linked, which is why it is so much largerthan <ICLASS="filename">/usr/bin/su</I>, which uses shared libraries.</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">-rwsr-xr-x   1 root     sys        32144 Jul 15  1994 /usr/bin/at-rwsr-xr-x   1 root     sys        12128 Jul 15  1994 /usr/bin/atq-rwsr-xr-x   1 root     sys        10712 Jul 15  1994 /usr/bin/atrm</PRE></BLOCKQUOTE><PCLASS="para">The <KBDCLASS="command">at</KBD> commands are <SPANCLASS="acronym">SUID</SPAN> <ICLASS="filename">root</I> because theyrun commands for all user IDs, and need <ICLASS="filename">root</I> permissions to setthe user and group permissions of jobs. Additionally, the directorywhere these jobs are stored is protected to prevent snooping andtampering with the files, and <ICLASS="filename">root</I> permissions are used to enforcethese protections.</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">-r-sr-xr-x   1 root     sys        29976 Jul 16  1994 /usr/bin/chkey</PRE></BLOCKQUOTE><PCLASS="para">The chkey command is <SPANCLASS="acronym">SUID</SPAN> <ICLASS="filename">root</I> becauseit accesses the <ICLASS="filename">/etc/publickey </I>database.</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">-r-sr-xr-x   1 root     bin        14600 Jul 15  1994 /usr/bin/<KBDCLASS="command">cron</KBD></PRE></BLOCKQUOTE><PCLASS="para">The cron program is <SPANCLASS="acronym">SUID</SPAN> <ICLASS="filename">root</I> so that itcan alter files in the <ICLASS="filename">/var/spool/cron</I> directory.As with the <ICLASS="filename">at </I>commands above, it also runsjobs under different user IDs and needs <ICLASS="filename">root</I> privileges to do so.</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">-r-sr-xr-x   1 root     bin         9880 Jul 16  1994 /usr/bin/eject-r-sr-xr-x   1 root     bin        22872 Jul 16  1994 /usr/bin/fdformat-r-sr-xr-x   1 root     bin         4872 Jul 16  1994 /usr/bin/volcheck</PRE></BLOCKQUOTE><PCLASS="para">These programs are <SPANCLASS="acronym">SUID</SPAN> <ICLASS="filename">root</I> because theydirectly manipulate the floppy disk device.</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">-r-sr-xr-x   1 root     bin        27260 Jul 16  1994 /usr/bin/login</PRE></BLOCKQUOTE><PCLASS="para">login must be <SPANCLASS="acronym">SUID</SPAN> <ICLASS="filename">root</I> so that one usercan use <KBDCLASS="command">login</KBD> to log in as another user without first logging out.If <KBDCLASS="command">login</KBD> were not <SPANCLASS="acronym">SUID</SPAN> <ICLASS="filename">root</I>, it could not changeits real and effective <SPANCLASS="acronym">UID</SPAN> to be that of anotheruser. If the program is not <SPANCLASS="acronym">SUID</SPAN>, then usersneed to log out before logging in as another user&nbsp;- a minorinconvenience. Many site administrators prefer this behavior andremove the <SPANCLASS="acronym">SUID</SPAN> permission on <KBDCLASS="command">login</KBD> as a result.</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">-rwsr-xr-x   1 root     sys         9520 Jul 16  1994 /usr/bin/newgrp</PRE></BLOCKQUOTE><PCLASS="para"><KBDCLASS="command">newgrp</KBD> is <SPANCLASS="acronym">SUID</SPAN> <ICLASS="filename">root</I> because it must alterthe process's effective and real group IDs (<SPANCLASS="acronym">GIDS</SPAN>).</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">-r-sr-sr-x   1 root     sys        11680 Jul 16  1994 /usr/bin/passwd</PRE></BLOCKQUOTE><PCLASS="para">This program must be <SPANCLASS="acronym">SUID</SPAN> <ICLASS="filename">root</I> becauseit modifies the <ICLASS="filename">/etc/passwd</I> or <ICLASS="filename">/etc/shadow</I> files.</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">-r-sr-xr-x   1 root     sys        17800 Jul 16  1994 /usr/bin/ps-r-sr-xr-x   1 root     bin        12080 Jul 16  1994 /usr/sbin/whodo</PRE></BLOCKQUOTE><PCLASS="para">These programs are <SPANCLASS="acronym">SUID</SPAN> <ICLASS="filename">root</I> because theyneed access to the computer's <ICLASS="filename">/dev/mem</I>and <ICLASS="filename">/dev/kmem </I>devices, and to access some accountingfiles. Perhaps a safer approach would be to have a <ICLASS="filename">kmem</I> group andhave needed files be <SPANCLASS="acronym">SGID</SPAN> <ICLASS="filename">kmem.</I></P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">-r-sr-xr-x   1 root     bin        15608 Jul 15  1994 /usr/bin/rcp-r-sr-xr-x   1 root     bin        60268 Jul 15  1994 /usr/bin/rdist-r-sr-xr-x   1 root     bin        14536 Jul 15  1994 /usr/bin/rlogin-r-sr-xr-x   1 root     bin         7920 Jul 15  1994 /usr/bin/rsh-rwsr-xr-x   1 root     other       7728 Jul 16  1994 /usr/bin/yppasswd-r-sr-x--x   1 root     bin       134832 Jul 16  1994 /usr/lib/sendmail-r-sr-x--x   1 root     bin       137552 Jul 16  1994 /usr/lib/sendmail.mx-r-sr-xr-x   1 root     bin        17968 Jul 15  1994 /usr/sbin/ping-r-sr-xr-x   1 root     bin       510532 Jul 15  1994 /usr/sbin/static/rcp</PRE></BLOCKQUOTE><PCLASS="para">In general, these programs are all <SPANCLASS="acronym">SUID</SPAN><ICLASS="filename">root</I> because they need to create <SPANCLASS="acronym">TCP/IP</SPAN> connectionson ports below 1024. The sendmail program also needs the abilityto modify files stored in its working directories. The <KBDCLASS="command">ping</KBD> programneeds to use raw IP.</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">-rws--x--x   1 uucp     bin        55608 Jul 16  1994 /usr/bin/tip---s--x--x   1 root     uucp       68816 Jul 15  1994 /usr/bin/ct---s--x--x   1 uucp     uucp       81904 Jul 15  1994 /usr/bin/cu</PRE></BLOCKQUOTE><PCLASS="para">These programs are <SPANCLASS="acronym">SUID</SPAN> <KBDCLASS="command">uucp</KBD> so that theycan access the dialer and modem devices.</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">-r-sr-xr-x   2 <ICLASS="filename">root</I>     bin        10888 Jul 16  1994 /usr/bin/uptime-r-sr-xr-x   2 <ICLASS="filename">root</I>     bin        10888 Jul 16  1994 /usr/bin/w</PRE></BLOCKQUOTE><PCLASS="para">We can't figure out why these programs are <SPANCLASS="acronym">SUID</SPAN><ICLASS="filename">root</I>, as they access files (<ICLASS="filename">/var/adm/utmp </I>and<ICLASS="filename">/dev/kstat</I>) that are world-readable. Theseare hard links which you can verify by using ls -li.</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">---s--x--x   1 uucp     uucp     64240 Jul 15  1994 /usr/bin/uucp---s--x--x   1 uucp     uucp     21304 Jul 15  1994 /usr/bin/uuglist---s--x--x   1 uucp     uucp     17144 Jul 15  1994 /usr/bin/uuname---s--x--x   1 uucp     uucp     60952 Jul 15  1994 /usr/bin/uustat---s--x--x   1 uucp     uucp     68040 Jul 15  1994 /usr/bin/uux---s--x--x   1 uucp     uucp      4816 Jul 15  1994 /usr/lib/uucp/remote.unknown---s--x--x   1 uucp     uucp    169096 Jul 15  1994 /usr/lib/uucp/uucico---s--x--x   1 uucp     uucp     32016 Jul 15  1994 /usr/lib/uucp/uusched---s--x--x   1 uucp     uucp     81040 Jul 15  1994 /usr/lib/uucp/uuxqt</PRE></BLOCKQUOTE><PCLASS="para">These programs are <SPANCLASS="acronym">SUID</SPAN> <KBDCLASS="command">uucp</KBD> because theyneed to access privileged <SPANCLASS="acronym">UUCP</SPAN> directories andfiles.</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">-r-sr-xr-x   1 root     bin        21496 Jul 16  1994 /usr/lib/exrecover</PRE></BLOCKQUOTE><PCLASS="para">This file is <SPANCLASS="acronym">SUID</SPAN> <ICLASS="filename">root</I> so that it can accessthe directory in which editor recovery files are saved. As we havesaid in other places in the book, a more secure approach would beto have an account specifically created for accessing this directory,or to create user-owned subdirectories in a common save directory.</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">-r-sr-sr-x   1 root     tty       151352 Jul 15  1994 /usr/lib/fs/ufs/ufsdump-r-sr-xr-x   1 root     bin       605348 Jul 15  1994 /usr/lib/fs/ufs/ufsrestore</PRE></BLOCKQUOTE><PCLASS="para">These files are <SPANCLASS="acronym">SUID</SPAN> <ICLASS="filename">root</I> so that usersother than the superuser can make backups. In the Solaris versionof these commands, any user who is in the <KBDCLASS="command">sys</KBD> group can dump thecontents of the system's disks and restore them withouthaving <ICLASS="filename">root</I> access. (As a result, having sys access on this operatingsystem means that you can effectively read any file on the computerby using a combination of <KBDCLASS="command">ufsdump</KBD> and <KBDCLASS="command">ufsrestore</KBD>.) Note: the factthat users in the sys group can dump and undump tapes is not documentedin the <KBDCLASS="command">man</KBD> page. Other programs may give undocumented privilegesto users who happen to be in particular groups.</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">-rwsr-xr-x   1 root     adm         4008 Jul 15  1994 /usr/lib/acct/accton</PRE></BLOCKQUOTE><PCLASS="para">There must be some reason that this program is <SPANCLASS="acronym">SUID</SPAN><ICLASS="filename">root</I>. But, once again, we can't figure it out, as the programgives the error &quot;permission denied&quot; when it isrun by anybody other than the superuser.</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">-rwsr-xr-x   3 root     bin        13944 Jul 16  1994 /usr/sbin/allocate-rwsr-xr-x   3 root     bin        13944 Jul 16  1994 /usr/sbin/deallocate-rwsr-xr-x   3 root     bin        13944 Jul 16  1994 /usr/sbin/list_devices</PRE></BLOCKQUOTE><PCLASS="para">The <KBDCLASS="command">allocate</KBD> command allocates devices to users based on theSolaris allocation mechanism. For more information, refer to theSolaris documentation. We believe that the <KBDCLASS="command">mkdevalloc</KBD> and <KBDCLASS="command">mkdevmaps</KBD>commands are part of the same system, but they are not documented.</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">-rwsr-xr-x   1 root     sys        21600 Jul 16  1994 /usr/sbin/sacadm</PRE></BLOCKQUOTE><PCLASS="para">The <KBDCLASS="command">sacadm</KBD> is the top-level entry point into the Service AccessFacility system.</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">-rwsrwxr-x   1 root     bin        87808 Jun 24  1994 /usr/openwin/bin/xlock</PRE></BLOCKQUOTE><PCLASS="para">We think that <KBDCLASS="command">xlock</KBD> needs to be <SPANCLASS="acronym">SUID</SPAN> <ICLASS="filename">root</I>so that it can read your password from the shadow file.</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">-r-sr-sr-x   1 root     sys        20968 Jun 27  1995 /usr/dt/bin/dtaction-r-sr-xr-x   1 root     bin        69172 Jun 27  1995 /usr/dt/bin/dtappgather-r-sr-xr-x   1 root     bin       134600 Jun 27  1995 /usr/dt/bin/dtsession-r-sr-xr-x   1 root     bin       373332 Jun 27  1995 /usr/dt/bin/dtprintinfo-r-sr-sr-x   1 root     daemon    278060 Jun 27  1995 /usr/dt/bin/sdtcm_convert</PRE></BLOCKQUOTE><PCLASS="para">These programs all appear to perform session management aspart of the Common Desktop Environment 1.0. We don't knowwhy <KBDCLASS="command">dtaction</KBD> needs to be <SPANCLASS="acronym">SUID</SPAN> <ICLASS="filename">root</I>.</P></DIV><DIVCLASS="sect3"><H4CLASS="sect3"><ACLASS="title"NAME="PUIS-APP-B-SECT-3.1.2">B.3.1.2 Undocumented SUID programs</A></H4><PCLASS="para">The following programs are <SPANCLASS="acronym">SUID</SPAN> and undocumented.This combination is dangerous, because there is no way to tell forsure what these programs are supposed to do, if they have their<SPANCLASS="acronym">SUID/SGID</SPAN> bits properly set, or if they are evenpart of the standard operating system release.</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">---s--x--x   1 root     bin         3116 Jul 16  1994 /usr/lib/pt_chmod-r-sr-xr-x   1 root     bin         5848 Jul 16  1994 /usr/lib/utmp_update-rwsr-xr-x   1 root     bin         8668 Jul 16  1994 /usr/sbin/mkdevalloc-rwsr-xr-x   1 root     bin         9188 Jul 16  1994 /usr/sbin/mkdevmaps-r-sr-sr-x   1 root     bin        14592 Jul 15  1994 /usr/openwin/bin/ff.core-rwsr-xr-x   1 root     bin        19580 Jun 24  1994 /usr/openwin/lib/mkcookie-rwsr-sr-x   1 bin      bin         8288 Jul 16  1994 /usr/vmsys/bin/chkperm-r-sr-xr-x   1 lp       lp           203 Jul 18  1994 /etc/lp/alerts/printer</PRE></BLOCKQUOTE></DIV><DIVCLASS="sect3"><H4CLASS="sect3"><ACLASS="title"NAME="PUIS-APP-B-SECT-3.1.3">B.3.1.3 SGID files</A></H4><BLOCKQUOTECLASS="screen"><PRECLASS="screen">-rwxr-sr-x   1 root     sys       147832 Jul 15  1994 /usr/kvm/crash-r-xr-sr-x   1 bin      sys        31440 Jul 15  1994 /usr/bin/netstat-r-xr-sr-x   1 bin      sys        11856 Jul 16  1994 /usr/bin/nfsstat-r-xr-sr-x   1 bin      sys        11224 Jul 16  1994 /usr/bin/ipcs-r-xr-sr-x   1 root     bin         6912 Jul 15  1994 /usr/sbin/arp-r-xr-sr-x   1 bin      sys         6280 Jul 16  1994 /usr/sbin/fusage-r-xr-sr-x   1 root     sys        15128 Jul 16  1994 /usr/sbin/prtconf-r-xr-sr-x   1 bin      sys         7192 Jul 16  1994 /usr/sbin/swap-r-xr-sr-x   1 root     sys        21416 Jul 16  1994 /usr/sbin/sysdef-r-xr-sr-x   1 bin      sys         5520 Jul 15  1994 /usr/sbin/dmesg-rwxr-sr-x   1 root     sys        12552 Jul 18  1994 /usr/openwin/bin/wsinfo-rwxrwsr-x   1 root     sys         9272 Jul 18  1994 /usr/openwin/bin/xload</PRE></BLOCKQUOTE><PCLASS="para">These programs examine and/or modify memory of therunning system and use group permissions to read the necessary devicefiles.</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">-r-xr-sr-x   1 bin      sys        28696 Jul 16  1994 /usr/kvm/eeprom</PRE></BLOCKQUOTE><PCLASS="para">The <KBDCLASS="command">eeprom</KBD> program allows you to view or modify the contentsof the system's <SPANCLASS="acronym">EEPROM</SPAN>. It should probablynot be executable by non-root users.</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">-r-x--s--x   1 bin      mail       65408 Jul 16  1994 /usr/bin/mail-r-x--s--x   1 bin      mail      132888 Jul 16  1994 /usr/bin/mailx-r-xr-sr-x   1 root     mail      449960 Jul 15  1994 /usr/openwin/bin/mailtool-r-xr-sr-x   1 bin      mail      825220 Jun 27  1995 /usr/dt/bin/dtmail-r-xr-sr-x   1 bin      mail      262708 Jun 27  1995 /usr/dt/bin/dtmailpr</PRE></BLOCKQUOTE><PCLASS="para">The mail programs can be used to send mail or read mail inthe <ICLASS="filename">/var/mail</I> directory. We are not certain whythese programs need to be <SPANCLASS="acronym">SGID</SPAN> <KBDCLASS="command">mail</KBD>,; however,we suspect it involves lock management.</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">-r-sr-sr-x   1 root     sys        20968 Jun 27  1995 /usr/dt/bin/dtaction</PRE></BLOCKQUOTE><PCLASS="para">This is another part of the Common Desktop Environment system.We don't know why it is both <SPANCLASS="acronym">SUID</SPAN> and<SPANCLASS="acronym">SGID</SPAN>.</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">-r-sr-sr-x   1 root     sys        11680 Jul 16  1994 /usr/bin/passwd</PRE></BLOCKQUOTE><PCLASS="para">We do not know why this program needs to be both <SPANCLASS="acronym">SUID</SPAN><ICLASS="filename">root</I> and <SPANCLASS="acronym">SGID</SPAN> <KBDCLASS="command">sys</KBD>.</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">-r-xr-sr-x   1 bin      tty       9984 Jul 16  1994 /usr/bin/write-r-sr-sr-x   1 root     tty     151352 Jul 15  1994 /usr/lib/fs/ufs/ufsdump-r-xr-sr-x   1 bin      tty       9296 Jul 16  1994 /usr/sbin/wall</PRE></BLOCKQUOTE><PCLASS="para">These programs are <SPANCLASS="acronym">SGID</SPAN> <KBDCLASS="command">tty</KBD> so that theycan write on the devices of users.</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">-rwxr-sr-x   1 root     root      650620 Jun 24  1994 /usr/openwin/bin/Xsun</PRE></BLOCKQUOTE><PCLASS="para"><ICLASS="filename">Xsun</I> is the X-Window server for the Sun. It is <SPANCLASS="acronym">SGID</SPAN>so that it can access necessary device files.</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">-r-sr-sr-x   1 root   daemon  278060 Jun 27  1995 /usr/dt/bin/sdtcm_convert</PRE></BLOCKQUOTE><PCLASS="para">This program converts files from the Open Windows calendardata format version 3 to version 4. According to the documentation,<KBDCLASS="command">sdtcm_convert</KBD> must be run by the superuser or the ownerof the calendar. Users can only run the program on their own calendars;the superuser can run the program on any calendar. Because the <ICLASS="filename">/var/spool/calendar</I>directory is mode 3777, there should be no reason for this programto be <SPANCLASS="acronym">SUID</SPAN> or <SPANCLASS="acronym">SGID</SPAN>.</P></DIV><DIVCLASS="sect3"><H4CLASS="sect3"><ACLASS="title"NAME="PUIS-APP-B-SECT-3.1.4">B.3.1.4 Undocumented SGID files</A></H4><PCLASS="para">These files are not documented in the Solaris system documentation:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">-r-sr-sr-x   1 root     bin        14592 Jul 15  1994 /usr/openwin/bin/ff.core-rwsr-sr-x   1 bin      bin         8288 Jul 16  1994 /usr/vmsys/bin/chkperm</PRE></BLOCKQUOTE></DIV></DIV><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="PUIS-APP-B-SECT-3.2">B.3.2 SUID/SGID Files in Berkeley UNIX</A></H3><PCLASS="para">This list of <SPANCLASS="acronym">SUID</SPAN> and <SPANCLASS="acronym">SGID</SPAN>files in Berkeley <SPANCLASS="acronym">UNIX</SPAN> was derived by lookingat computers made by Sun Microsystems, Digital Equipment Corporation,and NeXT Inc. The list of <SPANCLASS="acronym">SUID</SPAN> and <SPANCLASS="acronym">SGID</SPAN>files on your version of Berkeley <SPANCLASS="acronym">UNIX</SPAN> is likelyto be different. For this reason, we not only list <EMCLASS="emphasis">which</EM> files are <SPANCLASS="acronym">SUID</SPAN> and <SPANCLASS="acronym">SGID</SPAN>,we also explain <EMCLASS="emphasis">why </EM>they are <SPANCLASS="acronym">SUID</SPAN>or <SPANCLASS="acronym">SGID</SPAN>. After reading this list, you shouldbe able to look at all of the <SPANCLASS="acronym">SUID</SPAN> and <SPANCLASS="acronym">SGID</SPAN>files on your system and figure out why your files have been setin particular ways. If you have a question about a file that is<SPANCLASS="acronym">SUID</SPAN> or <SPANCLASS="acronym">SGID</SPAN>, consult yourdocumentation or contact your vendor.</P><DIVCLASS="sect3"><H4CLASS="sect3"><ACLASS="title"NAME="PUIS-APP-B-SECT-3.2.1">B.3.2.1 SUID files</A></H4><BLOCKQUOTECLASS="screen"><PRECLASS="screen">-rwsr-xr-x 1 root     wheel    16384 Aug 18 1989 /usr/etc/ping</PRE></BLOCKQUOTE><PCLASS="para"><KBDCLASS="command">ping</KBD> must be <SPANCLASS="acronym">SUID</SPAN> <ICLASS="filename">root</I> so that it can transmit<SPANCLASS="acronym">ICMP</SPAN> <SPANCLASS="acronym">ECHO</SPAN> requests on theraw IP port.</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">-r-s--x--x 1 root     wheel    16384 Aug 18 1989 /usr/etc/timedc</PRE></BLOCKQUOTE><PCLASS="para">The <KBDCLASS="command">timedc</KBD> (Time Daemon Control) program must be <SPANCLASS="acronym">SUID</SPAN>root so that it can access the privileged time port.</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">-r-sr-x--x 3 root     wheel    81920 Sep  7 1989 /usr/lib/sendmail-r-sr-x--x 3 root     wheel    81920 Sep  7 1989 /usr/bin/newaliases-r-sr-x--x 3 root     wheel    81920 Sep  7 1989 /usr/bin/mailq</PRE></BLOCKQUOTE><PCLASS="para">These programs are all hard links to the same binary. The<KBDCLASS="command">sendmail</KBD> program must be <SPANCLASS="acronym">SUID</SPAN> <ICLASS="filename">root</I> because itlistens on <SPANCLASS="acronym">TCP/IP</SPAN> port 25, which is privileged.</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">-rwsr-xr-x 1 root     wheel    16384 Aug 15 1989 /usr/lib/ex3.7recover-rwsr-xr-x 1 root     wheel    16384 Aug 15 1989 /usr/lib/ex3.7preserve</PRE></BLOCKQUOTE><PCLASS="para">These programs, part of the <KBDCLASS="command">vi</KBD> editor system, must be <SPANCLASS="acronym">SUID</SPAN><ICLASS="filename">root</I> so they can read and write the backup files used by <KBDCLASS="command">vi</KBD>. (Theseare often <SPANCLASS="acronym">SGID</SPAN> <KBDCLASS="command">preserve</KBD>.)</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">-rws--x--x 1 root     wheel   40960 Nov 15 1989 /usr/lib/lpd-rws--s--x 1 root     daemon  24576 Sep  6 1989 /usr/ucb/lpr-rws--s--x 1 root     daemon  24576 Sep  6 1989 /usr/ucb/lpq-rws--s--x 1 root     daemon  24576 Sep  6 1989 /usr/ucb/lprm</PRE></BLOCKQUOTE><PCLASS="para">The line-printer daemon must be <SPANCLASS="acronym">SUID</SPAN> rootso it can listen on <SPANCLASS="acronym">TCP/IP</SPAN> port 515, the printerport, and so can read and write files in the <ICLASS="filename">/usr/spool/lpd</I>directory. Likewise, the line-printer user commands must be <SPANCLASS="acronym">SUID</SPAN>so they can access spool files and the printer device.</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">-rwsr-xr-x 1 root     wheel    24576 Aug 18 1989 /bin/ps-rwsr-xr-x 2 root     wheel    57344 Aug 18 1989 /usr/ucb/w-rwsr-xr-x 2 root     wheel    57344 Aug 18 1989 /usr/ucb/uptime-rwsr-xr-x 1 root     wheel    16384 Aug 18 1989 /usr/bin/iostat</PRE></BLOCKQUOTE><PCLASS="para">These programs must be <SPANCLASS="acronym">SUID</SPAN> <ICLASS="filename">root</I> because they need to read the kernel's memoryto generate the statistics that they print. On some systems, theseprograms are distributed <SPANCLASS="acronym">SGID</SPAN> <ICLASS="filename">kmem</I>, and <ICLASS="filename">/dev/kmem</I>is made readable only by this group. This second approach is moresecure than the first approach.</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">-rwsr-xr-x 1 root     wheel    16384 Aug 18 1989 /usr/ucb/quota</PRE></BLOCKQUOTE><PCLASS="para">The <ICLASS="filename">quota </I>command must be <SPANCLASS="acronym">SUID</SPAN><ICLASS="filename">root</I> so that it can read the <ICLASS="filename">quota</I> file.</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">-rwsr-xr-x 1 root     wheel    16384 Aug 18 1989  /usr/ucb/rcp-rwsr-x--x 1 root     wheel    32768 Aug 18 1989  /usr/ucb/rdist-rwsr-xr-x 1 root     wheel    16384 Aug 23 1989  /usr/ucb/rlogin-rwsr-xr-x 1 root     wheel    16384 Aug 18 1989  /usr/ucb/rsh-rwsr-sr-x 1 root     tty      32768 Nov 11 17:17 /usr/etc/rdump</PRE></BLOCKQUOTE><PCLASS="para">These programs must be <SPANCLASS="acronym">SUID</SPAN> <ICLASS="filename">root</I> because they use privileged ports to do username authentication.</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">-rwsr-xr-x 1 daemon   wheel    16384 Aug 18 1989 /usr/bin/atq-rwsr-xr-x 1 daemon   wheel    16384 Aug 18 1989 /usr/bin/at-rwsr-xr-x 1 daemon   wheel    16384 Aug 18 1989 /usr/bin/atrm</PRE></BLOCKQUOTE><PCLASS="para">These programs must be <SPANCLASS="acronym">SUID</SPAN> because theyaccess and modify spool files that are kept in privileged directories.</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">-rws--x--x 2 root    daemon  205347 Sep 29 10:14 /usr/bin/tip-rws--x--x 2 root    daemon  205347 Sep 29 10:14 /usr/bin/cu&#13;</PRE></BLOCKQUOTE><PCLASS="para"><KBDCLASS="command">tip</KBD> and <KBDCLASS="command">cu</KBD>, which are both hard links to the same binary,must be <SPANCLASS="acronym">SUID</SPAN> <ICLASS="filename">root</I> so that they can have physicalaccess to the modem device. On some systems, these files may be<SPANCLASS="acronym">SUID</SPAN> <SPANCLASS="acronym">UUCP</SPAN>.</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">-rwsr-xr-x 1 root     wheel    16384 Aug 18 1989 /bin/login</PRE></BLOCKQUOTE><PCLASS="para"><KBDCLASS="command">login</KBD> must be <SPANCLASS="acronym">SUID</SPAN> <ICLASS="filename">root</I> so that one usercan use <KBDCLASS="command">login</KBD> to log in as another user, without first logging out.If <KBDCLASS="command">login</KBD> were not <SPANCLASS="acronym">SUID</SPAN> <ICLASS="filename">root</I>, it could not changeits real and effective <SPANCLASS="acronym">UID</SPAN> to be that of anotheruser.</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">-rwsr-xr-x 1 root     wheel    16384 Aug 21 1989 /bin/mail</PRE></BLOCKQUOTE><PCLASS="para"><KBDCLASS="command">mail</KBD> must be <SPANCLASS="acronym">SUID</SPAN> <ICLASS="filename">root</I> so that it can appendmessages to a user's mail file.</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">-rwsr-xr-x 1 root     wheel    16384 Aug 18 1989 /bin/passwd-rwsr-xr-x 1 root     system   28672 Feb 21 1990 /usr/ucb/chsh-rwsr-xr-x 1 root     system   28672 Feb 21 1990 /usr/ucb/chfn</PRE></BLOCKQUOTE><PCLASS="para">These programs must be <SPANCLASS="acronym">SUID</SPAN> <ICLASS="filename">root</I> becausethey modify the <ICLASS="filename">/etc/passwd</I> file.</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">-rwsr-xr-x 1 root     wheel    16384 Sep 3 1989 /bin/su</PRE></BLOCKQUOTE><PCLASS="para"><KBDCLASS="command">su</KBD> must be <SPANCLASS="acronym">SUID</SPAN> <ICLASS="filename">root</I> so it can change itsprocess's effective <SPANCLASS="acronym">UID</SPAN> to that of anotheruser.</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">--s--s--x 1 uucp    daemon  24576 Sep 3 1989  /usr/bin/uucp --s--s--x 1 uucp    daemon  24576 Sep 3 1989  /usr/bin/uux--s--s--x 1 uucp    daemon  16384 Sep 3 1989  /usr/bin/uulog--s--s--x 1 uucp    daemon  16384 Sep 3 1989  /usr/bin/uuname--s--s--x 1 uucp    daemon  16384 Sep 3 1989  /usr/bin/uusnap--s--s--x 1 uucp    daemon  24576 Sep 3 1989  /usr/bin/uupoll--s--s--x 1 uucp    daemon  16384 Sep 3 1989  /usr/bin/uuq--s--s--x 2 uucp    daemon  16384 Sep 3 1989  /usr/bin/uusend--s--s--x 2 uucp    daemon  16384 Sep 3 1989  /usr/bin/ruusend--s--s--x 1 uucp    daemon  90112 Sep 3 1989  /usr/lib/uucp/uucico--s--s--x 1 uucp    daemon  24576 Sep 3 1989  /usr/lib/uucp/uuclean--s--s--- 1 uucp    daemon  32768 Sep 3 1989  /usr/lib/uucp/uuxqt--s--x--x 1 uucp    daemon  32768 Feb 21 1990 /usr/var/uucp/uumonitor--s--x--x 1 uucp    daemon  86016 Feb 21 1990 /usr/var/uucp/uucompact--s--x--x 1 uucp    daemon  77824 Feb 21 1990 /usr/var/uucp/uumkspool--s------ 1 uucp    daemon  90112 Feb 21 1990 /usr/var/uucp/uurespool</PRE></BLOCKQUOTE><PCLASS="para">These <SPANCLASS="acronym">UUCP</SPAN> files are <SPANCLASS="acronym">SUID</SPAN><KBDCLASS="command">uucp</KBD> so they can access and modify the protected <SPANCLASS="acronym">UUCP</SPAN>directories. Not all of these will be <SPANCLASS="acronym">SUID</SPAN> inevery system.</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">-rwsr-xr-x 1 root     system   954120 Jun 8 03:58 /usr/bin/X11/xterm-rwsr-xr-x 1 root     system   155648 Nov 16 1989 /usr/lib/X11/getcons</PRE></BLOCKQUOTE><PCLASS="para"><KBDCLASS="command">xterm</KBD> is <SPANCLASS="acronym">SUID</SPAN> because it needs to be ableto change the ownership of the <KBDCLASS="command">pty</KBD> that it creates for the X terminal.<KBDCLASS="command">getcons</KBD> is <SPANCLASS="acronym">SUID</SPAN> because it needs to be able toexecute a privileged kernel call.</P></DIV><DIVCLASS="sect3"><H4CLASS="sect3"><ACLASS="title"NAME="PUIS-APP-B-SECT-3.2.2">B.3.2.2 SGID files</A></H4><BLOCKQUOTECLASS="screen"><PRECLASS="screen"><ACLASS="indexterm"NAME="AUTOID-38845"></A>-rwxr-sr-x 1 root     kmem    4772 Nov 11 17:07 /usr/etc/arp-rwxr-sr-x 1 root     kmem    2456 Nov 11 17:14 /usr/etc/dmesg-rwxr-sr-x 1 root     kmem    4276 Nov 11 17:35 /usr/etc/kgmon-rwxr-sr-x 1 root     kmem    5188 Nov 11 18:16 /usr/etc/vmmprint-rwxr-sr-x 1 root     kmem    3584 Nov 11 18:16 /usr/etc/vmoprint-rwxr-sr-x 1 root     kmem    5520 Nov 11 20:38 /usr/etc/nfsstat-r-xr-sr-x 1 root     kmem   32768 Oct 22 10:30 /usr/ucb/gprof-rwxr-sr-x 1 root     kmem   40960 Nov 11 18:39 /usr/ucb/netstat-rwxr-sr-x 1 root     kmem   24576 Nov 11 18:57 /usr/ucb/sysline-rwxr-sr-x 1 root     kmem   76660 Jun 8 03:56  /usr/bin/X11/xload</PRE></BLOCKQUOTE><PCLASS="para">These commands are <SPANCLASS="acronym">SGID</SPAN> because they needto be able to access the kernel's memory.</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">-rwxr-sr-x 1 root     tty      2756 Nov 11 17:05 /bin/wall-rwxr-sr-x 1 root     tty      4272 Nov 11 17:06 /bin/write</PRE></BLOCKQUOTE><PCLASS="para">These commands are <SPANCLASS="acronym">SGID</SPAN> because they needto be able to access the raw terminal devices.</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">---s--s--x 1 uucp    daemon  90112 Nov 11 20:25 /usr/lib/uucp/uucico---s--s--x 1 uucp    daemon  11136 Nov 11 20:25 /usr/lib/uucp/uuclean---s--s--- 1 uucp    daemon  32768 Nov 11 20:26 /usr/lib/uucp/uuxqt---s--s--x 1 uucp    daemon  24576 Nov 11 20:25 /usr/bin/uucp---s--s--x 1 uucp    daemon  24576 Nov 11 20:25 /usr/bin/uux---s--s--x 1 uucp    daemon   4620 Nov 11 20:25 /usr/bin/uulog---s--s--x 1 uucp    daemon   5776 Nov 11 20:25 /usr/bin/uuname---s--s--x 1 uucp    daemon   4260 Nov 11 20:26 /usr/bin/uusnap---s--s--x 1 uucp    daemon  24576 Nov 11 20:26 /usr/bin/uupoll---s--s--x 1 uucp    daemon   8716 Nov 11 20:26 /usr/bin/uuq---s--s--x 2 uucp    daemon   3548 Nov 11 20:26 /usr/bin/uusend---s--s--x 2 uucp    daemon   3548 Nov 11 20:26 /usr/bin/ruusend</PRE></BLOCKQUOTE><PCLASS="para">These commands are all <SPANCLASS="acronym">SGID</SPAN> because theyneed to be able to access <SPANCLASS="acronym">UUCP</SPAN> spool files.</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">-rwx--s--x 1 root    daemon  24576 Oct 27 18:39 /usr/etc/lpc-rws--s--x 1 root    daemon  40960 Oct 27 18:39 /usr/lib/lpd-rws--s--x 1 root    daemon  24576 Oct 27 18:39 /usr/ucb/lpr-rws--s--x 1 root    daemon  24576 Oct 27 18:39 /usr/ucb/lpq-rws--s--x 1 root    daemon  24576 Oct 27 18:39 /usr/ucb/lprm</PRE></BLOCKQUOTE><PCLASS="para">These commands are all <SPANCLASS="acronym">SGID</SPAN> because theyneed to be able to access the line-printer device and spool files.</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">-rwxr-sr-x 1 root    operator 6700 Nov 11 16:53 /bin/df</PRE></BLOCKQUOTE><PCLASS="para">This command is <SPANCLASS="acronym">SGID</SPAN> because it needs accessto the raw disk device (which is owned by the group <ICLASS="filename">operator</I> onsome versions of Berkeley <SPANCLASS="acronym">UNIX</SPAN>).</P><PCLASS="para"></P></DIV></DIV></DIV><DIVCLASS="htmlnav"><P></P><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="appb_02.htm"TITLE="B.2 Important Files in Your Home Directory"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: B.2 Important Files in Your Home Directory"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="book"HREF="index.htm"TITLE="Practical UNIX &amp; Internet Security"><IMGSRC="../gifs/txthome.gif"ALT="Practical UNIX &amp; Internet Security"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="APPENDIX"HREF="appc_01.htm"TITLE="C. UNIX Processes"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: C. UNIX Processes"BORDER="0"></A></TD></TR><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172">B.2 Important Files in Your Home Directory</TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="index"HREF="index/idx_0.htm"TITLE="Book Index"><IMGSRC="../gifs/index.gif"ALT="Book Index"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172">C. UNIX Processes</TD></TR></TABLE><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><PCLASS="nav"><FONTSIZE="-1">[ <AHREF="../index.htm"TITLE="The Networking CD Bookshelf">Library Home</A> | <AHREF="../dnsbind/index.htm"TITLE="DNS &amp; BIND">DNS &amp; BIND</A> | <AHREF="../tcpip/index.htm"TITLE="TCP/IP Network Administration">TCP/IP</A> | <AHREF="../sendmail/index.htm"TITLE="sendmail">sendmail</A> | <AHREF="../smdref/index.htm"TITLE="sendmail Desktop Reference">sendmail Reference</A> | <AHREF="../firewall/index.htm"TITLE="Building Internet Firewalls">Firewalls</A> | <AHREF="index.htm"TITLE="Practical UNIX &amp; Internet Security">Practical Security</A> ]</FONT></P></DIV></BODY></HTML>