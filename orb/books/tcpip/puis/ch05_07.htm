<HTML><HEAD><TITLE>[Chapter 5] 5.7 chown: Changing a File's Owner</TITLE><METANAME="DC.title"CONTENT="Practical UNIX &amp; Internet Security"><METANAME="DC.creator"CONTENT="Simson Garfinkel &amp; Gene Spafford"><METANAME="DC.publisher"CONTENT="O'Reilly &amp; Associates, Inc."><METANAME="DC.date"CONTENT="1999-02-04T00:02:20Z"><METANAME="DC.type"CONTENT="Text.Monograph"><METANAME="DC.format"CONTENT="text/html"SCHEME="MIME"><METANAME="DC.source"CONTENT="1-56592-148-8"SCHEME="ISBN"><METANAME="DC.language"CONTENT="en-US"><METANAME="generator"CONTENT="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><LINKREV="made"HREF="mailto:online-books@oreilly.com"TITLE="Online Books Comments"><LINKREL="up"HREF="ch05_01.htm"TITLE="5. The UNIX Filesystem"><LINKREL="prev"HREF="ch05_06.htm"TITLE="5.6 Device Files"><LINKREL="next"HREF="ch05_08.htm"TITLE="5.8 chgrp: Changing a File's Group"></HEAD><BODYBGCOLOR="#FFFFFF"TEXT="#000000"><DIVCLASS="htmlnav"><H1><IMGSRC="gifs/smbanner.gif"ALT="Practical UNIX &amp; Internet Security"USEMAP="#srchmap"BORDER="0"></H1><MAPNAME="srchmap"><AREASHAPE="RECT"COORDS="0,0,466,65"HREF="index.htm"ALT="Practical UNIX &amp; Internet Security"><AREASHAPE="RECT"COORDS="467,0,514,18"HREF="../search/psrch.htm"ALT="Search this book"></MAP><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch05_06.htm"TITLE="5.6 Device Files"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 5.6 Device Files"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><B><FONTFACE="ARIEL,HELVETICA,HELV,SANSERIF"SIZE="-1">Chapter 5<BR>The UNIX Filesystem</FONT></B></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch05_08.htm"TITLE="5.8 chgrp: Changing a File's Group"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 5.8 chgrp: Changing a File's Group"BORDER="0"></A></TD></TR></TABLE>&nbsp;<HRALIGN="LEFT"WIDTH="515"TITLE="footer"></DIV><DIVCLASS="SECT1"><H2CLASS="sect1"><ACLASS="title"NAME="PUIS-CHP-5-SECT-7">5.7 chown: Changing a File's Owner</A></H2><PCLASS="para">The <ACLASS="indexterm"NAME="AUTOID-6214"></A><ACLASS="indexterm"NAME="AUTOID-6216"></A><ACLASS="indexterm"NAME="AUTOID-6219"></A><KBDCLASS="command">chown</KBD> command lets you changethe owner of a file. Only the superuser can change the owner ofa file under most modern versions of <SPANCLASS="acronym">UNIX</SPAN>.</P><PCLASS="para">The <KBDCLASS="command">chown</KBD> command has the form:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">chown [ -fRh ] owner <ICLASS="filename">filelist</I></PRE></BLOCKQUOTE><PCLASS="para">The <ICLASS="filename">-f</I> and <ICLASS="filename">-R</I> options are interpreted exactlyas they are for the <KBDCLASS="command">chmod</KBD> and <KBDCLASS="command">chgrp</KBD> commands, if supported. The<ICLASS="filename">-h</I> option is a bit different from that of <KBDCLASS="command">chmod</KBD>. Under<KBDCLASS="command">chown</KBD>, the option specifies that the owner of the link itself ischanged and not what the link points to.</P><PCLASS="para">Other entries have the following meanings:</P><DLCLASS="variablelist"><DTCLASS="term">owner </DT><DDCLASS="listitem"><PCLASS="para">The file's new owner; specify the ownerby name or by decimal <SPANCLASS="acronym">UID</SPAN>.</P></DD><DTCLASS="term">filelist </DT><DDCLASS="listitem"><PCLASS="para">The list of files whose owner you are changing.</P></DD></DL><PCLASS="para">In earlier versions of <SPANCLASS="acronym">UNIX</SPAN>, all userscould run the <KBDCLASS="command">chown</KBD> command to change the ownership of a file thatthey owned to that of any other user on the system. This let them&quot;give away&quot; a file. The feature made sharing filesback and forth possible, and allowed a user to turn over projectdirectories to someone else.</P><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-6250"></A>Allowingusers to give away files can be a security problem because it makesa miscreant's job of hiding his tracks much easier. Ifsomeone has acquired stolen information or is running programs thatare trying to break computer security, that person can simply changethe ownership of the files to that of another user. If he sets thepermissions correctly, he can still read the results. Permittingfile give-aways also makes file quotas useless: a user who runsout of quota simply changes the ownership of his larger files toanother user. Worse, perhaps, he can create a huge file and changeits ownership to someone else, exceeding the user's quotainstantly. If the file is in a directory to which the victim doesnot have access, he or she is stuck.</P><PCLASS="para">The <SPANCLASS="acronym">BSD</SPAN> development group saw these problemsand changed the behavior of <KBDCLASS="command">chown</KBD> so that only the superuser couldchange ownership of files. This change has led to an interestingsituation. When the <SPANCLASS="acronym">POSIX</SPAN> group working on astandard was faced with the hard choice of which behavior to pickas standard, they bravely took a stand and said &quot;both.&quot;Thus, depending on the setting of a system configuration parameter,your system can use either the old <SPANCLASS="acronym">AT&T</SPAN> behavior,or the <SPANCLASS="acronym">BSD</SPAN>-derived behavior. We <EMCLASS="emphasis">strongly</EM>urge you to choose the <SPANCLASS="acronym">BSD</SPAN>-derived behavior.Not only does it allow you to use file quotas and keep mischievoususers from framing other users, but many software packages you mightdownload from the net or buy from vendors will not work properlyif run under the old <SPANCLASS="acronym">AT&T</SPAN>-style environment.</P><BLOCKQUOTECLASS="note"><PCLASS="para"><STRONG>NOTE:</STRONG> If your system came to you with the old <KBDCLASS="command">chown</KBD> behavior, then ensure that the software was written withthat in mind. Be extra careful as you read some of our advice inthis book, because a few things we might recommend won'twork for you on such a system. Also, be especially cautious aboutsoftware you might download from the net or buy from a vendor. Mostof this software has been developed under <SPANCLASS="acronym">BSD</SPAN>-derivedsystems that limit use of <KBDCLASS="command">chown</KBD> to the superuser. Thus, the softwaremight have vulnerabilities when run under your environment.  </P><PCLASS="para">Do<EMCLASS="emphasis">not </EM>mix the two types of systems when you areusing some form of network filesystem or removable, user-mountablemedia. The result can be a compromise of your system. Files createdusing one paradigm may possibly be exploited using another.  <ACLASS="indexterm"NAME="AUTOID-6269"></A><ACLASS="indexterm"NAME="AUTOID-6272"></A></P><PCLASS="para">Undersome versions of <SPANCLASS="acronym">UNIX</SPAN> (particularly those thatlet nonsuperusers <KBDCLASS="command">chown</KBD> files), <KBDCLASS="command">chown</KBD> will clear the <SPANCLASS="acronym">SUID</SPAN>,<SPANCLASS="acronym">SGID</SPAN>, and sticky bits. This is a security measure,so that <SPANCLASS="acronym">SUID</SPAN> programs are not accidentally created.If your version of <SPANCLASS="acronym">UNIX</SPAN> does not clear thesebits when using <KBDCLASS="command">chown</KBD>, check with an <KBDCLASS="command">ls -l</KBD>afteryou have done a <KBDCLASS="command">chown</KBD> to make sure that you have not suddenly createda <SPANCLASS="acronym">SUID</SPAN> program that will allow your system'ssecurity to be compromised. (Actually, this process is a good habitto get into even if your system does do the right thing.) Otherversions of <SPANCLASS="acronym">UNIX</SPAN> will clear the execute, <SPANCLASS="acronym">SUID</SPAN>,and <SPANCLASS="acronym">SGID</SPAN> bits when the file is written or modified.You should determine how your system behaves under these circumstancesand be alert to combinations of actions that might accidentallycreate a <SPANCLASS="acronym">SUID</SPAN> or <SPANCLASS="acronym">SGID</SPAN> file.  <SPANCLASS="acronym">POSIX</SPAN><ACLASS="indexterm"NAME="AUTOID-6293"></A>specifies that when <KBDCLASS="command">chown</KBD> isexecuted on a symbolic link, the ownership of the target of thelink is changed instead of the ownership of the link itself. <SPANCLASS="acronym">POSIX</SPAN>further specifies that the <KBDCLASS="command">-R</KBD> option does not follow symbolic linksif they point to directories (but nevertheless changes the ownershipof these directories). On most modern systems of <SPANCLASS="acronym">UNIX</SPAN>,there is a <KBDCLASS="command">-h</KBD> option to <KBDCLASS="command">chown</KBD> (and <KBDCLASS="command">chgrp</KBD> and <KBDCLASS="command">chmod</KBD>) thatinstructs the command to not follow the link and to instead changethe permissions on the link itself&nbsp;- or to ignore the symboliclink and change nothing. You should understand how this behaveson your system and use it if appropriate.<ACLASS="indexterm"NAME="AUTOID-6304"></A><ACLASS="indexterm"NAME="AUTOID-6306"></A><ACLASS="indexterm"NAME="AUTOID-6309"></A></P></BLOCKQUOTE></DIV><DIVCLASS="htmlnav"><P></P><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch05_06.htm"TITLE="5.6 Device Files"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 5.6 Device Files"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="book"HREF="index.htm"TITLE="Practical UNIX &amp; Internet Security"><IMGSRC="../gifs/txthome.gif"ALT="Practical UNIX &amp; Internet Security"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch05_08.htm"TITLE="5.8 chgrp: Changing a File's Group"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 5.8 chgrp: Changing a File's Group"BORDER="0"></A></TD></TR><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172">5.6 Device Files</TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="index"HREF="index/idx_0.htm"TITLE="Book Index"><IMGSRC="../gifs/index.gif"ALT="Book Index"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172">5.8 chgrp: Changing a File's Group</TD></TR></TABLE><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><PCLASS="nav"><FONTSIZE="-1">[ <AHREF="../index.htm"TITLE="The Networking CD Bookshelf">Library Home</A> | <AHREF="../dnsbind/index.htm"TITLE="DNS &amp; BIND">DNS &amp; BIND</A> | <AHREF="../tcpip/index.htm"TITLE="TCP/IP Network Administration">TCP/IP</A> | <AHREF="../sendmail/index.htm"TITLE="sendmail">sendmail</A> | <AHREF="../smdref/index.htm"TITLE="sendmail Desktop Reference">sendmail Reference</A> | <AHREF="../firewall/index.htm"TITLE="Building Internet Firewalls">Firewalls</A> | <AHREF="index.htm"TITLE="Practical UNIX &amp; Internet Security">Practical Security</A> ]</FONT></P></DIV></BODY></HTML>