<HTML><HEAD><TITLE>[Chapter 6] Cryptography</TITLE><METANAME="DC.title"CONTENT="Practical UNIX &amp; Internet Security"><METANAME="DC.creator"CONTENT="Simson Garfinkel &amp; Gene Spafford"><METANAME="DC.publisher"CONTENT="O'Reilly &amp; Associates, Inc."><METANAME="DC.date"CONTENT="1999-02-04T00:02:25Z"><METANAME="DC.type"CONTENT="Text.Monograph"><METANAME="DC.format"CONTENT="text/html"SCHEME="MIME"><METANAME="DC.source"CONTENT="1-56592-148-8"SCHEME="ISBN"><METANAME="DC.language"CONTENT="en-US"><METANAME="generator"CONTENT="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><LINKREV="made"HREF="mailto:online-books@oreilly.com"TITLE="Online Books Comments"><LINKREL="up"HREF="part02.htm"TITLE="II. User Responsibilities"><LINKREL="prev"HREF="ch05_10.htm"TITLE="5.10 Summary"><LINKREL="next"HREF="ch06_02.htm"TITLE="6.2 What Is Encryption?"></HEAD><BODYBGCOLOR="#FFFFFF"TEXT="#000000"><DIVCLASS="htmlnav"><H1><IMGSRC="gifs/smbanner.gif"ALT="Practical UNIX &amp; Internet Security"USEMAP="#srchmap"BORDER="0"></H1><MAPNAME="srchmap"><AREASHAPE="RECT"COORDS="0,0,466,65"HREF="index.htm"ALT="Practical UNIX &amp; Internet Security"><AREASHAPE="RECT"COORDS="467,0,514,18"HREF="../search/psrch.htm"ALT="Search this book"></MAP><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch05_10.htm"TITLE="5.10 Summary"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 5.10 Summary"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><B><FONTFACE="ARIEL,HELVETICA,HELV,SANSERIF"SIZE="-1">Chapter 6</FONT></B></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch06_02.htm"TITLE="6.2 What Is Encryption?"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 6.2 What Is Encryption?"BORDER="0"></A></TD></TR></TABLE>&nbsp;<HRALIGN="LEFT"WIDTH="515"TITLE="footer"></DIV><DIVCLASS="CHAPTER"><H1CLASS="chapter"><ACLASS="title"NAME="PUIS-CHP-6">6. Cryptography</A></H1><DIVCLASS="htmltoc"><P><B>Contents:</B><BR><ACLASS="SECT1"HREF="#PUIS-CHP-6-SECT-1"TITLE="6.1 A Brief History of Cryptography">A Brief History of Cryptography</A><BR><ACLASS="SECT1"HREF="ch06_02.htm"TITLE="6.2 What Is Encryption?">What Is Encryption?</A><BR><ACLASS="SECT1"HREF="ch06_03.htm"TITLE="6.3 The Enigma Encryption System">The Enigma Encryption System</A><BR><ACLASS="SECT1"HREF="ch06_04.htm"TITLE="6.4 Common Cryptographic Algorithms">Common Cryptographic Algorithms</A><BR><ACLASS="SECT1"HREF="ch06_05.htm"TITLE="6.5 Message Digests and Digital Signatures">Message Digests and Digital Signatures</A><BR><ACLASS="SECT1"HREF="ch06_06.htm"TITLE="6.6 Encryption Programs Available for UNIX">Encryption Programs Available for UNIX</A><BR><ACLASS="SECT1"HREF="ch06_07.htm"TITLE="6.7 Encryption and U.S. Law">Encryption and U.S. Law</A></P><P></P></DIV><PCLASS="para">Cryptography <ACLASS="indexterm"NAME="AUTOID-6480"></A><ACLASS="indexterm"NAME="AUTOID-6482"></A>isthe science and art of secret writing&nbsp;- keeping informationsecret.[1]When applied in a computing environment, cryptography can protectdata against unauthorized disclosure; it can authenticate the identityof a user or program requesting service; and it can disclose unauthorizedtampering. In this chapter, we'll survey some of thoseuses, and present a brief summary of encryption methods that areoften available in <SPANCLASS="acronym">UNIX </SPAN>systems.</P><BLOCKQUOTECLASS="footnote"><PCLASS="para">[1] <ICLASS="firstterm">Cryptanalysis</I> is therelated study of breaking ciphers. <ICLASS="firstterm">Cryptology</I>is the combined study of cryptography and cryptanalysis.</P></BLOCKQUOTE><PCLASS="para">Cryptography is an indispensable part of modern computer security.</P><DIVCLASS="sect1"><H2CLASS="sect1"><ACLASS="title"NAME="PUIS-CHP-6-SECT-1">6.1 A Brief History of Cryptography</A></H2><PCLASS="para">Knowledge of cryptography can be traced back to ancient times.It's not difficult to understand why: as soon as threepeople had mastered the art of reading and writing, there was thepossibility that two of them would want to send letters to eachother that the third could not read.</P><PCLASS="para">In ancient Greece, the Spartan generals used a form of cryptographyso that the generals could exchange secret messages: the messageswere written on narrow ribbons of parchment that were wound spirallyaround a cylindrical staff called a <ICLASS="firstterm"><ACLASS="indexterm"NAME="AUTOID-6496"></A>scytale</I>.After the ribbon was unwound, the writing on it could only be readby a person who had a matching cylinder of exactly the same size.This primitive system did a reasonably good job of protecting messagesfrom interception and from the prying eyes of the message courieras well.</P><PCLASS="para">In modern times, cryptography's main role has beenin securing electronic communications. Soon after Samuel F. B. Morsepublicly demonstrated the telegraph in 1845, users of the telegraphbegan worrying about the confidentiality of the messages that werebeing transmitted. What would happen if somebody tapped the telegraphline? What would prevent unscrupulous telegraph operators from keepinga copy of the messages that they relayed and then divulging themto others? The answer was to <ICLASS="firstterm">encode </I>the messageswith a secret code, so that nobody but the intended recipient coulddecrypt them.</P><PCLASS="para">Cryptography became even more important with the inventionof radio, and its use in war. Without cryptography, messages transmittedto or from the front lines could easily be intercepted by the enemy.</P><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="PUIS-CHP-6-SECT-1.1">6.1.1 Code Making and Code Breaking</A></H3><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-6504"></A><ACLASS="indexterm"NAME="AUTOID-6507"></A><ACLASS="indexterm"NAME="AUTOID-6510"></A>Aslong as there have been code makers, there have been code breakers.Indeed, the two have been locked in a competition for centuries,with each advance on one side being matched by counter-advanceson the other.</P><PCLASS="para">For people who use codes, the code-breaking efforts of <ICLASS="firstterm">cryptanalysts</I>pose a danger that is potentially larger than the danger of notusing cryptography in the first place. Without cryptography, youmight be reluctant to send sensitive information through the mail,across a telex, or by radio. But if you think that you have a securechannel of communication, then you might use it to transmit secretsthat should not be widely revealed.</P><PCLASS="para">For this reason, cryptographers and organizations that usecryptography routinely conduct their own code-breaking efforts tomake sure that their codes are resistant to attack. The findingsof these self-inflicted intrusions are not always pleasant. Thefollowing brief story from a 1943 book on cryptography demonstratesthis point quite nicely:</P><BLOCKQUOTECLASS="blockquote"><PCLASS="para">[T]he importance of the partplayed by cryptographers in military operations was demonstratedto us realistically in the First World War. One instructive incidentoccurred in September 1918, on the eve of the great offensive againstSaint-Mihiel. A student cryptographer, fresh from Washington, arrivedat United States Headquarters at the front. Promptly he threw theGeneral Staff into a state of alarm by decrypting with comparativeease a secret radio message intercepted in the American sector.</P><PCLASS="para">The smashing of the German salient at Saint-Mihiel was oneof the most gigantic tasks undertaken by the American forces duringthe war. For years that salient had stabbed into the Allied lines,cutting important railways and communication lines. Its lines ofdefense were thought to be virtually impregnable. But for severalmonths the Americans had been making secret preparations for attackingit and wiping it out. The state was set, the minutest details ofstrategy had been determined&nbsp;- when the young officer ofthe United States Military Intelligence spread consternation throughour General Staff.</P><PCLASS="para">The dismay at Headquarters was not caused by any new informationabout the strength of the enemy forces, but by the realization thatthe Germans must know as much about our secret plans as we did ourselves&nbsp;- eventhe exact hour set for the attack. The `intercepted'message had been from our own base. German cryptographers were asexpert as any in the world, and what had been done by an Americanstudent cryptographer could surely have been done by German specialists.</P><PCLASS="para">The revelation was even more bitter because the cipher theyoung officer had broken, without any knowledge of the system, wasconsidered absolutely safe and had long been used for most importantand secret communications.[2]</P><BLOCKQUOTECLASS="footnote"><PCLASS="para">[2] Smith, Laurence Dwight.<EMCLASS="emphasis">Cryptography: The Science of Secret Writing</EM>.Dover Publications, New York, 1941.</P></BLOCKQUOTE></BLOCKQUOTE></DIV><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="PUIS-CHP-6-SECT-1.2">6.1.2 Cryptography and Digital Computers</A></H3><PCLASS="para">Modern <ACLASS="indexterm"NAME="AUTOID-6528"></A>digital computersare, in some senses, the creations of cryptography. Some of thefirst digital computers were built by the Allies to break messagesthat had been encrypted by the Germans with electromechanical encryptingmachines. Code breaking is usually a much harder problem than codemaking; after the Germans switched codes, the Allies often tookseveral months to discover the new coding systems. Nevertheless,the codes were broken, and many historians say that World War IIwas shortened by at least a year as a result.</P><PCLASS="para">Things really picked up when computers were turned to thetask of code making. Before computers, all of cryptography was limitedto two basic techniques: <ICLASS="firstterm"><ACLASS="indexterm"NAME="AUTOID-6532"></A><ACLASS="indexterm"NAME="AUTOID-6534"></A>transposition</I>,or rearranging the order of letters in a message (such as the Spartan'sscytale), and <ICLASS="firstterm">substitution</I>, or replacingone letter with another one. The most sophisticated pre-computercipher used five or six transposition or substitution operations,but rarely more.</P><PCLASS="para">With the coming of computers, ciphers could be built fromdozens, hundreds, or thousands of complex operations, and yet couldstill encrypt and decrypt messages in a short amount of time. Computershave also opened up the possibility of using complex algebraic operationsto encrypt messages. All of these advantages have had a profoundimpact on cryptography.</P></DIV><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="PUIS-CHP-6-SECT-1.3">6.1.3 Modern Controversy</A></H3><PCLASS="para">In recent years, encryption has gone from being an arcanescience and the stuff of James Bond movies, to being the subjectof debate in several nations (but we'll focus on the casein the U.S. in the next few paragraphs). In the U.S. that debateis playing itself out on the front pages of newspapers such as <EMCLASS="emphasis">TheNew York Times </EM>and the<EMCLASS="emphasis"> San Jose Mercury News.</EM></P><PCLASS="para">On one side of the debate are a large number of computer professionals,civil libertarians, and perhaps a majority of the American public,who are rightly concerned about their privacy and the secrecy oftheir communications. These people want the right and the abilityto protect their data with the most powerful encryption systemspossible.</P><PCLASS="para">On the other side of the debate are the United States Government,members of the nation's law enforcement and intelligencecommunities, and (apparently) a small number of computer professionals,who argue that the use of cryptography should be limited becauseit can be used to hide illegal activities from authorized wiretapsand electronic searches.</P><PCLASS="para"><SPANCLASS="acronym">MIT</SPAN> Professor Ronald <ACLASS="indexterm"NAME="AUTOID-6547"></A>Rivest has observed that the controversy overcryptography fundamentally boils down to one question:</P><BLOCKQUOTECLASS="blockquote"><PCLASS="para">Should the citizens of a country have the rightto create and store documents which their government cannot read?[3]</P><BLOCKQUOTECLASS="footnote"><PCLASS="para">[3] Rivest, Ronald, speaking before the MIT TelecommunicationsForum, Spring 1994.</P></BLOCKQUOTE></BLOCKQUOTE><PCLASS="para">This chapter does not address this question. Nor do we attemptto explore the U.S. Government's[4]claimed need to eavesdrop on communications, the fear that civilrights activists have of governmental abuse, or other encryptionpolicy issues. Although those are interesting and important questions&nbsp;- questionsyou should also be concerned with as a computer user&nbsp;- theyare beyond the scope of this book. Instead, we focus on discussionof the types of encryption that are available to most <SPANCLASS="acronym">UNIX</SPAN>users today and those that are likely to be available in the nearfuture. If you are interested in the broader questions of who shouldhave access to encryption, we suggest that you pursue some of thereferences listed in <ACLASS="xref"HREF="appd_01.htm"TITLE="Paper Sources">Appendix D, <CITECLASS="appendix">Paper Sources</CITE></A>, startingwith <EMCLASS="emphasis">Building in Big Brother</EM>, edited by Professor Lance Hoffman.</P><BLOCKQUOTECLASS="footnote"><PCLASS="para">[4] Or any other government!</P></BLOCKQUOTE><DIVCLASS="sidebar"><H4CLASS="sidebar"><ACLASS="title"NAME="PUIS-CHP-6-SB-1">A Note About Key Escrow</A></H4><PCLASS="para">There has been considerable debate recently centering on thenotion of <ICLASS="firstterm">key <ACLASS="indexterm"NAME="AUTOID-6563"></A><ACLASS="indexterm"NAME="AUTOID-6566"></A><ACLASS="indexterm"NAME="AUTOID-6568"></A>escrow</I>. Theusual context is during debate over the ability of private citizensto have access to strong cryptography. Many government officialsand prominent scientists advocate a form of escrowed encryptionas a good compromise between law enforcement needs and privacy concerns.In such schemes, a copy of the decryption key for each user is escrowedby one or more trusted parties, and is available if a warrant isissued for it.</P><PCLASS="para">Whatever your feelings are on the matter of law enforcementaccess to your decryption keys, <EMCLASS="emphasis">consider escrowing yourkeys!</EM> By this, we do not mean making your keys availableto the government. Rather, we mean placing a copy of your keys ina secure location where they can be retrieved if you or someoneelse needs them. You may pick a key so strong that you forget ita year from now. Or, you might develop amnesia, get food poisoningfrom a bad Twinkie, or get kidnapped by aliens to keep Elvis company.If any of these calamities befall you, how are your coworkers orfamily going to decrypt the vital records that you have encrypted?</P><PCLASS="para">We recommend that you deposit copies of your encryption keysand passwords in safe locations, such as a safe or safety depositbox. If you are uncomfortable about leaving the keys all in oneplace, there are algorithms with which you can split a key intoseveral parts and deposit a part with each of several trusted parties.With key-splitting schemes, one or two parts by themselves are notenough to recreate the key, but a majority of them is enough torecover the key. Consult a good book on cryptography for details.</P><PCLASS="para">But <EMCLASS="emphasis">do</EM> escrow your own keys!</P></DIV></DIV></DIV></DIV><DIVCLASS="htmlnav"><P></P><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch05_10.htm"TITLE="5.10 Summary"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 5.10 Summary"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="book"HREF="index.htm"TITLE="Practical UNIX &amp; Internet Security"><IMGSRC="../gifs/txthome.gif"ALT="Practical UNIX &amp; Internet Security"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch06_02.htm"TITLE="6.2 What Is Encryption?"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 6.2 What Is Encryption?"BORDER="0"></A></TD></TR><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172">5.10 Summary</TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="index"HREF="index/idx_0.htm"TITLE="Book Index"><IMGSRC="../gifs/index.gif"ALT="Book Index"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172">6.2 What Is Encryption?</TD></TR></TABLE><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><PCLASS="nav"><FONTSIZE="-1">[ <AHREF="../index.htm"TITLE="The Networking CD Bookshelf">Library Home</A> | <AHREF="../dnsbind/index.htm"TITLE="DNS &amp; BIND">DNS &amp; BIND</A> | <AHREF="../tcpip/index.htm"TITLE="TCP/IP Network Administration">TCP/IP</A> | <AHREF="../sendmail/index.htm"TITLE="sendmail">sendmail</A> | <AHREF="../smdref/index.htm"TITLE="sendmail Desktop Reference">sendmail Reference</A> | <AHREF="../firewall/index.htm"TITLE="Building Internet Firewalls">Firewalls</A> | <AHREF="index.htm"TITLE="Practical UNIX &amp; Internet Security">Practical Security</A> ]</FONT></P></DIV></BODY></HTML>