<HTML><HEAD><TITLE>[Chapter 10] 10.7 Handwritten Logs</TITLE><METANAME="DC.title"CONTENT="Practical UNIX &amp; Internet Security"><METANAME="DC.creator"CONTENT="Simson Garfinkel &amp; Gene Spafford"><METANAME="DC.publisher"CONTENT="O'Reilly &amp; Associates, Inc."><METANAME="DC.date"CONTENT="1999-02-04T00:07:45Z"><METANAME="DC.type"CONTENT="Text.Monograph"><METANAME="DC.format"CONTENT="text/html"SCHEME="MIME"><METANAME="DC.source"CONTENT="1-56592-148-8"SCHEME="ISBN"><METANAME="DC.language"CONTENT="en-US"><METANAME="generator"CONTENT="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><LINKREV="made"HREF="mailto:online-books@oreilly.com"TITLE="Online Books Comments"><LINKREL="up"HREF="ch10_01.htm"TITLE="10. Auditing and Logging"><LINKREL="prev"HREF="ch10_06.htm"TITLE="10.6 Swatch: A Log File Tool"><LINKREL="next"HREF="ch10_08.htm"TITLE="10.8 Managing Log Files"></HEAD><BODYBGCOLOR="#FFFFFF"TEXT="#000000"><DIVCLASS="htmlnav"><H1><IMGSRC="gifs/smbanner.gif"ALT="Practical UNIX &amp; Internet Security"USEMAP="#srchmap"BORDER="0"></H1><MAPNAME="srchmap"><AREASHAPE="RECT"COORDS="0,0,466,65"HREF="index.htm"ALT="Practical UNIX &amp; Internet Security"><AREASHAPE="RECT"COORDS="467,0,514,18"HREF="../search/psrch.htm"ALT="Search this book"></MAP><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch10_06.htm"TITLE="10.6 Swatch: A Log File Tool"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 10.6 Swatch: A Log File Tool"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><B><FONTFACE="ARIEL,HELVETICA,HELV,SANSERIF"SIZE="-1">Chapter 10<BR>Auditing and Logging</FONT></B></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch10_08.htm"TITLE="10.8 Managing Log Files"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 10.8 Managing Log Files"BORDER="0"></A></TD></TR></TABLE>&nbsp;<HRALIGN="LEFT"WIDTH="515"TITLE="footer"></DIV><DIVCLASS="SECT1"><H2CLASS="sect1"><ACLASS="title"NAME="PUIS-CHP-10-SECT-7">10.7 Handwritten Logs</A></H2><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-14403"></A><ACLASS="indexterm"NAME="AUTOID-14406"></A><ACLASS="indexterm"NAME="AUTOID-14408"></A>Another type of logging thatcan help you with security is not done by the computer at all; itis done by you and your staff. Keep a log book that records yourday's activities. Log books should be kept on paper ina physically secure location. Because you keep them on paper, theycannot be altered by someone hacking into your computer even assuperuser. They will provide a nearly tamper-proof record of importantinformation.</P><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-14412"></A>Handwritten logs haveseveral advantages over online logs:</P><ULCLASS="itemizedlist"><LICLASS="listitem"><PCLASS="para">They can record many different kindsof information. For example, your computer will not record a suspicioustelephone call or a bomb threat, but you can (and should) recordthese occurrences in your log book.</P></LI><LICLASS="listitem"><PCLASS="para">If the systems are down, you can still access yourpaper logs. (Thus, this is a good place to keep a copy of accountnumbers and important phone numbers for field service, service contacts,and your own key personnel.)</P></LI><LICLASS="listitem"><PCLASS="para">If disaster befalls your disks, you can recreatesome vital information from paper, if it is in the log book.</P></LI><LICLASS="listitem"><PCLASS="para">If you keep the log book as a matter of course,and you enter into it printed copies of your exception logs, suchinformation might be more likely to be accepted into court proceedingsas business records. This advantage is important if you are in asituation where you need to pursue criminal or civil legal action.</P></LI><LICLASS="listitem"><PCLASS="para">Juries are more easily convinced that paper logsare authentic, as opposed to computer logs.</P></LI><LICLASS="listitem"><PCLASS="para">Having copies of significant information in thelog book keeps you from having to search all the disks on all yourworkstations for some selected information.</P></LI><LICLASS="listitem"><PCLASS="para">If all your other tools fail or might have beencompromised, holding an old printout and a new printout of the samefile together and up to a bright light, may be a quick way to revealchanges.</P></LI></UL><PCLASS="para">Think of your log book as a laboratory notebook, except thelaboratory is your own computer center. Each page should be numbered.You should not rip pages out of your book. Write in ink, not pencil.If you need to cross something out, draw a single line, but do notmake the text that you are scratching out unreadable. Keep yourold log books.</P><PCLASS="para">The biggest problem with log books is the amount of time youneed to keep them up to date. These are not items that can be automatedwith a shell script. Unfortunately, this time requirement is thebiggest reason why many administrators are reluctant to keep logs&nbsp;- especiallyat a site with hundreds (or thousands) of machines, each of whichmight require its own log book. We suggest you try to be creativeand think of some way to balance the need for good records againstthe drudgery of keeping multiple books up to date. Compressing information,and keeping logs for each cluster of machines is one way to reducethe overhead while receiving (nearly) the same benefit.</P><PCLASS="para">There are basically two kinds of log books: per-site logsand per-machine logs. We'll outline the kinds of materialyou might want to keep in each type. Be creative, though, and don'tlimit yourself to what we suggest here.</P><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="PUIS-CHP-10-SECT-7.1">10.7.1 Per-Site Logs</A></H3><PCLASS="para">In a <ACLASS="indexterm"NAME="AUTOID-14436"></A><ACLASS="indexterm"NAME="AUTOID-14438"></A>per-sitelog book, you want to keep information that would be of use acrossall your machines and throughout your operations. The informationcan be further divided into exception and activity reports, andinformational material.</P><DIVCLASS="sect3"><H4CLASS="sect3"><ACLASS="title"NAME="PUIS-CHP-10-SECT-7.1.1">10.7.1.1 Exception and activity reports</A></H4><PCLASS="para">These reports hold such information as the following:</P><ULCLASS="itemizedlist"><LICLASS="listitem"><PCLASS="para">Time/date/durationof <ACLASS="indexterm"NAME="AUTOID-14447"></A>power outages; overtime, this may help you justify uninterruptible power supplies,or to trace a cause of frequent problems</P></LI><LICLASS="listitem"><PCLASS="para">Servicing and testing of <ACLASS="indexterm"NAME="AUTOID-14451"></A>alarm systems</P></LI><LICLASS="listitem"><PCLASS="para">Triggering of alarm systems</P></LI><LICLASS="listitem"><PCLASS="para">Servicing and testing of fire suppression systems</P></LI><LICLASS="listitem"><PCLASS="para">Visits by service personnel, including the phonecompany</P></LI><LICLASS="listitem"><PCLASS="para">Dates of employment and termination of employeeswith privileged access (or with any access)</P></LI></UL></DIV><DIVCLASS="sect3"><H4CLASS="sect3"><ACLASS="title"NAME="PUIS-CHP-10-SECT-7.1.2">10.7.1.2 Informational material</A></H4><PCLASS="para">This material contains such information as the following:</P><ULCLASS="itemizedlist"><LICLASS="listitem"><PCLASS="para">Contact information for importantpersonnel, including corporate counsel, law enforcement, field service,and others who might be involved in any form of incident</P></LI><LICLASS="listitem"><PCLASS="para">Copies of purchase orders, receipts, and licensesfor all software installed on your systems (invaluable if you areone of the targets of a Software Publishers Association audit)</P></LI><LICLASS="listitem"><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-14472"></A>Serialnumbers for all significant equipment on the premises</P></LI><LICLASS="listitem"><PCLASS="para">All machine <SPANCLASS="acronym">MAC</SPAN>-level addresses(e.g., Ethernet addresses) with corresponding IP (or other protocol)numbers</P></LI><LICLASS="listitem"><PCLASS="para">Time and circumstances of formal bug reports madeto the vendor</P></LI><LICLASS="listitem"><PCLASS="para">Phone numbers connected to your computers for dial-in/dial-out</P></LI><LICLASS="listitem"><PCLASS="para">Paper copy of the configuration of any routers,firewalls, or other network devices not associated with a singlemachine</P></LI><LICLASS="listitem"><PCLASS="para">Paper copy of a list of disk configurations, <SPANCLASS="acronym">SCSI</SPAN>geometries, and partition tables and information.</P></LI></UL></DIV></DIV><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="PUIS-CHP-10-SECT-7.2">10.7.2 Per-Machine Logs</A></H3><PCLASS="para">Each <ACLASS="indexterm"NAME="AUTOID-14489"></A><ACLASS="indexterm"NAME="AUTOID-14491"></A>machineshould also have a log book associated with it. Information in theselogs, too, can be divided into exception and activity reports, andinformational material:</P><DIVCLASS="sect3"><H4CLASS="sect3"><ACLASS="title"NAME="PUIS-CHP-10-SECT-7.2.1">10.7.2.1 Exception and activity reports</A></H4><PCLASS="para">These reports hold such information as the following:</P><ULCLASS="itemizedlist"><LICLASS="listitem"><PCLASS="para">Times and dates of any halts or <ACLASS="indexterm"NAME="AUTOID-14500"></A>crashes, including information on any specialmeasures for system recovery</P></LI><LICLASS="listitem"><PCLASS="para">Times, dates, and purposes of any <ACLASS="indexterm"NAME="AUTOID-14504"></A>downtimes</P></LI><LICLASS="listitem"><PCLASS="para">Data associated with any unusual occurrence, suchas network behavior out of the ordinary, or a disk filling up withoutobvious cause</P></LI><LICLASS="listitem"><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-14511"></A>Timeand <SPANCLASS="acronym">UID</SPAN> of any accounts created, disabled, ordeleted, including the account owner, the user name, and the reasonfor the action.</P></LI><LICLASS="listitem"><PCLASS="para">Instances of changing <ACLASS="indexterm"NAME="AUTOID-14517"></A>passwords for users</P></LI><LICLASS="listitem"><PCLASS="para">Times and levels of backups and restores along witha count of how many times each backup tape has been used</P></LI><LICLASS="listitem"><PCLASS="para">Times, dates, and circumstances of software installationor <ACLASS="indexterm"NAME="AUTOID-14524"></A><ACLASS="indexterm"NAME="AUTOID-14526"></A>upgrades</P></LI><LICLASS="listitem"><PCLASS="para">Times and circumstances of any maintenance activity</P></LI></UL></DIV><DIVCLASS="sect3"><H4CLASS="sect3"><ACLASS="title"NAME="PUIS-CHP-10-SECT-7.2.2">10.7.2.2 Informational material</A></H4><PCLASS="para">This material contains such information as the following:</P><ULCLASS="itemizedlist"><LICLASS="listitem"><PCLASS="para">Copy of current <ACLASS="indexterm"NAME="AUTOID-14537"></A><ACLASS="indexterm"NAME="AUTOID-14541"></A><ACLASS="indexterm"NAME="AUTOID-14543"></A>configuration files,including <EMCLASS="emphasis">passwd</EM>, <EMCLASS="emphasis">group</EM>,and <EMCLASS="emphasis">inetd.conf</EM>. (update these copies periodically,or as the files change)</P></LI><LICLASS="listitem"><PCLASS="para">List of patches applied from the vendor, softwarerevision numbers, and other identifying information</P></LI><LICLASS="listitem"><PCLASS="para">Configuration information for any third-party softwareinstalled on the machine</P></LI><LICLASS="listitem"><PCLASS="para">&quot;<EMCLASS="emphasis">ls -l  </EM>&quot;listing of any <EMCLASS="emphasis">setuid/setgid</EM> files on the system,and of all device files<ACLASS="indexterm"NAME="AUTOID-14557"></A><ACLASS="indexterm"NAME="AUTOID-14560"></A><ACLASS="indexterm"NAME="AUTOID-14562"></A></P></LI></UL></DIV></DIV></DIV><DIVCLASS="htmlnav"><P></P><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch10_06.htm"TITLE="10.6 Swatch: A Log File Tool"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 10.6 Swatch: A Log File Tool"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="book"HREF="index.htm"TITLE="Practical UNIX &amp; Internet Security"><IMGSRC="../gifs/txthome.gif"ALT="Practical UNIX &amp; Internet Security"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch10_08.htm"TITLE="10.8 Managing Log Files"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 10.8 Managing Log Files"BORDER="0"></A></TD></TR><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172">10.6 Swatch: A Log File Tool</TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="index"HREF="index/idx_0.htm"TITLE="Book Index"><IMGSRC="../gifs/index.gif"ALT="Book Index"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172">10.8 Managing Log Files</TD></TR></TABLE><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><PCLASS="nav"><FONTSIZE="-1">[ <AHREF="../index.htm"TITLE="The Networking CD Bookshelf">Library Home</A> | <AHREF="../dnsbind/index.htm"TITLE="DNS &amp; BIND">DNS &amp; BIND</A> | <AHREF="../tcpip/index.htm"TITLE="TCP/IP Network Administration">TCP/IP</A> | <AHREF="../sendmail/index.htm"TITLE="sendmail">sendmail</A> | <AHREF="../smdref/index.htm"TITLE="sendmail Desktop Reference">sendmail Reference</A> | <AHREF="../firewall/index.htm"TITLE="Building Internet Firewalls">Firewalls</A> | <AHREF="index.htm"TITLE="Practical UNIX &amp; Internet Security">Practical Security</A> ]</FONT></P></DIV></BODY></HTML>