<HTML><HEAD><TITLE>[Chapter 14] 14.3 The RS-232 Serial Protocol</TITLE><METANAME="DC.title"CONTENT="Practical UNIX &amp; Internet Security"><METANAME="DC.creator"CONTENT="Simson Garfinkel &amp; Gene Spafford"><METANAME="DC.publisher"CONTENT="O'Reilly &amp; Associates, Inc."><METANAME="DC.date"CONTENT="1999-02-04T00:11:40Z"><METANAME="DC.type"CONTENT="Text.Monograph"><METANAME="DC.format"CONTENT="text/html"SCHEME="MIME"><METANAME="DC.source"CONTENT="1-56592-148-8"SCHEME="ISBN"><METANAME="DC.language"CONTENT="en-US"><METANAME="generator"CONTENT="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><LINKREV="made"HREF="mailto:online-books@oreilly.com"TITLE="Online Books Comments"><LINKREL="up"HREF="ch14_01.htm"TITLE="14. Telephone Security"><LINKREL="prev"HREF="ch14_02.htm"TITLE="14.2 Serial Interfaces"><LINKREL="next"HREF="ch14_04.htm"TITLE="14.4 Modems and Security"></HEAD><BODYBGCOLOR="#FFFFFF"TEXT="#000000"><DIVCLASS="htmlnav"><H1><IMGSRC="gifs/smbanner.gif"ALT="Practical UNIX &amp; Internet Security"USEMAP="#srchmap"BORDER="0"></H1><MAPNAME="srchmap"><AREASHAPE="RECT"COORDS="0,0,466,65"HREF="index.htm"ALT="Practical UNIX &amp; Internet Security"><AREASHAPE="RECT"COORDS="467,0,514,18"HREF="../search/psrch.htm"ALT="Search this book"></MAP><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch14_02.htm"TITLE="14.2 Serial Interfaces"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 14.2 Serial Interfaces"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><B><FONTFACE="ARIEL,HELVETICA,HELV,SANSERIF"SIZE="-1">Chapter 14<BR>Telephone Security</FONT></B></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch14_04.htm"TITLE="14.4 Modems and Security"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 14.4 Modems and Security"BORDER="0"></A></TD></TR></TABLE>&nbsp;<HRALIGN="LEFT"WIDTH="515"TITLE="footer"></DIV><DIVCLASS="SECT1"><H2CLASS="sect1"><ACLASS="title"NAME="PUIS-CHP-14-SECT-3">14.3 The RS-232 Serial Protocol</A></H2><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-17297"></A>One of the most common serial interfacesis based on the RS-232 standard, which was developed primarily toallow individuals to use terminals with remote computer systemsover a telephone line more easily.</P><PCLASS="para">The basic configurationof a terminal and a computer connected by two modems is shown in<ACLASS="xref"HREF="ch07_02.htm#PUIS-CHP-7-FIG-2"TITLE="Incremental backup with media rotation">Figure 7.2</A>.</P><H4CLASS="figure"><ACLASS="title"NAME="PUIS-CHP-14-FIG-2">Figure 14.2: A terminal and a computer connected by two modems</A></H4><IMGCLASS="graphic"SRC="figs/puis_1402.gif"ALT="Figure 14.2"><PCLASS="para">The computer and terminal are called <EMCLASS="emphasis"><ACLASS="indexterm"NAME="AUTOID-17306"></A><ACLASS="indexterm"NAME="AUTOID-17309"></A>dataterminal equipment</EM> (<SPANCLASS="acronym">DTE</SPAN>), while themodems are called <EMCLASS="emphasis"><ACLASS="indexterm"NAME="AUTOID-17313"></A><ACLASS="indexterm"NAME="AUTOID-17316"></A>data communicationequipment</EM> (<SPANCLASS="acronym">DCE</SPAN>). The standard RS-232connector is a 25-pin D-shell type connector; only nine pins areused to connect the <SPANCLASS="acronym">DTE</SPAN> and <SPANCLASS="acronym">DCE</SPAN>sides together, as seen in <ACLASS="xref"HREF="ch14_03.htm#PUIS-CHP-14-FIG-3"TITLE="The standard 25-pin RS-232 connector">Figure 14.3</A>.</P><H4CLASS="figure"><ACLASS="title"NAME="PUIS-CHP-14-FIG-3">Figure 14.3: The standard 25-pin RS-232 connector</A></H4><IMGCLASS="graphic"SRC="figs/puis_1403.gif"ALT="Figure 14.3"><PCLASS="para">Of these nine pins, only transmitdata (pin 2), receive data (pin 3), and signal ground (pin 7) areessential for directly wired communications. Five pins (2, 3, 7,8, and 20) are needed for proper operation of modems. Frame ground(pin 1) was originally used to connect electrically the physicalframe of the <SPANCLASS="acronym">DCE</SPAN> and the frame of the <SPANCLASS="acronym">DTE</SPAN>to reduce electrical hazards, although its use has been discontinuedin the RS-232-C standard. <ACLASS="xref"HREF="ch14_03.htm#PUIS-CHP-14-TAB-1"TITLE=".RS-232 Pin Assignments for a 25-Pin Connector">Table 14.1</A> describesthe use of each pin.</P><TABLECLASS="table"><CAPTIONCLASS="table"><ACLASS="title"NAME="PUIS-CHP-14-TAB-1">Table 14.1: .RS-232 Pin Assignments for a 25-Pin Connector</A></CAPTION><THEADCLASS="thead"><TRCLASS="row"VALIGN="TOP"><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Pin</P></TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Code</P></TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Name</P></TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Description</P></TH></TR></THEAD><TBODYCLASS="tbody"><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">1</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">FG</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-17354"></A>FrameGround</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Chassis ground of equipment. (Note: thispin is historical; modern systems don't connect the electricalground of different components together, because such a connectioncauses more problems than it solves.)</P></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">2</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">TD</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-17365"></A>TransmitData</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Data transmitted from the computer orterminal to the modem.</P></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">3</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">RD</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-17376"></A>ReceiveData</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Data transmitted from the modem to thecomputer.</P></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">4</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">RTS</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-17387"></A>Requestto Send</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Tells the modem when it can transmitdata. Sometimes the computer is busy and needs to have the modemwait before the next character is transmitted. Used for &quot;hardwareflow control.&quot;</P></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">5</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">CTS</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-17398"></A>Clearto Send</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Tells the computer when it'sokay to transmit data. Sometimes the modem is busy and needs tohave the computer wait before the next character is transmitted.Used for &quot;hardware flow control.&quot;</P></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">6</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">DSR</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-17409"></A>DataSet Ready</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Tells the computer that the modem isturned on. The computer should not send the modem commands if thissignal is not present.</P></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">7</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">SG</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-17420"></A>SignalGround</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Reference point for all signal voltages.</P></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">8</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">DCD</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-17431"></A>DataCarrier Detect</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Tells the computer that the modem isconnected by telephone with another modem. <SPANCLASS="acronym">UNIX</SPAN>may use this signal to tell it when to display a<KBDCLASS="command"> </KBD>login:<KBDCLASS="command"></KBD>banner.</P></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">22</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">RI</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-17445"></A>RingIndicator</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Tells the computer that the telephoneis ringing.</P></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">20</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">DTR</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-17456"></A>DataTerminal Ready</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Tells the modem that the computer isturned on and ready to accept connections. The modem should notanswer the telephone&nbsp;- and it should automatically hang upon an established conversation&nbsp;- if this signal is not present.</P></TD></TR></TBODY></TABLE><PCLASS="para">Because only eight pins of the 25-pin RS-232connector are used, the computer industry has largely moved to smallerconnectors that have fewer pins and cost less money to produce.Most PCs are equipped with a 9-pin RS-232 connector, which has pinassignments: listed in <ACLASS="xref"HREF="ch14_03.htm#PUIS-CHP-14-TAB-2"TITLE=".RS-232 Pin Assignments for 25- and 9-pin Connectors">Table 14.2</A>.</P><TABLECLASS="table"><CAPTIONCLASS="table"><ACLASS="title"NAME="PUIS-CHP-14-TAB-2">Table 14.2: .RS-232 Pin Assignments for 25- and 9-pin Connectors</A></CAPTION><THEADCLASS="thead"><TRCLASS="row"VALIGN="TOP"><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Code</P></TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Name</P></TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1"><PCLASS="para">25-pin Connector Assignment</P></TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1"><PCLASS="para">9-pin Connector Assignment</P></TH></TR></THEAD><TBODYCLASS="tbody"><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">TD</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Transmit Data</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">2</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">3</P></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">RD</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Receive Data</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">3</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">2</P></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">RTS</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Request to Send</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">4</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">7</P></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">CTS</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Clear to Send</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">5</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">8</P></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">DSR</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Data Set Ready</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">6</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">6</P></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">SG</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Signal Ground</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">7</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">5</P></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">DCD</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Data Carrier Detect</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">8</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">1</P></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">DTR</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Data Terminal Ready</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">20</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">4</P></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">RI</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Ring indicator</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">22</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">9</P></TD></TR></TBODY></TABLE><PCLASS="para">A number of nonstandard RS-232 connectorsare also in use. The Apple Macintosh computer uses a circular 9-pin<SPANCLASS="acronym">DIN</SPAN> connector, and there are several popular(and incompatible) systems for using standard modular telephonecords.</P><PCLASS="para">In general, you should be suspicious of any RS-232system that claims to carry all eight signals between the data setand the data terminal without the full complement of wires.<ACLASS="indexterm"NAME="AUTOID-17564"></A></P><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="PUIS-CHP-14-SECT-3.1">14.3.1 Originate and Answer</A></H3><PCLASS="para">Modern modems canboth place and receive telephone calls. After a connection betweentwo modems is established, information that each modem receiveson the TD pin is translated into a series of tones that are sentdown the telephone line. Likewise, each modem takes the tones thatit receives through its telephone connection, passes them througha series of filters and detectors, and eventually translates themback into data that is transmitted on the RD pin.</P><PCLASS="para">Toallow modems to transmit and receive information at the same time,different tones are used for each direction of data transfer. Byconvention, the modem that places the telephone call runs in <EMCLASS="emphasis"><ACLASS="indexterm"NAME="AUTOID-17571"></A>originate</EM> <EMCLASS="emphasis">mode</EM>and uses one set of tones, while the modem that receives the telephonecall operates in <EMCLASS="emphasis"><ACLASS="indexterm"NAME="AUTOID-17575"></A><ACLASS="indexterm"NAME="AUTOID-17577"></A>answer mode</EM> anduses another set of tones.</P><PCLASS="para">High-speed modems have additionalelectronics inside them that perform data compression before thedata is translated into tones. Some high-speed modems automaticallyreallocate their audio spectrum as the call progresses to maximizesignal clarity and thus maximize data transfer speed. Others allocatea high-speed channel to the answering modem and a low-speed channelto the originating modem, with provisions for swapping channelsshould the need arise.</P><PCLASS="para">Further details on modem operationare available from any reasonably current book on data communications.Some are listed in <ACLASS="xref"HREF="appd_01.htm"TITLE="Paper Sources">Appendix D, <CITECLASS="appendix">Paper Sources</CITE></A>.</P></DIV></DIV><DIVCLASS="htmlnav"><P></P><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch14_02.htm"TITLE="14.2 Serial Interfaces"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 14.2 Serial Interfaces"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="book"HREF="index.htm"TITLE="Practical UNIX &amp; Internet Security"><IMGSRC="../gifs/txthome.gif"ALT="Practical UNIX &amp; Internet Security"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch14_04.htm"TITLE="14.4 Modems and Security"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 14.4 Modems and Security"BORDER="0"></A></TD></TR><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172">14.2 Serial Interfaces</TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="index"HREF="index/idx_0.htm"TITLE="Book Index"><IMGSRC="../gifs/index.gif"ALT="Book Index"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172">14.4 Modems and Security</TD></TR></TABLE><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><PCLASS="nav"><FONTSIZE="-1">[ <AHREF="../index.htm"TITLE="The Networking CD Bookshelf">Library Home</A> | <AHREF="../dnsbind/index.htm"TITLE="DNS &amp; BIND">DNS &amp; BIND</A> | <AHREF="../tcpip/index.htm"TITLE="TCP/IP Network Administration">TCP/IP</A> | <AHREF="../sendmail/index.htm"TITLE="sendmail">sendmail</A> | <AHREF="../smdref/index.htm"TITLE="sendmail Desktop Reference">sendmail Reference</A> | <AHREF="../firewall/index.htm"TITLE="Building Internet Firewalls">Firewalls</A> | <AHREF="index.htm"TITLE="Practical UNIX &amp; Internet Security">Practical Security</A> ]</FONT></P></DIV></BODY></HTML>