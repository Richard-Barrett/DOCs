<HTML><HEAD><TITLE>[Chapter 14] 14.5 Modems and UNIX</TITLE><METANAME="DC.title"CONTENT="Practical UNIX &amp; Internet Security"><METANAME="DC.creator"CONTENT="Simson Garfinkel &amp; Gene Spafford"><METANAME="DC.publisher"CONTENT="O'Reilly &amp; Associates, Inc."><METANAME="DC.date"CONTENT="1999-02-04T00:11:46Z"><METANAME="DC.type"CONTENT="Text.Monograph"><METANAME="DC.format"CONTENT="text/html"SCHEME="MIME"><METANAME="DC.source"CONTENT="1-56592-148-8"SCHEME="ISBN"><METANAME="DC.language"CONTENT="en-US"><METANAME="generator"CONTENT="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><LINKREV="made"HREF="mailto:online-books@oreilly.com"TITLE="Online Books Comments"><LINKREL="up"HREF="ch14_01.htm"TITLE="14. Telephone Security"><LINKREL="prev"HREF="ch14_04.htm"TITLE="14.4 Modems and Security"><LINKREL="next"HREF="ch14_06.htm"TITLE="14.6 Additional Security for Modems"></HEAD><BODYBGCOLOR="#FFFFFF"TEXT="#000000"><DIVCLASS="htmlnav"><H1><IMGSRC="gifs/smbanner.gif"ALT="Practical UNIX &amp; Internet Security"USEMAP="#srchmap"BORDER="0"></H1><MAPNAME="srchmap"><AREASHAPE="RECT"COORDS="0,0,466,65"HREF="index.htm"ALT="Practical UNIX &amp; Internet Security"><AREASHAPE="RECT"COORDS="467,0,514,18"HREF="../search/psrch.htm"ALT="Search this book"></MAP><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch14_04.htm"TITLE="14.4 Modems and Security"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 14.4 Modems and Security"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><B><FONTFACE="ARIEL,HELVETICA,HELV,SANSERIF"SIZE="-1">Chapter 14<BR>Telephone Security</FONT></B></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch14_06.htm"TITLE="14.6 Additional Security for Modems"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 14.6 Additional Security for Modems"BORDER="0"></A></TD></TR></TABLE>&nbsp;<HRALIGN="LEFT"WIDTH="515"TITLE="footer"></DIV><DIVCLASS="SECT1"><H2CLASS="sect1"><ACLASS="title"NAME="PUIS-CHP-14-SECT-5">14.5 Modems and UNIX</A></H2><PCLASS="para"><SPANCLASS="acronym">UNIX</SPAN><ACLASS="indexterm"NAME="AUTOID-17753"></A><ACLASS="indexterm"NAME="AUTOID-17756"></A>can use modems bothfor placing calls (dialing out) and for receiving them (lettingother people dial in).</P><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-17760"></A>Ifyou are calling out, you can call computers running any operatingsystem. Outgoing calls are usually made with the <EMCLASS="emphasis"><ACLASS="indexterm"NAME="AUTOID-17763"></A><ACLASS="indexterm"NAME="AUTOID-17765"></A>tip </EM>or <EMCLASS="emphasis">cu </EM>commands.If you call a computer that's running the <SPANCLASS="acronym">UNIX</SPAN>operating system, you may be able to use a simple file-transfersystem built into <EMCLASS="emphasis">tip</EM> and <EMCLASS="emphasis">cu</EM>.Unfortunately, such a system performs no error checking or correctionand works only for transferring text files.</P><PCLASS="para">Anotherpopular program for dialing out is <EMCLASS="emphasis"><ACLASS="indexterm"NAME="AUTOID-17773"></A><ACLASS="indexterm"NAME="AUTOID-17775"></A>kermit</EM>, from Columbia University.Besides performing terminal emulation, <EMCLASS="emphasis">kermit</EM>also allows reliable file transfer between different kinds of computers.Versions of <EMCLASS="emphasis">kermit</EM> are available for practicallyevery kind of computer in existence.</P><PCLASS="para">You can also setup your computer's modem to let people with their own modemscall into your computer. There are many reasons why you might wishto do this:</P><ULCLASS="itemizedlist"><LICLASS="listitem"><PCLASS="para">If you have many people within yourorganization who want to use your computer, but they need to useit only infrequently, the most cost-effective approach might beto have each employee call your computer, rather than wiring terminallines to every person's office.</P></LI><LICLASS="listitem"><PCLASS="para">If some people in your organization travel a lot,they might want to use a modem to access the computer when they'reout of town.</P></LI><LICLASS="listitem"><PCLASS="para">If people in your organization want to use the computerfrom their homes after hours or on weekends, a modem will allowthem to do so.</P></LI><LICLASS="listitem"><PCLASS="para">You can have administrators do some remote maintenanceand administration when they are &quot;on call.&quot;</P></LI></UL><PCLASS="para"><SPANCLASS="acronym">UNIX</SPAN> also uses modems with the <ACLASS="indexterm"NAME="AUTOID-17793"></A><SPANCLASS="acronym">UUCP</SPAN> (<SPANCLASS="acronym">UNIX</SPAN>-to<SPANCLASS="acronym">-UNIX</SPAN>Copy) network system, which allows different computers to exchangeelectronic mail; we discuss <SPANCLASS="acronym">UUCP</SPAN> in detail in<ACLASS="xref"HREF="ch15_01.htm"TITLE="UUCP">Chapter 15, <CITECLASS="chapter">UUCP</CITE></A>. You can also usemodems with <SPANCLASS="acronym">SLIP</SPAN><ACLASS="indexterm"NAME="AUTOID-17801"></A><ACLASS="indexterm"NAME="AUTOID-17803"></A>(SerialLine Internet Protocol) or <SPANCLASS="acronym">PPP</SPAN><ACLASS="indexterm"NAME="AUTOID-17806"></A><ACLASS="indexterm"NAME="AUTOID-17808"></A>(Point-to-PointProtocol) to integrate remote computers transparently with localarea networks. To set up a <SPANCLASS="acronym">UUCP</SPAN>, <SPANCLASS="acronym">SLIP</SPAN>,or <SPANCLASS="acronym">PPP</SPAN> link between two computers, one computermust be able to place telephone calls and the other must be ableto receive them.</P><PCLASS="para">Despite these benefits, modems comewith many risks. Because people routinely use modems to transmittheir usernames and passwords, you should ensure that your modemsare properly installed, behaving properly, and doing exactly whatyou think they are doing&nbsp;- and nothing else.</P><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="PUIS-CHP-14-SECT-5.1">14.5.1 Hooking Up a Modem to Your Computer</A></H3><PCLASS="para">Becauseevery computer and every modem is a little different, follow yourmanufacturer's directions when connecting a modem to yourcomputer. Usually, there is a simple, ready-made cable that canbe used to connect the two. If you are lucky, that cable may evencome in the same box as your modem.</P><PCLASS="para">After the modemis physically connected, you will need to set up a number of configurationfiles on your computer so that your system knows where the modemis connected and what kind of commands it responds to.</P><PCLASS="para">OnBerkeley-derived systems, you may have to modify the files <EMCLASS="emphasis"><ACLASS="indexterm"NAME="AUTOID-17820"></A><ACLASS="indexterm"NAME="AUTOID-17822"></A><ACLASS="indexterm"NAME="AUTOID-17825"></A><ACLASS="indexterm"NAME="AUTOID-17827"></A><ACLASS="indexterm"NAME="AUTOID-17830"></A><ACLASS="indexterm"NAME="AUTOID-17832"></A>/etc/ttys</EM>, <EMCLASS="emphasis">/etc/remote</EM>,and <EMCLASS="emphasis">/usr/lib/uucp/L-devices</EM> if you wish touse <SPANCLASS="acronym">UUCP</SPAN>. On <ACLASS="indexterm"NAME="AUTOID-17838"></A><ACLASS="indexterm"NAME="AUTOID-17841"></A>System V systems, you may haveto modify the files <EMCLASS="emphasis"><ACLASS="indexterm"NAME="AUTOID-17845"></A><ACLASS="indexterm"NAME="AUTOID-17847"></A><ACLASS="indexterm"NAME="AUTOID-17849"></A>/etc/inittab</EM>and <EMCLASS="emphasis">/usr/lib/uucp/Devices</EM>. You may also haveto create a special device file in the <ICLASS="filename"><ACLASS="indexterm"NAME="AUTOID-17854"></A>/dev</I> directory, orchange the permissions on an existing file. The formats of thesefiles are discussed in Chapter&nbsp;15, UUCP.</P><PCLASS="para">Dependingon the software you are using, you should also check the <ACLASS="indexterm"NAME="AUTOID-17857"></A>permissions on any configuration files used withyour modem software. These may include files of commands, phonenumbers, <SPANCLASS="acronym">PPP</SPAN> or <SPANCLASS="acronym">SLIP</SPAN> initializationvalues, and so on. As the number and location of these files varyconsiderably from system to system, we can only suggest that youread the documentation carefully for the names of any auxiliaryfiles that may be involved. Pay special attention to any <EMCLASS="emphasis">man</EM>pages associated with the software as they often include a sectionentitled &quot;Files&quot; that names associated files.</P></DIV><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="PUIS-CHP-14-SECT-5.2">14.5.2 Setting Up the UNIX Device</A></H3><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-17866"></A>Each version of <SPANCLASS="acronym">UNIX</SPAN> has oneor more special devices in the <EMCLASS="emphasis">/dev</EM> directorythat are dedicated to modem control. Some of the names that we haveseen are:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">/dev/cua*/dev/ttyda/dev/ttys[0-9]/dev/tty1A/dev/modem/dev/ttydfa</PRE></BLOCKQUOTE><PCLASS="para">Some versions of <SPANCLASS="acronym">UNIX</SPAN> use the same devicesfor inbound and outbound calls; others use different names for eachpurpose, even though the names represent the same physical device.Check your documentation to see what the filenames are for yoursystem.</P><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-17875"></A>Permissionsfor the <SPANCLASS="acronym">UNIX</SPAN> devices associated with modems shouldbe set to mode 600 and owned by either <EMCLASS="emphasis">root</EM>or <EMCLASS="emphasis">uucp</EM>. If the modem device is made readableby group or world, it might be possible for users to intercept incomingphone calls and eavesdrop on ongoing conversations, or create TrojanHorse programs that invite unsuspecting callers to type their usernamesand passwords.</P><PCLASS="para">Permissions for the <SPANCLASS="acronym">UNIX</SPAN>devices associated with the outgoing modems should also be set sothat the modems cannot be accessed by ordinary users. Usually, thesepermissions are achieved by setting the devices to mode 600, andare owned by either <EMCLASS="emphasis">root</EM> or <EMCLASS="emphasis">uucp</EM>.To make an outgoing call, users must then use a specially designatedcommunications program such as <EMCLASS="emphasis">tip</EM> or <EMCLASS="emphasis">cu</EM>.These systems must be installed <EMCLASS="emphasis">SUID</EM> so thatthey can access the external device.</P><PCLASS="para">You can check theownership and modes of these devices with the <EMCLASS="emphasis">ls</EM>command:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">% ls -lgd /dev/cu*crw----- 1 uucp &nbsp;&nbsp;&nbsp;&nbsp;wheel&nbsp;&nbsp;&nbsp; 11,192 Oct 20 10:38 /dev/cuacrw----- 1 uucp &nbsp;&nbsp;&nbsp;&nbsp;wheel&nbsp;&nbsp;&nbsp; 11,193 Dec 21 1989&nbsp;&nbsp;/dev/cub%</PRE></BLOCKQUOTE></DIV><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="PUIS-CHP-14-SECT-5.3">14.5.3 Checking Your Modem</A></H3><PCLASS="para">After your modemis connected, you should thoroughly test its ability to make andreceive telephone calls. First, make sure that the modem behavesproperly under normal operating circumstances. Next, make sure thatwhen something unexpected happens, the computer behaves in a reasonableand responsible way. For example, if a telephone connection is lost,your computer should kill the associated processes and log the userout, rather than letting the next person who dials in type commandsat the previous shell. Most of this testing will ensure that yourmodem's control signals are being properly sent to thecomputer (so that your computer knows when a call is in progress),as well as ensuring that your computer behaves properly with thisinformation.</P><DIVCLASS="sect3"><H4CLASS="sect3"><ACLASS="title"NAME="PUIS-CHP-14-SECT-5.3.1">14.5.3.1 Originate testing</A></H4><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-17897"></A>If you have configured your modem to place telephonecalls, you need to verify that it always does the right thing whencalls are placed as well as when they are disconnected.</P><PCLASS="para">Totest your modem, you must call another computer that you know behavesproperly. (Do not place a call to the same computer that you aretrying to call out from; if there are problems, you may not be ableto tell where the problem lies.)</P><PCLASS="para">Test as follows:</P><OLCLASS="orderedlist"><LICLASS="listitem"><PCLASS="para">Try calling the remote computer withthe <EMCLASS="emphasis"><ACLASS="indexterm"NAME="AUTOID-17905"></A><ACLASS="indexterm"NAME="AUTOID-17907"></A>tip</EM>or <EMCLASS="emphasis">cu</EM> command. When the computer answers, youshould be able to log in and use the remote computer as if you wereconnected directly.</P></LI><LICLASS="listitem"><PCLASS="para">Hang up on the remote computer by pulling the telephoneline out of the originating modem. Your <EMCLASS="emphasis">tip</EM>or <EMCLASS="emphasis">cu</EM> program should realize that the connectionhas been lost and return you to the <SPANCLASS="acronym">UNIX</SPAN> prompt.</P></LI><LICLASS="listitem"><PCLASS="para">Call the remote computer again and this time hangup by turning off your modem. Again, your <EMCLASS="emphasis">tip</EM>or <EMCLASS="emphasis">cu</EM> program should realize that somethingis wrong and return you to the <SPANCLASS="acronym">UNIX</SPAN> prompt.</P></LI><LICLASS="listitem"><PCLASS="para">Call the remote computer again. This time, leavethe telephone connection intact and exit your <EMCLASS="emphasis">tip</EM>or <EMCLASS="emphasis">cu</EM> program by typing the following sequence:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">carriage return, tilde (~), period (.), carriage return </PRE></BLOCKQUOTE></LI></OL><PCLASS="para">Your modemshould automatically hang up on the remote computer.</P><OLCLASS="orderedlist"><LICLASS="listitem"><PCLASS="para">Call the remote computer one last time.This time, do a software disconnect by killing the <EMCLASS="emphasis">tip</EM>or <EMCLASS="emphasis">cu</EM> process on your local computer from anotherterminal. (You may need to be the superuser to use the <EMCLASS="emphasis">kill</EM>command to kill the other process. See <ACLASS="xref"HREF="appc_01.htm"TITLE="UNIX Processes">Appendix C, <CITECLASS="appendix">UNIX Processes</CITE></A>, for details about how to use thesecommands.) Once again, your modem should automatically hang up onthe remote computer.</P></LI></OL><PCLASS="para">The abovesequence of steps checks out the modem control signals between yourcomputer and your modem. If things do not work properly, then oneof the following may be a problem:</P><ULCLASS="itemizedlist"><LICLASS="listitem"><PCLASS="para">The cable connecting your modem andcomputer may be shorting together several pins, may have a brokenwire, or may be connecting the wrong pins on each connector together.</P></LI><LICLASS="listitem"><PCLASS="para">Your modem may not be properly configured. Manymodems have switches or internal registers that can make the modemignore some or all of the modem control signals.</P></LI><LICLASS="listitem"><PCLASS="para">You may be using the wrong <SPANCLASS="acronym">UNIX</SPAN>device. Many versions of <SPANCLASS="acronym">UNIX</SPAN> have several differentdevices in the <EMCLASS="emphasis">/dev</EM> directory for referringto each physical serial port. Usually one of these devices usesthe modem control signals, while others do not. Check your documentationand make sure you're using the proper device.</P></LI><LICLASS="listitem"><PCLASS="para">Your software vendor might not have figured outhow to make a <EMCLASS="emphasis">tty</EM> driver that works properly.Many older versions of <SPANCLASS="acronym">DEC</SPAN>'s Ultrixhad problems with their <EMCLASS="emphasis">tty</EM> drivers, for example.</P></LI></UL><PCLASS="para">Other things to check fordialing out include:</P><ULCLASS="itemizedlist"><LICLASS="listitem"><PCLASS="para">Make sure there is no way to enteryour modem's programming mode by sending an &quot;<ACLASS="indexterm"NAME="AUTOID-17953"></A>escape sequence.&quot; An escapesequence is a sequence of characters that lets you reassert controlover the modem and reprogram it. Most <SPANCLASS="acronym">UNIX</SPAN> modemcontrol programs will disable the modem's escape sequence,but some do not.[5]</P><BLOCKQUOTECLASS="footnote"><PCLASS="para">[5] Most modems that use the Hayes &quot;<EMCLASS="emphasis">AT</EM>&quot;command set, for example, can be forced into programming mode byallowing a three-second pause; sending three plus signs (+),the default escape character, in quick succession; and waiting anotherthree seconds. If your modem prints &quot;OK,&quot; thenyour modem's escape sequence is still active.</P></BLOCKQUOTE><PCLASS="para">If your modem's escape sequence is not disabled,consult your modem documentation or contact your modem vendor todetermine how to disable the sequence. This step may require youto add some additional initialization sequence to the modem software,or set some configuration switches.</P></LI><LICLASS="listitem"><PCLASS="para">Verify that your modems lock properly. Be sure thatthere is no way for one user to make <EMCLASS="emphasis">tip</EM> or<EMCLASS="emphasis">cu</EM> use a modem that is currently in use byanother user or by the <SPANCLASS="acronym">UUCP</SPAN> system. Likewise,make sure that <SPANCLASS="acronym">UUCP</SPAN> does not use a telephoneline that is being used interactively.</P></LI></UL><PCLASS="para">Finally, verify that every modem connected to your computerworks as indicated above. Both <EMCLASS="emphasis">cu</EM> and <EMCLASS="emphasis">tip</EM>allow you to specify which modem to use with<EMCLASS="emphasis"><ACLASS="indexterm"NAME="AUTOID-17970"></A><ACLASS="indexterm"NAME="AUTOID-17973"></A></EM> the<EMCLASS="emphasis">-l</EM> option. Try them all.</P><PCLASS="para">If the<EMCLASS="emphasis">cu</EM> or <EMCLASS="emphasis">tip</EM> program doesnot exit when the telephone is disconnected, or if it is possibleto return the modem to programming mode by sending an escape sequence,a user may be able to make telephone calls that are not logged.A user might even be able to reprogram the modem, causing it tocall a specific phone number automatically, no matter what phonenumber it was instructed to call. At the other end, a Trojan horsemight be waiting for your users.</P><PCLASS="para">If the modem doesnot hang up the phone when <EMCLASS="emphasis">cu</EM> exits, it canresult in abnormally high telephone bills. Perhaps more importantly,if a modem does not hang up the telephone when the <EMCLASS="emphasis">tip</EM>or <EMCLASS="emphasis">cu</EM> program exits, then your user might remainlogged into the remote machine. The next person who uses the <EMCLASS="emphasis">tip</EM>or <EMCLASS="emphasis">cu</EM> program would then have full access tothat first user's account on the remote computer. <ACLASS="indexterm"NAME="AUTOID-17986"></A></P></DIV><DIVCLASS="sect3"><H4CLASS="sect3"><ACLASS="title"NAME="PUIS-CHP-14-SECT-5.3.2">14.5.3.2 Answer testing</A></H4><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-17991"></A>Totest your computer's answering ability, you need anothercomputer or terminal with a second modem to call your computer.</P><PCLASS="para">Test as follows:</P><OLCLASS="orderedlist"><LICLASS="listitem"><PCLASS="para">Call your computer. It should answerthe phone on the first few rings and print a login:<KBDCLASS="command"> </KBD>banner.If your modem is set to cycle among various baud rates, you mayneed to press the <ACLASS="indexterm"NAME="AUTOID-17998"></A><SPANCLASS="acronym">BREAK</SPAN>or linefeed key on your terminal a few times to synchronize theanswering modem's baud rate with the one that you are using.You should <EMCLASS="emphasis">not </EM>press <SPANCLASS="acronym">BREAK</SPAN>if you are using a <SPANCLASS="acronym">MNP</SPAN> modem that automaticallyselects baud rate.</P></LI><LICLASS="listitem"><PCLASS="para">Log in as usual. Type <EMCLASS="emphasis">tty</EM> todetermine for sure which serial line you are using. Then log out.Your computer should hang up the phone. (Some versions of SystemV <SPANCLASS="acronym">UNIX</SPAN> will instead print a second <KBDCLASS="command">login:</KBD>banner. Pressing <SPANCLASS="acronym">CTRL-D</SPAN> at this banner may hangup the telephone.)</P></LI><LICLASS="listitem"><PCLASS="para">Call your computer and log in a second time. Thistime, hang up the telephone by pulling the telephone line out ofthe originating modem. This action simulates having the phone connectionaccidentally broken. Call your computer back on the same telephonenumber. You should get a new <KBDCLASS="command">login: </KBD>banner. Youshould <EMCLASS="emphasis">not </EM>be reconnected to your old shell;that shell should have had its process destroyed when the connectionwas broken. Type <EMCLASS="emphasis">tty</EM> again to make sure thatyou got the same modem. Use the <EMCLASS="emphasis">ps</EM> commandto ensure that your old process was killed. <SPANCLASS="acronym">UNIX</SPAN>must automatically log you out when the telephone connection isbroken. Otherwise, if the telephone is accidentally hung up andsomebody else calls your computer, that person will be able to typecommands as if he was a legitimate user, without ever having tolog in or enter a password.</P></LI><LICLASS="listitem"><PCLASS="para">Verify that every modem connected to your computerbehaves in this manner. Call the modem with a terminal, log in,then unplug the telephone line going into the originating modemto hang up the phone. <EMCLASS="emphasis">Immediately</EM> redial the<SPANCLASS="acronym">UNIX</SPAN> computer's modem and verify thatyou get a new <KBDCLASS="command">login:</KBD> prompt.</P></LI></OL><BLOCKQUOTECLASS="note"><PCLASS="para"><STRONG>NOTE:</STRONG> Even though <SPANCLASS="acronym">UNIX</SPAN> should automaticallylog you out when you hang up the telephone, do not depend on thisfeature. Always log out of a remote system before disconnectingfrom it.</P></BLOCKQUOTE><OLCLASS="orderedlist"><LICLASS="listitem"><PCLASS="para">If you have several modems connectedto a hunt group (a pool of modems where the first non-busy one answers,and all calls are made to a single number), make sure that the grouphunts properly. Many don't&nbsp;- which results in callersgetting busy signals even when there are modems available.</P></LI></OL></DIV><DIVCLASS="sect3"><H4CLASS="sect3"><ACLASS="title"NAME="PUIS-CHP-14-SECT-5.3.3">14.5.3.3 Privilege testing</A></H4><PCLASS="para">Programs such as <EMCLASS="emphasis"><ACLASS="indexterm"NAME="AUTOID-18032"></A><ACLASS="indexterm"NAME="AUTOID-18034"></A><ACLASS="indexterm"NAME="AUTOID-18036"></A>cu</EM>and <EMCLASS="emphasis">tip</EM> usually must run <SPANCLASS="acronym">SUID</SPAN>so that they can manipulate the devices associated with the modems.However, these programs are specially designed so that if the userattempts a shell escape, the command runs with the user's<SPANCLASS="acronym">UID</SPAN> and not the program's. (Likewise,if the user tries to redirect data to or from a file, <EMCLASS="emphasis">cu</EM>and <EMCLASS="emphasis">tip</EM> are careful not to give the user accessto a file to which the user would normally not otherwise have access.)You should check your versions of <EMCLASS="emphasis">cu</EM> and <EMCLASS="emphasis">tip</EM>to make sure that users are not granted any special privileges whenthey run these programs.</P><PCLASS="para">One way to check to make sureyour program is properly configured is to use <EMCLASS="emphasis">cu</EM>or <EMCLASS="emphasis">tip</EM> to connect to a remote machine and thenuse a shell escape that creates a file in the <EMCLASS="emphasis"><ACLASS="indexterm"NAME="AUTOID-18049"></A>/tmp</EM> directory. Then,look at the file to see who owns it. For example:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">% <BCLASS="emphasis.bold">tip 5557000</B>connectedlogin: ~![sh]	% <BCLASS="emphasis.bold">touch /tmp/myfile</B>% <BCLASS="emphasis.bold">ls -l /tmp/myfile</B>-rw-r--r-- 1 jason &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0 Jul 12 12:19 /tmp/myfile%</PRE></BLOCKQUOTE><PCLASS="para">The file should be owned by the user who runs the <EMCLASS="emphasis">cu</EM>or <EMCLASS="emphasis">tip</EM> program, and <EMCLASS="emphasis">not </EM>by<EMCLASS="emphasis">root</EM> or <EMCLASS="emphasis">uucp</EM>.</P><PCLASS="para">Somecommunications programs, such as <EMCLASS="emphasis"><ACLASS="indexterm"NAME="AUTOID-18063"></A>kermit</EM>,must be installed <SPANCLASS="acronym">SUID</SPAN> <EMCLASS="emphasis">uucp</EM>,and not <EMCLASS="emphasis">root</EM>. For example, if you try to runkermit if it is <SPANCLASS="acronym">SUID</SPAN> <EMCLASS="emphasis">root</EM>,you will get the following message:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">unix% <BCLASS="emphasis.bold">kermit</B>Fatal: C-Kermit setuid to root!unix%</PRE></BLOCKQUOTE><PCLASS="para">Thereason for this behavior is that <SPANCLASS="acronym">SUID</SPAN> <EMCLASS="emphasis">root</EM>programs can be dangerous things, and the authors of <ICLASS="filename">kermit</I> wisely decided that the program was too complex to beentrusted with such privilege. Instead,<ICLASS="filename"> kermit</I>should be installed <SPANCLASS="acronym">SUID</SPAN> <EMCLASS="emphasis">uucp</EM>,and with the outbound modems similarly configured. In this manner,<ICLASS="filename">kermit</I> has access to the modems and nothingelse.</P><PCLASS="para">If you have a third-party communications programthat you cannot install <SPANCLASS="acronym">SUID</SPAN> <ICLASS="systemitem">uucp</I>, you may wish to use <SPANCLASS="acronym">SGID</SPAN>instead. Simply create a <EMCLASS="emphasis">uucp</EM> group, set thegroup of the modem <SPANCLASS="acronym">UNIX</SPAN> devices to be <SPANCLASS="acronym">UUCP</SPAN>and give the group both read and write access to the modems, andmake the third-party program <SPANCLASS="acronym">SGID</SPAN> <EMCLASS="emphasis">uucp</EM>.And if these measures don't work, complain to your softwarevendor!<ACLASS="indexterm"NAME="AUTOID-18089"></A><ACLASS="indexterm"NAME="AUTOID-18092"></A></P></DIV></DIV><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="PUIS-CHP-14-SECT-5.4">14.5.4 Physical Protection of Modems</A></H3><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-18098"></A><ACLASS="indexterm"NAME="AUTOID-18101"></A>Althoughphysical protection is often overlooked, protecting the physicalaccess to your telephone line is as important as securing the computerto which the telephone line and its modem are connected.</P><PCLASS="para">Besure to follow these guidelines:</P><ULCLASS="itemizedlist"><LICLASS="listitem"><PCLASS="para"><BCLASS="emphasis.bold">Protect physical access to your telephone line.</B> Be sure that your telephone<ACLASS="indexterm"NAME="AUTOID-18109"></A><ACLASS="indexterm"NAME="AUTOID-18112"></A>line is physically secure. Lock all junction boxes. Place the telephoneline itself in an electrical conduit, pulled through walls, or atleast located in locked areas. An intruder who gains physical accessto your telephone line can attach his or her own modem to the lineand intercept your telephone calls before they reach your computer.By spoofing your users, the intruder may learn their login namesand passwords. Instead of intercepting your telephone calls, anintruder might simply monitor them, making a transcript of all ofthe information sent in either direction. In this way, the intrudermight learn passwords not only to your system, but to all of thesystems to which your users connect.</P></LI><LICLASS="listitem"><PCLASS="para"><BCLASS="emphasis.bold">Make sure your telephone line does not allow callforwarding.</B> <ACLASS="indexterm"NAME="AUTOID-18119"></A>If your telephonecan be programmed for call forwarding, an intruder can effectivelytransfer all incoming telephone calls to a number of his choosing.If there is a computer at the new number that has been programmedto act like your system, your users might be fooled into typingtheir usernames and passwords.</P></LI><LICLASS="listitem"><PCLASS="para"><BCLASS="emphasis.bold">Consider using a leased line. </B><ACLASS="indexterm"NAME="AUTOID-18124"></A><ACLASS="indexterm"NAME="AUTOID-18126"></A>If all your modemusage is to a single outside location, consider getting a leasedline. A leased line is a dedicated circuit between two points providedby the phone company. It acts like a dedicated cable, and cannotbe used to place or receive calls. As such, it allows you to keepyour connection with the remote site, but it does not allow someoneto dial up your modem and attempt a break-in. Leased lines are moreexpensive than regular lines in most places, but the security mayoutweigh the cost. Leased lines offer another advantage: you canusually transfer data much faster over leased lines than over standardtelephone lines.</P></LI><LICLASS="listitem"><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-18132"></A><BCLASS="emphasis.bold">Don't get longdistance service.</B> If you don't intend to use the telephonefor long-distance calls, do not order long distance service forthe telephone lines.</P></LI><LICLASS="listitem"><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-18137"></A><BCLASS="emphasis.bold">Have your telephone company disable third-party billing.</B> Without third-party billing,people can't bill their calls to your modem line.</P></LI></UL></DIV></DIV><DIVCLASS="htmlnav"><P></P><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch14_04.htm"TITLE="14.4 Modems and Security"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 14.4 Modems and Security"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="book"HREF="index.htm"TITLE="Practical UNIX &amp; Internet Security"><IMGSRC="../gifs/txthome.gif"ALT="Practical UNIX &amp; Internet Security"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch14_06.htm"TITLE="14.6 Additional Security for Modems"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 14.6 Additional Security for Modems"BORDER="0"></A></TD></TR><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172">14.4 Modems and Security</TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="index"HREF="index/idx_0.htm"TITLE="Book Index"><IMGSRC="../gifs/index.gif"ALT="Book Index"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172">14.6 Additional Security for Modems</TD></TR></TABLE><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><PCLASS="nav"><FONTSIZE="-1">[ <AHREF="../index.htm"TITLE="The Networking CD Bookshelf">Library Home</A> | <AHREF="../dnsbind/index.htm"TITLE="DNS &amp; BIND">DNS &amp; BIND</A> | <AHREF="../tcpip/index.htm"TITLE="TCP/IP Network Administration">TCP/IP</A> | <AHREF="../sendmail/index.htm"TITLE="sendmail">sendmail</A> | <AHREF="../smdref/index.htm"TITLE="sendmail Desktop Reference">sendmail Reference</A> | <AHREF="../firewall/index.htm"TITLE="Building Internet Firewalls">Firewalls</A> | <AHREF="index.htm"TITLE="Practical UNIX &amp; Internet Security">Practical Security</A> ]</FONT></P></DIV></BODY></HTML>