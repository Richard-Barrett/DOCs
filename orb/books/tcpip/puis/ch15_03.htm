<HTML><HEAD><TITLE>[Chapter 15] 15.3 UUCP and Security</TITLE><METANAME="DC.title"CONTENT="Practical UNIX &amp; Internet Security"><METANAME="DC.creator"CONTENT="Simson Garfinkel &amp; Gene Spafford"><METANAME="DC.publisher"CONTENT="O'Reilly &amp; Associates, Inc."><METANAME="DC.date"CONTENT="1999-02-04T00:12:01Z"><METANAME="DC.type"CONTENT="Text.Monograph"><METANAME="DC.format"CONTENT="text/html"SCHEME="MIME"><METANAME="DC.source"CONTENT="1-56592-148-8"SCHEME="ISBN"><METANAME="DC.language"CONTENT="en-US"><METANAME="generator"CONTENT="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><LINKREV="made"HREF="mailto:online-books@oreilly.com"TITLE="Online Books Comments"><LINKREL="up"HREF="ch15_01.htm"TITLE="15. UUCP"><LINKREL="prev"HREF="ch15_02.htm"TITLE="15.2 Versions of UUCP"><LINKREL="next"HREF="ch15_04.htm"TITLE="15.4 Security in Version 2 UUCP"></HEAD><BODYBGCOLOR="#FFFFFF"TEXT="#000000"><DIVCLASS="htmlnav"><H1><IMGSRC="gifs/smbanner.gif"ALT="Practical UNIX &amp; Internet Security"USEMAP="#srchmap"BORDER="0"></H1><MAPNAME="srchmap"><AREASHAPE="RECT"COORDS="0,0,466,65"HREF="index.htm"ALT="Practical UNIX &amp; Internet Security"><AREASHAPE="RECT"COORDS="467,0,514,18"HREF="../search/psrch.htm"ALT="Search this book"></MAP><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch15_02.htm"TITLE="15.2 Versions of UUCP"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 15.2 Versions of UUCP"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><B><FONTFACE="ARIEL,HELVETICA,HELV,SANSERIF"SIZE="-1">Chapter 15<BR>UUCP</FONT></B></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch15_04.htm"TITLE="15.4 Security in Version 2 UUCP"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 15.4 Security in Version 2 UUCP"BORDER="0"></A></TD></TR></TABLE>&nbsp;<HRALIGN="LEFT"WIDTH="515"TITLE="footer"></DIV><DIVCLASS="SECT1"><H2CLASS="sect1"><ACLASS="title"NAME="PUIS-CHP-15-SECT-3">15.3 UUCP and Security</A></H2><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-18595"></A>Any system that allows files to be copiedfrom computer to computer and allows commands to be remotely executedraises a number of security concerns. What mechanisms exist to preventunauthorized use? What prevents an attacker from using the systemto gain unauthorized entry? What prevents an attacker from reverseengineering the system to capture confidential information? Fortunately,<SPANCLASS="acronym">UUCP</SPAN> has many security measures built into itto minimize the dangers posed by its capabilities. For example:</P><ULCLASS="itemizedlist"><LICLASS="listitem"><PCLASS="para">The <EMCLASS="emphasis"><ACLASS="indexterm"NAME="AUTOID-18604"></A>uucico</EM>program must log into your system to transfer files or run commands.By assigning a password to the <EMCLASS="emphasis">uucp</EM> account,you can prevent unauthorized users from logging in.</P></LI><LICLASS="listitem"><PCLASS="para">The <SPANCLASS="acronym">UUCP</SPAN> programs run <ACLASS="indexterm"NAME="AUTOID-18610"></A><SPANCLASS="acronym">SUID</SPAN> <EMCLASS="emphasis">uucp</EM>,not <SPANCLASS="acronym">SUID</SPAN> <EMCLASS="emphasis">root</EM>. Other thanbeing able to read the spooled <SPANCLASS="acronym">UUCP</SPAN> files, the<EMCLASS="emphasis">uucp</EM> user doesn't have any specialprivileges. It can read only files that are owned by <EMCLASS="emphasis">uucp</EM>or that are readable by everybody on the system; likewise, it cancreate files only in directories that are owned by <EMCLASS="emphasis">uucp</EM>or in directories that are world writable.</P></LI><LICLASS="listitem"><PCLASS="para">The <SPANCLASS="acronym">UUCP</SPAN> login does not receivea normal shell, but instead invokes another copy of <EMCLASS="emphasis">uucico</EM>.The only functions that can be performed by this copy of <EMCLASS="emphasis">uucico</EM>are those specified by the system administrator.</P></LI></UL><PCLASS="para">As <ACLASS="indexterm"NAME="AUTOID-18627"></A>systemadministrator, you have a few more tools for controlling the levelof security:</P><ULCLASS="itemizedlist"><LICLASS="listitem"><PCLASS="para">You can create additional <EMCLASS="emphasis">/etc/passwd</EM>entries for each system that calls your machine, allowing you togrant different privileges and access to different remote computers.</P></LI><LICLASS="listitem"><PCLASS="para">You can configure <SPANCLASS="acronym">UUCP</SPAN> so remotesystems can retrieve files only from particular directories. Alternatively,you can turn off remote file retrieval altogether.</P></LI><LICLASS="listitem"><PCLASS="para">You can require callback for certain systems, soyou can be reasonably sure that the <SPANCLASS="acronym">UUCP</SPAN> systemyou are communicating with is not an impostor.</P></LI></UL><PCLASS="para">But even with these protective mechanisms, <SPANCLASS="acronym">UUCP</SPAN><EMCLASS="emphasis">can</EM> compromise system security if it is notproperly installed. And once one system is compromised, it can beused to compromise others, because <SPANCLASS="acronym">UUCP</SPAN> passwordsare stored unencrypted.</P><BLOCKQUOTECLASS="note"><PCLASS="para"><STRONG>NOTE:</STRONG> If you run an <ACLASS="indexterm"NAME="AUTOID-18646"></A><ACLASS="indexterm"NAME="AUTOID-18649"></A><SPANCLASS="acronym">NFS</SPAN>server on the same computer that you use for <SPANCLASS="acronym">UUCP</SPAN>,the <SPANCLASS="acronym">NFS</SPAN> server must not export the <SPANCLASS="acronym">UUCP</SPAN>configuration, program, or data directories. This is because the<SPANCLASS="acronym">UUCP</SPAN> files are owned by the <EMCLASS="emphasis">uucp</EM>user, not by the user <EMCLASS="emphasis">root</EM>. In standard <SPANCLASS="acronym">NFS</SPAN>,only files owned by <EMCLASS="emphasis">root</EM> are protected. Thus,an attacker could use <SPANCLASS="acronym">NFS</SPAN> to modify the <SPANCLASS="acronym">UUCP</SPAN>files on your system, and use that modification as a means for gainingfurther access.</P></BLOCKQUOTE><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="PUIS-CHP-15-SECT-3.1">15.3.1 Assigning Additional UUCP Logins</A></H3><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-18666"></A><ACLASS="indexterm"NAME="AUTOID-18669"></A>Most Berkeley<SPANCLASS="acronym">UNIX</SPAN> systems come with two <SPANCLASS="acronym">UUCP</SPAN>logins. The first is used by computers that call and exchange informationusing <EMCLASS="emphasis">uucico</EM>:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">uucp:Ab1zDIdS2/JCQ:4:4:Mr.&nbsp;UUCP:/usr/spool/uucppublic/:/usr/lib/uucp/uucico </PRE></BLOCKQUOTE><PCLASS="para">The second <SPANCLASS="acronym">UUCP</SPAN> login, usually called <EMCLASS="emphasis"><ACLASS="indexterm"NAME="AUTOID-18679"></A><ACLASS="indexterm"NAME="AUTOID-18681"></A>uucpa</EM>or <EMCLASS="emphasis">nuucp</EM>, has a regular shell as its loginshell. It is used for administration. (The &quot;a&quot;stands for &quot;administrator.&quot;)</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">uucp:Ab1zDIdS2/JCQ:4:4:Mr. UUCP:/usr/lib/uucp/uucicouucpa:3jd912JFK31fa:4:4:UUCP Admin:/usr/lib/uucp/:/bin/csh</PRE></BLOCKQUOTE><PCLASS="para">(System V systems usually use the account name <EMCLASS="emphasis">uucp</EM>as the administrative login and <EMCLASS="emphasis">nuucp</EM> as the<EMCLASS="emphasis">uucico</EM> login.)</P><PCLASS="para">These two loginsare all that you need to use <SPANCLASS="acronym">UUCP</SPAN>. Every machinethat calls you uses the same <EMCLASS="emphasis">uucp</EM> login. Inmost cases, every machine will be granted the same type of accesson your machine.</P><PCLASS="para">Alternatively, you may wish to assigna different login to each machine that calls you. This lets yougrant different classes of access to each machine, and gives youa lot more control over each one.</P><PCLASS="para">For example, if youare called by the machines <ICLASS="filename">garp</I>, <ICLASS="filename">idr</I>,and <ICLASS="filename">prose</I>, you might want to have a separatelogin for each of these machines[6]:</P><BLOCKQUOTECLASS="footnote"><PCLASS="para">[6] Many system administratorscapitalize the &quot;U&quot; at the beginning of dedicatedUUCP login names. This notation helps to distinguish the login namesfrom usernames that might begin with a lower-case &quot;u&quot;(e.g., ursula and ulrich). Furthermore, some software uses thisconvention to trigger special behavior&nbsp;- such as mgetty inLinux, which will switch to uucico instead of login. Reliance onsuch naming is a questionable design from a security point of view,but we do note the convention.</P></BLOCKQUOTE><BLOCKQUOTECLASS="screen"><PRECLASS="screen">uucp:asXN3sQefHsh:4:4:Mr.&nbsp;UUCP:/usr/spool/uucppublic/:/usr/lib/uucp/uucicoUgarp:ddGw1opxMz1MQ:4:4:UUCP Login for garp:/usr/spool/uucppublic/&nbsp;&nbsp;:/usr/lib/uucp/uucicoUprose:777uf2KOKdbkY:4:4:UUCP Login for prose:/usr/spool/uucppublic/&nbsp;&nbsp;:/usr/lib/uucp/uucicoUidr:asv.nbgMNy/cA:4:4:UUCP Login for idr:/usr/spool/uucppublic/&nbsp;&nbsp;:/usr/lib/uucp/uucico</PRE></BLOCKQUOTE><PCLASS="para">The only differences between these logins are their usernames,passwords, and full names; the <SPANCLASS="acronym">UIDS</SPAN>, home directories,and shells all remain the same. Having separate <SPANCLASS="acronym">UUCP</SPAN>logins lets you use the <EMCLASS="emphasis"><ACLASS="indexterm"NAME="AUTOID-18704"></A><ACLASS="indexterm"NAME="AUTOID-18706"></A>last</EM> and <EMCLASS="emphasis">finger</EM>commands to monitor who is calling you. Separate logins also makethe task of tracing security leaks easier: for example, one machinedialing in with one username and password, but pretending to beanother. Furthermore, if you decide that you no longer want a <SPANCLASS="acronym">UUCP</SPAN>link with a particular system, you can shut off access to that siteby changing the password of one of the <SPANCLASS="acronym">UUCP</SPAN> loginswithout affecting other systems.</P><PCLASS="para">If you have many <SPANCLASS="acronym">UUCP</SPAN>connections within your organization and only a few to the outside,you may wish to compromise by having one <SPANCLASS="acronym">UUCP</SPAN>login for your local connections and separate <SPANCLASS="acronym">UUCP</SPAN>logins for all of the systems that dial in from outside.</P></DIV><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="PUIS-CHP-15-SECT-3.2">15.3.2 Establishing UUCP Passwords</A></H3><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-18718"></A><ACLASS="indexterm"NAME="AUTOID-18721"></A><ACLASS="indexterm"NAME="AUTOID-18724"></A>Many <SPANCLASS="acronym">UNIX</SPAN> systems come withoutpasswords for their <SPANCLASS="acronym">UUCP</SPAN> accounts; be sure toestablish passwords for these accounts immediately, whether or notyou intend to use <SPANCLASS="acronym">UUCP</SPAN>.</P><PCLASS="para">Becausethe shell for <SPANCLASS="acronym">UUCP</SPAN> accounts is <EMCLASS="emphasis">uucico</EM>(rather than <EMCLASS="emphasis">sh</EM>, <EMCLASS="emphasis">ksh</EM>,or <EMCLASS="emphasis">csh</EM>), you can't set the passwordsfor these accounts by <EMCLASS="emphasis">su</EM>-ing to them and thenusing the <EMCLASS="emphasis">passwd</EM> command. If you do, you'llget a copy of <EMCLASS="emphasis">uucico</EM> as your shell, and youwon't be able to type sensible commands. Instead, to setthe password for the <SPANCLASS="acronym">UUCP</SPAN> account, you must becomethe superuser and use the <EMCLASS="emphasis">passwd</EM> command withits optional argument&nbsp;- the name of the account whose passwordyou are changing. For example:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">% /bin/supassword: <ICLASS="systemitem.password">bigtime!</I>				<EMCLASS="emphasis">Superuser password</EM># passwd uucpNew password: <ICLASS="systemitem.password">longcat!</I> 				<EMCLASS="emphasis">New password for the uucp account</EM>Re-enter new password: <ICLASS="systemitem.password">longcat!</I></PRE></BLOCKQUOTE></DIV><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="PUIS-CHP-15-SECT-3.3">15.3.3 Security of L.sys and Systems Files</A></H3><PCLASS="para">Becauseit logs in to remote systems, <EMCLASS="emphasis">uucico</EM> has tokeep track of the names, telephone numbers, account names, and passwordsit uses to log into these machines. This information is kept ina special file called <EMCLASS="emphasis"><ACLASS="indexterm"NAME="AUTOID-18753"></A><ACLASS="indexterm"NAME="AUTOID-18755"></A>/usr/lib/uucp/L.sys</EM>(in Version 2) or <EMCLASS="emphasis"><ACLASS="indexterm"NAME="AUTOID-18759"></A><ACLASS="indexterm"NAME="AUTOID-18761"></A>/usr/lib/uucp/Systems</EM>(in <SPANCLASS="acronym">BNU</SPAN>).</P><PCLASS="para">The information in the<EMCLASS="emphasis">L.sys</EM> or <EMCLASS="emphasis">Systems</EM> filecan easily be misused. For example, somebody who has access to thisfile can program his or her computer to log into one of the machinesthat you exchange mail with, pretending to be your machine, andin this way get all of your electronic mail!</P><PCLASS="para">To protectthe <EMCLASS="emphasis">L.sys</EM> or <EMCLASS="emphasis">Systems</EM> file,make sure that the file is owned by the <EMCLASS="emphasis">uucp</EM>user and is mode 400 or 600&nbsp;- that is, unreadable to anybodybut <SPANCLASS="acronym">UUCP</SPAN>.</P><PCLASS="para">You should check to makesure that there is no way to read or copy your <ICLASS="systemitem">L.sys</I> or <EMCLASS="emphasis">Systems</EM>file by using the <EMCLASS="emphasis">uucp</EM> program. You shouldalso make sure that the <ICLASS="filename">uucp</I> program does notallow people on remote machines to retrieve your <ICLASS="systemitem">/etc/passwd </I>file when they specifypathnames such as &quot;<EMCLASS="emphasis">../../../../etc/passwd.</EM>&quot;</P><BLOCKQUOTECLASS="note"><PCLASS="para"><STRONG>NOTE:</STRONG> When debugging a <SPANCLASS="acronym">UUCP</SPAN> connectionto a remote site, you may wish to run the <EMCLASS="emphasis">uucico</EM>command in debug mode. When you do so, the command prints a runningaccount of the data exchanged with the remote machine. On most systems,if you do this as <EMCLASS="emphasis">root</EM> (or as a user with readpermission on the <ICLASS="filename">L.sys</I> or <ICLASS="filename">Systems</I>file, e.g., a user in group <EMCLASS="emphasis">uucp</EM>), then thedebug text will include the telephone number, account name, andpossibly the password(s) of the remote site. Thus, run in debugmode as a non-privileged user, or in a secured location to preventsomeone from snooping.</P></BLOCKQUOTE></DIV></DIV><DIVCLASS="htmlnav"><P></P><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch15_02.htm"TITLE="15.2 Versions of UUCP"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 15.2 Versions of UUCP"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="book"HREF="index.htm"TITLE="Practical UNIX &amp; Internet Security"><IMGSRC="../gifs/txthome.gif"ALT="Practical UNIX &amp; Internet Security"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch15_04.htm"TITLE="15.4 Security in Version 2 UUCP"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 15.4 Security in Version 2 UUCP"BORDER="0"></A></TD></TR><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172">15.2 Versions of UUCP</TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="index"HREF="index/idx_0.htm"TITLE="Book Index"><IMGSRC="../gifs/index.gif"ALT="Book Index"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172">15.4 Security in Version 2 UUCP</TD></TR></TABLE><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><PCLASS="nav"><FONTSIZE="-1">[ <AHREF="../index.htm"TITLE="The Networking CD Bookshelf">Library Home</A> | <AHREF="../dnsbind/index.htm"TITLE="DNS &amp; BIND">DNS &amp; BIND</A> | <AHREF="../tcpip/index.htm"TITLE="TCP/IP Network Administration">TCP/IP</A> | <AHREF="../sendmail/index.htm"TITLE="sendmail">sendmail</A> | <AHREF="../smdref/index.htm"TITLE="sendmail Desktop Reference">sendmail Reference</A> | <AHREF="../firewall/index.htm"TITLE="Building Internet Firewalls">Firewalls</A> | <AHREF="index.htm"TITLE="Practical UNIX &amp; Internet Security">Practical Security</A> ]</FONT></P></DIV></BODY></HTML>