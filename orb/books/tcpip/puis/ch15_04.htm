<HTML><HEAD><TITLE>[Chapter 15] 15.4 Security in Version 2 UUCP</TITLE><METANAME="DC.title"CONTENT="Practical UNIX &amp; Internet Security"><METANAME="DC.creator"CONTENT="Simson Garfinkel &amp; Gene Spafford"><METANAME="DC.publisher"CONTENT="O'Reilly &amp; Associates, Inc."><METANAME="DC.date"CONTENT="1999-02-04T00:12:02Z"><METANAME="DC.type"CONTENT="Text.Monograph"><METANAME="DC.format"CONTENT="text/html"SCHEME="MIME"><METANAME="DC.source"CONTENT="1-56592-148-8"SCHEME="ISBN"><METANAME="DC.language"CONTENT="en-US"><METANAME="generator"CONTENT="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><LINKREV="made"HREF="mailto:online-books@oreilly.com"TITLE="Online Books Comments"><LINKREL="up"HREF="ch15_01.htm"TITLE="15. UUCP"><LINKREL="prev"HREF="ch15_03.htm"TITLE="15.3 UUCP and Security"><LINKREL="next"HREF="ch15_05.htm"TITLE="15.5 Security in BNU UUCP"></HEAD><BODYBGCOLOR="#FFFFFF"TEXT="#000000"><DIVCLASS="htmlnav"><H1><IMGSRC="gifs/smbanner.gif"ALT="Practical UNIX &amp; Internet Security"USEMAP="#srchmap"BORDER="0"></H1><MAPNAME="srchmap"><AREASHAPE="RECT"COORDS="0,0,466,65"HREF="index.htm"ALT="Practical UNIX &amp; Internet Security"><AREASHAPE="RECT"COORDS="467,0,514,18"HREF="../search/psrch.htm"ALT="Search this book"></MAP><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch15_03.htm"TITLE="15.3 UUCP and Security"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 15.3 UUCP and Security"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><B><FONTFACE="ARIEL,HELVETICA,HELV,SANSERIF"SIZE="-1">Chapter 15<BR>UUCP</FONT></B></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch15_05.htm"TITLE="15.5 Security in BNU UUCP"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 15.5 Security in BNU UUCP"BORDER="0"></A></TD></TR></TABLE>&nbsp;<HRALIGN="LEFT"WIDTH="515"TITLE="footer"></DIV><DIVCLASS="SECT1"><H2CLASS="sect1"><ACLASS="title"NAME="PUIS-CHP-15-SECT-4">15.4 Security in Version 2 UUCP</A></H2><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-18791"></A><ACLASS="indexterm"NAME="AUTOID-18793"></A>Version 2 of <SPANCLASS="acronym">UUCP</SPAN>provides five files that control what type of access remote systemsare allowed on your computer (see <ACLASS="xref"HREF="ch15_04.htm#PUIS-CHP-15-TAB-1"TITLE="UUCP Version 2 Access Control Files">Table 15.1</A>).</P><TABLECLASS="table"><CAPTIONCLASS="table"><ACLASS="title"NAME="PUIS-CHP-15-TAB-1">Table 15.1: UUCP Version 2 Access Control Files</A></CAPTION><THEADCLASS="thead"><TRCLASS="row"VALIGN="TOP"><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1"><PCLASS="para">File</P></TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Meaning</P></TH></TR></THEAD><TBODYCLASS="tbody"><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">USERFILE</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Determines access to files and directories.</P></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">L.cmds</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Specifies commands that can be executedlocally by remote sites.</P></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">SEQFILE</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Specifies machines for which to keepconversation counts.</P></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">FWDFILE</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Specifies a list of systems to whichyour system will forward files. (Not available in all implementations.)</P></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">ORGFILE</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Specifies a list of systems (and optionally,users on those systems) who can forward files through your system.(Not available in all implementations.)</P></TD></TR></TBODY></TABLE><PCLASS="para">The two files of primary concern are <EMCLASS="emphasis">USERFILE</EM>and <EMCLASS="emphasis">L.cmds</EM>; for a detailed description of theother files, please see the book <EMCLASS="emphasis">Managing UUCP and Usenet</EM>referenced above.</P><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="PUIS-CHP-15-SECT-4.1">15.4.1 USERFILE: Providing Remote File Access</A></H3><PCLASS="para">The<EMCLASS="emphasis"><ACLASS="indexterm"NAME="AUTOID-18843"></A><ACLASS="indexterm"NAME="AUTOID-18845"></A><ACLASS="indexterm"NAME="AUTOID-18848"></A><ACLASS="indexterm"NAME="AUTOID-18851"></A><ACLASS="indexterm"NAME="AUTOID-18854"></A>/usr/lib/uucp/USERFILE</EM> file controlswhich files on your computer can be accessed through the <SPANCLASS="acronym">UUCP</SPAN>system. Normally, you specify one entry in <EMCLASS="emphasis">USERFILE</EM>for each <SPANCLASS="acronym">UUCP</SPAN> login in the <EMCLASS="emphasis">/etc/passwd</EM>file. You can also include entries in <EMCLASS="emphasis">USERFILE</EM>for particular users on your computer: this allows you to give individualusers additional <SPANCLASS="acronym">UUCP</SPAN> privileges.</P><PCLASS="para"><EMCLASS="emphasis">USERFILE</EM>entries can specify four things:</P><ULCLASS="itemizedlist"><LICLASS="listitem"><PCLASS="para">Which directories can be accessedby remote systems</P></LI><LICLASS="listitem"><PCLASS="para">The login name that a remote system must use totalk to the local system</P></LI><LICLASS="listitem"><PCLASS="para">Whether a remote system must be called back by thelocal system to confirm its identity before communication can takeplace</P></LI><LICLASS="listitem"><PCLASS="para">Which files can be sent out over <SPANCLASS="acronym">UUCP</SPAN>by local users</P></LI></UL><DIVCLASS="sect3"><H4CLASS="sect3"><ACLASS="title"NAME="PUIS-CHP-15-SECT-4.1.1">15.4.1.1 USERFILE entries</A></H4><PCLASS="para"><EMCLASS="emphasis">USERFILE</EM>is one of the more complicated parts of Version 2 <SPANCLASS="acronym">UUCP</SPAN>.In some cases, making a mistake with <EMCLASS="emphasis">USERFILE</EM>can prevent <SPANCLASS="acronym">UUCP</SPAN> from working at all. In othercases, it can result in a security hole.</P><PCLASS="para">Entries in<EMCLASS="emphasis">USERFILE</EM> take the form:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen"><KBDCLASS="command">username,system-name [c] pathname(s)</KBD></PRE></BLOCKQUOTE><PCLASS="para">An entry in <EMCLASS="emphasis">USERFILE</EM> that uses all fourfields might look like this:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">Ugarp,garp c /usr/spool/uucppublic</PRE></BLOCKQUOTE><PCLASS="para">These fields are described in <ACLASS="xref"HREF="ch15_04.htm#PUIS-CHP-15-TAB-5"TITLE="USERFILE Fields">Table 15.2</A>.</P><TABLECLASS="table"><CAPTIONCLASS="table"><ACLASS="title"NAME="PUIS-CHP-15-TAB-5">Table 15.2: <EMCLASS="emphasis">USERFILE</EM> Fields</A></CAPTION><THEADCLASS="thead"><TRCLASS="row"VALIGN="TOP"><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Field</P></TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Example</P></TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Function in <EMCLASS="emphasis">USERFILE</EM></P></TH></TR></THEAD><TBODYCLASS="tbody"><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">username</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><ICLASS="filename">Ugarp</I></P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><EMCLASS="emphasis"></EM>Login name in <EMCLASS="emphasis">/etc/passwd</EM>that will be used</P></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">system name</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><ICLASS="filename">garp</I></P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><EMCLASS="emphasis"></EM>System name of the remote system.</P></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">c</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><ICLASS="filename">c</I></P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><EMCLASS="emphasis"></EM>Optional callback flag. If present, <EMCLASS="emphasis">uucico</EM>on the local computer halts conversation after the remote machinecalls the local machine; <EMCLASS="emphasis">uucico</EM> on the localmachine then calls back the remote machine to establish the remotemachine's identity</P></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">pathname</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><ICLASS="filename">/usr/spool/uucppublic</I></P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><EMCLASS="emphasis"></EM>List of absolute pathname prefixes separatedby blanks. The remote system can access only those files beginningwith these pathnames. A blank field indicates open access to anyfile in the system, as does a pathname of /.</P></TD></TR></TBODY></TABLE><PCLASS="para">You should have at least one entry in <EMCLASS="emphasis">USERFILE</EM>without a username field, and at least one other entry without asystem name field:</P><ULCLASS="itemizedlist"><LICLASS="listitem"><PCLASS="para">The line that has no username fieldis used by <EMCLASS="emphasis">uucico</EM> when it is transmitting files,to determine if it is allowed to transmit the file that you haveasked to transmit.</P></LI><LICLASS="listitem"><PCLASS="para">The line that has no system name field is used by<EMCLASS="emphasis">uucico</EM> when it is receiving files and cannotfind a name in the <EMCLASS="emphasis">USERFILE</EM> that has a systemname matching the current system. <EMCLASS="emphasis">uucico</EM> usesthis line to see if it is allowed to place a file in the requesteddirectory. This line is also used by the <EMCLASS="emphasis">uuxqt</EM>program.</P></LI></UL><PCLASS="para">To make things moreinteresting, almost every implementation of <SPANCLASS="acronym">UUCP</SPAN>parses <EMCLASS="emphasis">USERFILE</EM> a little differently. The keyrules that apply to all versions are:</P><ULCLASS="itemizedlist"><LICLASS="listitem"><PCLASS="para">When <EMCLASS="emphasis">uucp</EM> and<EMCLASS="emphasis">uux</EM> are run by users, and when <EMCLASS="emphasis">uucico</EM>runs in the Master role (a connection originating from your localmachine), <SPANCLASS="acronym">UUCP</SPAN> uses only the username part ofthe username and system name fields.</P></LI><LICLASS="listitem"><PCLASS="para">When <EMCLASS="emphasis">uucico</EM> runs in the Slaverole, <SPANCLASS="acronym">UUCP</SPAN> looks only at the system name field.</P></LI><LICLASS="listitem"><PCLASS="para">There must be at least one line that has an emptysystem name, and one line that has an empty username. (In most <SPANCLASS="acronym">BSD</SPAN>-derivedsystems, they can be the same line. Every other implementation requirestwo separate lines. You are safest in using two lines if you don'tunderstand what your version allows.) The locations of these linesin the file is not important, but both lines must be present.</P></LI></UL></DIV><DIVCLASS="sect3"><H4CLASS="sect3"><ACLASS="title"NAME="PUIS-CHP-15-SECT-4.1.2">15.4.1.2 USERFILE entries for local users</A></H4><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-18979"></A><ACLASS="indexterm"NAME="AUTOID-18982"></A>You can have anentry in your <EMCLASS="emphasis">USERFILE</EM> for every user who willbe allowed to transfer files. For example, the following entriesgive the local users <EMCLASS="emphasis">lance</EM> and <EMCLASS="emphasis">annalisa</EM>permission to transfer a file in or out of any directory on yourcomputer to which they have access:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">lance, /annalisa, /</PRE></BLOCKQUOTE><PCLASS="para">This <EMCLASS="emphasis">USERFILE</EM> entry gives the local user<EMCLASS="emphasis">casper</EM> permission to transfer files in or outof the <SPANCLASS="acronym">UUCP</SPAN> public directory or the directory<EMCLASS="emphasis">/usr/ghost</EM>:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">casper, /usr/spool/uucppublic /usr/ghost</PRE></BLOCKQUOTE><PCLASS="para">Be aware that<EMCLASS="emphasis">USERFILE</EM> allows a maximum of 20 entries inVersion 7 and System V Release 1.0.</P><PCLASS="para">Instead of specifyinga <EMCLASS="emphasis">USERFILE</EM> entry for each user on your system,you can specify a <EMCLASS="emphasis">USERFILE</EM> entry without ausername. This default entry covers <EMCLASS="emphasis">all users</EM>on your system that are not otherwise specified. To give all usersaccess to the <SPANCLASS="acronym">UUCP</SPAN> public directory, you mightuse the following <EMCLASS="emphasis">USERFILE</EM> entry:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">,localhost /usr/spool/uucppublic</PRE></BLOCKQUOTE><PCLASS="para">(The hostname <EMCLASS="emphasis">localhost</EM> is ignored bythe <SPANCLASS="acronym">UUCP</SPAN> software and is included only for clarity.)</P></DIV><DIVCLASS="sect3"><H4CLASS="sect3"><ACLASS="title"NAME="PUIS-CHP-15-SECT-4.1.3">15.4.1.3 Format of USERFILE entry without system name</A></H4><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-19010"></A><ACLASS="indexterm"NAME="AUTOID-19012"></A>Toallow file transfer from other systems to your system, and to allowfiles to be accessed by <EMCLASS="emphasis">uuxqt</EM> (even when itis started from your system), you must have at least one entry in<EMCLASS="emphasis">USERFILE</EM> for which the system name is not specified.For example:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">nuucp, /usr/spool/uucppublic</PRE></BLOCKQUOTE><PCLASS="para">Although you might expect that this line would mean that anysystem logging in with the name <EMCLASS="emphasis"><ACLASS="indexterm"NAME="AUTOID-19020"></A>nuucp</EM>would have access to<ACLASS="indexterm"NAME="AUTOID-19022"></A><ACLASS="indexterm"NAME="AUTOID-19024"></A><EMCLASS="emphasis">/usr/spool/uucppublic</EM>, such is not the casefor all versions of <SPANCLASS="acronym">UUCP</SPAN>.</P><PCLASS="para">In <ACLASS="indexterm"NAME="AUTOID-19031"></A><ACLASS="indexterm"NAME="AUTOID-19034"></A>System V Release 2.0 and in Ultrix,<SPANCLASS="acronym">UUCP</SPAN> will actually check both the username fieldand the blank system<EMCLASS="emphasis"> </EM>name field, and will allowlogins by any system using <EMCLASS="emphasis">nuucp</EM>.</P><PCLASS="para">Inother <SPANCLASS="acronym">UUCP</SPAN> implementations, however, the factthat <EMCLASS="emphasis">nuucp</EM> appears on this line is completelyirrelevant to a system calling in. The system name is used onlyto validate file transfers for files that are received by your system.If this is the first entry with a missing system name, <SPANCLASS="acronym">UUCP</SPAN>will actually allow access to <EMCLASS="emphasis">uucppublic</EM> byany system for which there is no explicit <EMCLASS="emphasis">USERFILE</EM>entry containing that system's system name. If this isnot the first entry with a blank system name, it will have no effect.</P></DIV><DIVCLASS="sect3"><H4CLASS="sect3"><ACLASS="title"NAME="PUIS-CHP-15-SECT-4.1.4">15.4.1.4 Special permissions</A></H4><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-19049"></A>Youmay wish to make special directories on your system available toparticular users on your system or to particular systems with whichyou communicate. For example:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">Ugarp,garp /usr/spool/uucppublic /usr/spool/news</PRE></BLOCKQUOTE><PCLASS="para">Thisline will make both the directories <EMCLASS="emphasis">/usr/spool/uucppublic</EM>and <EMCLASS="emphasis">/usr/spool/news</EM> available to the systemname <ICLASS="filename">garp</I> when you call it, and to any systemthat logs in with the <SPANCLASS="acronym">UUCP</SPAN> login <ICLASS="systemitem">Ugarp</I>. You might want to addthis line if you anticipate transferring news articles between yourcomputer and <EMCLASS="emphasis">garp</EM> directly, without going throughthe Usenet news software.</P></DIV><DIVCLASS="sect3"><H4CLASS="sect3"><ACLASS="title"NAME="PUIS-CHP-15-SECT-4.1.5">15.4.1.5 Requiring callback</A></H4><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-19063"></A><ACLASS="indexterm"NAME="AUTOID-19066"></A>Version 2 <SPANCLASS="acronym">UUCP</SPAN>has a callback feature that you can use if you are extremely concernedabout security. With callback, when a remote system calls your computer,your system immediately hangs up on the remote system and callsit back. In this way, you can be sure that the remote system iswho it claims to be.</P><PCLASS="para">If you put a <EMCLASS="emphasis">c</EM>as the first entry in the <EMCLASS="emphasis">USERFILE</EM> path list,no files will be transferred when the remote system's <EMCLASS="emphasis">uucico</EM>logs in. Instead, your system will call back the remote system.No special callback hardware is required to take advantage of <SPANCLASS="acronym">UUCP</SPAN>callback, because it is performed by the system software, not bythe modem.</P><PCLASS="para">For example, here is garp's <EMCLASS="emphasis">USERFILE</EM>entry modified so the local system will always call <ICLASS="filename">garp</I>back whenever <ICLASS="filename">garp</I> calls the localsystem:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">Ugarp,garp c /usr/spool/uucppublic /usr/spool/news</PRE></BLOCKQUOTE><PCLASS="para">Callbackadds to the security of <SPANCLASS="acronym">UUCP</SPAN>. Normally thereis no way to be sure that a computer calling up and claiming tobe <ICLASS="filename">garp</I>, for example, is really <ICLASS="filename">garp</I>.It might be another system that belongs to a computer cracker whohas learned <ICLASS="filename">garp</I>'s <SPANCLASS="acronym">UUCP</SPAN>login and password. If you call back the remote system, however,you can be reasonably sure that you are connecting to the rightsystem.</P><BLOCKQUOTECLASS="note"><PCLASS="para"><STRONG>NOTE:</STRONG> Only one system out of each pair of communicating systemscan have a <EMCLASS="emphasis">c</EM> in its <EMCLASS="emphasis">USERFILE</EM>to enable the callback feature. If both ends of a connection enablecallback, they will loop endlessly&nbsp;- calling each other,hanging up, and calling back. For more information, see the commentson callback in <ACLASS="xref"HREF="ch14_01.htm"TITLE="Telephone Security">Chapter 14, <CITECLASS="chapter">Telephone Security</CITE></A>.</P></BLOCKQUOTE></DIV></DIV><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="PUIS-CHP-15-SECT-4.2">15.4.2 A USERFILE Example</A></H3><PCLASS="para">Here is a sample<EMCLASS="emphasis">USERFILE</EM>:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">, /usr/spool/uucppublic# Next line not needed in BSD 4.2 or 4.3nuucp, /usr/spool/uucppublicdan, /usr/spool/uucppublic /u1/dancsd, /usr/spool/uucppublic /u1/csdroot, /udecwrl,decwrl /usr/spool/uucppublic /usr/spool/newsupyrnj,pyrnj /usr/spool/uucppublic /usr/src</PRE></BLOCKQUOTE><PCLASS="para">As noted earlier, in some systems the first line defines boththe missing <EMCLASS="emphasis">username</EM> and the missing systemname and gives access to the directory <EMCLASS="emphasis">/usr/spool/uucppublic</EM>.In other implementations of <SPANCLASS="acronym">UNIX</SPAN>, two separatelines are required: The first line will suffice for the missingusername, and another line, such as the second one shown here (theline beginning with <EMCLASS="emphasis">nuucp</EM>), will account forthe missing <EMCLASS="emphasis">system</EM> name.</P><PCLASS="para">The effectof these lines is to allow any local user, and any remote machine,to transfer files only from the public directory.</P><PCLASS="para">Ifyou don't have any particularly trusted sites or users,you may want to stop at this point. However, if you want to givespecial privileges to particular local users, you'll includelines such as the next three (the lines beginning with <EMCLASS="emphasis">dan</EM>,<EMCLASS="emphasis">csd</EM>, and <EMCLASS="emphasis">root</EM>). Users<EMCLASS="emphasis">dan</EM> and <EMCLASS="emphasis">csd</EM> can transferfiles to or from their home directories as well as from the publicdirectory. Users logged in as <EMCLASS="emphasis">root</EM> can transferfiles to or from any directory. (This structure makes sense, asthey can do anything else, including modifying <EMCLASS="emphasis">USERFILE</EM>to suit their needs or whims.)</P><PCLASS="para">Finally, you may needto specify particular permissions for known local systems. In theexample, <ICLASS="filename">decwrl </I>is able to transfer files to<ICLASS="filename">/usr/spool/news</I> as well as to the public directory.The site <ICLASS="filename">pyrnj </I>is able to transfer files toand from <ICLASS="filename">/usr/src</I> as well as to and from thepublic directory.</P><DIVCLASS="sect3"><H4CLASS="sect3"><ACLASS="title"NAME="PUIS-CHP-15-SECT-4.2.1">15.4.2.1 Some bad examples</A></H4><PCLASS="para">If you are not veryconcerned about security, the following <EMCLASS="emphasis">USERFILE</EM>might suffice:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen"># A wide open USERFILEnuucp, /usr/spool/uucppublic, /</PRE></BLOCKQUOTE><PCLASS="para">However, we recommend against it!This <EMCLASS="emphasis">USERFILE</EM> will allow remote systems (assumingthat they all log in as <EMCLASS="emphasis">nuucp</EM>) to transferfiles to or from the public directory, but will give complete <SPANCLASS="acronym">UUCP</SPAN>access to local users. This is dangerous and is not recommended,as it allows local users access to any protected file and directorythat is owned by <EMCLASS="emphasis">uucp</EM>.</P><PCLASS="para">If youdon't talk to the outside world and are using <SPANCLASS="acronym">UUCP</SPAN>only for communication with <SPANCLASS="acronym">UNIX</SPAN> sites insideyour organization, you might use the following <EMCLASS="emphasis">USERFILE</EM>:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen"># A completely open USERFILE, /, /</PRE></BLOCKQUOTE><PCLASS="para">Thisuserfile will allow any user on your system, or any remote system,to transfer files to or from any directory. This example is evenmore dangerous than the previous one. (Note that on many systems,two lines are necessary, even though they are identical. The firstline defines the missing username, and the other line defines themissing system name. In some systems, a single line will suffice,but you will never be wrong if you include both of them.)</P><PCLASS="para">Rememberthat even with complete access specified in <EMCLASS="emphasis">USERFILE</EM>,<SPANCLASS="acronym">UUCP</SPAN> is still subject to <SPANCLASS="acronym">UNIX</SPAN>file permissions. A user requesting outbound transfer of a filemust have read access to it. For a remote system to have accessto a file or directory, the file or directory must be readable andwritable by all users, or by <SPANCLASS="acronym">UUCP</SPAN>.</P><BLOCKQUOTECLASS="note"><PCLASS="para"><STRONG>NOTE:</STRONG> If you wish to run a secure system, the directory <ICLASS="filename"><ACLASS="indexterm"NAME="AUTOID-19140"></A><ACLASS="indexterm"NAME="AUTOID-19143"></A>/usr/lib/uucp</I>(or <ICLASS="filename">/etc/uucp</I>) must not be in the permissionlist! If users from the outside are allowed to transfer into thesedirectories, they can change the <ICLASS="filename">USERFILE</I> orthe <ICLASS="filename">L.cmds</I> files to allow them to execute anycommand that they wish. Local users can similarly use the <EMCLASS="emphasis">uucp</EM>command to change these files, and subvert <SPANCLASS="acronym">UUCP</SPAN>.Giving all access from the <ACLASS="indexterm"NAME="AUTOID-19151"></A>/directory is also dangerous&nbsp;- such access makes it possiblefor people outside your organization to subvert your system easily,as they can then modify any directory on your system that is worldwritable.</P><PCLASS="para">For example, granting access to /lets an outsider read the contents of your <EMCLASS="emphasis">/etc/passwd</EM>file, and also allows him to read and change the contents of your<EMCLASS="emphasis">/usr/lib/uucp/L.sys</EM> file. As an added precaution,the home directory for the <ICLASS="systemitem">uucp</I>user should not be in <EMCLASS="emphasis">/usr/spool/uucp/uucppublic,</EM>or any other directory that can be written to by a <EMCLASS="emphasis">uucp</EM>user. Doing so may allow an outside user to subvert your system.<EMCLASS="emphasis"><ACLASS="indexterm"NAME="AUTOID-19161"></A><ACLASS="indexterm"NAME="AUTOID-19163"></A><ACLASS="indexterm"NAME="AUTOID-19166"></A><ACLASS="indexterm"NAME="AUTOID-19169"></A><ACLASS="indexterm"NAME="AUTOID-19172"></A></EM></P></BLOCKQUOTE></DIV></DIV><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="PUIS-CHP-15-SECT-4.3">15.4.3 L.cmds: Providing Remote Command Execution</A></H3><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-19178"></A><ACLASS="indexterm"NAME="AUTOID-19180"></A><ACLASS="indexterm"NAME="AUTOID-19183"></A><ACLASS="indexterm"NAME="AUTOID-19186"></A>Youwill probably want to limit the commands that can be executed bya remote system via <EMCLASS="emphasis">uucp</EM>. After all, if <EMCLASS="emphasis">any</EM>command could be executed by <SPANCLASS="acronym">UUCP</SPAN>, then peopleon other computers could use the <ICLASS="systemitem">/bin/rm</I>command to delete files in any writable directory on your computer![7]</P><BLOCKQUOTECLASS="footnote"><PCLASS="para">[7] This gives a new definition to the phrase &quot;worldwritable.&quot;</P></BLOCKQUOTE><PCLASS="para">For this reason,<SPANCLASS="acronym">UUCP</SPAN> allows you to specify which commands remotesystems are allowed to execute on your computer. The list of validcommands is contained in the directory <EMCLASS="emphasis">/usr/lib/uucp</EM>in the file <EMCLASS="emphasis">L.cmds</EM>, <EMCLASS="emphasis">L-cmds</EM>,or <EMCLASS="emphasis"><ACLASS="indexterm"NAME="AUTOID-19202"></A>uuxqtcmds</EM>(different versions store the command list in different files).Some early <SPANCLASS="acronym">UNIX</SPAN> systems (Version 7 or earlier)may not have this file at all (and have no way of changing the defaultswithout modifying the source code to the <EMCLASS="emphasis">uuxqt</EM>program.) For further information, check your own system'sdocumentation.</P><PCLASS="para">In some versions of <SPANCLASS="acronym">UUCP</SPAN>,the <EMCLASS="emphasis">L.cmds</EM> file can also include a <SPANCLASS="acronym">PATH</SPAN><KBDCLASS="command">=</KBD>statement that specifies which directories <EMCLASS="emphasis">uuxqt</EM>should check when searching for the command to execute.</P><PCLASS="para">Atypical <EMCLASS="emphasis">L.cmds</EM> file might contain the followinglist of commands:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">PATH=/bin:/usr/bin:/usr/ucbrmailrnewslprwhofinger</PRE></BLOCKQUOTE><PCLASS="para">If a command is not in the commands file, <EMCLASS="emphasis">uux</EM>cannot execute it. <EMCLASS="emphasis">L.cmds</EM> should at least containthe <EMCLASS="emphasis"><ACLASS="indexterm"NAME="AUTOID-19219"></A>rmail</EM>program (the remote mail program that decides whether mail is tobe delivered locally or forwarded on to yet another system). If<EMCLASS="emphasis">rmail</EM> is not listed in <EMCLASS="emphasis">L.cmds</EM>,a local user will not be able to receive mail from remote usersvia <SPANCLASS="acronym">UUCP</SPAN>.</P><PCLASS="para">Add commands to this filecarefully; commands like <EMCLASS="emphasis"><ACLASS="indexterm"NAME="AUTOID-19226"></A><ACLASS="indexterm"NAME="AUTOID-19228"></A><ACLASS="indexterm"NAME="AUTOID-19230"></A>cat</EM> or <EMCLASS="emphasis">rm</EM> mayplace your system at risk. You should be careful about commandsthat allow <ACLASS="indexterm"NAME="AUTOID-19233"></A>shell escapes (such as <EMCLASS="emphasis">man</EM>).Even <EMCLASS="emphasis">finger</EM> can be dangerous if you are veryconcerned about security, because it might provide a cracker witha list of usernames to try when guessing passwords.</P><PCLASS="para">Lookcarefully at the <EMCLASS="emphasis">L.cmds</EM> file that comes withyour system: you may wish to remove some of the commands that itincludes. For example, some <SPANCLASS="acronym">BSD</SPAN>-derived systemsinclude the <EMCLASS="emphasis"><ACLASS="indexterm"NAME="AUTOID-19242"></A><ACLASS="indexterm"NAME="AUTOID-19244"></A>ruusend</EM> command in this file,which allows file forwarding. This command is a security hole, becausea remote system could ask your system to forward protected filesthat are owned by the <EMCLASS="emphasis">uucp</EM> user, such as thefile<ICLASS="filename"> L.sys</I>.</P><PCLASS="para">If the <EMCLASS="emphasis">L.cmds</EM>file does not exist, <SPANCLASS="acronym">UUCP</SPAN> will use a defaultset of commands. If the file exists but is empty, remote commandscannot be executed on your system. In this event, the <SPANCLASS="acronym">UUCP</SPAN>system can be used only for transferring files. <ACLASS="indexterm"NAME="AUTOID-19253"></A><ACLASS="indexterm"NAME="AUTOID-19255"></A></P></DIV></DIV><DIVCLASS="htmlnav"><P></P><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch15_03.htm"TITLE="15.3 UUCP and Security"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 15.3 UUCP and Security"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="book"HREF="index.htm"TITLE="Practical UNIX &amp; Internet Security"><IMGSRC="../gifs/txthome.gif"ALT="Practical UNIX &amp; Internet Security"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch15_05.htm"TITLE="15.5 Security in BNU UUCP"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 15.5 Security in BNU UUCP"BORDER="0"></A></TD></TR><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172">15.3 UUCP and Security</TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="index"HREF="index/idx_0.htm"TITLE="Book Index"><IMGSRC="../gifs/index.gif"ALT="Book Index"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172">15.5 Security in BNU UUCP</TD></TR></TABLE><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><PCLASS="nav"><FONTSIZE="-1">[ <AHREF="../index.htm"TITLE="The Networking CD Bookshelf">Library Home</A> | <AHREF="../dnsbind/index.htm"TITLE="DNS &amp; BIND">DNS &amp; BIND</A> | <AHREF="../tcpip/index.htm"TITLE="TCP/IP Network Administration">TCP/IP</A> | <AHREF="../sendmail/index.htm"TITLE="sendmail">sendmail</A> | <AHREF="../smdref/index.htm"TITLE="sendmail Desktop Reference">sendmail Reference</A> | <AHREF="../firewall/index.htm"TITLE="Building Internet Firewalls">Firewalls</A> | <AHREF="index.htm"TITLE="Practical UNIX &amp; Internet Security">Practical Security</A> ]</FONT></P></DIV></BODY></HTML>