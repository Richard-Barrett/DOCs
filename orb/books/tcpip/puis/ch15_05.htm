<HTML><HEAD><TITLE>[Chapter 15] 15.5 Security in BNU UUCP</TITLE><METANAME="DC.title"CONTENT="Practical UNIX &amp; Internet Security"><METANAME="DC.creator"CONTENT="Simson Garfinkel &amp; Gene Spafford"><METANAME="DC.publisher"CONTENT="O'Reilly &amp; Associates, Inc."><METANAME="DC.date"CONTENT="1999-02-04T00:12:07Z"><METANAME="DC.type"CONTENT="Text.Monograph"><METANAME="DC.format"CONTENT="text/html"SCHEME="MIME"><METANAME="DC.source"CONTENT="1-56592-148-8"SCHEME="ISBN"><METANAME="DC.language"CONTENT="en-US"><METANAME="generator"CONTENT="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><LINKREV="made"HREF="mailto:online-books@oreilly.com"TITLE="Online Books Comments"><LINKREL="up"HREF="ch15_01.htm"TITLE="15. UUCP"><LINKREL="prev"HREF="ch15_04.htm"TITLE="15.4 Security in Version 2 UUCP"><LINKREL="next"HREF="ch15_06.htm"TITLE="15.6 Additional Security Concerns"></HEAD><BODYBGCOLOR="#FFFFFF"TEXT="#000000"><DIVCLASS="htmlnav"><H1><IMGSRC="gifs/smbanner.gif"ALT="Practical UNIX &amp; Internet Security"USEMAP="#srchmap"BORDER="0"></H1><MAPNAME="srchmap"><AREASHAPE="RECT"COORDS="0,0,466,65"HREF="index.htm"ALT="Practical UNIX &amp; Internet Security"><AREASHAPE="RECT"COORDS="467,0,514,18"HREF="../search/psrch.htm"ALT="Search this book"></MAP><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch15_04.htm"TITLE="15.4 Security in Version 2 UUCP"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 15.4 Security in Version 2 UUCP"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><B><FONTFACE="ARIEL,HELVETICA,HELV,SANSERIF"SIZE="-1">Chapter 15<BR>UUCP</FONT></B></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch15_06.htm"TITLE="15.6 Additional Security Concerns"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 15.6 Additional Security Concerns"BORDER="0"></A></TD></TR></TABLE>&nbsp;<HRALIGN="LEFT"WIDTH="515"TITLE="footer"></DIV><DIVCLASS="SECT1"><H2CLASS="sect1"><ACLASS="title"NAME="PUIS-CHP-15-SECT-5">15.5 Security in BNU UUCP</A></H2><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-19261"></A><ACLASS="indexterm"NAME="AUTOID-19263"></A><ACLASS="indexterm"NAME="AUTOID-19266"></A>In <SPANCLASS="acronym">BNU</SPAN>,the <EMCLASS="emphasis">Permissions</EM> file replaces both the Version2 <EMCLASS="emphasis">USERFILE</EM> and <EMCLASS="emphasis">L.cmds</EM>files. <EMCLASS="emphasis">Permissions</EM> provides additional protectionand finer control over the <SPANCLASS="acronym">UUCP</SPAN> system. A secondfile called <EMCLASS="emphasis"><ACLASS="indexterm"NAME="AUTOID-19275"></A>remote.unknown</EM>controls whether or not an unknown system (that is, one not listedin your <EMCLASS="emphasis">Systems</EM> file) can log in (assumingthat the remote system knows a valid <SPANCLASS="acronym">UUCP</SPAN> loginname and password).</P><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="PUIS-CHP-15-SECT-5.1">15.5.1 Permissions File</A></H3><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-19282"></A><ACLASS="indexterm"NAME="AUTOID-19284"></A>The <EMCLASS="emphasis">Permissions</EM>file consists of commands, possibly multi-line, and often separatedby blank lines, that are used to determine what users and remotemachines can and cannot do with the <SPANCLASS="acronym">UUCP</SPAN> system.</P><PCLASS="para">Here is a sample <EMCLASS="emphasis">Permissions</EM> file.For now, don't worry about what all the commands mean:we'll explain them shortly.</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">LOGNAME=Ugarp READ=/usr/spool/uucppublic WRITE=/usr/spool/uucppublicMACHINE=garp READ=/usr/spool/uucppublic WRITE=/usr/spool/uucppublic</PRE></BLOCKQUOTE><DIVCLASS="sect3"><H4CLASS="sect3"><ACLASS="title"NAME="PUIS-CHP-15-SECT-5.1.1">15.5.1.1 Starting up</A></H4><PCLASS="para">When <EMCLASS="emphasis"><ACLASS="indexterm"NAME="AUTOID-19297"></A>uucico</EM> starts, it scans the <EMCLASS="emphasis">Permissions</EM>file to determine which commands the remote machine can executeand which files can be accessed.</P><PCLASS="para">When <EMCLASS="emphasis">uucicio</EM>calls another system, it looks for a block of commands containinga <KBDCLASS="command">MACHINE=system</KBD> statement, where <EMCLASS="emphasis">system</EM>is the name of the machine that it is calling. For example, if youare calling the machine idr, it looks for a line in the form:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">MACHINE=idr</PRE></BLOCKQUOTE><PCLASS="para">When <EMCLASS="emphasis">uucico</EM>is started by another computer logging in to your local machine,<EMCLASS="emphasis">uucico</EM> looks for a block of commands containinga <KBDCLASS="command">LOGNAME=loginname</KBD>, where <EMCLASS="emphasis">loginname</EM>is the username with which the remote computer has logged in. Forexample, if the remote computer has logged in with the username<EMCLASS="emphasis">Uidr</EM>, the <EMCLASS="emphasis">uucico</EM> runningon your computer looks for a block of commands with a line containingthis statement:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">LOGNAME=Uidr</PRE></BLOCKQUOTE><PCLASS="para">Othercommands in the command block specify what the remote machine cando:</P></DIV><DIVCLASS="sect3"><H4CLASS="sect3"><ACLASS="title"NAME="PUIS-CHP-15-SECT-5.1.2">15.5.1.2 Name-value pairs</A></H4><PCLASS="para">In <SPANCLASS="acronym">BNU</SPAN>terminology, the <KBDCLASS="command">MACHINE=, LOGNAME=, READ=, </KBD>and<KBDCLASS="command">WRITE= </KBD>statements are called &quot;<ACLASS="indexterm"NAME="AUTOID-19320"></A>name-valuepairs.&quot; This name comes from their format:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">name=value</PRE></BLOCKQUOTE><PCLASS="para">To specifya block of commands for use when calling the machine <ICLASS="systemitem">bread</I>, you would use a commandin the form:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen"> <ACLASS="indexterm"NAME="AUTOID-19326"></A> MACHINE=bread</PRE></BLOCKQUOTE><PCLASS="para">You can specify multiple values by separating them with colons(:). For example:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">MACHINE=bread:butter:circus</PRE></BLOCKQUOTE></DIV><DIVCLASS="sect3"><H4CLASS="sect3"><ACLASS="title"NAME="PUIS-CHP-15-SECT-5.1.3">15.5.1.3 A Sample Permissions file</A></H4><PCLASS="para">Here is thesample <EMCLASS="emphasis">Permissions</EM> file again:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">LOGNAME=Ugarp READ=/usr/spool/uucppublic WRITE=/usr/spool/uucppublicMACHINE=garp READ=/usr/spool/uucppublic WRITE=/usr/spool/uucppublic</PRE></BLOCKQUOTE><PCLASS="para">This <EMCLASS="emphasis">Permissions</EM> file gives the machine<EMCLASS="emphasis">garp</EM> permission to read and write files inthe <EMCLASS="emphasis">/usr/spool/uucppublic</EM> directory. It alsoallows any remote computer logging in with the <SPANCLASS="acronym">UUCP</SPAN>login <EMCLASS="emphasis">Ugarp</EM> to read and write files from thosedirectories.</P><PCLASS="para">Here is another example:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen"># If garp calls us, only allow access to uucppublic# <ACLASS="indexterm"NAME="AUTOID-19343"></A> LOGNAME=Ugarp MACHINE=garp READ=/usr/spool/uucppublic \  WRITE=/usr/spool/uucppublic</PRE></BLOCKQUOTE><PCLASS="para">This command allows the machine <ICLASS="filename">garp</I>to read or write any file in <EMCLASS="emphasis">/usr/spool/uucppublic</EM>,but only when the machine <ICLASS="filename">garp</I> logs into yourcomputer using the <EMCLASS="emphasis">uucp</EM> login <EMCLASS="emphasis">Ugarp</EM>.Notice in this example that the backslash (\) characteris used to continue the entry on the following line. To includea <ACLASS="indexterm"NAME="AUTOID-19351"></A>comment, begin a linewith a hash mark (#).</P><PCLASS="para">You can combine a <KBDCLASS="command">LOGNAME=</KBD>and a <KBDCLASS="command">MACHINE=</KBD> entry in a single line:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen"># Let garp have lots of access#LOGNAME=Ugarp MACHINE=garp READ=/ WRITE=/ REQUEST=yes SENDFILES=yes</PRE></BLOCKQUOTE><PCLASS="para">The<KBDCLASS="command"><ACLASS="indexterm"NAME="AUTOID-19359"></A><ACLASS="indexterm"NAME="AUTOID-19361"></A>REQUEST=yes</KBD>name-value pair allows <ICLASS="filename">garp</I> to request filesfrom your machine. The <KBDCLASS="command">SENDFILES=yes</KBD> pair allowsyou to send files to <ICLASS="filename">garp</I> even when it initiatesthe call to you.</P><PCLASS="para">If you assign a unique login ID foreach <SPANCLASS="acronym">UUCP</SPAN> system with which you communicate,then <KBDCLASS="command">LOGNAME=</KBD> and <KBDCLASS="command">MACHINE=</KBD>can each be thought of as controlling one direction of the filetransfer operation. But if the same login ID is shared by several<SPANCLASS="acronym">UUCP</SPAN> systems, they will all be covered by thesame <KBDCLASS="command">LOGNAME=</KBD> entry when they call you, eventhough they will each be covered by their own <KBDCLASS="command">MACHINE=</KBD>entry when you call them.</P></DIV></DIV><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="PUIS-CHP-15-SECT-5.2">15.5.2 Permissions Commands</A></H3><PCLASS="para"><SPANCLASS="acronym">BNU</SPAN><SPANCLASS="acronym">UUCP</SPAN> has 13 different commands that can be includedin the <EMCLASS="emphasis">Permissions</EM> file. These commands helpprovide the flexibility that <SPANCLASS="acronym">BNU</SPAN> allows over<SPANCLASS="acronym">UUCP</SPAN> connections. These commands are placed inthe same command block as the <KBDCLASS="command">MACHINE=</KBD> and <KBDCLASS="command">LOGNAME=</KBD>commands described above. You can specify as many commands in ablock as you wish.</P><PCLASS="para">A <KBDCLASS="command"><ACLASS="indexterm"NAME="AUTOID-19385"></A>MACHINE=</KBD>entry in the <EMCLASS="emphasis">Permissions</EM> file is used whena specific remote site is contacted by the local computer. Specifya <KBDCLASS="command">MACHINE= OTHER</KBD> entry to define a <EMCLASS="emphasis">Permissions</EM>entry for any machine that is not explicitly referenced.</P><PCLASS="para">Forexample:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen"># Setup for when we call garpMACHINE=garp</PRE></BLOCKQUOTE><PCLASS="para"><KBDCLASS="command"><ACLASS="indexterm"NAME="AUTOID-19394"></A>LOGNAME=</KBD>is used when a remote site logs in with a specific login name. Each<SPANCLASS="acronym">UUCP</SPAN> login name should appear in only one <KBDCLASS="command">LOGNAME</KBD>entry.</P><PCLASS="para">For example:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen"># Setup login for when garp callsLOGNAME=Ugarp </PRE></BLOCKQUOTE><PCLASS="para">You can specify a <KBDCLASS="command">LOGNAME=OTHER</KBD>entry to define a <EMCLASS="emphasis">Permissions</EM> entry for anymachine that is not explicitly referenced.</P><PCLASS="para">For example:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen"># Setup login for everybody elseLOGNAME=OTHER</PRE></BLOCKQUOTE><PCLASS="para"><KBDCLASS="command"><ACLASS="indexterm"NAME="AUTOID-19407"></A>REQUEST=</KBD>specifies whether the remote system can request file transfers withyour computer. The default is &quot;no,&quot; which meansthat files can be transferred only if the <EMCLASS="emphasis">uucp</EM>command is issued on your computer.</P><PCLASS="para">For example:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen"># Let garp request filesMACHINE=garp LOGNAME=Ugarp REQUEST=YES</PRE></BLOCKQUOTE><PCLASS="para"><KBDCLASS="command"><ACLASS="indexterm"NAME="AUTOID-19414"></A>SENDFILES=</KBD> specifies whether filesthat are queued on the local system should be sent to the callingsystem when it contacts the local system. The default is &quot;call,&quot;which means &quot;no, don't send any queued files whenthe other computer calls me; hold the files until I call the othercomputer.&quot; The reason for this option is that you are moresure of the identity of a remote computer when <EMCLASS="emphasis">you callit</EM> than when <EMCLASS="emphasis">it calls you</EM>. If youset this entry to &quot;yes,&quot; all of the queued fileswill be sent whenever the remote system calls you, or when you callit, whichever happens first. This option makes sense only with the<KBDCLASS="command">LOGNAME</KBD> entries. If this option is used witha <KBDCLASS="command">MACHINE</KBD> entry, it is ignored.</P><PCLASS="para">Forexample:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen"># Send files to garp when it calls usLOGNAME=Ugarp SENDFILES=YES</PRE></BLOCKQUOTE><PCLASS="para"><KBDCLASS="command"><ACLASS="indexterm"NAME="AUTOID-19424"></A>PUBDIR=</KBD> allows you to specify directoriesfor public access. The default is <EMCLASS="emphasis">/usr/spool/uucppublic.</EM></P><PCLASS="para">For example:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen"># Let garp use two public directoriesMACHINE=garp LOGNAME=Ugarp READ=/ WRITE=/ \PUBDIR=/usr/spool/uucppublic:/usr/spool/garp</PRE></BLOCKQUOTE><PCLASS="para"><KBDCLASS="command"><ACLASS="indexterm"NAME="AUTOID-19431"></A>READ= </KBD>and<KBDCLASS="command"><ACLASS="indexterm"NAME="AUTOID-19434"></A>WRITE=</KBD> specifythe directories that <EMCLASS="emphasis">uucico</EM> can use to readfrom or write to. The default is the <EMCLASS="emphasis">PUBDIR</EM>.</P><PCLASS="para">You can specify access to all of the temporary directorieson your system with the following command:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen"># Let garp read lotsMACHINE=garp LOGNAME=Ugarp \READ=/usr/spool/uucppublic:/tmp:/usr/tmp \WRITE=/usr/spool/uucppublic:/tmp:/usr/tmp</PRE></BLOCKQUOTE><PCLASS="para">You can let <ICLASS="systemitem">garp</I>access every file on your system with the command:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen"># Let garp read even moreMACHINE=garp LOGNAME=Ugarp \READ=/ WRITE=/</PRE></BLOCKQUOTE><PCLASS="para">We don'trecommend this!</P><PCLASS="para"><KBDCLASS="command"><ACLASS="indexterm"NAME="AUTOID-19446"></A><ACLASS="indexterm"NAME="AUTOID-19448"></A>NOREAD=</KBD> and <KBDCLASS="command">NOWRITE=</KBD>specify directories that <EMCLASS="emphasis">uucico</EM> may not readto or write from, even if those directories are included in a <KBDCLASS="command">READ</KBD>or a <KBDCLASS="command">WRITE</KBD> command. You might want to use the<KBDCLASS="command">NOREAD</KBD> and <KBDCLASS="command">NOWRITE</KBD> directivesto exclude directories like <EMCLASS="emphasis">/etc</EM> and <EMCLASS="emphasis">/usr/lib/uucp</EM>,so that there is no way that people on machines connected to yoursvia <SPANCLASS="acronym">UUCP</SPAN> can read files like <EMCLASS="emphasis">/etc/passwd</EM>and <ICLASS="filename">/</I><EMCLASS="emphasis">usr/lib/uucp/Systems</EM>.</P><PCLASS="para">For example:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">MACHINE=garp LOGNAME=Ugarp \READ=/ \WRITE=/usr/spool/uucppublic:/tmp:/usr/tmp \NOREAD=/etc:/usr/lib/uucp \NOWRITE=/etc:/usr/lib/uucp</PRE></BLOCKQUOTE><PCLASS="para"><KBDCLASS="command"><ACLASS="indexterm"NAME="AUTOID-19466"></A><ACLASS="indexterm"NAME="AUTOID-19468"></A>CALLBACK=</KBD>specifies whether or not the local system must call backthe calling system before file transfer can occur. The default is&quot;no.&quot; <KBDCLASS="command">CALLBACK</KBD> enhances securityin some environments. Normally, it is possible with <SPANCLASS="acronym">UUCP</SPAN>for one machine to masquerade as another. If you call a remote machine,however, it is unlikely that such a masquerade is taking place.<KBDCLASS="command">CALLBACK</KBD> is also useful for situations whereone computer is equipped with a low-cost, long-distance telephoneline, so that the majority of the call will be billed at the lowerrate. The <KBDCLASS="command">CALLBACK</KBD> command makes sense only for<KBDCLASS="command">LOGNAME </KBD>entries. If two sites have <KBDCLASS="command">CALLBACK=yes</KBD>specified for each other, the machines will continually call backand forth, but no data will be transferred.</P><PCLASS="para">For example:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen"># We'll call garpLOGNAME=Ugarp CALLBACK=YES</PRE></BLOCKQUOTE><PCLASS="para">For further information,see our comments on callback in <ACLASS="xref"HREF="ch14_01.htm"TITLE="Telephone Security">Chapter 14</A>.</P><PCLASS="para"><KBDCLASS="command"><ACLASS="indexterm"NAME="AUTOID-19483"></A>COMMANDS=</KBD> specifies commands that theremote system can execute on the local computer. When <EMCLASS="emphasis">uuxqt</EM>executes a command, it searches the <EMCLASS="emphasis">Permissions</EM>file for the <KBDCLASS="command">MACHINE=</KBD> entry associated with theparticular system from which the commands were sent. The <KBDCLASS="command">MACHINE=</KBD>entry is the one that is used, even if the <EMCLASS="emphasis">uucico</EM>connection was originated by the remote machine and a different<KBDCLASS="command">LOGNAME=</KBD> entry is being used.</P><PCLASS="para">Thedefault value for <KBDCLASS="command">COMMANDS</KBD> is compiled into yourversion of <EMCLASS="emphasis">uuxqt</EM>; if you have source code,it is defined in the file <EMCLASS="emphasis">params.h</EM>. The <KBDCLASS="command">COMMANDS=</KBD>entry often has the single form:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">COMMANDS=rmail</PRE></BLOCKQUOTE><PCLASS="para">Youcan specify a full pathname:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">COMMANDS=rmail:/usr/bin/rnews:/usr/ucb/lpr</PRE></BLOCKQUOTE><PCLASS="para">You can specify the value<KBDCLASS="command"> ALL</KBD>, which allowsany command to be executed:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">COMMANDS=ALL</PRE></BLOCKQUOTE><PCLASS="para">You probablydon't want to specify <KBDCLASS="command">ALL </KBD>unless youhave complete control over all of the machines that you connectto with <SPANCLASS="acronym">UUCP</SPAN>.</P><PCLASS="para">For example:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen"># Let garp send us mail, netnews, and print filesMACHINE=garp LOGNAME=Ugarp \COMMANDS=rmail:rnews:lpr</PRE></BLOCKQUOTE><PCLASS="para"><KBDCLASS="command"><ACLASS="indexterm"NAME="AUTOID-19509"></A>VALIDATE=</KBD>is used with a <KBDCLASS="command">LOGNAME</KBD> entry to provide a smalladditional degree of security. Specifying a machine name (or manymachine names) in the <KBDCLASS="command">VALIDATE=</KBD> entry will allowthat <SPANCLASS="acronym">UUCP</SPAN> login to be used only by those machines.</P><PCLASS="para">For example:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen"># Let's be sure about garpLOGNAME=Ugarp VALIDATE=garp </PRE></BLOCKQUOTE><PCLASS="para">This command preventsany <SPANCLASS="acronym">UUCP</SPAN> computer other than <ICLASS="filename">garp</I>from using the <EMCLASS="emphasis">Ugarp</EM> login. Of course, anybodyinterested in using <SPANCLASS="acronym">UUCP</SPAN> to break into your computercould as easily change their <SPANCLASS="acronym">UUCP</SPAN> name to be<ICLASS="filename">garp</I>, so this command really doesn'tprovide very much security.</P><PCLASS="para"><KBDCLASS="command"><ACLASS="indexterm"NAME="AUTOID-19525"></A><ACLASS="indexterm"NAME="AUTOID-19527"></A><ACLASS="indexterm"NAME="AUTOID-19530"></A><ACLASS="indexterm"NAME="AUTOID-19533"></A>MYNAME=</KBD> can be used to change the<SPANCLASS="acronym">UUCP</SPAN> name of your computer when it initiatesa <SPANCLASS="acronym">UUCP</SPAN> connection. This command is useful fortesting. It is also helpful when you use a generic name for yoursite, but it is not the same as your <SPANCLASS="acronym">UUCP</SPAN> machine.For example:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen"># When we call garp, present ourselves as bigcorpMACHINE=garp \MYNAME=bigcorp</PRE></BLOCKQUOTE><PCLASS="para">Got that? <EMCLASS="emphasis">You can make your computer have any UUCPname that you want!</EM> Anybody else can do this as well,so be careful if you let<EMCLASS="emphasis"> any</EM> machine executecommands (specified in the <KBDCLASS="command">COMMANDS=</KBD> entry) thatmight be considered potentially unsafe (e.g., <EMCLASS="emphasis">rm</EM>,<EMCLASS="emphasis">shutdown</EM>).</P><BLOCKQUOTECLASS="note"><PCLASS="para"><STRONG>NOTE:</STRONG> If you wish to run a secure system, the directory <ICLASS="filename"><ACLASS="indexterm"NAME="AUTOID-19549"></A>/usr/lib/uucp</I>(or <ICLASS="filename">/etc/uucp</I>) must not be in the <KBDCLASS="command">WRITE</KBD>directory list (or it must be in the <KBDCLASS="command">NOWRITE</KBD>list)! If users from the outside are allowed to transfer into thesedirectories, they can change the <ICLASS="filename">Permissions</I>file to allow them to execute any command that they wish. Similarly,local users can use the <EMCLASS="emphasis">uucp</EM> command to changethese files, and then subvert <SPANCLASS="acronym">UUCP</SPAN>. Giving allaccess from the / directory is also dangerous&nbsp;- assuch, people outside your organization can subvert your system easily.Furthermore, the home directory for the <EMCLASS="emphasis">uucp</EM>user should not be in the<ICLASS="filename"> /<ACLASS="indexterm"NAME="AUTOID-19560"></A>usr/spool/uucp/uucppublic</I>directory, or in any other directory that can be written to by a<EMCLASS="emphasis">uucp</EM> user. Doing so allows an outside userto subvert the system.</P></BLOCKQUOTE></DIV><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="PUIS-CHP-15-SECT-5.3">15.5.3 uucheck: Checking Your Permissions File</A></H3><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-19566"></A><ACLASS="indexterm"NAME="AUTOID-19568"></A>Verifyingthe <EMCLASS="emphasis">Permissions</EM> file can be tricky. To helpwith this important task, <SPANCLASS="acronym">BNU</SPAN> includes a programcalled <EMCLASS="emphasis">uucheck</EM> that does it for you.</P><PCLASS="para">Normally,the uucheck program only reports security problems. However, ithas a <EMCLASS="emphasis">-v</EM> option which causes the program toproduce a full report.</P><PCLASS="para">Below is a sample <EMCLASS="emphasis">Permissions</EM>file that lets the computer <ICLASS="filename">garp</I> (or anybodyusing the <SPANCLASS="acronym">UUCP</SPAN> login <EMCLASS="emphasis">Ugarp</EM>)access a variety of files and execute a number of commands:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen"># cat PermissionsMACHINE=garp LOGNAME=Ugarp \COMMANDS=rmail:rnews:uucp \READ=/usr/spool/uucppublic:/usr/tmp \WRITE=/usr/spool/uucppublic:/usr/tmp \SENDFILES=yes REQUEST=no</PRE></BLOCKQUOTE><PCLASS="para">Here is the output from the <EMCLASS="emphasis">uucheck</EM> programrun with the above <EMCLASS="emphasis">Permissions</EM> file:</P><DIVCLASS="example"><H4CLASS="example"><ACLASS="title"NAME="PUIS-CHP-15-EX-1">Example 15.1: Verifying the Sample UUCP Permissions File</A></H4><BLOCKQUOTECLASS="screen"><PRECLASS="screen"># /usr/lib/uucp/uucheck -v*** uucheck:  Check Required Files and Directories*** uucheck:  Directories Check Complete*** uucheck:  Check /etc/uucp/Permissions file** LOGNAME PHASE (when they call us) When a system logs in as: (Ugarp)         We DO NOT allow them to request files.        We WILL send files queued for them on this call.        They can send files to            /usr/spool/uucppublic            /usr/tmp        Sent files will be created in /var/spool/uucp         before they are copied to the target directory.        Myname for the conversation will be sun.        PUBDIR for the conversation will be /usr/spool/uucppublic.** MACHINE PHASE (when we call or execute their uux requests) When we call system(s): (garp)         We DO NOT allow them to request files.        They can send files to            /usr/spool/uucppublic            /usr/tmp        Sent files will be created in /var/spool/uucp         before they are copied to the target directory.        Myname for the conversation will be sun.        PUBDIR for the conversation will be /usr/spool/uucppublic.Machine(s): (garp) CAN execute the following commands:command (rmail), fullname (rmail)command (rnews), fullname (rnews)command (uucp), fullname (uucp)*** uucheck:  /etc/uucp/Permissions Check Complete#  <ACLASS="indexterm"NAME="AUTOID-19588"></A><ACLASS="indexterm"NAME="AUTOID-19590"></A><ACLASS="indexterm"NAME="AUTOID-19593"></A> </PRE></BLOCKQUOTE></DIV></DIV></DIV><DIVCLASS="htmlnav"><P></P><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch15_04.htm"TITLE="15.4 Security in Version 2 UUCP"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 15.4 Security in Version 2 UUCP"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="book"HREF="index.htm"TITLE="Practical UNIX &amp; Internet Security"><IMGSRC="../gifs/txthome.gif"ALT="Practical UNIX &amp; Internet Security"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch15_06.htm"TITLE="15.6 Additional Security Concerns"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 15.6 Additional Security Concerns"BORDER="0"></A></TD></TR><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172">15.4 Security in Version 2 UUCP</TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="index"HREF="index/idx_0.htm"TITLE="Book Index"><IMGSRC="../gifs/index.gif"ALT="Book Index"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172">15.6 Additional Security Concerns</TD></TR></TABLE><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><PCLASS="nav"><FONTSIZE="-1">[ <AHREF="../index.htm"TITLE="The Networking CD Bookshelf">Library Home</A> | <AHREF="../dnsbind/index.htm"TITLE="DNS &amp; BIND">DNS &amp; BIND</A> | <AHREF="../tcpip/index.htm"TITLE="TCP/IP Network Administration">TCP/IP</A> | <AHREF="../sendmail/index.htm"TITLE="sendmail">sendmail</A> | <AHREF="../smdref/index.htm"TITLE="sendmail Desktop Reference">sendmail Reference</A> | <AHREF="../firewall/index.htm"TITLE="Building Internet Firewalls">Firewalls</A> | <AHREF="index.htm"TITLE="Practical UNIX &amp; Internet Security">Practical Security</A> ]</FONT></P></DIV></BODY></HTML>