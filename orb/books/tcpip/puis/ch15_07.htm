<HTML><HEAD><TITLE>[Chapter 15] 15.7 Early Security Problems with UUCP</TITLE><METANAME="DC.title"CONTENT="Practical UNIX &amp; Internet Security"><METANAME="DC.creator"CONTENT="Simson Garfinkel &amp; Gene Spafford"><METANAME="DC.publisher"CONTENT="O'Reilly &amp; Associates, Inc."><METANAME="DC.date"CONTENT="1999-02-04T00:12:13Z"><METANAME="DC.type"CONTENT="Text.Monograph"><METANAME="DC.format"CONTENT="text/html"SCHEME="MIME"><METANAME="DC.source"CONTENT="1-56592-148-8"SCHEME="ISBN"><METANAME="DC.language"CONTENT="en-US"><METANAME="generator"CONTENT="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><LINKREV="made"HREF="mailto:online-books@oreilly.com"TITLE="Online Books Comments"><LINKREL="up"HREF="ch15_01.htm"TITLE="15. UUCP"><LINKREL="prev"HREF="ch15_06.htm"TITLE="15.6 Additional Security Concerns"><LINKREL="next"HREF="ch15_08.htm"TITLE="15.8 UUCP Over Networks"></HEAD><BODYBGCOLOR="#FFFFFF"TEXT="#000000"><DIVCLASS="htmlnav"><H1><IMGSRC="gifs/smbanner.gif"ALT="Practical UNIX &amp; Internet Security"USEMAP="#srchmap"BORDER="0"></H1><MAPNAME="srchmap"><AREASHAPE="RECT"COORDS="0,0,466,65"HREF="index.htm"ALT="Practical UNIX &amp; Internet Security"><AREASHAPE="RECT"COORDS="467,0,514,18"HREF="../search/psrch.htm"ALT="Search this book"></MAP><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch15_06.htm"TITLE="15.6 Additional Security Concerns"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 15.6 Additional Security Concerns"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><B><FONTFACE="ARIEL,HELVETICA,HELV,SANSERIF"SIZE="-1">Chapter 15<BR>UUCP</FONT></B></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch15_08.htm"TITLE="15.8 UUCP Over Networks"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 15.8 UUCP Over Networks"BORDER="0"></A></TD></TR></TABLE>&nbsp;<HRALIGN="LEFT"WIDTH="515"TITLE="footer"></DIV><DIVCLASS="SECT1"><H2CLASS="sect1"><ACLASS="title"NAME="PUIS-CHP-15-SECT-7">15.7 Early Security Problems with UUCP</A></H2><PCLASS="para"><SPANCLASS="acronym">UUCP</SPAN><ACLASS="indexterm"NAME="AUTOID-19674"></A><ACLASS="indexterm"NAME="AUTOID-19677"></A>is one of the oldest major subsystems of the <SPANCLASS="acronym">UNIX</SPAN>operating system (older than the <EMCLASS="emphasis">csh</EM>), andit has had its share of security holes. All of the known securityproblems have been fixed in recent years. Unfortunately, there arestill some old versions of <SPANCLASS="acronym">UUCP</SPAN> in use.</P><PCLASS="para">The main <SPANCLASS="acronym">UUCP</SPAN> security problems were mosteasily triggered by sending mail messages to addresses other thanvalid user names. In one version of <SPANCLASS="acronym">UUCP</SPAN>, mailcould be sent directly to a file; in another version of <SPANCLASS="acronym">UUCP</SPAN>,mail could be sent to a special address that caused a command tobe executed&nbsp;- sometimes as <EMCLASS="emphasis">root</EM>! Bothof these holes pose obvious security problems. [8]</P><BLOCKQUOTECLASS="footnote"><PCLASS="para">[8] Interestinglyenough, these same problems reappeared in the <EMCLASS="emphasis">sendmail</EM>program in recent years. People designing software don'tseem to be very good about learning from the past.</P></BLOCKQUOTE><PCLASS="para">Fortunately, you can easily check to see if the version of<SPANCLASS="acronym">UUCP</SPAN> you are running contains these flaws. Ifit does, get a software upgrade, or disable your version of <SPANCLASS="acronym">UUCP</SPAN>.A current version of <SPANCLASS="acronym">BNU</SPAN> <SPANCLASS="acronym">UUCP</SPAN>can be licensed from AT&amp;T if your vendor doesn'thave one.</P><PCLASS="para">To check your version of <SPANCLASS="acronym">UUCP</SPAN>,follow the steps outlined here:</P><OLCLASS="orderedlist"><LICLASS="listitem"><PCLASS="para">Your <ACLASS="indexterm"NAME="AUTOID-19701"></A><ACLASS="indexterm"NAME="AUTOID-19704"></A>mail system shouldnot allow mail to be sent directly to a file. Mailers that deliverdirectly to files can be used to corrupt system databases or applicationprograms. You can test whether or not your system allows mail tobe sent to a file with the command sequence:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">$ mail /tmp/mailbugthis is a mailbug file test^D</PRE></BLOCKQUOTE><PCLASS="para">If the file <EMCLASS="emphasis">mailbug</EM> appears in the <EMCLASS="emphasis">/tmp</EM>directory, then your mailer is unsecure. If your mailer returnsa mail message to you with an error notification (usually containinga message like &quot;cannot deliver to a file&quot;), thenyour mail program does not contain this error. You should try thistest with <EMCLASS="emphasis">/bin/mail</EM>, <EMCLASS="emphasis">/bin/rmail</EM>,and any other mail delivery program on your system.</P></LI><LICLASS="listitem"><PCLASS="para">Your <SPANCLASS="acronym">UUCP</SPAN> systemshould not allow commands to be encapsulated in <ACLASS="indexterm"NAME="AUTOID-19716"></A><ACLASS="indexterm"NAME="AUTOID-19719"></A>addresses.This bug arises from the fact that some early <EMCLASS="emphasis">uuxqt</EM>implementations used the <EMCLASS="emphasis">system (  )</EM> libraryfunction to spawn commands (including mail). Mail sent to an addresscontaining a backrsquoed command string would cause that commandstring to be executed before the mail was delivered. You can testwhether or not your system executes commands encapsulated in addresseswith the command sequence:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">$ uux - mail 'root `/bin/touch /tmp/foo`'this is a mailbug command test^D$ uux - mail 'root &amp; /bin/touch /tmp/foo'this is another test^D</PRE></BLOCKQUOTE><PCLASS="para">Thesystem should return mail with a message that <EMCLASS="emphasis">/bin/touch/tmp/foo</EM> is an unknown user. If the mailer <EMCLASS="emphasis">executed</EM>the <EMCLASS="emphasis">touch</EM>&nbsp;- you can tell because a <EMCLASS="emphasis">foo</EM>file will be created in your <EMCLASS="emphasis">/tmp</EM> directory&nbsp;- thenyour <EMCLASS="emphasis">uux</EM> program is unsecure. Get a new versionfrom your vendor.</P></LI><LICLASS="listitem"><PCLASS="para">Check both types of addresses describedearlier for mail that is sent by <SPANCLASS="acronym">UUCP</SPAN> as wellas for mail that originates locally on your system. For example,if the machines prose and idr are connected by <SPANCLASS="acronym">UUCP</SPAN>,then log onto <ICLASS="systemitem">idr </I>andtry:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">$ mail 'prose!/tmp/send1'Subject: This is a mailbug testTest^D$ mail 'prose!`/bin/touch /tmp/foo`'Subject: This is a mail bugtest #2Another test.^D</PRE></BLOCKQUOTE></LI></OL></DIV><DIVCLASS="htmlnav"><P></P><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch15_06.htm"TITLE="15.6 Additional Security Concerns"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 15.6 Additional Security Concerns"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="book"HREF="index.htm"TITLE="Practical UNIX &amp; Internet Security"><IMGSRC="../gifs/txthome.gif"ALT="Practical UNIX &amp; Internet Security"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch15_08.htm"TITLE="15.8 UUCP Over Networks"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 15.8 UUCP Over Networks"BORDER="0"></A></TD></TR><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172">15.6 Additional Security Concerns</TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="index"HREF="index/idx_0.htm"TITLE="Book Index"><IMGSRC="../gifs/index.gif"ALT="Book Index"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172">15.8 UUCP Over Networks</TD></TR></TABLE><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><PCLASS="nav"><FONTSIZE="-1">[ <AHREF="../index.htm"TITLE="The Networking CD Bookshelf">Library Home</A> | <AHREF="../dnsbind/index.htm"TITLE="DNS &amp; BIND">DNS &amp; BIND</A> | <AHREF="../tcpip/index.htm"TITLE="TCP/IP Network Administration">TCP/IP</A> | <AHREF="../sendmail/index.htm"TITLE="sendmail">sendmail</A> | <AHREF="../smdref/index.htm"TITLE="sendmail Desktop Reference">sendmail Reference</A> | <AHREF="../firewall/index.htm"TITLE="Building Internet Firewalls">Firewalls</A> | <AHREF="index.htm"TITLE="Practical UNIX &amp; Internet Security">Practical Security</A> ]</FONT></P></DIV></BODY></HTML>