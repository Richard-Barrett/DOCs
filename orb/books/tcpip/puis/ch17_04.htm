<HTML><HEAD><TITLE>[Chapter 17] 17.4 Security Implications of Network Services</TITLE><METANAME="DC.title"CONTENT="Practical UNIX &amp; Internet Security"><METANAME="DC.creator"CONTENT="Simson Garfinkel &amp; Gene Spafford"><METANAME="DC.publisher"CONTENT="O'Reilly &amp; Associates, Inc."><METANAME="DC.date"CONTENT="1999-02-04T00:13:51Z"><METANAME="DC.type"CONTENT="Text.Monograph"><METANAME="DC.format"CONTENT="text/html"SCHEME="MIME"><METANAME="DC.source"CONTENT="1-56592-148-8"SCHEME="ISBN"><METANAME="DC.language"CONTENT="en-US"><METANAME="generator"CONTENT="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><LINKREV="made"HREF="mailto:online-books@oreilly.com"TITLE="Online Books Comments"><LINKREL="up"HREF="ch17_01.htm"TITLE="17. TCP/IP Services"><LINKREL="prev"HREF="ch17_03.htm"TITLE="17.3 Primary UNIX Network Services"><LINKREL="next"HREF="ch17_05.htm"TITLE="17.5 Monitoring Your Network with netstat"></HEAD><BODYBGCOLOR="#FFFFFF"TEXT="#000000"><DIVCLASS="htmlnav"><H1><IMGSRC="gifs/smbanner.gif"ALT="Practical UNIX &amp; Internet Security"USEMAP="#srchmap"BORDER="0"></H1><MAPNAME="srchmap"><AREASHAPE="RECT"COORDS="0,0,466,65"HREF="index.htm"ALT="Practical UNIX &amp; Internet Security"><AREASHAPE="RECT"COORDS="467,0,514,18"HREF="../search/psrch.htm"ALT="Search this book"></MAP><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch17_03.htm"TITLE="17.3 Primary UNIX Network Services"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 17.3 Primary UNIX Network Services"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><B><FONTFACE="ARIEL,HELVETICA,HELV,SANSERIF"SIZE="-1">Chapter 17<BR>TCP/IP Services</FONT></B></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch17_05.htm"TITLE="17.5 Monitoring Your Network with netstat"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 17.5 Monitoring Your Network with netstat"BORDER="0"></A></TD></TR></TABLE>&nbsp;<HRALIGN="LEFT"WIDTH="515"TITLE="footer"></DIV><DIVCLASS="SECT1"><H2CLASS="sect1"><ACLASS="title"NAME="PUIS-CHP-17-SECT-4">17.4 Security Implications of Network Services</A></H2><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-24050"></A>Network serversare the portals through which the outside world accesses the informationstored on your computer. Every server must:</P><ULCLASS="itemizedlist"><LICLASS="listitem"><PCLASS="para">Determine what information or actionthe client requests.</P></LI><LICLASS="listitem"><PCLASS="para">Decide whether or not the client is entitled tothe information, optionally authenticating the person (or program)on the other side of the network that is requesting service.</P></LI><LICLASS="listitem"><PCLASS="para">Transfer the requested information or perform thedesired service.</P></LI></UL><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-24061"></A><ACLASS="indexterm"NAME="AUTOID-24064"></A>By their design, many servers must run with<ICLASS="filename">root</I> privileges. A bug or an intentional back door built into aserver can therefore compromise the security of an entire computer,opening the system to any user of the network who is aware of theflaw. Even a relatively innocuous program can be the downfall ofan entire computer. Flaws may remain in programs distributed byvendors for many years, only to be uncovered some time in the future.<ACLASS="indexterm"NAME="AUTOID-24068"></A></P><PCLASS="para">Furthermore, many <SPANCLASS="acronym">UNIX</SPAN> network serversrely on IP numbers or hostnames to authenticate incoming networkconnections. This approach is fundamentally flawed, as neither theIP protocol nor <SPANCLASS="acronym">DNS</SPAN> were designed to be resistantto attack. There have been many reports of computers that have fallenvictim to successful IP spoofing attacks or <SPANCLASS="acronym">DNS</SPAN>compromise.</P><PCLASS="para">Given these factors, you may wish to adopt one or more ofthe following strategies to protect your servers and data:</P><ULCLASS="itemizedlist"><LICLASS="listitem"><PCLASS="para">Use <ACLASS="indexterm"NAME="AUTOID-24078"></A><ACLASS="indexterm"NAME="AUTOID-24081"></A>encryption to protect your data. If it is stolen,the data will do your attacker no good. Furthermore, making alterationsin your data that you will not notice will be difficult, if notimpossible.</P></LI><LICLASS="listitem"><PCLASS="para">Avoid using <ACLASS="indexterm"NAME="AUTOID-24086"></A><ACLASS="indexterm"NAME="AUTOID-24089"></A><ACLASS="indexterm"NAME="AUTOID-24091"></A><ACLASS="indexterm"NAME="AUTOID-24094"></A>passwords and host-based authentication. Instead,rely on tokens, one-time passwords, or cryptographically securecommunications.</P></LI><LICLASS="listitem"><PCLASS="para">Use a firewall to isolate your internal networkfrom the outside world.</P></LI><LICLASS="listitem"><PCLASS="para">Disconnect your internal network from the outsideworld. You can still relay electronic mail between the two networksusing <SPANCLASS="acronym">UUCP</SPAN> or some other mechanism. Set up separatenetwork workstations to allow people to access the <SPANCLASS="acronym">WWW</SPAN>or other Internet services.</P></LI><LICLASS="listitem"><PCLASS="para">Create a second internal network for the most confidentialinformation.</P></LI></UL><DIVCLASS="sidebar"><H4CLASS="sidebar"><ACLASS="title"NAME="AUTOID-24105">Bringing Up an Internet Server Machine: Step-by-Step</A></H4><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-24108"></A>Althoughevery site is unique, you may find the following step-by-step listhelpful in bringing up new servers as securely as possible:</P><OLCLASS="orderedlist"><LICLASS="listitem"><PCLASS="para">Don't physically connect to the networkbefore you perform all of the following steps. Because some networkaccess may be needed to <SPANCLASS="acronym">FTP</SPAN> patches, for example,you may need to connect as briefly as possible in single-user mode(so there are no daemons running), fetch what you need, disconnectphysically, and then follow steps 2-12.</P></LI><LICLASS="listitem"><PCLASS="para">Erase your computer's hard disk and loada fresh copy of your operating system.</P></LI><LICLASS="listitem"><PCLASS="para">Locate and load all security-related patches. Tofind the patches, check with both your vendor and with <SPANCLASS="acronym">CERT</SPAN>'s<SPANCLASS="acronym">FTP</SPAN> server, <ACLASS="systemitem.ftpserver"HREF="ftp://ftp.cert.org.">ftp.cert.org.</A></P></LI><LICLASS="listitem"><PCLASS="para">Modify your computer's <ICLASS="filename">/etc/syslog.conf</I>file so that logs are stored both locally and on your organization'slogging host.</P></LI><LICLASS="listitem"><PCLASS="para">Configure as few user accounts as necessary. Ideally,users should avoid logging into your Internet server.</P></LI><LICLASS="listitem"><PCLASS="para">If your server is a mail server, then you may wishto have your users read their mail with <SPANCLASS="acronym">POP</SPAN>.You will need to create user accounts, but give each user a <ICLASS="filename">/bin/nologin</I>(or a shell script that simply prints a &quot;no logins allowed&quot;message) as their shell to prevent logins.</P></LI><LICLASS="listitem"><PCLASS="para">Check all <ICLASS="filename">/etc/rc*</I> andother system initialization files, and remove daemons you don'twant running. (Use<ICLASS="filename"> netstat </I>to see what servicesare running.)</P></LI><LICLASS="listitem"><PCLASS="para">Look through <ICLASS="filename">/etc/inetd.conf </I>anddisable all unneeded services. Protect the remaining services with<KBDCLASS="command">tcpwrapper</KBD> or a similar program.</P></LI><LICLASS="listitem"><PCLASS="para">Add your own server programs to the system. Makesure that each one is based on the most up-to-date code.</P></LI><LICLASS="listitem"><PCLASS="para">Get and install Tripwire, so you can tell if anyfiles have been modified as the result of a compromise. (See <ACLASS="xref"HREF="ch09_01.htm"TITLE="Integrity Management">Chapter 9, <CITECLASS="chapter">Integrity Management</CITE></A>, for details.)</P></LI><LICLASS="listitem"><PCLASS="para">Get and run Tiger to look for other problems.</P></LI><LICLASS="listitem"><PCLASS="para">Monitor your system. Make sure that log files aren'tgrowing out of control. Use the <KBDCLASS="command">last</KBD> commandto see if people have logged in. Be curious.</P></LI></OL></DIV><ULCLASS="itemizedlist"><LICLASS="listitem"><PCLASS="para">Disable all services that you arenot sure you need, and put wrappers around the rest to log connectionsand restrict connectivity.</P></LI></UL></DIV><DIVCLASS="htmlnav"><P></P><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch17_03.htm"TITLE="17.3 Primary UNIX Network Services"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 17.3 Primary UNIX Network Services"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="book"HREF="index.htm"TITLE="Practical UNIX &amp; Internet Security"><IMGSRC="../gifs/txthome.gif"ALT="Practical UNIX &amp; Internet Security"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch17_05.htm"TITLE="17.5 Monitoring Your Network with netstat"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 17.5 Monitoring Your Network with netstat"BORDER="0"></A></TD></TR><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172">17.3 Primary UNIX Network Services</TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="index"HREF="index/idx_0.htm"TITLE="Book Index"><IMGSRC="../gifs/index.gif"ALT="Book Index"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172">17.5 Monitoring Your Network with netstat</TD></TR></TABLE><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><PCLASS="nav"><FONTSIZE="-1">[ <AHREF="../index.htm"TITLE="The Networking CD Bookshelf">Library Home</A> | <AHREF="../dnsbind/index.htm"TITLE="DNS &amp; BIND">DNS &amp; BIND</A> | <AHREF="../tcpip/index.htm"TITLE="TCP/IP Network Administration">TCP/IP</A> | <AHREF="../sendmail/index.htm"TITLE="sendmail">sendmail</A> | <AHREF="../smdref/index.htm"TITLE="sendmail Desktop Reference">sendmail Reference</A> | <AHREF="../firewall/index.htm"TITLE="Building Internet Firewalls">Firewalls</A> | <AHREF="index.htm"TITLE="Practical UNIX &amp; Internet Security">Practical Security</A> ]</FONT></P></DIV></BODY></HTML>