<HTML><HEAD><TITLE>[Chapter 19] 19.5 Sun's NIS+</TITLE><METANAME="DC.title"CONTENT="Practical UNIX &amp; Internet Security"><METANAME="DC.creator"CONTENT="Simson Garfinkel &amp; Gene Spafford"><METANAME="DC.publisher"CONTENT="O'Reilly &amp; Associates, Inc."><METANAME="DC.date"CONTENT="1999-02-04T00:15:34Z"><METANAME="DC.type"CONTENT="Text.Monograph"><METANAME="DC.format"CONTENT="text/html"SCHEME="MIME"><METANAME="DC.source"CONTENT="1-56592-148-8"SCHEME="ISBN"><METANAME="DC.language"CONTENT="en-US"><METANAME="generator"CONTENT="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><LINKREV="made"HREF="mailto:online-books@oreilly.com"TITLE="Online Books Comments"><LINKREL="up"HREF="ch19_01.htm"TITLE="19. RPC, NIS, NIS+,  and Kerberos"><LINKREL="prev"HREF="ch19_04.htm"TITLE="19.4 Sun's Network Information Service (NIS)"><LINKREL="next"HREF="ch19_06.htm"TITLE="19.6 Kerberos"></HEAD><BODYBGCOLOR="#FFFFFF"TEXT="#000000"><DIVCLASS="htmlnav"><H1><IMGSRC="gifs/smbanner.gif"ALT="Practical UNIX &amp; Internet Security"USEMAP="#srchmap"BORDER="0"></H1><MAPNAME="srchmap"><AREASHAPE="RECT"COORDS="0,0,466,65"HREF="index.htm"ALT="Practical UNIX &amp; Internet Security"><AREASHAPE="RECT"COORDS="467,0,514,18"HREF="../search/psrch.htm"ALT="Search this book"></MAP><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch19_04.htm"TITLE="19.4 Sun's Network Information Service (NIS)"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 19.4 Sun's Network Information Service (NIS)"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><B><FONTFACE="ARIEL,HELVETICA,HELV,SANSERIF"SIZE="-1">Chapter 19<BR>RPC, NIS, NIS+,  and Kerberos</FONT></B></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch19_06.htm"TITLE="19.6 Kerberos"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 19.6 Kerberos"BORDER="0"></A></TD></TR></TABLE>&nbsp;<HRALIGN="LEFT"WIDTH="515"TITLE="footer"></DIV><DIVCLASS="SECT1"><H2CLASS="sect1"><ACLASS="title"NAME="PUIS-CHP-19-SECT-5">19.5 Sun's NIS+</A></H2><PCLASS="para"><SPANCLASS="acronym">NIS</SPAN><ACLASS="indexterm"NAME="AUTOID-27066"></A> was designedfor a small, friendly computing environment. As Sun Microsystem'scustomers began to build networks with thousands or tens of thousandsof workstations, <SPANCLASS="acronym">NIS</SPAN> started to show its weaknesses:</P><ULCLASS="itemizedlist"><LICLASS="listitem"><PCLASS="para"><SPANCLASS="acronym">NIS</SPAN> maps couldonly be updated by logging onto the server and editing files.</P></LI><LICLASS="listitem"><PCLASS="para"><SPANCLASS="acronym">NIS</SPAN> servers could only be updatedin a single batch operation. Updates could take many minutes, oreven hours, to complete.</P></LI><LICLASS="listitem"><PCLASS="para">All information transmitted by <SPANCLASS="acronym">NIS</SPAN>was transmitted without encryption, making it subject to eavesdropping.</P></LI><LICLASS="listitem"><PCLASS="para"><SPANCLASS="acronym">NIS</SPAN> updates themselves were authenticatedwith <SPANCLASS="acronym">AUTH_UNIX</SPAN> <SPANCLASS="acronym">RPC</SPAN> authentication,making them subject to spoofing.</P></LI></UL><PCLASS="para">Torespond to these complaints, Sun Microsystems started working onan <SPANCLASS="acronym">NIS</SPAN> replacement in 1990. That system was eventuallyreleased a few years later as <SPANCLASS="acronym">NIS</SPAN>+.</P><PCLASS="para"><SPANCLASS="acronym">NIS</SPAN>+ quickly earned a bad reputation.By all accounts, the early releases were virtually untested andrarely operated as promised. Sun Microsystems sent engineers intothe field to debug their software at customer sites. Eventually,Sun worked the bugs out of <SPANCLASS="acronym">NIS</SPAN>+ andtoday it is a more reliable system for secure network managementand control.</P><PCLASS="para">An excellent reference for people using<SPANCLASS="acronym">NIS</SPAN>+ is Rick Ramsey's book,<EMCLASS="emphasis">All About Administrating NIS+ </EM>(SunSoft Press,Prentice Hall, 1994).</P><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="PUIS-CHP-19-SECT-5.1">19.5.1 What NIS+ Does</A></H3><PCLASS="para"><SPANCLASS="acronym">NIS</SPAN>+creates network databases that are used to store information aboutcomputers and users within an organization. <SPANCLASS="acronym">NIS</SPAN>+calls these databases <ICLASS="firstterm">tables</I>; they are functionallysimilar to <SPANCLASS="acronym">NIS</SPAN> <ICLASS="firstterm">maps</I>. Unlike<SPANCLASS="acronym">NIS</SPAN>, <SPANCLASS="acronym">NIS</SPAN>+ allowsfor incremental updates of the information stored on replicateddatabase servers throughout the network.</P><PCLASS="para">Each <SPANCLASS="acronym">NIS</SPAN>+domain has one and only one <SPANCLASS="acronym">NIS</SPAN>+ <EMCLASS="emphasis">rootdomain server</EM>. This is a computer that contains the mastercopy of the information stored in the <SPANCLASS="acronym">NIS</SPAN>+<EMCLASS="emphasis">root domain</EM>. The information stored on this server canbe replicated, allowing the network to remain usable even when theroot server is down or unavailable. There may also be <SPANCLASS="acronym">NIS</SPAN>+servers for subdomains.</P><PCLASS="para">Entities that communicate using<SPANCLASS="acronym">NIS</SPAN>+ are called <ICLASS="firstterm">NIS+ <ACLASS="indexterm"NAME="AUTOID-27113"></A><ACLASS="indexterm"NAME="AUTOID-27115"></A>principals</I>. An <SPANCLASS="acronym">NIS</SPAN>+principle may be a host or an authenticated user. Each <SPANCLASS="acronym">NIS</SPAN>+principal has a public key and a secret key, which are stored onan <SPANCLASS="acronym">NIS</SPAN>+ server in the domain. (As thisis Secure <SPANCLASS="acronym">RPC</SPAN>, the secret key is stored encrypted.)</P><PCLASS="para">All communication between <SPANCLASS="acronym">NIS</SPAN>+servers and <SPANCLASS="acronym">NIS</SPAN>+ principals take placethrough Secure <SPANCLASS="acronym">RPC</SPAN>. This makes the communicationresistant to both eavesdropping and spoofing attacks. <SPANCLASS="acronym">NIS</SPAN>+also oversees the creation and management of Secure <SPANCLASS="acronym">RPC</SPAN>keys; by virtue of using <SPANCLASS="acronym">NIS</SPAN>+, everymember of the organization is enabled to use Secure <SPANCLASS="acronym">RPC</SPAN>.</P></DIV><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="PUIS-CHP-19-SECT-5.2">19.5.2 NIS+ Objects</A></H3><PCLASS="para">All informationstored on an <SPANCLASS="acronym">NIS</SPAN>+ server is stored inthe form of objects. <SPANCLASS="acronym">NIS</SPAN>+ supports threefundamental kinds of objects:</P><DLCLASS="variablelist"><DTCLASS="term">Table objects</DT><DDCLASS="listitem"><PCLASS="para">Store configuration information.</P></DD><DTCLASS="term">Group objects</DT><DDCLASS="listitem"><PCLASS="para">Used for <SPANCLASS="acronym">NIS</SPAN>+ authorization,<SPANCLASS="acronym">NIS</SPAN>+ groups give you a way to collectivelyrefer to a set of <SPANCLASS="acronym">NIS</SPAN>+ principals (usersor machines) at a single time.</P></DD><DTCLASS="term">Directories</DT><DDCLASS="listitem"><PCLASS="para">Provide structure to an <SPANCLASS="acronym">NIS</SPAN>+server. Directories can store tables, groups, or other directories,creating a tree structure on the <SPANCLASS="acronym">NIS</SPAN>+server similar to the <SPANCLASS="acronym">UNIX</SPAN> filesystem.</P></DD></DL></DIV><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="PUIS-CHP-19-SECT-5.3">19.5.3 NIS+ Tables</A></H3><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-27157"></A>Information stored in <SPANCLASS="acronym">NIS</SPAN>+tables can be retrieved using any table column as a key; <SPANCLASS="acronym">NIS</SPAN>+thus eliminates the need under <SPANCLASS="acronym">NIS</SPAN> to have multiple<SPANCLASS="acronym">NIS</SPAN> maps (such as <ICLASS="filename">group.bygid</I> and <ICLASS="filename">group.byname)</I>.	<SPANCLASS="acronym">NIS</SPAN>+ predefines 16 tables (see <ACLASS="xref"HREF="ch19_05.htm#PUIS-CHP-19-TAB-2"TITLE="NIS+ Predefined Tables">Table 19.2</A>);users are free to create additional tables of their own.</P><TABLECLASS="table"><CAPTIONCLASS="table"><ACLASS="title"NAME="PUIS-CHP-19-TAB-2">Table 19.2: NIS+ Predefined Tables</A></CAPTION><THEADCLASS="thead"><TRCLASS="row"VALIGN="TOP"><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Table</P></TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Equivalent UNIX File</P></TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Stores</P></TH></TR></THEAD><TBODYCLASS="tbody"><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Hosts</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><ICLASS="filename">/etc/hosts</I></P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">IP address and hostname of every workstationin the NIS+ domain.</P></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-27193"></A>Bootparams</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><ICLASS="filename">/etc/bootparams</I></P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Configuration information for disklessclients, including location of root, swap and dump partitions.</P></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-27203"></A>Passwd</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><ICLASS="filename">/etc/passwd</I></P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">User account information (password, fullname, home directory, etc.)</P></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-27213"></A>Cred</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"></P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Secure RPC credentials for users in thedomain.</P></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-27222"></A>Group</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><ICLASS="filename">/etc/group</I></P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Groupnames, passwords, and members ofevery UNIX group.</P></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-27232"></A>Netgroup</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><ICLASS="filename">/etc/netgroup</I></P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Netgroups to which workstations and usersbelong.</P></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-27242"></A>Mail_Aliases</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><ICLASS="filename">/usr/lib/aliases /etc/aliases /etc/mail/aliases</I></P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Electronic mail aliases.</P></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-27252"></A>Timezone</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><ICLASS="filename">/etc/timezone</I></P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">The time zone of each workstation inthe domain.</P></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-27262"></A>Networks</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><ICLASS="filename">/etc/networks</I></P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">The networks in the domain and theircanonical names.</P></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-27272"></A>Netmasks</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><ICLASS="filename">/etc/inet/netmasks /etc/netmasks</I></P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">The name of each network in the domainand its associated netmask.</P></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-27282"></A>Ethers</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><ICLASS="filename">/etc/ethers</I></P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">The Ethernet address of every workstationin the domain.</P></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-27292"></A>Services</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><ICLASS="filename">/etc/services</I></P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">The port number for every Internet serviceused in the domain.</P></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-27302"></A>Protocols</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><ICLASS="filename">/etc/protocols</I></P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">The IP protocols used in the domain.</P></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-27312"></A>RPC</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"></P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">The RPC program numbers for RPC serversin the domain.</P></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-27321"></A>Outcome</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">None</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">The location of home directories forusers in the domain.</P></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-27330"></A>Auto_Mounter</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">None</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Information for Sun's Automounter.</P></TD></TR></TBODY></TABLE></DIV><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="PUIS-CHP-19-SECT-5.4">19.5.4 Using NIS+</A></H3><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-27339"></A><ACLASS="indexterm"NAME="AUTOID-27341"></A>For users, using an <SPANCLASS="acronym">NIS</SPAN>+domain can be remarkably pleasant. When a user logs in to a workstation,the <ICLASS="filename">/bin/login</I> command automatically acquiresthe user's <SPANCLASS="acronym">NIS</SPAN>+ security credentialsand attempts to decrypt them with the user's login password.</P><PCLASS="para">If the account password and the <SPANCLASS="acronym">NIS</SPAN>+credentials password are the same (and they usually are), the <SPANCLASS="acronym">NIS</SPAN>+<ACLASS="indexterm"NAME="AUTOID-27351"></A><KBDCLASS="command">keyserv</KBD> process will cachethe user's secret key and the user will have transparentaccess to all Secure <SPANCLASS="acronym">RPC</SPAN> services. If the accountpassword and the <SPANCLASS="acronym">NIS</SPAN>+ credentials passwordare not the same, then the user will need to manually log in tothe <SPANCLASS="acronym">NIS</SPAN>+ domain by using the <ACLASS="indexterm"NAME="AUTOID-27357"></A><KBDCLASS="command">keylogin</KBD> command.</P><PCLASS="para"><SPANCLASS="acronym">NIS</SPAN>+users should change their passwords with the <SPANCLASS="acronym">NIS</SPAN>+<ACLASS="indexterm"NAME="AUTOID-27363"></A><KBDCLASS="command">nispasswd</KBD> command,which works in much the same way as the standard <SPANCLASS="acronym">UNIX</SPAN><KBDCLASS="command">passwd</KBD> command.</P><PCLASS="para"><SPANCLASS="acronym">NIS</SPAN>+ securityis implemented by providing a means for authenticating users, andby establishing access control lists that control the ways thatthose authenticated users can interact with the information storedin <SPANCLASS="acronym">NIS</SPAN>+ tables.<SPANCLASS="acronym"> NIS</SPAN>+provides for two authentication types:</P><DLCLASS="variablelist"><DTCLASS="term">LOCAL	</DT><DDCLASS="listitem"><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-27377"></A><ACLASS="indexterm"NAME="AUTOID-27380"></A><ACLASS="indexterm"NAME="AUTOID-27383"></A>Authenticationbased on the <SPANCLASS="acronym">UID</SPAN> of the <SPANCLASS="acronym">UNIX</SPAN>process executing the <SPANCLASS="acronym">NIS</SPAN>+ command.<SPANCLASS="acronym">LOCAL</SPAN> authentication is used largely for administratingthe root <SPANCLASS="acronym">NIS</SPAN>+ server.</P></DD><DTCLASS="term">DES	</DT><DDCLASS="listitem"><PCLASS="para">Authentication based on Secure <SPANCLASS="acronym">RPC</SPAN>.Users must have their public key and encrypted secret key storedin the <SPANCLASS="acronym">NIS</SPAN>+ Cred table to use <SPANCLASS="acronym">DES</SPAN>authentication.</P></DD></DL><PCLASS="para">Like<SPANCLASS="acronym">UNIX</SPAN> files, each <SPANCLASS="acronym">NIS</SPAN>+object has an <ICLASS="firstterm">owner</I>, which is usually theobject's creator. (An object's owner can be changedwith the <ACLASS="indexterm"NAME="AUTOID-27402"></A><KBDCLASS="command">nischown</KBD> command.)<SPANCLASS="acronym">NIS</SPAN>+ objects also have access controllists, which are used to control which principals have what kindof access to the object.</P><PCLASS="para"><SPANCLASS="acronym">NIS</SPAN>+allows four kinds of access to objects:</P><TABLECLASS="informaltable"><TBODYCLASS="tbody"><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><ICLASS="filename">Read</I></P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Ability to read the contents of the object.</P></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><ICLASS="filename">Modify</I></P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Ability to modify the contents of theobject.</P></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><ICLASS="filename">Create</I></P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Ability to create new objects withinthe table.</P></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><ICLASS="filename">Destroy</I></P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Ability to destroy objects containedwithin the table.</P></TD></TR></TBODY></TABLE><PCLASS="para"><SPANCLASS="acronym">NIS</SPAN>+ maintainsa list of these access rights for four different kinds of principals:</P><TABLECLASS="informaltable"><TBODYCLASS="tbody"><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><ICLASS="filename">Nobody</I></P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-27446"></A>Unauthenticatedrequests, such as requests from individuals who do not have NIS+credentials within this NIS+ domain.</P></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><ICLASS="filename">Owner</I></P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">The principal that created the object(or that was assigned ownership via the<ICLASS="filename"> nischown</I>command).</P></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><ICLASS="filename">Group</I></P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Other principals in the object'sgroup.</P></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><ICLASS="filename">World</I></P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Other principals within the object'sNIS+ domain.</P></TD></TR></TBODY></TABLE><PCLASS="para">The way that <SPANCLASS="acronym">NIS</SPAN>+commands display access rights similar to the way that the <SPANCLASS="acronym">UNIX</SPAN><KBDCLASS="command">ls</KBD> command displays file permissions. The key difference is that<SPANCLASS="acronym">NIS</SPAN>+ access rights are displayed asa list of 16 characters, and the first four characters representthe rights for &quot;nobody,&quot; rather than &quot;owner,&quot;as shown in <ACLASS="xref"HREF="ch19_05.htm#PUIS-CHP-19-FIG-2"TITLE="NIS+ access rights are displayed as a list of 16 characters">Figure 19.2</A>.</P><H4CLASS="figure"><ACLASS="title"NAME="PUIS-CHP-19-FIG-2">Figure 19.2: NIS+ access rights are displayed as a list of 16 characters</A></H4><IMGCLASS="graphic"SRC="figs/puis_1902.gif"ALT="Figure 19.2"><PCLASS="para"><SPANCLASS="acronym">NIS</SPAN>+ tables mayprovide additional access privileges for individual rows, columnsor entries that they contain. Thus, all authenticated users mayhave read access to an entire table, but each user may further havethe ability to modify the row of the table associated with the user'sown account. Note that while individual rows, columns or entriescan broaden the access control list, they cannot impose more restrictiverules.</P><DIVCLASS="sect3"><H4CLASS="sect3"><ACLASS="title"NAME="PUIS-CHP-19-SECT-5.4.1">19.5.4.1 Changing your password</A></H4><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-27482"></A>Once a user hasher <SPANCLASS="acronym">NIS</SPAN>+ account set up, she shoulduse the <ICLASS="filename">nispasswd</I> command to change the password:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">% <BCLASS="emphasis.bold">nispasswd</B>Changing password for simsong on NIS+ server.Old login password: <ICLASS="systemitem.password">fj39=3-f</I>New login password: <ICLASS="systemitem.password">fj43fadf</I>Re-enter new  password:        NIS+ password information changed for simsong        NIS+ credential information changed for simsong% </PRE></BLOCKQUOTE></DIV><DIVCLASS="sect3"><H4CLASS="sect3"><ACLASS="title"NAME="PUIS-CHP-19-SECT-5.4.2">19.5.4.2 When a user's passwords don't match</A></H4><PCLASS="para">If a user has a different password stored on their workstationand on the Secure <SPANCLASS="acronym">RPC</SPAN> server, he will see thefollowing message when he logs in:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">login: <BCLASS="emphasis.bold">simsong</B>Password: <ICLASS="systemitem.password">fj39=3-f</I>Password does not decrypt secret key for unix.237@cpg.com.Last login: Sun Nov 19 18:03:42 from sun.vineyard.netSun Microsystems Inc.   SunOS 5.4       Generic July 1994% </PRE></BLOCKQUOTE><PCLASS="para">In this case, the user has a problem becausethe password that the user knows and uses to log in, for some reason,does not match the password that was used to encrypt the passwordon the Secure <SPANCLASS="acronym">RPC</SPAN> server. The user can'tchange his password with the <KBDCLASS="command">nispasswd</KBD> program, because he doesn'tknow his <SPANCLASS="acronym">NIS</SPAN> password:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen">% <BCLASS="emphasis.bold">nispasswd</B>Changing password for simsong on NIS+ server.Old login password:Sorry.% </PRE></BLOCKQUOTE><PCLASS="para">Likewise, the superuser can't runthe nispasswd program for the user. The only solution is for thesystem administrator to become superuser and give the user a newkey:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen"><ACLASS="indexterm"NAME="AUTOID-27506"></A> #  <BCLASS="emphasis.bold">newkey -u simsong</B>Updating nisplus publickey database.Adding new key for unix.237@cpg.com.Enter simsong's login password: <ICLASS="systemitem.password">fj39=3-f</I># </PRE></BLOCKQUOTE><PCLASS="para">This procedure sets the user's Secure <SPANCLASS="acronym">RPC</SPAN>password to be the same as their login password. Note that you mustknow the user's login password. If you don't,you'll get this error:</P><BLOCKQUOTECLASS="screen"><PRECLASS="screen"># <BCLASS="emphasis.bold">newkey -u simsong</B>Updating nisplus publickey database.Adding new key for unix.237@cpg.com.Enter simsong's login password: <ICLASS="systemitem.password">nosmis</I>newkey: ERROR, password differs from login password.# </PRE></BLOCKQUOTE><PCLASS="para">After the user has a new key, he can thenuse the <KBDCLASS="command">nispasswd</KBD> command to change his password, as shown above.<ACLASS="indexterm"NAME="AUTOID-27517"></A></P></DIV></DIV><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="PUIS-CHP-19-SECT-5.5">19.5.5 NIS+ Limitations</A></H3><PCLASS="para">If properlyconfigured, <SPANCLASS="acronym">NIS</SPAN>+ can be a very securesystem for network management and authentication. However, likeall security systems, it is possible to make a mistake in the configurationor management of <SPANCLASS="acronym">NIS</SPAN>+ that would rendera network that it protects somewhat less than absolutely secure.</P><PCLASS="para">Here are some things to be aware of:</P><ULCLASS="itemizedlist"><LICLASS="listitem"><PCLASS="para"><BCLASS="emphasis.bold">Do not run <SPANCLASS="acronym">NIS</SPAN>+in <SPANCLASS="acronym">NIS</SPAN> compatibility mode</B>. <SPANCLASS="acronym">NIS</SPAN>+has an <SPANCLASS="acronym">NIS</SPAN> compatibility mode that allows the<SPANCLASS="acronym">NIS</SPAN>+ server to interoperate with <SPANCLASS="acronym">NIS</SPAN>clients. If you run <SPANCLASS="acronym">NIS</SPAN>+ in this mode,then any <SPANCLASS="acronym">NIS</SPAN> server on your network (and possiblyother networks as well) will have the ability to access any pieceof information stored within your <SPANCLASS="acronym">NIS</SPAN>+server. Typically, <SPANCLASS="acronym">NIS</SPAN> access is used by attackersto obtain a copy of your domain's encrypted password file,which is then used to probe for weaknesses.</P></LI><LICLASS="listitem"><PCLASS="para"><BCLASS="emphasis.bold">Manually inspect the <ACLASS="indexterm"NAME="AUTOID-27542"></A>permissions of your<SPANCLASS="acronym">NIS</SPAN>+ objects on a regular basis</B>. System<ACLASS="indexterm"NAME="AUTOID-27546"></A><ACLASS="indexterm"NAME="AUTOID-27549"></A>integrity checkingsoftware such as <ACLASS="indexterm"NAME="AUTOID-27552"></A><ACLASS="indexterm"NAME="AUTOID-27554"></A><ACLASS="indexterm"NAME="AUTOID-27556"></A><SPANCLASS="acronym">COPS</SPAN>and Tripwire does not exist (yet) for <SPANCLASS="acronym">NIS</SPAN>+.In its absence, you must manually inspect the <SPANCLASS="acronym">NIS</SPAN>+tables, directories and groups on a regular basis. Be on the lookoutfor objects that can be modified by Nobody or by World; also beon the lookout for tables in which new objects can be created bythese principal classes.</P></LI><LICLASS="listitem"><PCLASS="para"><BCLASS="emphasis.bold">Secure the <ACLASS="indexterm"NAME="AUTOID-27565"></A>computerson which your <SPANCLASS="acronym">NIS</SPAN>+ servers are running</B>.Your <SPANCLASS="acronym">NIS</SPAN>+ server is only as secure asthe computer on which it is running. If attackers can obtain <ICLASS="filename">root</I>access on your <SPANCLASS="acronym">NIS</SPAN>+ server, they canmake any change that they wish to your <SPANCLASS="acronym">NIS</SPAN>+domain, including creating new users, changing user passwords, andeven changing your <SPANCLASS="acronym">NIS</SPAN>+ server'smaster password.</P></LI><LICLASS="listitem"><PCLASS="para"><SPANCLASS="acronym">NIS</SPAN>+ <ACLASS="indexterm"NAME="AUTOID-27577"></A><ACLASS="indexterm"NAME="AUTOID-27580"></A>serversoperate at one of three security levels, described in <ACLASS="xref"HREF="ch19_05.htm#PUIS-CHP-19-TAB-3"TITLE="NIS+ Server Security Levels">Table 19.3</A>.Make sure that your server is operating at level 2, which is thedefault level.</P></LI></UL><TABLECLASS="table"><CAPTIONCLASS="table"><ACLASS="title"NAME="PUIS-CHP-19-TAB-3">Table 19.3: NIS+ Server Security Levels</A></CAPTION><THEADCLASS="thead"><TRCLASS="row"VALIGN="TOP"><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Security Level</P></TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Description</P></TH></TR></THEAD><TBODYCLASS="tbody"><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">0</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">NIS+ server runs with all securityoptions turned off. Any NIS+ principal may make any changeto any NIS+ object. This level is designed for testingand initially setting up the NIS+ namespace. Security level0 should not be present in a shipping product (but for some reasonit is.) Do not use security level 0.</P></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">1</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">NIS+ server runs with securityturned on, but with DES authentication turned off. That is, theserver will respond to any request in which LOCAL or DES authenticationis specified, opening it up to a wide variety of attacks. Securitylevel 1 is designed for testing and debugging; like security level0, it should not be present in a shipping &quot;security&quot;product. Do not use it.</P></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">2</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">NIS+ server runs with full securityauthentication and access checking enabled. Only run NIS+servers at security level 2.<ACLASS="indexterm"NAME="AUTOID-27611"></A></P></TD></TR></TBODY></TABLE></DIV></DIV><DIVCLASS="htmlnav"><P></P><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch19_04.htm"TITLE="19.4 Sun's Network Information Service (NIS)"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 19.4 Sun's Network Information Service (NIS)"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="book"HREF="index.htm"TITLE="Practical UNIX &amp; Internet Security"><IMGSRC="../gifs/txthome.gif"ALT="Practical UNIX &amp; Internet Security"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch19_06.htm"TITLE="19.6 Kerberos"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 19.6 Kerberos"BORDER="0"></A></TD></TR><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172">19.4 Sun's Network Information Service (NIS)</TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="index"HREF="index/idx_0.htm"TITLE="Book Index"><IMGSRC="../gifs/index.gif"ALT="Book Index"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172">19.6 Kerberos</TD></TR></TABLE><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><PCLASS="nav"><FONTSIZE="-1">[ <AHREF="../index.htm"TITLE="The Networking CD Bookshelf">Library Home</A> | <AHREF="../dnsbind/index.htm"TITLE="DNS &amp; BIND">DNS &amp; BIND</A> | <AHREF="../tcpip/index.htm"TITLE="TCP/IP Network Administration">TCP/IP</A> | <AHREF="../sendmail/index.htm"TITLE="sendmail">sendmail</A> | <AHREF="../smdref/index.htm"TITLE="sendmail Desktop Reference">sendmail Reference</A> | <AHREF="../firewall/index.htm"TITLE="Building Internet Firewalls">Firewalls</A> | <AHREF="index.htm"TITLE="Practical UNIX &amp; Internet Security">Practical Security</A> ]</FONT></P></DIV></BODY></HTML>