<HTML><HEAD><TITLE>[Chapter 21] 21.5 Special Considerations</TITLE><METANAME="DC.title"CONTENT="Practical UNIX &amp; Internet Security"><METANAME="DC.creator"CONTENT="Simson Garfinkel &amp; Gene Spafford"><METANAME="DC.publisher"CONTENT="O'Reilly &amp; Associates, Inc."><METANAME="DC.date"CONTENT="1999-02-04T00:16:56Z"><METANAME="DC.type"CONTENT="Text.Monograph"><METANAME="DC.format"CONTENT="text/html"SCHEME="MIME"><METANAME="DC.source"CONTENT="1-56592-148-8"SCHEME="ISBN"><METANAME="DC.language"CONTENT="en-US"><METANAME="generator"CONTENT="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><LINKREV="made"HREF="mailto:online-books@oreilly.com"TITLE="Online Books Comments"><LINKREL="up"HREF="ch21_01.htm"TITLE="21. Firewalls"><LINKREL="prev"HREF="ch21_04.htm"TITLE="21.4 Setting Up the Gate"><LINKREL="next"HREF="ch21_06.htm"TITLE="21.6 Final Comments"></HEAD><BODYBGCOLOR="#FFFFFF"TEXT="#000000"><DIVCLASS="htmlnav"><H1><IMGSRC="gifs/smbanner.gif"ALT="Practical UNIX &amp; Internet Security"USEMAP="#srchmap"BORDER="0"></H1><MAPNAME="srchmap"><AREASHAPE="RECT"COORDS="0,0,466,65"HREF="index.htm"ALT="Practical UNIX &amp; Internet Security"><AREASHAPE="RECT"COORDS="467,0,514,18"HREF="../search/psrch.htm"ALT="Search this book"></MAP><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch21_04.htm"TITLE="21.4 Setting Up the Gate"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 21.4 Setting Up the Gate"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><B><FONTFACE="ARIEL,HELVETICA,HELV,SANSERIF"SIZE="-1">Chapter 21<BR>Firewalls</FONT></B></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch21_06.htm"TITLE="21.6 Final Comments"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 21.6 Final Comments"BORDER="0"></A></TD></TR></TABLE>&nbsp;<HRALIGN="LEFT"WIDTH="515"TITLE="footer"></DIV><DIVCLASS="SECT1"><H2CLASS="sect1"><ACLASS="title"NAME="PUIS-CHP-21-SECT-5">21.5 Special Considerations</A></H2><PCLASS="para">To make the firewallsetup effective, the gate should be a pain to use: really, all youwant this computer to do is forward specific kinds of informationacross the choke. The gate should be as impervious as possible tosecurity threats, applying the techniques we've describedelsewhere in this book, plus more extreme measures that you wouldnot apply to a general machine. The list below summarizes techniquesyou may want to implement on the gate machine: </P><ULCLASS="itemizedlist"><LICLASS="listitem"><PCLASS="para">Enable auditing if your operatingsystem supports it.</P></LI><LICLASS="listitem"><PCLASS="para">Do not allow regular user accounts, but only accountsfor people requiring incoming connections, system accounts for neededservices, and the <ICLASS="filename">root</I> account. </P></LI><LICLASS="listitem"><PCLASS="para">Do not allow incoming connections to your X11 servers(ports 6000 through 6000+<ICLASS="filename">n</I>, where<ICLASS="filename">n</I> is the number of X11 displays on any givencomputer). </P></LI><LICLASS="listitem"><PCLASS="para">Do not mount directories using <SPANCLASS="acronym">NFS</SPAN>(or any other network filesystem). Export only directories thatcontain data files (<ICLASS="filename">ftp/pub</I>, news, etc), never programs.Export read-only.</P></LI><LICLASS="listitem"><PCLASS="para">Remove the binaries of all commands not necessaryfor gate operation, including tools like <ICLASS="filename">cc, awk, sed, ld, emacs,Perl</I>, etc. Remove all libraries (except the shared portion of sharedlibraries) from <ICLASS="filename">/usr/lib</I> and <ICLASS="filename">/lib</I>. Programdevelopment for the gate should be done on another machine and copiedto the gate machine; with program development tools and unnecessarycommands removed, a cracker can't easily install Trojanhorses or other nasty code. Remove <ICLASS="filename">/bin/csh, /bin/ksh,</I>and all other shells except <ICLASS="filename">/bin/sh</I> (which yoursystem needs for startup). Change the permission on <ICLASS="filename">/bin/sh</I>to be 500, so that it can only be run by the superuser.</P><PCLASS="para">Ifyou really don't want to remove these programs, <KBDCLASS="command">chmod</KBD> themfrom 755 to 500. The <ICLASS="filename">root</I> user will still be able to use these programs,but no one else will. This approach is not as secure as removingthe programs, but it is more effective than leaving the tools inplace. </P></LI><LICLASS="listitem"><PCLASS="para"><KBDCLASS="command">chmod</KBD> all system directories (e.g., <ICLASS="filename">/,/bin, /usr, /usr/bin, /etc,/usr/spool)</I> to mode 711. Users of the system otherthan the superuser do not need to list directory contents to seewhat is and is not present. This change will really slow down someonewho manages to establish a non-<ICLASS="filename">root</I> shell on the machine throughsome other mechanism. Don't run <SPANCLASS="acronym">NIS</SPAN>on the gate machine. Do not import or export <SPANCLASS="acronym">NIS</SPAN>files, especially the <ICLASS="filename">alias</I> and <ICLASS="filename">passwd</I> files. </P></LI><LICLASS="listitem"><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-30235"></A><ACLASS="indexterm"NAME="AUTOID-30238"></A>Turn on full logging on the gate machine. Readthe logs regularly. Set the <ICLASS="filename">syslog.conf</I> file so that the gate logsto an internal machine as well as a hardcopy device, if possible.&#13;</P></LI><LICLASS="listitem"><PCLASS="para">Mount as many disks as possible read-only. Thisprevents a cracker from modifying the files on those disks. Somedirectories, notably <ICLASS="filename">/usr/spool/uucp,</I><ICLASS="filename">/usr/adm</I>, and <ICLASS="filename">~ftp/pub</I>, will need tobe writable. You can place all of these directories on a singlepartition and use symbolic links so that they appear in the appropriateplace. </P></LI><LICLASS="listitem"><PCLASS="para">Turn on process and file quotas, if available. </P></LI><LICLASS="listitem"><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-30251"></A>Usesome form of smart card or key-based access for the root user. Ifyou don't use such devices, don't allow anyoneto log in as root on the machine.</P></LI><LICLASS="listitem"><PCLASS="para">Make the gate computer &quot;equivalent&quot;to no other machine. Remove the files <ICLASS="filename">/etc/hosts.equiv</I>and <ICLASS="filename">/etc/hosts.lpd. </I></P></LI><LICLASS="listitem"><PCLASS="para">Enable process accounting on the gate machine.</P></LI><LICLASS="listitem"><PCLASS="para">Disable all unneeded network services. </P></LI></UL><PCLASS="para">Finally, look back at the guidelines listed under <ACLASS="xref"HREF="ch17_01.htm"TITLE="TCP/IP Services">Chapter 17</A>they are also useful when setting up a gate. When you configureyour gate machine, remember that every service and program thatcan be run presents a threat to the security of your entire protectednetwork. Even if the programs appear safe today, bugs or securityflaws may be found in them in the future. The purpose of the gateis to restrict access to your network, not to serve as a computingplatform. Therefore, remove everything that's not essentialto the network services. </P><PCLASS="para"><EMCLASS="emphasis">Be sure to monitor your gateon a regular basis:</EM> if you simply set the gate up and forget aboutit, you may let weeks or more go by before discovering a break-in.If your network is connected to the Internet 24 hours a day, 7 daysa week, it should be monitored at least daily.</P><PCLASS="para">Evenif you follow all of these rules and closely monitor your gate,a group of very persistent and clever crackers might still breakthrough to your machines. If they do, the cause will not likelybe accidental. They will have to work hard at it, and you will mostlikely find evidence of the break-in soon after it occurs. The stepswe've outlined will probably discourage the random or curiouscracker, as well as many more serious intruders, and this is reallyyour goal. </P></DIV><DIVCLASS="htmlnav"><P></P><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch21_04.htm"TITLE="21.4 Setting Up the Gate"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 21.4 Setting Up the Gate"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="book"HREF="index.htm"TITLE="Practical UNIX &amp; Internet Security"><IMGSRC="../gifs/txthome.gif"ALT="Practical UNIX &amp; Internet Security"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch21_06.htm"TITLE="21.6 Final Comments"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 21.6 Final Comments"BORDER="0"></A></TD></TR><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172">21.4 Setting Up the Gate</TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="index"HREF="index/idx_0.htm"TITLE="Book Index"><IMGSRC="../gifs/index.gif"ALT="Book Index"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172">21.6 Final Comments</TD></TR></TABLE><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><PCLASS="nav"><FONTSIZE="-1">[ <AHREF="../index.htm"TITLE="The Networking CD Bookshelf">Library Home</A> | <AHREF="../dnsbind/index.htm"TITLE="DNS &amp; BIND">DNS &amp; BIND</A> | <AHREF="../tcpip/index.htm"TITLE="TCP/IP Network Administration">TCP/IP</A> | <AHREF="../sendmail/index.htm"TITLE="sendmail">sendmail</A> | <AHREF="../smdref/index.htm"TITLE="sendmail Desktop Reference">sendmail Reference</A> | <AHREF="../firewall/index.htm"TITLE="Building Internet Firewalls">Firewalls</A> | <AHREF="index.htm"TITLE="Practical UNIX &amp; Internet Security">Practical Security</A> ]</FONT></P></DIV></BODY></HTML>