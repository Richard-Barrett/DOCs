<HTML><HEAD><TITLE>[Chapter 22] Wrappers and Proxies</TITLE><METANAME="DC.title"CONTENT="Practical UNIX &amp; Internet Security"><METANAME="DC.creator"CONTENT="Simson Garfinkel &amp; Gene Spafford"><METANAME="DC.publisher"CONTENT="O'Reilly &amp; Associates, Inc."><METANAME="DC.date"CONTENT="1999-02-04T00:17:06Z"><METANAME="DC.type"CONTENT="Text.Monograph"><METANAME="DC.format"CONTENT="text/html"SCHEME="MIME"><METANAME="DC.source"CONTENT="1-56592-148-8"SCHEME="ISBN"><METANAME="DC.language"CONTENT="en-US"><METANAME="generator"CONTENT="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><LINKREV="made"HREF="mailto:online-books@oreilly.com"TITLE="Online Books Comments"><LINKREL="up"HREF="part05.htm"TITLE="V. Advanced Topics"><LINKREL="prev"HREF="ch21_06.htm"TITLE="21.6 Final Comments"><LINKREL="next"HREF="ch22_02.htm"TITLE="22.2 sendmail (smap/smapd) Wrapper"></HEAD><BODYBGCOLOR="#FFFFFF"TEXT="#000000"><DIVCLASS="htmlnav"><H1><IMGSRC="gifs/smbanner.gif"ALT="Practical UNIX &amp; Internet Security"USEMAP="#srchmap"BORDER="0"></H1><MAPNAME="srchmap"><AREASHAPE="RECT"COORDS="0,0,466,65"HREF="index.htm"ALT="Practical UNIX &amp; Internet Security"><AREASHAPE="RECT"COORDS="467,0,514,18"HREF="../search/psrch.htm"ALT="Search this book"></MAP><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch21_06.htm"TITLE="21.6 Final Comments"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 21.6 Final Comments"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><B><FONTFACE="ARIEL,HELVETICA,HELV,SANSERIF"SIZE="-1">Chapter 22</FONT></B></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch22_02.htm"TITLE="22.2 sendmail (smap/smapd) Wrapper"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 22.2 sendmail (smap/smapd) Wrapper"BORDER="0"></A></TD></TR></TABLE>&nbsp;<HRALIGN="LEFT"WIDTH="515"TITLE="footer"></DIV><DIVCLASS="CHAPTER"><H1CLASS="chapter"><ACLASS="title"NAME="PUIS-CHP-22">22. Wrappers and Proxies</A></H1><DIVCLASS="htmltoc"><P><B>Contents:</B><BR><ACLASS="SECT1"HREF="#PUIS-CHP-22-SECT-1"TITLE="22.1 Why Wrappers?">Why Wrappers?</A><BR><ACLASS="SECT1"HREF="ch22_02.htm"TITLE="22.2 sendmail (smap/smapd) Wrapper">sendmail (smap/smapd) Wrapper</A><BR><ACLASS="SECT1"HREF="ch22_03.htm"TITLE="22.3 tcpwrapper">tcpwrapper</A><BR><ACLASS="SECT1"HREF="ch22_04.htm"TITLE="22.4 SOCKS">SOCKS</A><BR><ACLASS="SECT1"HREF="ch22_05.htm"TITLE="22.5 UDP Relayer">UDP Relayer</A><BR><ACLASS="SECT1"HREF="ch22_06.htm"TITLE="22.6 Writing Your Own Wrappers">Writing Your Own Wrappers</A></P><P></P></DIV><PCLASS="para">A<ICLASS="firstterm">wrapper </I>is a program that is used to controlaccess to a second program. The wrapper literally wraps around thesecond program, allowing you to enforce a higher degree of securitythan the program can enforce on its own.</P><DIVCLASS="sect1"><H2CLASS="sect1"><ACLASS="title"NAME="PUIS-CHP-22-SECT-1">22.1 Why Wrappers?</A></H2><PCLASS="para">Wrappers are a recent inventionin <SPANCLASS="acronym">UNIX </SPAN>security. These programs were born outof the need to modify operating systems without access to the systems'source code. However, their use has grown. and wrappers have becomea rather elegant security tool for a variety of reasons:</P><ULCLASS="itemizedlist"><LICLASS="listitem"><PCLASS="para">Because the security logic is encapsulatedinto a single program, wrappers are simple and easy to validate.</P></LI><LICLASS="listitem"><PCLASS="para">Because the wrapped program remains a separate entity,it can be upgraded without a need to recertify the program thatis wrapping it.</P></LI><LICLASS="listitem"><PCLASS="para">Because wrappers call the wrapped program via thestandard exec() system call,a single wrapper can be used to control access to a variety of wrappedprograms.</P></LI></UL><PCLASS="para">One common use ofwrappers is to limit the amount of information reaching a network-capableprogram. The default design of such programs can be too trusting,and can accept too much information without validation. We willdiscuss a few common examples later in this chapter.</P><PCLASS="para">Thischapter describes three common wrappers:</P><ULCLASS="itemizedlist"><LICLASS="listitem"><PCLASS="para">A <KBDCLASS="command">sendmail</KBD> wrapper(<ICLASS="filename">smap/smapd</I>) developed by Trusted Information Systems (<SPANCLASS="acronym">TIS</SPAN>)</P></LI><LICLASS="listitem"><PCLASS="para">A general-purpose wrapper (<ICLASS="filename">tcpwrapper</I>) for <SPANCLASS="acronym">UDP</SPAN>and <SPANCLASS="acronym">TCP</SPAN> daemons, developed by Wietse Venema</P></LI><LICLASS="listitem"><PCLASS="para"><SPANCLASS="acronym">SOCKS</SPAN>, a wrapper that permitsoutbound <SPANCLASS="acronym">TCP/IP</SPAN> connections to tunnel throughfirewalls, developed by David Koblas and Michelle Koblas</P></LI></UL><PCLASS="para">This chapter also briefly describes the <SPANCLASS="acronym">UDP</SPAN>Relayer, developed by Tom Fitzgerald. The final section of thischapter describes the situations in which you might wish to writewrappers of your own.</P></DIV></DIV><DIVCLASS="htmlnav"><P></P><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch21_06.htm"TITLE="21.6 Final Comments"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 21.6 Final Comments"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="book"HREF="index.htm"TITLE="Practical UNIX &amp; Internet Security"><IMGSRC="../gifs/txthome.gif"ALT="Practical UNIX &amp; Internet Security"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch22_02.htm"TITLE="22.2 sendmail (smap/smapd) Wrapper"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 22.2 sendmail (smap/smapd) Wrapper"BORDER="0"></A></TD></TR><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172">21.6 Final Comments</TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="index"HREF="index/idx_0.htm"TITLE="Book Index"><IMGSRC="../gifs/index.gif"ALT="Book Index"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172">22.2 sendmail (smap/smapd) Wrapper</TD></TR></TABLE><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><PCLASS="nav"><FONTSIZE="-1">[ <AHREF="../index.htm"TITLE="The Networking CD Bookshelf">Library Home</A> | <AHREF="../dnsbind/index.htm"TITLE="DNS &amp; BIND">DNS &amp; BIND</A> | <AHREF="../tcpip/index.htm"TITLE="TCP/IP Network Administration">TCP/IP</A> | <AHREF="../sendmail/index.htm"TITLE="sendmail">sendmail</A> | <AHREF="../smdref/index.htm"TITLE="sendmail Desktop Reference">sendmail Reference</A> | <AHREF="../firewall/index.htm"TITLE="Building Internet Firewalls">Firewalls</A> | <AHREF="index.htm"TITLE="Practical UNIX &amp; Internet Security">Practical Security</A> ]</FONT></P></DIV></BODY></HTML>