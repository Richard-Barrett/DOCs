<HTML><HEAD><TITLE>[Chapter 23] 23.6 Tips on Generating Random Numbers</TITLE><METANAME="DC.title"CONTENT="Practical UNIX &amp; Internet Security"><METANAME="DC.creator"CONTENT="Simson Garfinkel &amp; Gene Spafford"><METANAME="DC.publisher"CONTENT="O'Reilly &amp; Associates, Inc."><METANAME="DC.date"CONTENT="1999-02-04T00:17:58Z"><METANAME="DC.type"CONTENT="Text.Monograph"><METANAME="DC.format"CONTENT="text/html"SCHEME="MIME"><METANAME="DC.source"CONTENT="1-56592-148-8"SCHEME="ISBN"><METANAME="DC.language"CONTENT="en-US"><METANAME="generator"CONTENT="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><LINKREV="made"HREF="mailto:online-books@oreilly.com"TITLE="Online Books Comments"><LINKREL="up"HREF="ch23_01.htm"TITLE="23. Writing Secure SUID and Network Programs"><LINKREL="prev"HREF="ch23_05.htm"TITLE="23.5 Tips on Using Passwords"><LINKREL="next"HREF="ch23_07.htm"TITLE="23.7 UNIX Pseudo-Random Functions"></HEAD><BODYBGCOLOR="#FFFFFF"TEXT="#000000"><DIVCLASS="htmlnav"><H1><IMGSRC="gifs/smbanner.gif"ALT="Practical UNIX &amp; Internet Security"USEMAP="#srchmap"BORDER="0"></H1><MAPNAME="srchmap"><AREASHAPE="RECT"COORDS="0,0,466,65"HREF="index.htm"ALT="Practical UNIX &amp; Internet Security"><AREASHAPE="RECT"COORDS="467,0,514,18"HREF="../search/psrch.htm"ALT="Search this book"></MAP><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch23_05.htm"TITLE="23.5 Tips on Using Passwords"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 23.5 Tips on Using Passwords"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><B><FONTFACE="ARIEL,HELVETICA,HELV,SANSERIF"SIZE="-1">Chapter 23<BR>Writing Secure SUID and Network Programs</FONT></B></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch23_07.htm"TITLE="23.7 UNIX Pseudo-Random Functions"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 23.7 UNIX Pseudo-Random Functions"BORDER="0"></A></TD></TR></TABLE>&nbsp;<HRALIGN="LEFT"WIDTH="515"TITLE="footer"></DIV><DIVCLASS="SECT1"><H2CLASS="sect1"><ACLASS="title"NAME="PUIS-CHP-23-SECT-6">23.6 Tips on Generating Random Numbers</A></H2><PCLASS="para"><ACLASS="indexterm"NAME="IDX-643399"></A><ACLASS="indexterm"NAME="AUTOID-32912"></A>Random numbers play an important role in modern computersecurity. Many programs that use encryption need a good source ofrandom numbers for producing session keys. For example, the PGPprogram uses random numbers for generating a random key which is usedto encrypt the contents of electronic mail messages; the random key isthen itself encrypted using the recipient's public key.</P><PCLASS="para">Random numbers have other uses in computer security as well. Avariety of authentication protocols require that the computer create arandom number, encrypt it, and send it to the user. The user must thendecrypt the number, perform a mathematical operation on it, re-encryptthe number, and send it back to the computer.</P><PCLASS="para">A great deal is knownabout random numbers.  Here are some general rules of thumb:</P><OLCLASS="orderedlist"><LICLASS="listitem"><PCLASS="para">If a number is random, then each bit of that number should have an equal probability of being a 0 or a 1.</P></LI><LICLASS="listitem"><PCLASS="para">If a number is random, then after each 0 in that number there should be an equal proba-bility that the following bit is a 0 or a 1. Likewise, after each 1 there should be an equal probability that the following bit is a 0 or a 1.</P></LI><LICLASS="listitem"><PCLASS="para">If the number has a large number of bits, then roughly half of the number's bits should be 0s, and half of the bits should be 1s.</P></LI></OL><PCLASS="para">For security-related purposes, a further requirement for random numbers is <ACLASS="indexterm"NAME="IDX-643400"></A><EMCLASS="emphasis">unpredictability</EM>:</P><OLCLASS="orderedlist"><LICLASS="listitem"><PCLASS="para">It should not be possible to predict the output of the random number generator given previous outputs or other knowledge about the computer generating the random numbers.</P></LI><LICLASS="listitem"><PCLASS="para">It should not be possible to determine the internal state of the random number generator.</P></LI><LICLASS="listitem"><PCLASS="para">It should not be possible to replicate the initial state of the random number generator, or to reseed the generator with the same initial value.</P></LI></OL><PCLASS="para">One of the best ways of generating a stream of random numbers isto make use of a random process, such as radioactivedecay. Unfortunately, most UNIX computers are not equipped with Geigercounters. Thus, they need to use something else. Often, they usepseudorandom functions as random number generators.</P><PCLASS="para">A <ACLASS="indexterm"NAME="IDX-643401"></A>pseudorandom function is a function that yields a series of outputs which appears to be unpredictable. In practice, these functions maintain a large internal state from which the output is calculated. Each time a new number is generated, the internal state is changed. The function's initial state is referred to as its <ACLASS="indexterm"NAME="IDX-643402"></A><EMCLASS="emphasis">seed</EM>.</P><PCLASS="para">If you need a series of random numbers that is repeatable, you need a pseudorandom generator that takes a seed and keeps an internal state. If you need a non-reproducible series of random numbers, you should avoid pseudo-random generators. Thus, successfully picking random numbers in the UNIX environment depends on two things: picking the right random number generator, and then picking a different seed each time the program is run.</P></DIV><DIVCLASS="htmlnav"><P></P><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch23_05.htm"TITLE="23.5 Tips on Using Passwords"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 23.5 Tips on Using Passwords"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="book"HREF="index.htm"TITLE="Practical UNIX &amp; Internet Security"><IMGSRC="../gifs/txthome.gif"ALT="Practical UNIX &amp; Internet Security"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch23_07.htm"TITLE="23.7 UNIX Pseudo-Random Functions"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 23.7 UNIX Pseudo-Random Functions"BORDER="0"></A></TD></TR><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172">23.5 Tips on Using Passwords</TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="index"HREF="index/idx_0.htm"TITLE="Book Index"><IMGSRC="../gifs/index.gif"ALT="Book Index"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172">23.7 UNIX Pseudo-Random Functions</TD></TR></TABLE><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><PCLASS="nav"><FONTSIZE="-1">[ <AHREF="../index.htm"TITLE="The Networking CD Bookshelf">Library Home</A> | <AHREF="../dnsbind/index.htm"TITLE="DNS &amp; BIND">DNS &amp; BIND</A> | <AHREF="../tcpip/index.htm"TITLE="TCP/IP Network Administration">TCP/IP</A> | <AHREF="../sendmail/index.htm"TITLE="sendmail">sendmail</A> | <AHREF="../smdref/index.htm"TITLE="sendmail Desktop Reference">sendmail Reference</A> | <AHREF="../firewall/index.htm"TITLE="Building Internet Firewalls">Firewalls</A> | <AHREF="index.htm"TITLE="Practical UNIX &amp; Internet Security">Practical Security</A> ]</FONT></P></DIV></BODY></HTML>