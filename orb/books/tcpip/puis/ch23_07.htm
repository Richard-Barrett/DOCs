<HTML><HEAD><TITLE>[Chapter 23] 23.7 UNIX Pseudo-Random Functions</TITLE><METANAME="DC.title"CONTENT="Practical UNIX &amp; Internet Security"><METANAME="DC.creator"CONTENT="Simson Garfinkel &amp; Gene Spafford"><METANAME="DC.publisher"CONTENT="O'Reilly &amp; Associates, Inc."><METANAME="DC.date"CONTENT="1999-02-04T00:17:59Z"><METANAME="DC.type"CONTENT="Text.Monograph"><METANAME="DC.format"CONTENT="text/html"SCHEME="MIME"><METANAME="DC.source"CONTENT="1-56592-148-8"SCHEME="ISBN"><METANAME="DC.language"CONTENT="en-US"><METANAME="generator"CONTENT="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><LINKREV="made"HREF="mailto:online-books@oreilly.com"TITLE="Online Books Comments"><LINKREL="up"HREF="ch23_01.htm"TITLE="23. Writing Secure SUID and Network Programs"><LINKREL="prev"HREF="ch23_06.htm"TITLE="23.6 Tips on Generating Random Numbers"><LINKREL="next"HREF="ch23_08.htm"TITLE="23.8 Picking a Random Seed"></HEAD><BODYBGCOLOR="#FFFFFF"TEXT="#000000"><DIVCLASS="htmlnav"><H1><IMGSRC="gifs/smbanner.gif"ALT="Practical UNIX &amp; Internet Security"USEMAP="#srchmap"BORDER="0"></H1><MAPNAME="srchmap"><AREASHAPE="RECT"COORDS="0,0,466,65"HREF="index.htm"ALT="Practical UNIX &amp; Internet Security"><AREASHAPE="RECT"COORDS="467,0,514,18"HREF="../search/psrch.htm"ALT="Search this book"></MAP><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch23_06.htm"TITLE="23.6 Tips on Generating Random Numbers"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 23.6 Tips on Generating Random Numbers"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><B><FONTFACE="ARIEL,HELVETICA,HELV,SANSERIF"SIZE="-1">Chapter 23<BR>Writing Secure SUID and Network Programs</FONT></B></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch23_08.htm"TITLE="23.8 Picking a Random Seed"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 23.8 Picking a Random Seed"BORDER="0"></A></TD></TR></TABLE>&nbsp;<HRALIGN="LEFT"WIDTH="515"TITLE="footer"></DIV><DIVCLASS="SECT1"><H2CLASS="sect1"><ACLASS="title"NAME="PUIS-CHP-23-SECT-7">23.7 UNIX Pseudo-RandomFunctions</A></H2><PCLASS="para">The standard UNIX C library provides two random number generators: <KBDCLASS="command">rand( )</KBD> and <KBDCLASS="command">random( )</KBD>. A third random number generator, <KBDCLASS="command">drand48( )</KBD>, is available on some versions of UNIX. Although you won't want to use any of these routines to produce cryptographic random numbers, we'll briefly explain each. Then, if you need to use one of them for something else, you'll know something about its strengths and shortcomings.</P><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="PUIS-CHP-23-SECT-7.1">23.7.1 rand  (  )</A></H3><PCLASS="para">The original UNIX random number generator, <ACLASS="indexterm"NAME="IDX-643403"></A><KBDCLASS="command">rand( )</KBD>, is not a very good random number generator. It uses a 32-bit seed and maintains a 32-bit internal state. The output of the function is also 32 bits in length, making it a simple matter to determine the function's internal state by examining the output. As a result, rand( ) is not very random. Furthermore, the low-order bits of some implementations are not random at all, but flip back and forth between 0 and 1 according to a regular pattern. The <KBDCLASS="command">rand(  )</KBD> random number generator is seeded with the function <KBDCLASS="command">srand( )</KBD>. On some versions of UNIX, a third function is provided, <KBDCLASS="command">rand_r( )</KBD>, for multi threaded applications. (The function <KBDCLASS="command">rand( )</KBD> itself is not safe for multi-threading, as it maintains internal state.)</P><PCLASS="para">Do not use <KBDCLASS="command">rand( )</KBD>, even for simple statistical purposes.</P></DIV><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="PUIS-CHP-23-SECT-7.2">23.7.2 random  (  )</A></H3><PCLASS="para">The function <ACLASS="indexterm"NAME="IDX-643404"></A><KBDCLASS="command">random( )</KBD> is a more sophisticated random number generator which uses nonlinear feedback and an internal table that is 124 bytes (992 bits) long. The function returns random values that are 32 bits in length. All of the bits generated by <KBDCLASS="command">random( )</KBD> are usable.</P><PCLASS="para">The <KBDCLASS="command">random( )</KBD> function is adequate for simulations and games, but should not be used for security related applications such as picking cryptographic keys or simulating one-time pads.</P></DIV><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="PUIS-CHP-23-SECT-7.3">23.7.3 drand48  (  ), lrand48  (  ), and mrand48  (  )</A></H3><PCLASS="para">The function <ACLASS="indexterm"NAME="IDX-643405"></A><ACLASS="indexterm"NAME="AUTOID-32975"></A><ACLASS="indexterm"NAME="AUTOID-32977"></A><ACLASS="indexterm"NAME="AUTOID-32979"></A><KBDCLASS="command">drand48( )</KBD> is one of many functions which make up the System V random number generator. According to the Solaris documen-tation, the algorithm uses &quot;the well-known linear congruential algorithm and 48-bit integer arithmetic.&quot; The function <KBDCLASS="command">drand48( )</KBD> returns a double-precision number that is greater or equal to 0.0 and less than 1.0, while the <KBDCLASS="command">lrand48(  )</KBD> and <KBDCLASS="command">mrand48( )</KBD> functions return random numbers within a specified integer range. As with <KBDCLASS="command">random( )</KBD>, these functions provide excellent random numbers for simulations and games, but should not be used for security-related applications such as picking cryptographic keys or simulating one-time pads; linear congruential algorithms are too easy to break.</P></DIV><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="PUIS-CHP-23-SECT-7.4">23.7.4 Other random number generators</A></H3><PCLASS="para">There are many other random number generators. Some of them areoptimized for speed, while others are optimized for randomness. Youcan find a list of other random number generators in Bruce Schneier'sexcellent book, Applied Cryptography (John Wiley &amp; Sons, SecondEdition, 1995).</P><PCLASS="para">Some versions of the <ACLASS="indexterm"NAME="IDX-643407"></A>Linux operating system have carefullythought out random number generators in their kernel, accessiblethrough the <ICLASS="filename">/dev/random</I> and <ACLASS="indexterm"NAME="IDX-643406"></A><ACLASS="indexterm"NAME="AUTOID-32998"></A><ACLASS="indexterm"NAME="AUTOID-33001"></A><ACLASS="indexterm"NAME="AUTOID-33003"></A><ICLASS="filename">/dev/urandom</I> devices. We think that thisdesign is excellent-especially when the random number generators takeinto account additional system states, user inputs, and &quot;random&quot;external events to provide numbers that are &quot;more&quot; random.</P></DIV></DIV><DIVCLASS="htmlnav"><P></P><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch23_06.htm"TITLE="23.6 Tips on Generating Random Numbers"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 23.6 Tips on Generating Random Numbers"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="book"HREF="index.htm"TITLE="Practical UNIX &amp; Internet Security"><IMGSRC="../gifs/txthome.gif"ALT="Practical UNIX &amp; Internet Security"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch23_08.htm"TITLE="23.8 Picking a Random Seed"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 23.8 Picking a Random Seed"BORDER="0"></A></TD></TR><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172">23.6 Tips on Generating Random Numbers</TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="index"HREF="index/idx_0.htm"TITLE="Book Index"><IMGSRC="../gifs/index.gif"ALT="Book Index"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172">23.8 Picking a Random Seed</TD></TR></TABLE><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><PCLASS="nav"><FONTSIZE="-1">[ <AHREF="../index.htm"TITLE="The Networking CD Bookshelf">Library Home</A> | <AHREF="../dnsbind/index.htm"TITLE="DNS &amp; BIND">DNS &amp; BIND</A> | <AHREF="../tcpip/index.htm"TITLE="TCP/IP Network Administration">TCP/IP</A> | <AHREF="../sendmail/index.htm"TITLE="sendmail">sendmail</A> | <AHREF="../smdref/index.htm"TITLE="sendmail Desktop Reference">sendmail Reference</A> | <AHREF="../firewall/index.htm"TITLE="Building Internet Firewalls">Firewalls</A> | <AHREF="index.htm"TITLE="Practical UNIX &amp; Internet Security">Practical Security</A> ]</FONT></P></DIV></BODY></HTML>