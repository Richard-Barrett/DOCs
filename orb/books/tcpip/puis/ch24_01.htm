<HTML><HEAD><TITLE>[Chapter 24] Discovering a  Break-in</TITLE><METANAME="DC.title"CONTENT="Practical UNIX &amp; Internet Security"><METANAME="DC.creator"CONTENT="Simson Garfinkel &amp; Gene Spafford"><METANAME="DC.publisher"CONTENT="O'Reilly &amp; Associates, Inc."><METANAME="DC.date"CONTENT="1999-02-04T00:18:36Z"><METANAME="DC.type"CONTENT="Text.Monograph"><METANAME="DC.format"CONTENT="text/html"SCHEME="MIME"><METANAME="DC.source"CONTENT="1-56592-148-8"SCHEME="ISBN"><METANAME="DC.language"CONTENT="en-US"><METANAME="generator"CONTENT="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><LINKREV="made"HREF="mailto:online-books@oreilly.com"TITLE="Online Books Comments"><LINKREL="up"HREF="part06.htm"TITLE="VI. Handling Security Incidents"><LINKREL="prev"HREF="part06.htm"TITLE="VI. Handling Security Incidents"><LINKREL="next"HREF="ch24_02.htm"TITLE="24.2 Discovering an Intruder"></HEAD><BODYBGCOLOR="#FFFFFF"TEXT="#000000"><DIVCLASS="htmlnav"><H1><IMGSRC="gifs/smbanner.gif"ALT="Practical UNIX &amp; Internet Security"USEMAP="#srchmap"BORDER="0"></H1><MAPNAME="srchmap"><AREASHAPE="RECT"COORDS="0,0,466,65"HREF="index.htm"ALT="Practical UNIX &amp; Internet Security"><AREASHAPE="RECT"COORDS="467,0,514,18"HREF="../search/psrch.htm"ALT="Search this book"></MAP><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="PART"HREF="part06.htm"TITLE="VI. Handling Security Incidents"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: VI. Handling Security Incidents"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><B><FONTFACE="ARIEL,HELVETICA,HELV,SANSERIF"SIZE="-1">Chapter 24</FONT></B></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch24_02.htm"TITLE="24.2 Discovering an Intruder"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 24.2 Discovering an Intruder"BORDER="0"></A></TD></TR></TABLE>&nbsp;<HRALIGN="LEFT"WIDTH="515"TITLE="footer"></DIV><DIVCLASS="CHAPTER"><H1CLASS="chapter"><ACLASS="title"NAME="PUIS-CHP-24">24. Discovering a  Break-in</A></H1><DIVCLASS="htmltoc"><P><B>Contents:</B><BR><ACLASS="SECT1"HREF="#PUIS-CHP-24-SECT-1"TITLE="24.1 Prelude">Prelude</A><BR><ACLASS="SECT1"HREF="ch24_02.htm"TITLE="24.2 Discovering an Intruder">Discovering an Intruder</A><BR><ACLASS="SECT1"HREF="ch24_03.htm"TITLE="24.3 The Log Files: Discovering an Intruder's Tracks">The Log Files: Discovering an Intruder'sTracks</A><BR><ACLASS="SECT1"HREF="ch24_04.htm"TITLE="24.4 Cleaning Up After the Intruder">Cleaning Up After the Intruder</A><BR><ACLASS="SECT1"HREF="ch24_05.htm"TITLE="24.5 An Example">An Example</A><BR><ACLASS="SECT1"HREF="ch24_06.htm"TITLE="24.6 Resuming Operation">Resuming Operation</A><BR><ACLASS="SECT1"HREF="ch24_07.htm"TITLE="24.7 Damage Control">Damage Control</A></P><P></P></DIV><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-33136"></A><ACLASS="indexterm"NAME="AUTOID-33139"></A><ACLASS="indexterm"NAME="AUTOID-33142"></A><ACLASS="indexterm"NAME="AUTOID-33145"></A>Thischapter describes what to do if you discover that someone has brokeninto your computer system: how to catch the intruder; how to figureout what, if any, damage has been done; and how to repair the damage,if necessary. <EMCLASS="emphasis">We hope that you'll never have to use thetechniques mentioned here. </EM></P><DIVCLASS="sect1"><H2CLASS="sect1"><ACLASS="title"NAME="PUIS-CHP-24-SECT-1">24.1 Prelude</A></H2><PCLASS="para">There are three major rules for handling security breaches.</P><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="PUIS-CHP-24-SECT-1.1">24.1.1 Rule #1: DON'T PANIC</A></H3><PCLASS="para">After a security breach, you are faced with many differentchoices. No matter what has happened, you will only make thingsworse if you act without thinking.</P><PCLASS="para">Before acting, you need to answer certain questions and keepthe answers firmly in mind:</P><ULCLASS="itemizedlist"><LICLASS="listitem"><PCLASS="para">Did you really have a breach of security?Something that appears to be the action of an intruder might actuallybe the result of human error or software failure.</P></LI><LICLASS="listitem"><PCLASS="para">Was any damage really done? With many security breaches,the perpetrator gains unauthorized access but doesn't actuallyaccess privileged information or maliciously change the contentsof files.</P></LI><LICLASS="listitem"><PCLASS="para">Is it important to obtain and protect evidence thatmight be used in an investigation?</P></LI><LICLASS="listitem"><PCLASS="para">Is it important to get the system back into normaloperation as soon as possible?</P></LI><LICLASS="listitem"><PCLASS="para">Are you willing to take the chance that files havebeen altered or removed? If not, how can you tell for sure if changeshave been made?</P></LI><LICLASS="listitem"><PCLASS="para">Does it matter if anyone within the organizationhears about this incident? If somebody outside hears about it?</P></LI><LICLASS="listitem"><PCLASS="para">Can it happen again?</P></LI></UL><PCLASS="para">The answers to many of these questions may be contradictory;for example, protecting evidence and comparing files may not bepossible if the goal is to get the system back into normal operationas soon as possible. You'll have to decide what'sbest for your own site.</P></DIV><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="PUIS-CHP-24-SECT-1.2">24.1.2 Rule #2: DOCUMENT</A></H3><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-33175"></A><ACLASS="indexterm"NAME="AUTOID-33178"></A>Starta log, immediately. Take a notebook and write down everything youfind, always noting the date and time. If you examine text files,print copies and then sign and date the hardcopy. If you have thenecessary disk space, record your entire session with the scriptcommand, too. Having this information on hand to study later maysave you considerable time and aggravation, especially if you needto restore or change files quickly to bring the system back to normal.</P><PCLASS="para">This chapter and the two chapters that follow present a setof guidelines for handling security breaches. In the following sections,we describe the mechanisms you can use to help you detect a break-in,and handle the question of what to do if you discover an intruderon your system. In <ACLASS="xref"HREF="ch25_01.htm"TITLE="Denial of Service Attacks and Solutions">Chapter 25, <CITECLASS="chapter">Denial of Service Attacks and Solutions</CITE></A>, we'lldescribe denial of service attacks&nbsp;- ways in which attackerscan make your system unusable without actually destroying any information.Finally, in <ACLASS="xref"HREF="ch26_01.htm"TITLE="Computer Security and U.S. Law">Chapter 26, <CITECLASS="chapter">Computer Security and U.S. Law</CITE></A>, we'll discusslegal approaches and considerations you may need to consider aftera security incident.</P></DIV><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="PUIS-CHP-24-SECT-1.3">24.1.3 Rule #3: PLAN AHEAD</A></H3><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-33186"></A><ACLASS="indexterm"NAME="AUTOID-33188"></A>A keyto effective response in an emergency is advance planning. Whena security problem occurs, there are some standard steps to be taken.You should have these steps planned out in advance so there is littleconfusion or hesitation when an incident occurs.</P><PCLASS="para">In larger installations, you may want to practice your plans.For example, along with standard fire drills, you may want to have&quot;virus drills&quot; to practice coping with the threatof a virus, or &quot;break-in drills.&quot; The followingbasic steps should be at the heart of your plan:</P><DLCLASS="variablelist"><DTCLASS="term">Step 1: Identify and understandthe problem. </DT><DDCLASS="listitem"><PCLASS="para">If you don't know what the problem is,you cannot take action against it. This rule does not mean thatyou need to have perfect understanding, but you should understandat least what <EMCLASS="emphasis">form</EM> of problem you are dealingwith. Cutting your computer's network connection won'thelp you if the problem is being caused by a revenge-bent employeewith a terminal in his office.</P></DD><DTCLASS="term">Step 2: Contain or stop the damage.</DT><DDCLASS="listitem"><PCLASS="para">If you've identified the problem, takeimmediate steps to halt or limit it. For instance, if you'veidentified the employee who is deleting system files, you'llwant to turn off his account, and probably take disciplinary actionas well. Both are steps to limit the damage to your data and system.</P></DD><DTCLASS="term">Step 3: Confirm your diagnosis and determinethe damage. </DT><DDCLASS="listitem"><PCLASS="para">After you've taken steps to contain thedamage, confirm your diagnosis of the problem and determine thedamage it caused. Are files still disappearing after the employeeis discharged? You may never be 100% sure if two or moreincidents are actually related. Furthermore, you may not be ableto identify all of the damage immediately, if ever.</P></DD><DTCLASS="term">Step 4: Restore your system. </DT><DDCLASS="listitem"><PCLASS="para">After you know the extent of the damage, you needto restore the system and data to a consistent state. This may involvereloading portions of the system from backups, or it may mean asimple restart of the system. Before you proceed, be certain thatall of the programs you are going to use are &quot;safe.&quot;The attacker may have replaced your <ICLASS="filename">restore</I>program with a Trojan horse that deletes both the files on yourhard disk <EMCLASS="emphasis">and </EM>on your backup tape!</P></DD><DTCLASS="term">Step 5: Deal with the cause.</DT><DDCLASS="listitem"><PCLASS="para">If the problem occurred because of some weaknessin your security or operational measures, you'll want tomake changes and repairs after your system has been restored toa normal state. If the cause was a person making a mistake, youwill probably want to educate him or her to avoid a second occurrenceof the situation. If someone purposefully interfered with your operations,you may wish to involve law enforcement authorities.</P></DD><DTCLASS="term">Step 6: Perform related recovery. </DT><DDCLASS="listitem"><PCLASS="para">If what occurred was covered by insurance, you mayneed to file claims. Rumor control, and perhaps even community relations,will be required at the end of the incident to explain what happened,what breaches occurred, and what measures were taken to resolvethe situation. This step is especially important with a large usercommunity, because unchecked rumors and fears can often damage youroperations more than the problem itself.</P></DD></DL></DIV></DIV></DIV><DIVCLASS="htmlnav"><P></P><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="PART"HREF="part06.htm"TITLE="VI. Handling Security Incidents"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: VI. Handling Security Incidents"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="book"HREF="index.htm"TITLE="Practical UNIX &amp; Internet Security"><IMGSRC="../gifs/txthome.gif"ALT="Practical UNIX &amp; Internet Security"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch24_02.htm"TITLE="24.2 Discovering an Intruder"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 24.2 Discovering an Intruder"BORDER="0"></A></TD></TR><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172">VI. Handling Security Incidents</TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="index"HREF="index/idx_0.htm"TITLE="Book Index"><IMGSRC="../gifs/index.gif"ALT="Book Index"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172">24.2 Discovering an Intruder</TD></TR></TABLE><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><PCLASS="nav"><FONTSIZE="-1">[ <AHREF="../index.htm"TITLE="The Networking CD Bookshelf">Library Home</A> | <AHREF="../dnsbind/index.htm"TITLE="DNS &amp; BIND">DNS &amp; BIND</A> | <AHREF="../tcpip/index.htm"TITLE="TCP/IP Network Administration">TCP/IP</A> | <AHREF="../sendmail/index.htm"TITLE="sendmail">sendmail</A> | <AHREF="../smdref/index.htm"TITLE="sendmail Desktop Reference">sendmail Reference</A> | <AHREF="../firewall/index.htm"TITLE="Building Internet Firewalls">Firewalls</A> | <AHREF="index.htm"TITLE="Practical UNIX &amp; Internet Security">Practical Security</A> ]</FONT></P></DIV></BODY></HTML>