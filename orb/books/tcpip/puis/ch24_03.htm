<HTML><HEAD><TITLE>[Chapter 24] 24.3 The Log Files: Discovering an Intruder's Tracks</TITLE><METANAME="DC.title"CONTENT="Practical UNIX &amp; Internet Security"><METANAME="DC.creator"CONTENT="Simson Garfinkel &amp; Gene Spafford"><METANAME="DC.publisher"CONTENT="O'Reilly &amp; Associates, Inc."><METANAME="DC.date"CONTENT="1999-02-04T00:19:01Z"><METANAME="DC.type"CONTENT="Text.Monograph"><METANAME="DC.format"CONTENT="text/html"SCHEME="MIME"><METANAME="DC.source"CONTENT="1-56592-148-8"SCHEME="ISBN"><METANAME="DC.language"CONTENT="en-US"><METANAME="generator"CONTENT="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><LINKREV="made"HREF="mailto:online-books@oreilly.com"TITLE="Online Books Comments"><LINKREL="up"HREF="ch24_01.htm"TITLE="24. Discovering a  Break-in"><LINKREL="prev"HREF="ch24_02.htm"TITLE="24.2 Discovering an Intruder"><LINKREL="next"HREF="ch24_04.htm"TITLE="24.4 Cleaning Up After the Intruder"></HEAD><BODYBGCOLOR="#FFFFFF"TEXT="#000000"><DIVCLASS="htmlnav"><H1><IMGSRC="gifs/smbanner.gif"ALT="Practical UNIX &amp; Internet Security"USEMAP="#srchmap"BORDER="0"></H1><MAPNAME="srchmap"><AREASHAPE="RECT"COORDS="0,0,466,65"HREF="index.htm"ALT="Practical UNIX &amp; Internet Security"><AREASHAPE="RECT"COORDS="467,0,514,18"HREF="../search/psrch.htm"ALT="Search this book"></MAP><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch24_02.htm"TITLE="24.2 Discovering an Intruder"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 24.2 Discovering an Intruder"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><B><FONTFACE="ARIEL,HELVETICA,HELV,SANSERIF"SIZE="-1">Chapter 24<BR>Discovering a  Break-in</FONT></B></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch24_04.htm"TITLE="24.4 Cleaning Up After the Intruder"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 24.4 Cleaning Up After the Intruder"BORDER="0"></A></TD></TR></TABLE>&nbsp;<HRALIGN="LEFT"WIDTH="515"TITLE="footer"></DIV><DIVCLASS="SECT1"><H2CLASS="sect1"><ACLASS="title"NAME="PUIS-CHP-24-SECT-3">24.3 The Log Files: Discovering an Intruder'sTracks</A></H2><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-33670"></A><ACLASS="indexterm"NAME="AUTOID-33673"></A>Even if you don't catch an intruderin the act, you still have a good chance of finding the intruder'stracks by routinely looking through the system logs. (For a detaileddescription of the <SPANCLASS="acronym">UNIX</SPAN> log files, see <ACLASS="xref"HREF="ch10_01.htm"TITLE="Auditing and Logging">Chapter 10, <CITECLASS="chapter">Auditing and Logging</CITE></A>.) Remember: look for things out of the ordinary;for example:</P><ULCLASS="itemizedlist"><LICLASS="listitem"><PCLASS="para">Users logging in at strange hours</P></LI><LICLASS="listitem"><PCLASS="para">Unexplained reboots</P></LI><LICLASS="listitem"><PCLASS="para">Unexplained changes to the system clock</P></LI><LICLASS="listitem"><PCLASS="para">Unusual error messages from the mailer, <KBDCLASS="command">ftp daemon,</KBD>or other network server</P></LI><LICLASS="listitem"><PCLASS="para">Failed login attempts with bad passwords</P></LI><LICLASS="listitem"><PCLASS="para">Unauthorized or suspicious use of the <KBDCLASS="command">su</KBD> command</P></LI><LICLASS="listitem"><PCLASS="para">Users logging in from unfamiliar sites on the network</P></LI></UL><PCLASS="para">On the other hand, if the intruder is sufficiently skillfuland achieves superuser access on your machine, he or she may eraseall evidence of the invasion. Simply because your system has norecord of an intrusion in the log files, you can't assumethat your system hasn't been attacked.</P><PCLASS="para">Many intruders operate with little finesse: instead of carefullyediting out a record of their attacks, they simply delete or corruptthe entire log file. This means that if you discover a log filedeleted or containing corrupted information, there is a possibilitythat the computer has been successfully broken into. However, abreak-in is not the only possible conclusion. Missing or corruptedlogs might mean that one of your system administrators was careless;there might even be an automatic program in your system that erasesthe log files at periodic intervals.</P><PCLASS="para">You may also discover that your system has been attacked ifyou notice unauthorized changes in system programs or in an individualuser's files. This is another good reason for using somethinglike the Tripwire tool to monitor your files for changes (see <ACLASS="xref"HREF="ch09_01.htm"TITLE="Integrity Management">Chapter 9</A>).</P><PCLASS="para">If your system logs to a hardcopy terminal or another computer,you may wish to examine that log first, because you know that itcan't have been surreptitiously modified by an attackercoming in by the telephone or network.</P></DIV><DIVCLASS="htmlnav"><P></P><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch24_02.htm"TITLE="24.2 Discovering an Intruder"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 24.2 Discovering an Intruder"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="book"HREF="index.htm"TITLE="Practical UNIX &amp; Internet Security"><IMGSRC="../gifs/txthome.gif"ALT="Practical UNIX &amp; Internet Security"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch24_04.htm"TITLE="24.4 Cleaning Up After the Intruder"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 24.4 Cleaning Up After the Intruder"BORDER="0"></A></TD></TR><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172">24.2 Discovering an Intruder</TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="index"HREF="index/idx_0.htm"TITLE="Book Index"><IMGSRC="../gifs/index.gif"ALT="Book Index"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172">24.4 Cleaning Up After the Intruder</TD></TR></TABLE><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><PCLASS="nav"><FONTSIZE="-1">[ <AHREF="../index.htm"TITLE="The Networking CD Bookshelf">Library Home</A> | <AHREF="../dnsbind/index.htm"TITLE="DNS &amp; BIND">DNS &amp; BIND</A> | <AHREF="../tcpip/index.htm"TITLE="TCP/IP Network Administration">TCP/IP</A> | <AHREF="../sendmail/index.htm"TITLE="sendmail">sendmail</A> | <AHREF="../smdref/index.htm"TITLE="sendmail Desktop Reference">sendmail Reference</A> | <AHREF="../firewall/index.htm"TITLE="Building Internet Firewalls">Firewalls</A> | <AHREF="index.htm"TITLE="Practical UNIX &amp; Internet Security">Practical Security</A> ]</FONT></P></DIV></BODY></HTML>