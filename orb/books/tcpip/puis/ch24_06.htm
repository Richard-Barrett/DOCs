<HTML><HEAD><TITLE>[Chapter 24] 24.6 Resuming Operation</TITLE><METANAME="DC.title"CONTENT="Practical UNIX &amp; Internet Security"><METANAME="DC.creator"CONTENT="Simson Garfinkel &amp; Gene Spafford"><METANAME="DC.publisher"CONTENT="O'Reilly &amp; Associates, Inc."><METANAME="DC.date"CONTENT="1999-02-04T00:19:25Z"><METANAME="DC.type"CONTENT="Text.Monograph"><METANAME="DC.format"CONTENT="text/html"SCHEME="MIME"><METANAME="DC.source"CONTENT="1-56592-148-8"SCHEME="ISBN"><METANAME="DC.language"CONTENT="en-US"><METANAME="generator"CONTENT="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><LINKREV="made"HREF="mailto:online-books@oreilly.com"TITLE="Online Books Comments"><LINKREL="up"HREF="ch24_01.htm"TITLE="24. Discovering a  Break-in"><LINKREL="prev"HREF="ch24_05.htm"TITLE="24.5 An Example"><LINKREL="next"HREF="ch24_07.htm"TITLE="24.7 Damage Control"></HEAD><BODYBGCOLOR="#FFFFFF"TEXT="#000000"><DIVCLASS="htmlnav"><H1><IMGSRC="gifs/smbanner.gif"ALT="Practical UNIX &amp; Internet Security"USEMAP="#srchmap"BORDER="0"></H1><MAPNAME="srchmap"><AREASHAPE="RECT"COORDS="0,0,466,65"HREF="index.htm"ALT="Practical UNIX &amp; Internet Security"><AREASHAPE="RECT"COORDS="467,0,514,18"HREF="../search/psrch.htm"ALT="Search this book"></MAP><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch24_05.htm"TITLE="24.5 An Example"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 24.5 An Example"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><B><FONTFACE="ARIEL,HELVETICA,HELV,SANSERIF"SIZE="-1">Chapter 24<BR>Discovering a  Break-in</FONT></B></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch24_07.htm"TITLE="24.7 Damage Control"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 24.7 Damage Control"BORDER="0"></A></TD></TR></TABLE>&nbsp;<HRALIGN="LEFT"WIDTH="515"TITLE="footer"></DIV><DIVCLASS="SECT1"><H2CLASS="sect1"><ACLASS="title"NAME="PUIS-CHP-24-SECT-6">24.6 Resuming Operation</A></H2><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-34079"></A><ACLASS="indexterm"NAME="AUTOID-34082"></A>The next step in handling a break-inis to restore the system to a working state. How quickly you mustbe back in operation, and what you intend to do about the break-inin the long term, will determine when and how you do this step.</P><PCLASS="para">In general you have a few options about how to proceed fromthis point:</P><ULCLASS="itemizedlist"><LICLASS="listitem"><PCLASS="para">Investigate until you have determinedhow the break-in happened, and when. Close up the holes and restorethe system to the state it was prior to the break-in.</P></LI><LICLASS="listitem"><PCLASS="para">Simply patch and repair whatever you think may havebeen related to the break-in. Then restore the system to operationwith heightened monitoring.</P></LI><LICLASS="listitem"><PCLASS="para">Do a quick scan and cleanup, and put the systemback into operation.</P></LI><LICLASS="listitem"><PCLASS="para">Call in law enforcement before you do anything elseso they can start an investigation.</P></LI><LICLASS="listitem"><PCLASS="para">Do nothing whatsoever.</P></LI></UL><PCLASS="para">You want to get whatever assurance you can that you have restoredanything damaged on the system, and fixed whatever it was that allowedthe intruder in. Then, if you have been keeping good backups, youcan restore the system to a working state.</P><PCLASS="para">The difficulty with determining what failed and allowed anintruder in is complicated by the fact that there is usually littledata in the logs to show what happened, and there are few thingsyou can execute to reverse-engineer the break-in. Most break-insseem to result from either a compromised user password (suspectthis especially if you find that the intruders have installed asniffer on your system), or a bug. If it is a bug, you may havedifficulty determining what it is, especially if it is a new onethat has not been widely exploited. If you suspect that it is abug in some system software, you can try contacting your vendorto see if you can get some assistance there. In some cases it helpsif you have a maintenance contract or are a major customer.</P><PCLASS="para">Another avenue you can explore is to contact the <ACLASS="indexterm"NAME="AUTOID-34100"></A><SPANCLASS="acronym">FIRST</SPAN> team appropriate for yoursite. Teams in <SPANCLASS="acronym">FIRST</SPAN> often have some insightinto current break-ins, largely because they see so many reportsof them. Contacting a representative from one of the teams may resultin some good advice for things to check before you put your systemback into operation. However, many teams have rules of operationthat prevent them from giving too much explicit information aboutactive vulnerabilities until the appropriate vendors have announceda fix. Thus, you may not be able to get complete information fromthis source.</P><PCLASS="para">As a possible last resort, you might consult recent postingsto the <ACLASS="indexterm"NAME="AUTOID-34105"></A><ACLASS="indexterm"NAME="AUTOID-34108"></A>Usenet security groups, and to some of thecurrent <SPANCLASS="acronym">WWW</SPAN> sites and mailing lists. Often, currentvulnerabilities are discussed in some detail in these locations.This is a mixed blessing, because not only does this provide youwith some valuable information to protect (or restore) your site,but it also often provides details to hacker wannabes who are lookingfor ways to break into systems. It is also the case that we haveseen incorrect and even dangerous advice and analysis given in someof these forums. Therefore, be very wary of what you read, and considerthese sources as a last resort.</P></DIV><DIVCLASS="htmlnav"><P></P><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch24_05.htm"TITLE="24.5 An Example"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 24.5 An Example"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="book"HREF="index.htm"TITLE="Practical UNIX &amp; Internet Security"><IMGSRC="../gifs/txthome.gif"ALT="Practical UNIX &amp; Internet Security"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch24_07.htm"TITLE="24.7 Damage Control"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 24.7 Damage Control"BORDER="0"></A></TD></TR><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172">24.5 An Example</TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="index"HREF="index/idx_0.htm"TITLE="Book Index"><IMGSRC="../gifs/index.gif"ALT="Book Index"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172">24.7 Damage Control</TD></TR></TABLE><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><PCLASS="nav"><FONTSIZE="-1">[ <AHREF="../index.htm"TITLE="The Networking CD Bookshelf">Library Home</A> | <AHREF="../dnsbind/index.htm"TITLE="DNS &amp; BIND">DNS &amp; BIND</A> | <AHREF="../tcpip/index.htm"TITLE="TCP/IP Network Administration">TCP/IP</A> | <AHREF="../sendmail/index.htm"TITLE="sendmail">sendmail</A> | <AHREF="../smdref/index.htm"TITLE="sendmail Desktop Reference">sendmail Reference</A> | <AHREF="../firewall/index.htm"TITLE="Building Internet Firewalls">Firewalls</A> | <AHREF="index.htm"TITLE="Practical UNIX &amp; Internet Security">Practical Security</A> ]</FONT></P></DIV></BODY></HTML>