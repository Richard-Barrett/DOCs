<HTML><HEAD><TITLE>[Chapter 25] Denial of Service Attacks and Solutions</TITLE><METANAME="DC.title"CONTENT="Practical UNIX &amp; Internet Security"><METANAME="DC.creator"CONTENT="Simson Garfinkel &amp; Gene Spafford"><METANAME="DC.publisher"CONTENT="O'Reilly &amp; Associates, Inc."><METANAME="DC.date"CONTENT="1999-02-04T00:19:31Z"><METANAME="DC.type"CONTENT="Text.Monograph"><METANAME="DC.format"CONTENT="text/html"SCHEME="MIME"><METANAME="DC.source"CONTENT="1-56592-148-8"SCHEME="ISBN"><METANAME="DC.language"CONTENT="en-US"><METANAME="generator"CONTENT="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><LINKREV="made"HREF="mailto:online-books@oreilly.com"TITLE="Online Books Comments"><LINKREL="up"HREF="part06.htm"TITLE="VI. Handling Security Incidents"><LINKREL="prev"HREF="ch24_07.htm"TITLE="24.7 Damage Control"><LINKREL="next"HREF="ch25_02.htm"TITLE="25.2 Overload Attacks"></HEAD><BODYBGCOLOR="#FFFFFF"TEXT="#000000"><DIVCLASS="htmlnav"><H1><IMGSRC="gifs/smbanner.gif"ALT="Practical UNIX &amp; Internet Security"USEMAP="#srchmap"BORDER="0"></H1><MAPNAME="srchmap"><AREASHAPE="RECT"COORDS="0,0,466,65"HREF="index.htm"ALT="Practical UNIX &amp; Internet Security"><AREASHAPE="RECT"COORDS="467,0,514,18"HREF="../search/psrch.htm"ALT="Search this book"></MAP><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch24_07.htm"TITLE="24.7 Damage Control"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 24.7 Damage Control"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><B><FONTFACE="ARIEL,HELVETICA,HELV,SANSERIF"SIZE="-1">Chapter 25</FONT></B></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch25_02.htm"TITLE="25.2 Overload Attacks"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 25.2 Overload Attacks"BORDER="0"></A></TD></TR></TABLE>&nbsp;<HRALIGN="LEFT"WIDTH="515"TITLE="footer"></DIV><DIVCLASS="CHAPTER"><H1CLASS="chapter"><ACLASS="title"NAME="PUIS-CHP-25">25. Denial of Service Attacks and Solutions</A></H1><DIVCLASS="htmltoc"><P><B>Contents:</B><BR><ACLASS="SECT1"HREF="#PUIS-CHP-25-SECT-1"TITLE="25.1 Destructive Attacks">Destructive Attacks</A><BR><ACLASS="SECT1"HREF="ch25_02.htm"TITLE="25.2 Overload Attacks">Overload Attacks</A><BR><ACLASS="SECT1"HREF="ch25_03.htm"TITLE="25.3 Network Denial of Service Attacks">Network Denial of Service Attacks</A></P><P></P></DIV><DIVCLASS="epigraph"><PCLASS="para"ALIGN="right"><I>In cases where denial of service attacks did occur,  itwas either by accident or relatively easy to  figure out whowas responsible. The individual  could be disciplined outsidethe operating  system by other means. </I></P></DIV><DIVCLASS="epigraph"><PCLASS="para"ALIGN="right"><I>&nbsp;- Dennis Ritchie </I></P></DIV><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-34155"></A><ACLASS="indexterm"NAME="AUTOID-34158"></A>A denial of service attack is an attack in whichone user takes up so much of a shared resource that none of theresource is left for other users. Denial of service attacks compromisethe <ICLASS="firstterm">availability</I> of the resources. Thoseresources can be processes, disk space, percentage of <SPANCLASS="acronym">CPU</SPAN>,printer paper, modems, or the time of a harried system administrator.The result is degradation or loss of service.</P><PCLASS="para"><SPANCLASS="acronym">UNIX</SPAN> provides few types of protection againstaccidental or intentional denial of service attacks. Most versionsof <SPANCLASS="acronym">UNIX</SPAN> allow you to limit the maximum numberof files or processes that a user is allowed. Some versions alsolet you place limits on the amount of disk space consumed by anysingle <SPANCLASS="acronym">UID</SPAN> (account). But compared with otheroperating systems, <SPANCLASS="acronym">UNIX</SPAN> is downright primitivein its mechanisms for preventing denial of service attacks.</P><PCLASS="para">This is a short chapter because, as Ritchie noted, it is usuallyeasy to determine who is responsible for a denial of service attackand to take appropriate actions.</P><PCLASS="para">There are two types of denial of service attacks. The firsttype of attack attempts to damage or destroy resources so you can'tuse them. Examples range from causing a disk crash that halts yoursystem to deleting critical commands like cc and ls.</P><PCLASS="para">The second type of attack overloads some system service orexhausts some resource (either deliberately by an attacker, or accidentallyas the result of a user's mistake), thus preventing othersfrom using that service. This simplest type of overload involvesfilling up a disk partition so users and system programs can'tcreate new files. The &quot;bacteria&quot; discussed in<ACLASS="xref"HREF="ch11_01.htm"TITLE="Protecting Against Programmed Threats">Chapter 11, <CITECLASS="chapter">Protecting Against Programmed Threats</CITE></A>, perform this kind of attack.</P><PCLASS="para">Many denial of service problems in this second category resultfrom user error or runaway programs rather than explicit attacks.For example, one common cause is typographical errors in programs,or reversed conditions, such as using the statement x==0when you really meant to type x!=0.</P><DIVCLASS="sect1"><H2CLASS="sect1"><ACLASS="title"NAME="PUIS-CHP-25-SECT-1">25.1 Destructive Attacks</A></H2><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-34175"></A><ACLASS="indexterm"NAME="AUTOID-34179"></A><ACLASS="indexterm"NAME="AUTOID-34181"></A><ACLASS="indexterm"NAME="AUTOID-34184"></A><ACLASS="indexterm"NAME="AUTOID-34186"></A><ACLASS="indexterm"NAME="AUTOID-34189"></A><ACLASS="indexterm"NAME="AUTOID-34192"></A><ACLASS="indexterm"NAME="AUTOID-34195"></A>There are a number of ways to destroy or damageinformation in a fashion that denies service. Almost all of theattacks we know about can be prevented by restricting access tocritical accounts and files, and protecting them from unauthorizedusers. If you follow good security practice to protect the integrityof your system, you will also prevent destructive denial of serviceattacks. <ACLASS="xref"HREF="ch25_01.htm#PUIS-CHP-25-TAB-1"TITLE="Potential Attacks and Their Prevention">Table 25.1</A> lists some potential attacksand how to prevent them.</P><TABLECLASS="table"><CAPTIONCLASS="table"><ACLASS="title"NAME="PUIS-CHP-25-TAB-1">Table 25.1: Potential Attacksand Their Prevention</A></CAPTION><THEADCLASS="thead"><TRCLASS="row"VALIGN="TOP"><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Attack</P></TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Prevention</P></TH></TR></THEAD><TBODYCLASS="tbody"><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Reformatting a disk partition or runningthe <KBDCLASS="command">newfs/mkfs</KBD> command.</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Prevent anyone from accessing the machinein single-user mode. Protect the superuser account. Physically write-protectdisks that are used read-only.</P></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Deleting critical files (e.g., neededfiles that are in <ICLASS="filename">/dev</I> or the <ICLASS="filename">/etc/passwd</I>file)</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Protect system files and accounts byspecifying appropriate modes (e.g., 755 or 711). Protect the superuseraccount. Set ownership of NFS-mounted files to user <ICLASS="systemitem">root</I> and export read-only.</P></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Shutting off power to the computer</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Put the computer in a physically securelocation. Put a lock on circuit-breaker boxes, or place them inlocked rooms. (However, be sure to check the National Electric CodeSection 100 regarding the accessibility of emergency shutoffs. Rememberthat a computer that is experiencing an electrical fire is not verysecure.)</P></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Cutting network or terminal cables</P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Run cables and wires through conduitsto their destinations. Restrict access to rooms where the wiresare exposed</P></TD></TR></TBODY></TABLE></DIV></DIV><DIVCLASS="htmlnav"><P></P><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch24_07.htm"TITLE="24.7 Damage Control"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 24.7 Damage Control"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="book"HREF="index.htm"TITLE="Practical UNIX &amp; Internet Security"><IMGSRC="../gifs/txthome.gif"ALT="Practical UNIX &amp; Internet Security"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch25_02.htm"TITLE="25.2 Overload Attacks"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 25.2 Overload Attacks"BORDER="0"></A></TD></TR><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172">24.7 Damage Control</TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="index"HREF="index/idx_0.htm"TITLE="Book Index"><IMGSRC="../gifs/index.gif"ALT="Book Index"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172">25.2 Overload Attacks</TD></TR></TABLE><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><PCLASS="nav"><FONTSIZE="-1">[ <AHREF="../index.htm"TITLE="The Networking CD Bookshelf">Library Home</A> | <AHREF="../dnsbind/index.htm"TITLE="DNS &amp; BIND">DNS &amp; BIND</A> | <AHREF="../tcpip/index.htm"TITLE="TCP/IP Network Administration">TCP/IP</A> | <AHREF="../sendmail/index.htm"TITLE="sendmail">sendmail</A> | <AHREF="../smdref/index.htm"TITLE="sendmail Desktop Reference">sendmail Reference</A> | <AHREF="../firewall/index.htm"TITLE="Building Internet Firewalls">Firewalls</A> | <AHREF="index.htm"TITLE="Practical UNIX &amp; Internet Security">Practical Security</A> ]</FONT></P></DIV></BODY></HTML>