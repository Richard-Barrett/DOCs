<HTML><HEAD><TITLE>[Appendix B] Host Status File Internals</TITLE><METANAME="DC.title"CONTENT="sendmail"><METANAME="DC.creator"CONTENT="Bryan Costales &amp; Eric Allman"><METANAME="DC.publisher"CONTENT="O'Reilly &amp; Associates, Inc."><METANAME="DC.date"CONTENT="1999-01-06T22:50:04Z"><METANAME="DC.type"CONTENT="Text.Monograph"><METANAME="DC.format"CONTENT="text/html"SCHEME="MIME"><METANAME="DC.source"CONTENT="1-56592-222-0"SCHEME="ISBN"><METANAME="DC.language"CONTENT="en-US"><METANAME="generator"CONTENT="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><LINKREV="made"HREF="mailto:online-books@oreilly.com"TITLE="Online Books Comments"><LINKREL="up"HREF="part05.htm"TITLE="V. Appendixes"><LINKREL="prev"HREF="appa_01.htm"TITLE="A. The client.cf File"><LINKREL="next"HREF="appc_01.htm"TITLE="C. The Berkeley DB Database"></HEAD><BODYBGCOLOR="#FFFFFF"TEXT="#000000"><DIVCLASS="htmlnav"><H1><IMGSRC="gifs/smbanner.gif"ALT="sendmail"USEMAP="#srchmap"BORDER="0"></H1><MAPNAME="srchmap"><AREASHAPE="RECT"COORDS="0,0,466,65"HREF="index.htm"ALT="sendmail"><AREASHAPE="RECT"COORDS="467,0,514,18"HREF="../search/ssrch.htm"ALT="Search this book"></MAP><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="APPENDIX"HREF="appa_01.htm"TITLE="A. The client.cf File"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: A. The client.cf File"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><B><FONTFACE="ARIEL,HELVETICA,HELV,SANSERIF"SIZE="-1">Appendix B</FONT></B></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="APPENDIX"HREF="appc_01.htm"TITLE="C. The Berkeley DB Database"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: C. The Berkeley DB Database"BORDER="0"></A></TD></TR></TABLE>&nbsp;<HRALIGN="LEFT"WIDTH="515"TITLE="footer"></DIV><DIVCLASS="APPENDIX"><H1CLASS="appendix"><ACLASS="title"NAME="SML2-AP-B">B. Host Status File Internals</A></H1><DIVCLASS="htmltoc"><P><B>Contents:</B><BR><ACLASS="sect1"HREF="#SML2-AP-B-SECT-1"TITLE="B.1 Status file lines">Status file lines</A></P><P></P></DIV><PCLASS="para"></P><PCLASS="para">&quot;Persistent host status&quot; is described under, and enabled with,the <CODECLASS="literal">HostStatusDirectory</CODE> option(see <ACLASS="xref"HREF="ch34_08.htm#SML2-CH-34-SECT-8-31"TITLE="">Section 34.8.31, HostStatusDirectory</A>).<ACLASS="indexterm"NAME="AUTOID-62864"></A>The format for each directory created by that option,as of V\*[sendmail_version] <EMCLASS="emphasis">sendmail</EM>, looks like this:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">HostStatusDirectory<CODECLASS="replaceable"><I>/domain./subdomain./host</I></CODE></PRE></BLOCKQUOTE></P><PCLASS="para">That is, the canonical name of the host whose statusis being stored is divided into components basedon the separating dots in its name. The dot for eachcomponent, is moved to the end of each componentand all but the <CODECLASS="replaceable"><I>host</I></CODE> part are created as directories.</P><PCLASS="para">To illustrate, consider the following canonical name:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">here.uofa.edu</PRE></BLOCKQUOTE></P><PCLASS="para">If the <CODECLASS="literal">HostStatusDirectory</CODE> option were declaredlike this:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">O HostStatusDirectory=/tmp/.hoststat</PRE></BLOCKQUOTE></P><PCLASS="para">the status for the host <EMCLASS="emphasis">here.uofa.edu</EM> would be stored in thefile:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">/tmp/.hoststat/edu./uofa./here</PRE></BLOCKQUOTE></P><PCLASS="para"></P><DIVCLASS="sect1"><H2CLASS="sect1"><ACLASS="title"NAME="SML2-AP-B-SECT-1">B.1 Status file lines</A></H2><PCLASS="para"><ACLASS="indexterm"NAME="SML2-AP-B-IX-STATUS-HOST-STATUS-FILE"></A><ACLASS="indexterm"NAME="SML2-AP-B-IX-HOST-STATUS"></A>The format of the status file (in the above case <CODECLASS="literal">here</CODE>)is one item of information per line, where each linebegins with a key letter:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen"><ICLASS="lineannotation">letter</I><CODECLASS="replaceable"><I>what</I></CODE></PRE></BLOCKQUOTE></P><PCLASS="para">The complete list of key letters is shown in<ACLASS="xref"HREF="appb_01.htm#SML2-AP-B-TAB-0"TITLE="Host Status File Key Letters">Table 38.3</A>.</P><TABLECLASS="table"><CAPTIONCLASS="table"><ACLASS="title"NAME="SML2-AP-B-TAB-0">Table B.1: Host Status File Key Letters</A></CAPTION><THEADCLASS="thead"><TRCLASS="row"VALIGN="TOP"><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Letter</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Version</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Description</TH></TR></THEAD><TBODYCLASS="tbody"><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">D</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">V8.8 and above</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">The DSN status text</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">E</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">V8.8 and above</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">The UNIX error number</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">H</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">V8.8 and above</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">The DNS error number</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">R</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">V8.8 and above</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">The SMTP status-code text</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">S</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">V8.8 and above</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">The UNIX <EMCLASS="emphasis">exit</EM>(2) status</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">U</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">V8.8 and above</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">The time last used</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">V</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">V8.8 and above</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">The version of this status file</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">.</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">V8.8 and above</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">The end of file marker</TD></TR></TBODY></TABLE><PCLASS="para">In the sections that follow, we describe each keyletter in alphabetical order, rather than in the orderin which they will appear in the status file.</P><PCLASS="para">Note that not all these lines are printed with the<EMCLASS="emphasis">hoststat</EM>(1) command (see <ACLASS="xref"HREF="ch36_01.htm#SML2-CH-36-SECT-1-1"TITLE="hoststat (V8.8 and Above)">Section 36.1.1, "hoststat (V8.8 and Above)"</A>). As of\*[sendmail_version],only the information in the <CODECLASS="literal">E</CODE>, <CODECLASS="literal">R</CODE>, and <CODECLASS="literal">U</CODE> lines is printed.</P><PCLASS="para">Also note that the letters that are used and the meaning of eachare essentially internal to <EMCLASS="emphasis">sendmail</EM> andare subject to change without notice.</P><DIVCLASS="refentry"><DIVCLASS="refnamediv"><H3CLASS="refname"><ACLASS="refname"NAME="AUTOID-62950">B.1.1 D line</A></H3><PCLASS="refpurpose">The DSN status text</P>(V8.8 and above)</DIV><BLOCKQUOTE><DIVCLASS="refsect1"><PCLASS="para">Delivery Status Notification (DSN) gives thestatus of a returned message in its <CODECLASS="literal">Status:</CODE>MIME-body header (see RFC1892).That status is formed from three digits, each separatedfrom the others by a dot, for example:<ACLASS="indexterm"NAME="AUTOID-62959"></A><ACLASS="indexterm"NAME="AUTOID-62961"></A><ACLASS="indexterm"NAME="AUTOID-62963"></A><ACLASS="indexterm"NAME="AUTOID-62965"></A></P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">5.0.1</PRE></BLOCKQUOTE></P><PCLASS="para">The meaning of each digit is documented in RFC1893.This <CODECLASS="literal">D</CODE> line stores that status as text.</P></DIV></BLOCKQUOTE></DIV><DIVCLASS="refentry"><DIVCLASS="refnamediv"><H3CLASS="refname"><ACLASS="refname"NAME="AUTOID-62972">B.1.2 E line</A></H3><PCLASS="refpurpose">The UNIX error number</P>(V8.8 and above)</DIV><BLOCKQUOTE><DIVCLASS="refsect1"><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-62980"></A><ACLASS="indexterm"NAME="AUTOID-62983"></A><ACLASS="indexterm"NAME="AUTOID-62985"></A><ACLASS="indexterm"NAME="AUTOID-62988"></A><ACLASS="indexterm"NAME="AUTOID-62991"></A>When delivery or a connection fails because of a systemerror, that error is stored in the <CODECLASS="literal">E</CODE> line.Such errors are integer values as defined in <EMCLASS="emphasis">&lt;errno.h&gt;</EM>.If there was no error, the value stored in this lineis a zero.</P></DIV></BLOCKQUOTE></DIV><DIVCLASS="refentry"><DIVCLASS="refnamediv"><H3CLASS="refname"><ACLASS="refname"NAME="AUTOID-62995">B.1.3 H line</A></H3><PCLASS="refpurpose">The DNS error number</P>(V8.8 and above)</DIV><BLOCKQUOTE><DIVCLASS="refsect1"><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-63003"></A><ACLASS="indexterm"NAME="AUTOID-63005"></A><ACLASS="indexterm"NAME="AUTOID-63008"></A><ACLASS="indexterm"NAME="AUTOID-63011"></A><ACLASS="indexterm"NAME="AUTOID-63014"></A><ACLASS="indexterm"NAME="AUTOID-63016"></A>Some connection problems are caused by errors in lookingup hosts with the Domain Name System (DNS).The software that provides lookups provides its ownset of errors (see <EMCLASS="emphasis">&lt;arpa/nameser.h&gt;</EM>).If a DNS error occurs, it is stored in this<CODECLASS="literal">H</CODE> line as an integer value.</P></DIV></BLOCKQUOTE></DIV><DIVCLASS="refentry"><DIVCLASS="refnamediv"><H3CLASS="refname"><ACLASS="refname"NAME="AUTOID-63020">B.1.4 R line</A></H3><PCLASS="refpurpose">The SMTP status-code text</P>(V8.8 and above)</DIV><BLOCKQUOTE><DIVCLASS="refsect1"><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-63028"></A><ACLASS="indexterm"NAME="AUTOID-63030"></A><ACLASS="indexterm"NAME="AUTOID-63033"></A><ACLASS="indexterm"NAME="AUTOID-63036"></A><ACLASS="indexterm"NAME="AUTOID-63039"></A>The Simple Mail Transfer Protocol (SMTP) specifiesthat all errors be prefixed with three-digit codes. The meaningof all the three-digit codes is given in RFC821 andseveral newer RFCs.</P><PCLASS="para">The <CODECLASS="literal">R</CODE> line stores this three-digit code as text. Ifthere is no code (as when there is a system error insteadof an SMTP error), the text is a lone hyphen.</P></DIV></BLOCKQUOTE></DIV><DIVCLASS="refentry"><DIVCLASS="refnamediv"><H3CLASS="refname"><ACLASS="refname"NAME="AUTOID-63044">B.1.5 S line</A></H3><PCLASS="refpurpose">The UNIX exit(2) status</P>(V8.8 and above)</DIV><BLOCKQUOTE><DIVCLASS="refsect1"><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-63052"></A><ACLASS="indexterm"NAME="AUTOID-63054"></A><ACLASS="indexterm"NAME="AUTOID-63057"></A><ACLASS="indexterm"NAME="AUTOID-63059"></A>All UNIX programs return a success or failure valueto the program that executed them. These values arecalled <EMCLASS="emphasis">exit</EM>(2) values and they may or may notcorrespond to standard values. The set of values thatis understood by <EMCLASS="emphasis">sendmail</EM> is defined in <EMCLASS="emphasis">&lt;sysexits.h&gt;</EM>.</P><PCLASS="para">This <CODECLASS="literal">S</CODE> line stores the integer value that was returnedby a delivery agent program. Such programs might be calledto deliver SMTP network mail.</P></DIV></BLOCKQUOTE></DIV><DIVCLASS="refentry"><DIVCLASS="refnamediv"><H3CLASS="refname"><ACLASS="refname"NAME="AUTOID-63067">B.1.6 U line</A></H3><PCLASS="refpurpose">The last time used</P>(V8.8 and above)</DIV><BLOCKQUOTE><DIVCLASS="refsect1"><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-63075"></A><ACLASS="indexterm"NAME="AUTOID-63077"></A><ACLASS="indexterm"NAME="AUTOID-63080"></A>Each time connection is made to, or fails to be made to,a host, its persistent status is updated. The date andtime of the last update are stored in the <CODECLASS="literal">U</CODE> line.</P><PCLASS="para">The date and time are represented as an unsigned long andare stored in the <CODECLASS="literal">U</CODE> line as a text representationof that value.</P></DIV></BLOCKQUOTE></DIV><DIVCLASS="refentry"><DIVCLASS="refnamediv"><H3CLASS="refname"><ACLASS="refname"NAME="AUTOID-63085">B.1.7 V line</A></H3><PCLASS="refpurpose">The version of this status file</P>(V8.8 and above)</DIV><BLOCKQUOTE><DIVCLASS="refsect1"><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-63093"></A><ACLASS="indexterm"NAME="AUTOID-63095"></A><ACLASS="indexterm"NAME="AUTOID-63098"></A>For V8.8 <EMCLASS="emphasis">sendmail</EM> this is version 0. If any other versionis stored in this <CODECLASS="literal">V</CODE> line, <EMCLASS="emphasis">sendmail</EM> logs thefollowing error:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">Unknown host status version <ICLASS="lineannotation">bad</I>: 0 max</PRE></BLOCKQUOTE></P><PCLASS="para">This is always the first line of the file.</P></DIV></BLOCKQUOTE></DIV><DIVCLASS="refentry"><DIVCLASS="refnamediv"><H3CLASS="refname"><ACLASS="refname"NAME="AUTOID-63107">B.1.8 . line</A></H3><PCLASS="refpurpose">The end of file marker</P>(V8.8 and above)</DIV><BLOCKQUOTE><DIVCLASS="refsect1"><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-63115"></A>A dot on a line by itself indicates the end of the host status file'sinformation. On systems that don't support the <EMCLASS="emphasis">ftruncate</EM>(2)call, additional data may appear after this line. Since this linemarks the end of information, any such extra data will be ignored.<ACLASS="indexterm"NAME="AUTOID-63119"></A><ACLASS="indexterm"NAME="AUTOID-63120"></A></P></DIV></BLOCKQUOTE></DIV></DIV></DIV><DIVCLASS="htmlnav"><P></P><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="APPENDIX"HREF="appa_01.htm"TITLE="A. The client.cf File"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: A. The client.cf File"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="book"HREF="index.htm"TITLE="sendmail"><IMGSRC="../gifs/txthome.gif"ALT="sendmail"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="APPENDIX"HREF="appc_01.htm"TITLE="C. The Berkeley DB Database"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: C. The Berkeley DB Database"BORDER="0"></A></TD></TR><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172">A. The client.cf File</TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="index"HREF="index/idx_0.htm"TITLE="Book Index"><IMGSRC="../gifs/index.gif"ALT="Book Index"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172">C. The Berkeley DB Database</TD></TR></TABLE><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><PCLASS="nav"><FONTSIZE="-1">[ <AHREF="../index.htm"TITLE="The Networking CD Bookshelf">Library Home</A> | <AHREF="../dnsbind/index.htm"TITLE="DNS &amp; BIND">DNS &amp; BIND</A> | <AHREF="../tcpip/index.htm"TITLE="TCP/IP Network Administration">TCP/IP</A> | <AHREF="index.htm"TITLE="sendmail">sendmail</A> | <AHREF="../smdref/index.htm"TITLE="sendmail Desktop Reference">sendmail Reference</A> | <AHREF="../firewall/index.htm"TITLE="Building Internet Firewalls">Firewalls</A> | <AHREF="../puis/index.htm"TITLE="Practical UNIX &amp; Internet Security">Practical Security</A> ]</FONT></P></DIV></BODY></HTML>