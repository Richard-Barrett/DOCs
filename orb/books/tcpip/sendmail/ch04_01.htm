<HTML><HEAD><TITLE>[Chapter 4] How to Run sendmail</TITLE><METANAME="DC.title"CONTENT="sendmail"><METANAME="DC.creator"CONTENT="Bryan Costales &amp; Eric Allman"><METANAME="DC.publisher"CONTENT="O'Reilly &amp; Associates, Inc."><METANAME="DC.date"CONTENT="1999-01-06T18:33:06Z"><METANAME="DC.type"CONTENT="Text.Monograph"><METANAME="DC.format"CONTENT="text/html"SCHEME="MIME"><METANAME="DC.source"CONTENT="1-56592-222-0"SCHEME="ISBN"><METANAME="DC.language"CONTENT="en-US"><METANAME="generator"CONTENT="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><LINKREV="made"HREF="mailto:online-books@oreilly.com"TITLE="Online Books Comments"><LINKREL="up"HREF="part01.htm"TITLE="I. A Tutorial"><LINKREL="prev"HREF="ch03_05.htm"TITLE="3.5 Things to Try"><LINKREL="next"HREF="ch04_02.htm"TITLE="4.2 Verbose (-v)"></HEAD><BODYBGCOLOR="#FFFFFF"TEXT="#000000"><DIVCLASS="htmlnav"><H1><IMGSRC="gifs/smbanner.gif"ALT="sendmail"USEMAP="#srchmap"BORDER="0"></H1><MAPNAME="srchmap"><AREASHAPE="RECT"COORDS="0,0,466,65"HREF="index.htm"ALT="sendmail"><AREASHAPE="RECT"COORDS="467,0,514,18"HREF="../search/ssrch.htm"ALT="Search this book"></MAP><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch03_05.htm"TITLE="3.5 Things to Try"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 3.5 Things to Try"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><B><FONTFACE="ARIEL,HELVETICA,HELV,SANSERIF"SIZE="-1">Chapter 4</FONT></B></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch04_02.htm"TITLE="4.2 Verbose (-v)"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 4.2 Verbose (-v)"BORDER="0"></A></TD></TR></TABLE>&nbsp;<HRALIGN="LEFT"WIDTH="515"TITLE="footer"></DIV><DIVCLASS="CHAPTER"><H1CLASS="chapter"><ACLASS="title"NAME="SML2-CH-4">4. How to Run sendmail</A></H1><DIVCLASS="htmltoc"><P><B>Contents:</B><BR><ACLASS="sect1"HREF="#SML2-CH-4-SECT-1"TITLE="4.1 Become a Mode (-b)">Become a Mode (-b)</A><BR><ACLASS="sect1"HREF="ch04_02.htm"TITLE="4.2 Verbose (-v)">Verbose (-v)</A><BR><ACLASS="sect1"HREF="ch04_03.htm"TITLE="4.3 Debugging (-d)">Debugging (-d)</A><BR><ACLASS="sect1"HREF="ch04_04.htm"TITLE="4.4 Things to Try">Things to Try</A></P><P></P></DIV><PCLASS="para"></P><PCLASS="para">One way to run <EMCLASS="emphasis">sendmail</EM>is to provide it with the name of a recipient as the onlycommand-line argument. For example, the followingsends a mail message to <CODECLASS="literal">george</CODE>:[1]<ACLASS="indexterm"NAME="SML2-CH-4-IX-COMMAND-LINE"></A></P><BLOCKQUOTECLASS="footnote"><PCLASS="para">[1] For now, you can do this only with the system-supplied <EMCLASS="emphasis">sendmail</EM>.It requires a configuration file that we have notyet written for our freshly compiled version.</P></BLOCKQUOTE><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">% <CODECLASS="userinput"><B>/usr/lib/sendmail george</B></CODE></PRE></BLOCKQUOTE></P><PCLASS="para">Multiple recipients can also be given.For example,the following sends a mail message to <CODECLASS="literal">george</CODE>, <CODECLASS="literal">truman</CODE>,and <CODECLASS="literal">teddy</CODE>:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">% <CODECLASS="userinput"><B>/usr/lib/sendmail george,truman,teddy</B></CODE></PRE></BLOCKQUOTE></P><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-2050"></A><ACLASS="indexterm"NAME="AUTOID-2053"></A><ACLASS="indexterm"NAME="AUTOID-2056"></A><ACLASS="indexterm"NAME="AUTOID-2058"></A>The <EMCLASS="emphasis">sendmail</EM> program acceptstwo different kinds of command-line arguments.Arguments that <EMCLASS="emphasis">do not</EM> begin with a <CODECLASS="literal">-</CODE>character (such as <CODECLASS="literal">george</CODE>)are assumed to be recipients.Arguments that <EMCLASS="emphasis">do</EM> begin with a <CODECLASS="literal">-</CODE> character are taken as switchesthat determine the behavior of <EMCLASS="emphasis">sendmail</EM>.In this chapter we will cover only a few of these switch-style command-linearguments (see<ACLASS="xref"HREF="ch04_01.htm#SML2-CH-4-TAB-0"TITLE="Some Command-Line Switches">Table 4.1</A>).The complete list of command-line switches, along with anexplanation of each, is presented in the reference part of this book(<ACLASS="xref"HREF="ch36_01.htm"TITLE="The Command Line">Chapter 36, <CITECLASS="chapter">The Command Line</CITE></A>).</P><TABLECLASS="table"><CAPTIONCLASS="table"><ACLASS="title"NAME="SML2-CH-4-TAB-0">Table 4.1: Some Command-Line Switches</A></CAPTION><THEADCLASS="thead"><TRCLASS="row"VALIGN="TOP"><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Flag</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Description</TH></TR></THEAD><TBODYCLASS="tbody"><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">-b</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Set operating mode</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">-v</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Run in verbose mode</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">-d</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Run in debugging mode</TD></TR></TBODY></TABLE><DIVCLASS="sect1"><H2CLASS="sect1"><ACLASS="title"NAME="SML2-CH-4-SECT-1">4.1 Become a Mode (-b)</A></H2><PCLASS="para"><ACLASS="indexterm"NAME="SML2-CH-4-IX-B-SWITCH"></A>The <EMCLASS="emphasis">sendmail</EM> program can function in a number of different waysdepending on which form of <CODECLASS="literal">-b</CODE> argument you use. One form, for example, causes<EMCLASS="emphasis">sendmail</EM> to display the contents of the queue.Another causes <EMCLASS="emphasis">sendmail</EM>to rebuild the <EMCLASS="emphasis">aliases</EM> database.A complete list of the <CODECLASS="literal">-b</CODE>command-line mode-setting switches is shown in <ACLASS="xref"HREF="ch04_01.htm#SML2-CH-4-TAB-1"TITLE="Forms of the -b Command-Line Switch">Table 4.2</A>.We will cover only a few in this chapter and will present the othersas this tutorial proceeds.</P><TABLECLASS="table"><CAPTIONCLASS="table"><ACLASS="title"NAME="SML2-CH-4-TAB-1">Table 4.2: Forms of the -b Command-Line Switch</A></CAPTION><THEADCLASS="thead"><TRCLASS="row"VALIGN="TOP"><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Form</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Description</TH></TR></THEAD><TBODYCLASS="tbody"><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">-ba</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Use ARPAnet (Grey Book) protocols</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">-bD</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Run as a daemon, but don't fork</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">-bd</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Run as a daemon</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">-bH</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Purge persistent host status</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">-bh</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Print persistent host status</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">-bi</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Rebuild alias database</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">-bm</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Be a mail sender</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">-bp</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Print the queue</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">-bs</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Run SMTP on standard input</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">-bt</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Test mode: resolve addresses only</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">-bv</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Verify: don't collect or deliver</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">-bz</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Freeze the configuration file (obsolete)</TD></TR></TBODY></TABLE><PCLASS="para">The effects of some of the options in<ACLASS="xref"HREF="ch04_01.htm#SML2-CH-4-TAB-1"TITLE="Forms of the -b Command-Line Switch">Table 4.2</A>can also be achieved by running the <EMCLASS="emphasis">sendmail</EM> executable using different names. Those names and a description of their results are shown in<ACLASS="xref"HREF="ch04_01.htm#SML2-CH-4-TAB-2"TITLE="Other Names for sendmail">Table 4.3</A>.Each name can be a hard link with, a symboliclink to, or a copy of <EMCLASS="emphasis">sendmail</EM>.</P><TABLECLASS="table"><CAPTIONCLASS="table"><ACLASS="title"NAME="SML2-CH-4-TAB-2">Table 4.3: Other Names for sendmail</A></CAPTION><THEADCLASS="thead"><TRCLASS="row"VALIGN="TOP"><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Name</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Form</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Description</TH></TR></THEAD><TBODYCLASS="tbody"><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">hoststat</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">-bh</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Print persistent host status</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">mailq</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">-bp</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Display the queue</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">newaliases</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">-bi</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Initialize alias database</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">purgestat</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">-bH</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Purge persistent host status</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">smtpd</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">-bd</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Run as a daemon</TD></TR></TBODY></TABLE><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="SML2-CH-4-SECT-1-1">4.1.1 Daemon Mode (-bd)</A></H3><PCLASS="para"><ACLASS="indexterm"NAME="SML2-CH-4-IX-MODES-DAEMON"></A><ACLASS="indexterm"NAME="SML2-CH-4-IX-DAEMON-MODE"></A><ACLASS="indexterm"NAME="SML2-CH-4-IX-B-SWITCH-BD-1"></A>The <EMCLASS="emphasis">sendmail</EM> program can run as a daemon in thebackground, listening for incoming mail from other machines.The <EMCLASS="emphasis">sendmail</EM> program reads its configuration file only once,when it first starts as a daemon.It then continues to run forever,never reading the configuration file again.As a consequence, it will never see any changesto that configuration file.</P><PCLASS="para">When you change something in the <EMCLASS="emphasis">sendmail.cf</EM>configuration file, you <EMCLASS="emphasis">always</EM> need to kill and restart the<EMCLASS="emphasis">sendmail</EM> daemon.But before you can kill the daemon, you need to know how to correctlyrestart it. This information is in the <EMCLASS="emphasis">/etc/sendmail.pid</EM>file or one of your system <EMCLASS="emphasis">rc</EM> files.</P><PCLASS="para">On a Berkeley UNIX-based system, for example,the daemon is usually started like this:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">/usr/lib/sendmail -bd -q1h</PRE></BLOCKQUOTE></P><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-2199"></A>The <CODECLASS="literal">-bd</CODE> command-line switch specifies daemon mode.The <CODECLASS="literal">-q</CODE> switch tells <EMCLASS="emphasis">sendmail</EM>how often to look in its queue to process pending mail.The <CODECLASS="literal">-q1h</CODE> switch says toprocess the queue at one (<CODECLASS="literal">1</CODE>) hour (<CODECLASS="literal">h</CODE>) intervals.</P><PCLASS="para">The actual command to start the <EMCLASS="emphasis">sendmail</EM> daemon on yoursystem may be different from what we've shown. If youmanage many different brands of systems, you'll need to know how tostart the daemon on all of them.&#13;</P><DIVCLASS="sect3"><H4CLASS="sect3"><ACLASS="title"NAME="SML2-CH-4-SECT-1-1-1">4.1.1.1 Kill and restart, beginning with V8.7</A></H4><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-2212"></A><ACLASS="indexterm"NAME="AUTOID-2214"></A><ACLASS="indexterm"NAME="AUTOID-2216"></A>Killing and restarting the <EMCLASS="emphasis">sendmail</EM> daemon became easier beginning withV8.7. A single command[2]will kill and restart the daemon:</P><BLOCKQUOTECLASS="footnote"><PCLASS="para">[2] Provided that the daemon was originally started with a full pathname.</P></BLOCKQUOTE><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">% <CODECLASS="userinput"><B>kill -HUP `head -1 /etc/sendmail.pid`</B></CODE></PRE></BLOCKQUOTE></P><PCLASS="para">This single command has the same effect as the two commands shown for V8.6 below.&#13;</P></DIV><DIVCLASS="sect3"><H4CLASS="sect3"><ACLASS="title"NAME="SML2-CH-4-SECT-1-1-2">4.1.1.2 Kill and restart, with V8.6</A></H4><PCLASS="para">Before you can start the <EMCLASS="emphasis">sendmail</EM> daemon, you need tomake sure there is not a daemon running already.Beginning with V8.6, the <EMCLASS="emphasis">pid</EM> of the currentlyrunning daemon is found in the first line of the <EMCLASS="emphasis">/etc/sendmail.pid</EM> file.The processes of killing the daemon looks like this:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen"><CODECLASS="literal">% </CODE><CODECLASS="userinput"><B>kill `head -1 /etc/sendmail.pid`</B></CODE></PRE></BLOCKQUOTE></P><PCLASS="para">&#13;After killing the currently running daemon, you can start anew daemon with the following simple command:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen"><CODECLASS="literal">% </CODE><CODECLASS="userinput"><B>`tail -1 /etc/sendmail.pid`</B></CODE></PRE></BLOCKQUOTE></P><PCLASS="para"></P></DIV><DIVCLASS="sect3"><H4CLASS="sect3"><ACLASS="title"NAME="SML2-CH-4-SECT-1-1-3">4.1.1.3 Kill and restart, old versions</A></H4><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-2245"></A>Under old versions of <EMCLASS="emphasis">sendmail</EM> you need to use the<EMCLASS="emphasis">ps</EM>(1) program to find the <EMCLASS="emphasis">pid</EM> of the daemon.How you run <EMCLASS="emphasis">ps</EM> is different onBSD UNIX and System V UNIX. For BSD UNIX thecommand that you use and the output that it produces resemble the following:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen"><CODECLASS="literal">% </CODE><CODECLASS="userinput"><B>ps ax | grep sendmail | grep -v grep</B></CODE><CODECLASS="literal">   99    ?  IW    0:07 /usr/lib/sendmail -bd -q1h</CODE><CODECLASS="literal">% </CODE><CODECLASS="userinput"><B>kill 99</B></CODE></PRE></BLOCKQUOTE></P><PCLASS="para">Here the leftmost number printed by <EMCLASS="emphasis">ps</EM> (the <CODECLASS="literal">99</CODE>) was usedto kill the daemon.</P><PCLASS="para">For System V-based systems you use different arguments for the<EMCLASS="emphasis">ps</EM> command, and its output differs:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen"><CODECLASS="literal">% </CODE><CODECLASS="userinput"><B>ps -ae | grep sendmail</B></CODE><CODECLASS="literal">   99 ?         0:01 sendmail</CODE><CODECLASS="literal">% </CODE><CODECLASS="userinput"><B>kill 99</B></CODE></PRE></BLOCKQUOTE></P><PCLASS="para">Under old versions of <EMCLASS="emphasis">sendmail</EM> you must look in your system <EMCLASS="emphasis">rc</EM>files for the way to restart <EMCLASS="emphasis">sendmail</EM>. We showed how tofind this information in <ACLASS="xref"HREF="ch03_01.htm"TITLE="The Roles of sendmail">Chapter 3, <CITECLASS="chapter">The Roles of sendmail</CITE></A> (see <ACLASS="xref"HREF="ch03_04.htm"TITLE="Role as a Daemon">Section 3.4, "Role as a Daemon"</A>).&#13;</P></DIV><DIVCLASS="sect3"><H4CLASS="sect3"><ACLASS="title"NAME="SML2-CH-4-SECT-1-1-4">4.1.1.4 If you forget to kill the daemon</A></H4><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-2279"></A>If you forget to kill the daemon before starting a new one,you may see a stream of messages similar to the following, one printedevery 5 seconds (probably to your console window):</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">getrequests: cannot bind: Address already in usegetrequests: cannot bind: Address already in usegetrequests: cannot bind: Address already in usegetrequests: cannot bind: Address already in usegetrequests: cannot bind: Address already in usegetrequests: cannot bind: Address already in usegetrequests: cannot bind: Address already in usegetrequests: cannot bind: Address already in usegetrequests: cannot bind: Address already in usegetrequests: cannot bind: Address already in usegetrequests: cannot bind: Address already in useopendaemonsocket: server SMTP socket wedged: exiting</PRE></BLOCKQUOTE></P><PCLASS="para">This shows that the attempt to run a second daemon failed.[3]<ACLASS="indexterm"NAME="AUTOID-2288"></A><ACLASS="indexterm"NAME="AUTOID-2289"></A><ACLASS="indexterm"NAME="AUTOID-2290"></A>&#13;</P><BLOCKQUOTECLASS="footnote"><PCLASS="para">[3] Note that some multicast-capable versions of UNIX allow multiple<EMCLASS="emphasis">sendmail</EM> daemons to run simultaneously. This is a known bug inthe SO_REUSEADDR <EMCLASS="emphasis">ioctl</EM>(2) call for TCP undermulticasting. Contact your vendor for a fix.</P></BLOCKQUOTE></DIV></DIV><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="SML2-CH-4-SECT-1-2">4.1.2 Show Queue Mode (-bp)</A></H3><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-2294"></A><ACLASS="indexterm"NAME="AUTOID-2296"></A><ACLASS="indexterm"NAME="AUTOID-2299"></A><ACLASS="indexterm"NAME="AUTOID-2302"></A><ACLASS="indexterm"NAME="AUTOID-2305"></A><ACLASS="indexterm"NAME="AUTOID-2308"></A>The <EMCLASS="emphasis">sendmail</EM> program can alsodisplay the contents of its queue directory. Itcan do this in two ways: by running as a program named <EMCLASS="emphasis">mailq</EM>or by being run as <EMCLASS="emphasis">sendmail</EM> with the <CODECLASS="literal">-bp</CODE>command-line switch.Whichever way you run it, the contentsof the queue directory are printed.If the queue is empty, <EMCLASS="emphasis">sendmail</EM> prints the following:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">Mail queue is empty</PRE></BLOCKQUOTE></P><PCLASS="para">If, on the other hand, there is mail waiting in the queue,the output is far more verbose, possibly containing lines similarto these:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">.ps 8                Mail Queue (1 requests)-Q-ID-- -Size- --Q-Time--- ------Sender/Recipient------GAA29775*     702 Thu Mar 12 16:51 &lt;you@here.us.edu&gt;            Deferred: Host fbi.dc.gov is down                                  &lt;george@fbi.dc.gov&gt;</PRE></BLOCKQUOTE></P><PCLASS="para">Here, the output produced with the <CODECLASS="literal">-bp</CODE> switchshows that there is only one mail message in the queue. If therewere more, each entry would look pretty much the same as this. Each messageresults in at least two lines of output.</P><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-2323"></A>The firstline shows details about the message and the sender. The<CODECLASS="literal">GAA29775</CODE> identifies this message in the queue.The <CODECLASS="literal">*</CODE> shows that this message is locked and currently beingprocessed.The <CODECLASS="literal">702</CODE> is the size of the message body in bytes(the size of the <CODECLASS="literal">df</CODE> file as mentioned in <ACLASS="xref"HREF="ch03_01.htm#SML2-CH-3-SECT-1-2"TITLE="The Queue Directory">Section 3.1.2, "The Queue Directory"</A>). The date shows when this message was originally queued.The address shown is the name of the sender.</P><PCLASS="para">A second line may appeargiving a reason for failure (if there was one).A message may be queued intentionally or because it couldn't bedelivered. </P><PCLASS="para">The third and possibly subsequent lines show the addresses of the recipients.</P><PCLASS="para">The output produced by the <CODECLASS="literal">-bp</CODE> switch is more fully covered in <ACLASS="xref"HREF="ch23_01.htm"TITLE="The Queue">Chapter 23, <CITECLASS="chapter">The Queue</CITE></A>.&#13;</P></DIV><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="SML2-CH-4-SECT-1-3">4.1.3 Rebuild Aliases Mode (-bi)</A></H3><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-2338"></A><ACLASS="indexterm"NAME="AUTOID-2340"></A><ACLASS="indexterm"NAME="AUTOID-2343"></A><ACLASS="indexterm"NAME="AUTOID-2346"></A>Because <EMCLASS="emphasis">sendmail</EM> may have to search throughthousands of names in the <EMCLASS="emphasis">aliases</EM> file, a version of thefile is stored in a separate <EMCLASS="emphasis">dbm</EM>(3) or <EMCLASS="emphasis">db</EM>(3)database format file.The use of a database significantly improves lookup speed.</P><PCLASS="para">Although <EMCLASS="emphasis">sendmail</EM> can automatically update the databasewhenever the <EMCLASS="emphasis">aliases</EM> file is changed, there will be timeswhen you will want to rebuild it yourself.<ACLASS="indexterm"NAME="AUTOID-2355"></A>You do this either by running <EMCLASS="emphasis">sendmail</EM> usingthe command <EMCLASS="emphasis">newaliases</EM>or with the <CODECLASS="literal">-bi</CODE> command-line switch.The following two commands do the same thing:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen"><CODECLASS="literal">% </CODE><CODECLASS="userinput"><B>newaliases</B></CODE><CODECLASS="literal">% </CODE><CODECLASS="userinput"><B>/usr/lib/sendmail -bi</B></CODE></PRE></BLOCKQUOTE></P><PCLASS="para">There will be a delay while <EMCLASS="emphasis">sendmail</EM> rebuilds the<EMCLASS="emphasis">aliases</EM> database; then a summary of what it did is printed:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">/etc/aliases: 859 aliases, longest 615 bytes, 28096 bytes total</PRE></BLOCKQUOTE></P><PCLASS="para">This line shows that the databasewas successfully rebuilt. Beginning with V8.6 <EMCLASS="emphasis">sendmail</EM>, multiple alias filesbecame possible, so each line (and there might be many) begins with thename of an alias file. The information then displayed is the numberof aliases processed, the size of the biggest entryto the right of the <CODECLASS="literal">:</CODE> in the <EMCLASS="emphasis">aliases</EM> file, andthe total number of bytes entered into the database.Any mistakes in an alias file will also be printed here.</P><PCLASS="para">The <EMCLASS="emphasis">aliases</EM> file and how to manipulate it are covered in <ACLASS="xref"HREF="ch24_01.htm"TITLE="Aliases">Chapter 24, <CITECLASS="chapter">Aliases</CITE></A>.&#13;</P></DIV><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="SML2-CH-4-SECT-1-4">4.1.4 Verify Mode (-bv)</A></H3><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-2381"></A><ACLASS="indexterm"NAME="AUTOID-2383"></A><ACLASS="indexterm"NAME="AUTOID-2386"></A><ACLASS="indexterm"NAME="AUTOID-2389"></A>A handy tool for checking aliasesis the <CODECLASS="literal">-bv</CODE> command-line switch. It causes<EMCLASS="emphasis">sendmail</EM> to recursively look up an aliasand report the ultimate real namethat it found. </P><PCLASS="para">To illustrate, consider the following <EMCLASS="emphasis">aliases</EM> file:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen"><CODECLASS="literal">animals:      farmanimals,wildanimals</CODE><CODECLASS="literal">bill-eats:    redmeat</CODE><CODECLASS="literal">birds:        farmbirds,wildbirds</CODE><CODECLASS="literal">bob-eats:     seafood,whitemeat</CODE><CODECLASS="literal">farmanimals:  pig,cow</CODE><CODECLASS="literal">farmbirds:    chicken,turkey</CODE><CODECLASS="literal">fish:         cod,tuna</CODE><CODECLASS="literal">redmeat:      animals</CODE><CODECLASS="literal">seafood:      fish,shellfish</CODE><CODECLASS="literal">shellfish:    crab,lobster</CODE><CODECLASS="literal">ted-eats:     bob-eats,bill-eats</CODE><CODECLASS="literal">whitemeat:    birds</CODE><CODECLASS="literal">wildanimals:  deer,boar</CODE><CODECLASS="literal">wildbirds:    quail</CODE></PRE></BLOCKQUOTE></P><PCLASS="para">Although you can figure out what the name <CODECLASS="literal">ted-eats</CODE>ultimately expands to, it is far easier to have <EMCLASS="emphasis">sendmail</EM>do it for you. By using <EMCLASS="emphasis">sendmail</EM>, you have theadded advantage of being assured accuracy, which is especiallyimportant in large and complex <EMCLASS="emphasis">aliases</EM> files.</P><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-2418"></A><ACLASS="indexterm"NAME="AUTOID-2421"></A><ACLASS="indexterm"NAME="AUTOID-2424"></A>In addition to expanding aliases, the <CODECLASS="literal">-bv</CODE>switch performs another important function. It verifieswhether or not the expanded aliases are in fact deliverable.Consider the following one-line <EMCLASS="emphasis">aliases</EM> file:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">root:       fred,larry</PRE></BLOCKQUOTE></P><PCLASS="para">Assume that the user <CODECLASS="literal">fred</CODE> is the system administratorand has an account on the local machine. The user <CODECLASS="literal">larry</CODE>,however, has left, and his account has been removed. You canrun <EMCLASS="emphasis">sendmail</EM> with the <CODECLASS="literal">-bv</CODE>switch to find out whether both names are valid:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">% <CODECLASS="userinput"><B>/usr/lib/sendmail -bv root</B></CODE></PRE></BLOCKQUOTE></P><PCLASS="para">This tells <EMCLASS="emphasis">sendmail</EM> to verify the name <CODECLASS="literal">root</CODE>from the <EMCLASS="emphasis">aliases</EM> file. Since <CODECLASS="literal">larry</CODE> (one of <CODECLASS="literal">root</CODE>'saliases) doesn't exist, the output produced looks like this:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">larry... User unknownfred... deliverable: mailer local, user fred</PRE></BLOCKQUOTE></P><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-2449"></A></P></DIV></DIV></DIV><DIVCLASS="htmlnav"><P></P><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch03_05.htm"TITLE="3.5 Things to Try"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 3.5 Things to Try"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="book"HREF="index.htm"TITLE="sendmail"><IMGSRC="../gifs/txthome.gif"ALT="sendmail"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch04_02.htm"TITLE="4.2 Verbose (-v)"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 4.2 Verbose (-v)"BORDER="0"></A></TD></TR><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172">3.5 Things to Try</TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="index"HREF="index/idx_0.htm"TITLE="Book Index"><IMGSRC="../gifs/index.gif"ALT="Book Index"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172">4.2 Verbose (-v)</TD></TR></TABLE><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><PCLASS="nav"><FONTSIZE="-1">[ <AHREF="../index.htm"TITLE="The Networking CD Bookshelf">Library Home</A> | <AHREF="../dnsbind/index.htm"TITLE="DNS &amp; BIND">DNS &amp; BIND</A> | <AHREF="../tcpip/index.htm"TITLE="TCP/IP Network Administration">TCP/IP</A> | <AHREF="index.htm"TITLE="sendmail">sendmail</A> | <AHREF="../smdref/index.htm"TITLE="sendmail Desktop Reference">sendmail Reference</A> | <AHREF="../firewall/index.htm"TITLE="Building Internet Firewalls">Firewalls</A> | <AHREF="../puis/index.htm"TITLE="Practical UNIX &amp; Internet Security">Practical Security</A> ]</FONT></P></DIV></BODY></HTML>