<HTML><HEAD><TITLE>[Chapter 7] Macros</TITLE><METANAME="DC.title"CONTENT="sendmail"><METANAME="DC.creator"CONTENT="Bryan Costales &amp; Eric Allman"><METANAME="DC.publisher"CONTENT="O'Reilly &amp; Associates, Inc."><METANAME="DC.date"CONTENT="1999-01-06T18:35:10Z"><METANAME="DC.type"CONTENT="Text.Monograph"><METANAME="DC.format"CONTENT="text/html"SCHEME="MIME"><METANAME="DC.source"CONTENT="1-56592-222-0"SCHEME="ISBN"><METANAME="DC.language"CONTENT="en-US"><METANAME="generator"CONTENT="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><LINKREV="made"HREF="mailto:online-books@oreilly.com"TITLE="Online Books Comments"><LINKREL="up"HREF="part01.htm"TITLE="I. A Tutorial"><LINKREL="prev"HREF="ch06_05.htm"TITLE="6.5 Things to Try"><LINKREL="next"HREF="ch07_02.htm"TITLE="7.2 Defining Macros"></HEAD><BODYBGCOLOR="#FFFFFF"TEXT="#000000"><DIVCLASS="htmlnav"><H1><IMGSRC="gifs/smbanner.gif"ALT="sendmail"USEMAP="#srchmap"BORDER="0"></H1><MAPNAME="srchmap"><AREASHAPE="RECT"COORDS="0,0,466,65"HREF="index.htm"ALT="sendmail"><AREASHAPE="RECT"COORDS="467,0,514,18"HREF="../search/ssrch.htm"ALT="Search this book"></MAP><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch06_05.htm"TITLE="6.5 Things to Try"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 6.5 Things to Try"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><B><FONTFACE="ARIEL,HELVETICA,HELV,SANSERIF"SIZE="-1">Chapter 7</FONT></B></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch07_02.htm"TITLE="7.2 Defining Macros"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 7.2 Defining Macros"BORDER="0"></A></TD></TR></TABLE>&nbsp;<HRALIGN="LEFT"WIDTH="515"TITLE="footer"></DIV><DIVCLASS="CHAPTER"><H1CLASS="chapter"><ACLASS="title"NAME="SML2-CH-7">7. Macros</A></H1><DIVCLASS="htmltoc"><P><B>Contents:</B><BR><ACLASS="sect1"HREF="#SML2-CH-7-SECT-1"TITLE="7.1 Overview">Overview</A><BR><ACLASS="sect1"HREF="ch07_02.htm"TITLE="7.2 Defining Macros">Defining Macros</A><BR><ACLASS="sect1"HREF="ch07_03.htm"TITLE="7.3 Predefined Macros">Predefined Macros</A><BR><ACLASS="sect1"HREF="ch07_04.htm"TITLE="7.4 Things to Try">Things to Try</A></P><P></P></DIV><PCLASS="para"></P><PCLASS="para">One of the major strengths of the <EMCLASS="emphasis">sendmail.cf</EM> file is that it allowstext to be referenced symbolically. This is very similar to howvariables in the Bourne and C shells are used:<ACLASS="indexterm"NAME="SML2-CH-7-IX-MACROS"></A></P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">REMOTE=mailhost          <ICLASS="lineannotation"><IMGSRC="../chars/larr.gif"ALT="&lt;-"> Bourne shell</I>set REMOTE=mailhost      <ICLASS="lineannotation"><IMGSRC="../chars/larr.gif"ALT="&lt;-"> C shell</I>D{REMOTE}mailhost        <ICLASS="lineannotation"><IMGSRC="../chars/larr.gif"ALT="&lt;-"> sendmail.cf file</I></PRE></BLOCKQUOTE></P><PCLASS="para">The statements above all causea variable with the name <CODECLASS="literal">REMOTE</CODE>to be assigned the value <CODECLASS="literal">mailhost</CODE>. </P><PCLASS="para">The expression for using (referencing) the value storedin <CODECLASS="literal">REMOTE</CODE> is similar for all three:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">$REMOTE              <ICLASS="lineannotation"><IMGSRC="../chars/larr.gif"ALT="&lt;-"> Bourne shell</I>$REMOTE              <ICLASS="lineannotation"><IMGSRC="../chars/larr.gif"ALT="&lt;-"> C shell</I>${REMOTE}            <ICLASS="lineannotation"><IMGSRC="../chars/larr.gif"ALT="&lt;-"> sendmail.cf file</I></PRE></BLOCKQUOTE></P><PCLASS="para">That is, all of the above expressions yield the value stored in <CODECLASS="literal">REMOTE</CODE>,in this case the text <CODECLASS="literal">mailhost</CODE>.Once you define the value of <CODECLASS="literal">REMOTE</CODE> as <CODECLASS="literal">mailhost</CODE>,you can use the expression <CODECLASS="literal">${REMOTE}</CODE> anywhere youneed to use the text <CODECLASS="literal">mailhost</CODE>.&#13;</P><DIVCLASS="sect1"><H2CLASS="sect1"><ACLASS="title"NAME="SML2-CH-7-SECT-1">7.1 Overview</A></H2><PCLASS="para">Macros cangreatly simplify your work. They allow you to represent textsymbolically and to define it in one central place.Changes in that text are automatically propagated to the rest of the file. For example,consider the following definition in your <EMCLASS="emphasis">sendmail.cf</EM> file:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">D{REMOTE}mailhost</PRE></BLOCKQUOTE></P><PCLASS="para">&#13;If you use the expression <CODECLASS="literal">${REMOTE}</CODE> anywherein that file, a single change to the definitionof <CODECLASS="literal">D{REMOTE}mailhost</CODE> changes the value of <CODECLASS="literal">${REMOTE}</CODE> throughout the entire file.</P><PCLASS="para">Here is the format for defining macros:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">D<CODECLASS="replaceable"><I>Xtext</I></CODE></PRE></BLOCKQUOTE></P><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-4047"></A>The letter <CODECLASS="literal">D</CODE> must begin the line. The <CODECLASS="literal">D</CODE> is immediately followed bythe name of the macro, here<CODECLASS="literal">X</CODE>, with no intervening space. The nameis then followed (again with no intervening space) by thetext (value) for the macro's definition. The value is all the text up to the end of the line.[1]</P><BLOCKQUOTECLASS="footnote"><PCLASS="para">[1] Trailing whitespace is automatically stripped in V8.7 but not inearlier versions. Leadingwhitespace is not, so the <CODECLASS="literal">D</CODE>, name, and text must beright smack against each other.<ACLASS="indexterm"NAME="AUTOID-4055"></A></P></BLOCKQUOTE><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-4059"></A><ACLASS="indexterm"NAME="AUTOID-4061"></A><ACLASS="indexterm"NAME="AUTOID-4063"></A>Macros may have single-character names or multicharacternames. Multicharacter names <EMCLASS="emphasis">must</EM> always be enclosed incurly braces. Single-character names <EMCLASS="emphasis">may</EM> be enclosedin curly braces if you desire. Prior to V8.7 you could usesingle characters only without curly braces.</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">DRmailhost            <ICLASS="lineannotation"><IMGSRC="../chars/larr.gif"ALT="&lt;-"> single-character name (prior to V8.7)</I>D{R}mailhost          <ICLASS="lineannotation"><IMGSRC="../chars/larr.gif"ALT="&lt;-"> same beginning with V8.7</I>D{REMOTE}mailhost     <ICLASS="lineannotation"><IMGSRC="../chars/larr.gif"ALT="&lt;-"> multicharacter name (beginning with V8.7)</I></PRE></BLOCKQUOTE></P><PCLASS="para">Except for header and delivery agent configuration commands, [2]macros, in general, are expanded (the text replaces the symbol)when the configuration file is read. Consequently, you must definethem <EMCLASS="emphasis">before</EM> you use them:</P><BLOCKQUOTECLASS="footnote"><PCLASS="para">[2] And configuration commands for which macros make nosense and are ignored.</P></BLOCKQUOTE><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">D{ROLE}sonS${ROLE}                <ICLASS="lineannotation"><IMGSRC="../chars/larr.gif"ALT="&lt;-"> use the text value ``son''</I>D{ROLE}motherS${ROLE}                <ICLASS="lineannotation"><IMGSRC="../chars/larr.gif"ALT="&lt;-"> use the text value ``mother''</I></PRE></BLOCKQUOTE></P><PCLASS="para">Here, <CODECLASS="literal">ROLE</CODE> was first given the value <CODECLASS="literal">son</CODE>. When thefirst <CODECLASS="literal">S</CODE> command is processed, <EMCLASS="emphasis">sendmail</EM> replacesthe expression <CODECLASS="literal">${ROLE}</CODE> with its current value to form</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">Sson</PRE></BLOCKQUOTE></P><PCLASS="para">Then <CODECLASS="literal">ROLE</CODE> is redefined and given a different value,that of <CODECLASS="literal">mother</CODE>. The second <CODECLASS="literal">S</CODE> command is processed,and its <CODECLASS="literal">${ROLE}</CODE> is replaced with the new value:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">Smother</PRE></BLOCKQUOTE></P><PCLASS="para">Please note that this is very bad style. In general, each macro should be defined only once to avoid confusion.&#13;</P></DIV></DIV><DIVCLASS="htmlnav"><P></P><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch06_05.htm"TITLE="6.5 Things to Try"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 6.5 Things to Try"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="book"HREF="index.htm"TITLE="sendmail"><IMGSRC="../gifs/txthome.gif"ALT="sendmail"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch07_02.htm"TITLE="7.2 Defining Macros"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 7.2 Defining Macros"BORDER="0"></A></TD></TR><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172">6.5 Things to Try</TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="index"HREF="index/idx_0.htm"TITLE="Book Index"><IMGSRC="../gifs/index.gif"ALT="Book Index"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172">7.2 Defining Macros</TD></TR></TABLE><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><PCLASS="nav"><FONTSIZE="-1">[ <AHREF="../index.htm"TITLE="The Networking CD Bookshelf">Library Home</A> | <AHREF="../dnsbind/index.htm"TITLE="DNS &amp; BIND">DNS &amp; BIND</A> | <AHREF="../tcpip/index.htm"TITLE="TCP/IP Network Administration">TCP/IP</A> | <AHREF="index.htm"TITLE="sendmail">sendmail</A> | <AHREF="../smdref/index.htm"TITLE="sendmail Desktop Reference">sendmail Reference</A> | <AHREF="../firewall/index.htm"TITLE="Building Internet Firewalls">Firewalls</A> | <AHREF="../puis/index.htm"TITLE="Practical UNIX &amp; Internet Security">Practical Security</A> ]</FONT></P></DIV></BODY></HTML>