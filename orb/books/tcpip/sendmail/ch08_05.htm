<HTML><HEAD><TITLE>[Chapter 8] 8.5 The Workspace</TITLE><METANAME="DC.title"CONTENT="sendmail"><METANAME="DC.creator"CONTENT="Bryan Costales &amp; Eric Allman"><METANAME="DC.publisher"CONTENT="O'Reilly &amp; Associates, Inc."><METANAME="DC.date"CONTENT="1999-01-06T18:35:35Z"><METANAME="DC.type"CONTENT="Text.Monograph"><METANAME="DC.format"CONTENT="text/html"SCHEME="MIME"><METANAME="DC.source"CONTENT="1-56592-222-0"SCHEME="ISBN"><METANAME="DC.language"CONTENT="en-US"><METANAME="generator"CONTENT="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><LINKREV="made"HREF="mailto:online-books@oreilly.com"TITLE="Online Books Comments"><LINKREL="up"HREF="ch08_01.htm"TITLE="8. Addresses and Rules"><LINKREL="prev"HREF="ch08_04.htm"TITLE="8.4 Rules"><LINKREL="next"HREF="ch08_06.htm"TITLE="8.6 The Flow of Addresses Through Rules"></HEAD><BODYBGCOLOR="#FFFFFF"TEXT="#000000"><DIVCLASS="htmlnav"><H1><IMGSRC="gifs/smbanner.gif"ALT="sendmail"USEMAP="#srchmap"BORDER="0"></H1><MAPNAME="srchmap"><AREASHAPE="RECT"COORDS="0,0,466,65"HREF="index.htm"ALT="sendmail"><AREASHAPE="RECT"COORDS="467,0,514,18"HREF="../search/ssrch.htm"ALT="Search this book"></MAP><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch08_04.htm"TITLE="8.4 Rules"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 8.4 Rules"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><B><FONTFACE="ARIEL,HELVETICA,HELV,SANSERIF"SIZE="-1">Chapter 8<BR>Addresses and Rules</FONT></B></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch08_06.htm"TITLE="8.6 The Flow of Addresses Through Rules"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 8.6 The Flow of Addresses Through Rules"BORDER="0"></A></TD></TR></TABLE>&nbsp;<HRALIGN="LEFT"WIDTH="515"TITLE="footer"></DIV><DIVCLASS="SECT1"><H2CLASS="sect1"><ACLASS="title"NAME="SML2-CH-8-SECT-5">8.5 The Workspace</A></H2><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-4797"></A><ACLASS="indexterm"NAME="AUTOID-4800"></A>Whether the LHS test is true or false is determined by makingcomparisons.When an address is processed by a rule set for rewriting,<EMCLASS="emphasis">sendmail</EM> first tokenizes it, then stores those tokens internally in a buffercalled the <EMCLASS="emphasis">workspace</EM>:<ACLASS="indexterm"NAME="AUTOID-4804"></A><ACLASS="indexterm"NAME="AUTOID-4808"></A><ACLASS="indexterm"NAME="AUTOID-4812"></A></P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">&quot;gw&quot; &quot;@&quot; &quot;wash&quot; &quot;.&quot; &quot;gov&quot;  <ICLASS="lineannotation"><IMGSRC="../chars/larr.gif"ALT="&lt;-"> in the workspace</I></PRE></BLOCKQUOTE></P><PCLASS="para">When the LHS of a rule is evaluated, it too is tokenized; thenthose tokens are compared to the tokens in the workspace. If boththe workspace and the LHS contain exactly the same tokens, a matchis found, and the result of the LHS comparison is true.Now, for illustration, create a demo rule bytemporarily adding the following two lines to the endof the <EMCLASS="emphasis">client.cf</EM> file:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">S0Rleft.side     new.stuff</PRE></BLOCKQUOTE></P><PCLASS="para">Don't forget that the LHS is separated from the RHSby tab characters.Now run <EMCLASS="emphasis">sendmail</EM> in rule-testing mode, just as you did before:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">% <CODECLASS="userinput"><B>./sendmail  -Cclient.cf -bt</B></CODE>ADDRESS TEST MODE (ruleset 3 NOT automatically invoked)Enter &lt;ruleset&gt; &lt;address&gt;&gt;</PRE></BLOCKQUOTE></P><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-4827"></A>In rule-testing mode you can view rules with the <CODECLASS="literal">=S</CODE> command(see <ACLASS="xref"HREF="ch38_04.htm#SML2-CH-38-SECT-4-1"TITLE="Show Rules in a Rule Set with =S">Section 38.4.1, "Show Rules in a Rule Set with =S"</A>).[7]Try it now:</P><BLOCKQUOTECLASS="footnote"><PCLASS="para">[7] One of several brand-new <CODECLASS="literal">-bt</CODE> commands introduced with V8.7 <EMCLASS="emphasis">sendmail</EM>.</P></BLOCKQUOTE><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">&gt; <CODECLASS="userinput"><B>=S 0</B></CODE>Rleft . side            new . stuff&gt;</PRE></BLOCKQUOTE></P><PCLASS="para">This shows that <EMCLASS="emphasis">sendmail</EM> found only one rule for rule set 0,the one we created.</P><PCLASS="para">Now enter rule set 0 and a typical email address at the prompt:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">&gt; <CODECLASS="userinput"><B>0 gw@wash.dc.gov</B></CODE>rewrite: ruleset  0   input: gw @ wash . dc . govrewrite: ruleset  0 returns: gw @ wash . dc . gov&gt;</PRE></BLOCKQUOTE></P><PCLASS="para">The address was not rewritten by the rule because the workspace and the LHSdid not exactly match:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">gw@wash.dc.gov               <ICLASS="lineannotation"><IMGSRC="../chars/larr.gif"ALT="&lt;-"> the workspace</I>      <IMGSRC="../chars/uarr.gif"ALT="-^">      <ICLASS="lineannotation">don't match</I>      <IMGSRC="../chars/darr.gif"ALT="-v">Rleft.side     new.stuff     <ICLASS="lineannotation"><IMGSRC="../chars/larr.gif"ALT="&lt;-"> the rule</I></PRE></BLOCKQUOTE></P><PCLASS="para">Now, at the prompt, enter the exact text that appears in theLHS of the demo rule:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">&gt; <CODECLASS="userinput"><B>0 left.side</B></CODE>rewrite: ruleset  0   input: left . siderewrite: ruleset  0 returns: new . stuff</PRE></BLOCKQUOTE></P><PCLASS="para">An amazing thing has happened. The rule has actually rewritten anaddress. The address <CODECLASS="literal">left.side</CODE> was given to rule set 0and rewritten by the rule in that rule set to become the address<CODECLASS="literal">new.stuff</CODE>.This transformation is possible because the workspace and theLHS exactly match each other, so the result of the LHScomparison is true:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">left.side         <ICLASS="lineannotation"><IMGSRC="../chars/larr.gif"ALT="&lt;-"> the workspace</I>      <IMGSRC="../chars/uarr.gif"ALT="-^">      <ICLASS="lineannotation">exact match, so: ``true''</I>      <IMGSRC="../chars/darr.gif"ALT="-v">Rleft.side     new.stuff      <ICLASS="lineannotation"><IMGSRC="../chars/uarr.gif"ALT="-^">           <IMGSRC="../chars/uarr.gif"ALT="-^"></I>      <ICLASS="lineannotation">if true,      then do this</I></PRE></BLOCKQUOTE></P><PCLASS="para">&#13;Before leaving this demo rule set, perform one final experiment.Enter the uppercase text <CODECLASS="literal">LEFT.SIDE</CODE>:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">&gt; <CODECLASS="userinput"><B>0 LEFT.SIDE</B></CODE>rewrite: ruleset  0   input: LEFT . SIDErewrite: ruleset  0 returns: new . stuff&gt;</PRE></BLOCKQUOTE></P><PCLASS="para">Notice that the workspace and the LHS are still considered to match, even thoughthey now differ by case. This illustrates that all comparisonsbetween the workspace and the LHS of rules are done in a case-insensitivemanner. This property enables rules to be written without the need to distinguish between uppercase andlowercase letters.&#13;</P></DIV><DIVCLASS="htmlnav"><P></P><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch08_04.htm"TITLE="8.4 Rules"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 8.4 Rules"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="book"HREF="index.htm"TITLE="sendmail"><IMGSRC="../gifs/txthome.gif"ALT="sendmail"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch08_06.htm"TITLE="8.6 The Flow of Addresses Through Rules"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 8.6 The Flow of Addresses Through Rules"BORDER="0"></A></TD></TR><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172">8.4 Rules</TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="index"HREF="index/idx_0.htm"TITLE="Book Index"><IMGSRC="../gifs/index.gif"ALT="Book Index"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172">8.6 The Flow of Addresses Through Rules</TD></TR></TABLE><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><PCLASS="nav"><FONTSIZE="-1">[ <AHREF="../index.htm"TITLE="The Networking CD Bookshelf">Library Home</A> | <AHREF="../dnsbind/index.htm"TITLE="DNS &amp; BIND">DNS &amp; BIND</A> | <AHREF="../tcpip/index.htm"TITLE="TCP/IP Network Administration">TCP/IP</A> | <AHREF="index.htm"TITLE="sendmail">sendmail</A> | <AHREF="../smdref/index.htm"TITLE="sendmail Desktop Reference">sendmail Reference</A> | <AHREF="../firewall/index.htm"TITLE="Building Internet Firewalls">Firewalls</A> | <AHREF="../puis/index.htm"TITLE="Practical UNIX &amp; Internet Security">Practical Security</A> ]</FONT></P></DIV></BODY></HTML>