<HTML><HEAD><TITLE>[Chapter 12] 12.2 The File Form of Class</TITLE><METANAME="DC.title"CONTENT="sendmail"><METANAME="DC.creator"CONTENT="Bryan Costales &amp; Eric Allman"><METANAME="DC.publisher"CONTENT="O'Reilly &amp; Associates, Inc."><METANAME="DC.date"CONTENT="1999-01-06T18:36:55Z"><METANAME="DC.type"CONTENT="Text.Monograph"><METANAME="DC.format"CONTENT="text/html"SCHEME="MIME"><METANAME="DC.source"CONTENT="1-56592-222-0"SCHEME="ISBN"><METANAME="DC.language"CONTENT="en-US"><METANAME="generator"CONTENT="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><LINKREV="made"HREF="mailto:online-books@oreilly.com"TITLE="Online Books Comments"><LINKREL="up"HREF="ch12_01.htm"TITLE="12. Class"><LINKREL="prev"HREF="ch12_01.htm"TITLE="12.1 The Class Command"><LINKREL="next"HREF="ch12_03.htm"TITLE="12.3 Things to Try"></HEAD><BODYBGCOLOR="#FFFFFF"TEXT="#000000"><DIVCLASS="htmlnav"><H1><IMGSRC="gifs/smbanner.gif"ALT="sendmail"USEMAP="#srchmap"BORDER="0"></H1><MAPNAME="srchmap"><AREASHAPE="RECT"COORDS="0,0,466,65"HREF="index.htm"ALT="sendmail"><AREASHAPE="RECT"COORDS="467,0,514,18"HREF="../search/ssrch.htm"ALT="Search this book"></MAP><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch12_01.htm"TITLE="12.1 The Class Command"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 12.1 The Class Command"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><B><FONTFACE="ARIEL,HELVETICA,HELV,SANSERIF"SIZE="-1">Chapter 12<BR>Class</FONT></B></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch12_03.htm"TITLE="12.3 Things to Try"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 12.3 Things to Try"BORDER="0"></A></TD></TR></TABLE>&nbsp;<HRALIGN="LEFT"WIDTH="515"TITLE="footer"></DIV><DIVCLASS="SECT1"><H2CLASS="sect1"><ACLASS="title"NAME="SML2-CH-12-SECT-2">12.2 The File Form of Class</A></H2><PCLASS="para"><ACLASS="indexterm"NAME="SML2-CH-12-IX-CLASSES-STORING-IN-FILES"></A><ACLASS="indexterm"NAME="SML2-CH-12-IX-FILES-STORING-CLASSES-IN"></A>It is not always possible or convenient to list the values fora class directly in the configuration file. Sometimes itmight be better to store values in files. Examples of this might be the following:</P><ULCLASS="itemizedlist"><LICLASS="listitem"><PCLASS="para">The names of hosts that are connected to the local machinevia UUCP. At some sites, such connections are createdand removed often, and it is undesirable to be constantlychanging the configuration file.</P></LI><LICLASS="listitem"><PCLASS="para">The names of hosts that are being moved from one location toanother. During a move, it is better to modify an externalfile while each hostname is changed and then to modify the configurationfile after all the moves have been done.</P></LI><LICLASS="listitem"><PCLASS="para">The alternative names for a machine may vary from machine to machine,yet a single configuration file may be shared among them. When sucha <EMCLASS="emphasis">boilerplate</EM> configuration file is centrally maintained(and distributed with <EMCLASS="emphasis">rdist</EM>(1), for example), names thatindicate the specialty roles of a machine should be external tothat file.</P></LI></UL><PCLASS="para">The <EMCLASS="emphasis">client.cf</EM> file lists two additional names forthe local host in the class <CODECLASS="literal">w</CODE>:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">Cw localhost printer1          # My other names.</PRE></BLOCKQUOTE></P><PCLASS="para">To make this configuration file more general,it would be better to store the host-specific name(<CODECLASS="literal">printer1</CODE>) in a separate file.To externalize words for a class list, you use the<CODECLASS="literal">F</CODE> configuration command. That command looks like this:<ACLASS="indexterm"NAME="AUTOID-6840"></A></P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">F<CODECLASS="replaceable"><I>w/path</I></CODE></PRE></BLOCKQUOTE></P><PCLASS="para">The <CODECLASS="literal">F</CODE> must begin a line. This tells <EMCLASS="emphasis">sendmail</EM> thatthis is a class definition, just like the <CODECLASS="literal">C</CODE> command that wejust illustrated. The name of the class (here <CODECLASS="literal">w</CODE>) mustimmediately follow the <CODECLASS="literal">F</CODE> with no intervening space.If the class name is multicharacter, it must be enclosed incurly braces.Optional space may separate the class name from the <CODECLASS="replaceable"><I>/path</I></CODE>.With the <CODECLASS="literal">C</CODE> command, a list of words follows the nameon the same line, but with the <CODECLASS="literal">F</CODE> command, the name of a <EMCLASS="emphasis">file</EM>follows.<ACLASS="indexterm"NAME="AUTOID-6855"></A><CODECLASS="replaceable"><I>/path</I></CODE> is the full pathname of a file.For demonstration purposes we will name that file <EMCLASS="emphasis">/etc/sendmail.cw</EM>.[1]</P><BLOCKQUOTECLASS="footnote"><PCLASS="para">[1] This is the path recommended by V8.7 and above <EMCLASS="emphasis">sendmail</EM>.</P></BLOCKQUOTE><PCLASS="para">Edit the <EMCLASS="emphasis">client.cf</EM> file and make two changes. Delete thename <CODECLASS="literal">printer1</CODE> from the <CODECLASS="literal">C</CODE> line and add a new<CODECLASS="literal">F</CODE> line:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">             <ICLASS="lineannotation">remove </I>printer1              <ICLASS="lineannotation"><IMGSRC="../chars/darr.gif"ALT="-v"></I>Cw localhost                   # My other names.<CODECLASS="userinput"><B>Fw/etc/sendmail.cw             # A file of other names       </B></CODE><ICLASS="lineannotation"><IMGSRC="../chars/larr.gif"ALT="&lt;-"> new</I></PRE></BLOCKQUOTE></P><PCLASS="para">The first class definition starts with the letter <CODECLASS="literal">C</CODE> andtells <EMCLASS="emphasis">sendmail</EM> to add the name <CODECLASS="literal">localhost</CODE> tothe list of words in the class <CODECLASS="literal">w</CODE>. The second line tells<EMCLASS="emphasis">sendmail</EM> to read the file named <EMCLASS="emphasis">/etc/sendmail.cw</EM>and to add the words in that file to the class <CODECLASS="literal">w</CODE>.Note that the name <CODECLASS="literal">w</CODE> is the same for each line. The <CODECLASS="literal">C</CODE>and <CODECLASS="literal">F</CODE> commands differ only in where the words are taken from.</P><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-6885"></A>Now run <EMCLASS="emphasis">sendmail</EM> and notice what happens when the file<EMCLASS="emphasis">/etc/sendmail.cw</EM> doesn't exist:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">% <CODECLASS="userinput"><B>./sendmail -Cclient.cf -bt</B></CODE>client.cf: line 7: fileclass: cannot open /etc/sendmail.cw: No such file or directoryADDRESS TEST MODE (ruleset 3 NOT automatically invoked)Enter &lt;ruleset&gt; &lt;address&gt;&gt;</PRE></BLOCKQUOTE></P><PCLASS="para">As you would expect, <EMCLASS="emphasis">sendmail</EM> prints an error message whenit fails to find the file. But as you might not expect, <EMCLASS="emphasis">sendmail</EM>prints the error warning and continues to run.</P><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-6896"></A><ACLASS="indexterm"NAME="AUTOID-6900"></A><ACLASS="indexterm"NAME="AUTOID-6903"></A>Because we are developing a generic configuration file, one that can be shared among many machines, we would prefer not to have an errorprinted if the file doesn't exist. We can suppress the error messageby adding a <CODECLASS="literal">-o</CODE> (for optional) switchto the <CODECLASS="literal">F</CODE> configuration command:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">Fw -o /etc/sendmail.cw         # A file of other names   <ICLASS="lineannotation"><IMGSRC="../chars/uarr.gif"ALT="-^"></I>   <ICLASS="lineannotation">new</I></PRE></BLOCKQUOTE></P><PCLASS="para">Now run <EMCLASS="emphasis">sendmail</EM> again and notice that the error message is gone:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">% <CODECLASS="userinput"><B>./sendmail -Cclient.cf -bt</B></CODE>ADDRESS TEST MODE (ruleset 3 NOT automatically invoked)Enter &lt;ruleset&gt; &lt;address&gt;&gt;</PRE></BLOCKQUOTE></P><PCLASS="para">But we still want the name <CODECLASS="literal">printer1</CODE>to be recognized as local. To do that, we need to either putit back into the <CODECLASS="literal">C</CODE> line that we just removed it from orput it into the file that doesn't exist yet, the <EMCLASS="emphasis">/etc/sendmail.cw</EM>file.</P><PCLASS="para">Create and edit the file <EMCLASS="emphasis">/etc/sendmail.cw</EM>. If you lack writepermission, create a file thatyou are permitted to write to (such as <EMCLASS="emphasis">/usr/tmp/sendmail.cw</EM>) and use itin the following examples and in the <EMCLASS="emphasis">client.cf</EM> file.Put this hostname into that file:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">printer1</PRE></BLOCKQUOTE></P><PCLASS="para">The next time you run <EMCLASS="emphasis">sendmail</EM>, it reads this fileand adds each word it sees to the class <CODECLASS="literal">w</CODE>.Run <EMCLASS="emphasis">sendmail</EM> in rule-testing mode again and verify thatfor yourself:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">% <CODECLASS="userinput"><B>./sendmail -Cclient.cf -bt</B></CODE>ADDRESS TEST MODE (ruleset 3 NOT automatically invoked)Enter &lt;ruleset&gt; &lt;address&gt;&gt; <CODECLASS="userinput"><B>$=w</B></CODE>here.us.edulocalhosthere[123.45.67.8]printer1</PRE></BLOCKQUOTE></P><PCLASS="para">Success! Now add some more names to the <EMCLASS="emphasis">sendmail.cw</EM> file.We will use bogus names just for demonstration purposes:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">         <ICLASS="lineannotation">add</I>         <ICLASS="lineannotation"><IMGSRC="../chars/darr.gif"ALT="-v"></I>printer1 <CODECLASS="userinput"><B>bogus</B></CODE><CODECLASS="userinput"><B>fake               </B></CODE><ICLASS="lineannotation"><IMGSRC="../chars/larr.gif"ALT="&lt;-"> add</I></PRE></BLOCKQUOTE></P><PCLASS="para">Run <EMCLASS="emphasis">sendmail</EM> again and notice that the name <CODECLASS="literal">bogus</CODE>is missing:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">% <CODECLASS="userinput"><B>./sendmail -Cclient.cf -bt</B></CODE>ADDRESS TEST MODE (ruleset 3 NOT automatically invoked)Enter &lt;ruleset&gt; &lt;address&gt;&gt; <CODECLASS="userinput"><B>$=w</B></CODE>here.us.edufakelocalhosthere[123.45.67.8]printer1</PRE></BLOCKQUOTE></P><PCLASS="para">Why is <CODECLASS="literal">bogus</CODE> missing? To answer this question,leap ahead to <ACLASS="xref"HREF="ch32_01.htm#SML2-CH-32-SECT-1"TITLE="Class Configuration Commands">Section 32.1, "Class Configuration Commands"</A>. But for now, just assumethat there may be only one word per line.<ACLASS="indexterm"NAME="AUTOID-6953"></A><ACLASS="indexterm"NAME="AUTOID-6954"></A>&#13;</P></DIV><DIVCLASS="htmlnav"><P></P><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch12_01.htm"TITLE="12.1 The Class Command"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 12.1 The Class Command"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="book"HREF="index.htm"TITLE="sendmail"><IMGSRC="../gifs/txthome.gif"ALT="sendmail"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch12_03.htm"TITLE="12.3 Things to Try"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 12.3 Things to Try"BORDER="0"></A></TD></TR><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172">12.1 The Class Command</TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="index"HREF="index/idx_0.htm"TITLE="Book Index"><IMGSRC="../gifs/index.gif"ALT="Book Index"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172">12.3 Things to Try</TD></TR></TABLE><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><PCLASS="nav"><FONTSIZE="-1">[ <AHREF="../index.htm"TITLE="The Networking CD Bookshelf">Library Home</A> | <AHREF="../dnsbind/index.htm"TITLE="DNS &amp; BIND">DNS &amp; BIND</A> | <AHREF="../tcpip/index.htm"TITLE="TCP/IP Network Administration">TCP/IP</A> | <AHREF="index.htm"TITLE="sendmail">sendmail</A> | <AHREF="../smdref/index.htm"TITLE="sendmail Desktop Reference">sendmail Reference</A> | <AHREF="../firewall/index.htm"TITLE="Building Internet Firewalls">Firewalls</A> | <AHREF="../puis/index.htm"TITLE="Practical UNIX &amp; Internet Security">Practical Security</A> ]</FONT></P></DIV></BODY></HTML>