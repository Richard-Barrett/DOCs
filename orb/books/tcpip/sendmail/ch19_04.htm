<HTML><HEAD><TITLE>[Chapter 19] 19.4 m4 Macros by Function</TITLE><METANAME="DC.title"CONTENT="sendmail"><METANAME="DC.creator"CONTENT="Bryan Costales &amp; Eric Allman"><METANAME="DC.publisher"CONTENT="O'Reilly &amp; Associates, Inc."><METANAME="DC.date"CONTENT="1999-01-06T19:14:44Z"><METANAME="DC.type"CONTENT="Text.Monograph"><METANAME="DC.format"CONTENT="text/html"SCHEME="MIME"><METANAME="DC.source"CONTENT="1-56592-222-0"SCHEME="ISBN"><METANAME="DC.language"CONTENT="en-US"><METANAME="generator"CONTENT="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><LINKREV="made"HREF="mailto:online-books@oreilly.com"TITLE="Online Books Comments"><LINKREL="up"HREF="ch19_01.htm"TITLE="19. V8 m4 Configuration"><LINKREL="prev"HREF="ch19_03.htm"TITLE="19.3 The Minimal mc File"><LINKREL="next"HREF="ch19_05.htm"TITLE="19.5 Pitfalls"></HEAD><BODYBGCOLOR="#FFFFFF"TEXT="#000000"><DIVCLASS="htmlnav"><H1><IMGSRC="gifs/smbanner.gif"ALT="sendmail"USEMAP="#srchmap"BORDER="0"></H1><MAPNAME="srchmap"><AREASHAPE="RECT"COORDS="0,0,466,65"HREF="index.htm"ALT="sendmail"><AREASHAPE="RECT"COORDS="467,0,514,18"HREF="../search/ssrch.htm"ALT="Search this book"></MAP><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch19_03.htm"TITLE="19.3 The Minimal mc File"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 19.3 The Minimal mc File"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><B><FONTFACE="ARIEL,HELVETICA,HELV,SANSERIF"SIZE="-1">Chapter 19<BR>V8 m4 Configuration</FONT></B></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch19_05.htm"TITLE="19.5 Pitfalls"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 19.5 Pitfalls"BORDER="0"></A></TD></TR></TABLE>&nbsp;<HRALIGN="LEFT"WIDTH="515"TITLE="footer"></DIV><DIVCLASS="SECT1"><H2CLASS="sect1"><ACLASS="title"NAME="SML2-CH-19-SECT-4">19.4 m4 Macros by Function</A></H2><PCLASS="para">The <EMCLASS="emphasis">m4</EM> technique uses a huge number of macros to accomplish the complextask of creating configuration files for all possible circumstances.Most are detailed in the reference section at the end of this chapter.Others are documented in chapters dedicated to particular subjects.Here, we summarize all <EMCLASS="emphasis">m4</EM> macros by classification or function.</P><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="SML2-CH-19-SECT-4-1">19.4.1 Options</A></H3><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-13726"></A><ACLASS="indexterm"NAME="AUTOID-13728"></A>Options may be set, unset, and changed in your <EMCLASS="emphasis">mc</EM> file withsimple <CODECLASS="literal">define</CODE> statements. For example, the followingline sets the location of the alias file and thus the<CODECLASS="literal">AliasFile</CODE> (<CODECLASS="literal">A</CODE>) option:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">define(`ALIAS_FILE', `nis:-N mail.aliases')</PRE></BLOCKQUOTE></P><PCLASS="para">Configuring options with the <EMCLASS="emphasis">m4</EM> technique is described in<ACLASS="xref"HREF="ch34_03.htm"TITLE="Configuring with V8 m4 Options">Section 34.3, "Configuring with V8 m4 Options"</A> (with the individual <EMCLASS="emphasis">m4</EM>option names listed in <ACLASS="xref"HREF="ch34_03.htm#SML2-CH-34-TAB-2"TITLE="All V8 m4 Options Ordered by m4 Name">Table 34.3</A> of that section).Options are described in general in <ACLASS="xref"HREF="ch34_01.htm"TITLE="Options">Chapter 34, <CITECLASS="chapter">Options</CITE></A>.</P></DIV><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="SML2-CH-19-SECT-4-2">19.4.2 Define Macros</A></H3><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-13745"></A>Defined macros may be declared in your <EMCLASS="emphasis">mc</EM> file. Those that areuseful are listed in <ACLASS="xref"HREF="ch31_08.htm#SML2-CH-31-TAB-4"TITLE="Macros Reserved with the m4 Technique">Table 31.5</A> of <ACLASS="xref"HREF="ch31_08.htm"TITLE="Macros with the m4 Technique">Section 31.8, "Macros with the m4 Technique"</A>.That section also describes the general technique of definingmacros via <EMCLASS="emphasis">m4</EM>. To illustrate, for example,</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">define(`BITNET_RELAY', `<CODECLASS="replaceable"><I>host.domain</I></CODE>')</PRE></BLOCKQUOTE></P><PCLASS="para">causes the value <CODECLASS="replaceable"><I>host.domain</I></CODE> to be assigned to the<CODECLASS="literal">$B</CODE> macro. Non-<EMCLASS="emphasis">m4</EM> specific defined macros can bedeclared with the LOCAL_CONFIG technique (see <ACLASS="xref"HREF="ch19_06.htm#SML2-CH-19-SECT-6-30"TITLE="">Section 19.6.30</A>).</P></DIV><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="SML2-CH-19-SECT-4-3">19.4.3 Rules and rule sets</A></H3><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-13763"></A><ACLASS="indexterm"NAME="AUTOID-13766"></A>The <EMCLASS="emphasis">m4</EM> technique allows custom rules and rule sets to be inserted ina variety of convenient ways. The complete list of <EMCLASS="emphasis">m4</EM> keywords thataffect rules is shown in <ACLASS="xref"HREF="ch19_04.htm#SML2-CH-19-TAB-4"TITLE="Rule and Rule Set Keywords">Table 19.5</A>.</P><TABLECLASS="table"><CAPTIONCLASS="table"><ACLASS="title"NAME="SML2-CH-19-TAB-4">Table 19.5: Rule and Rule Set Keywords</A></CAPTION><THEADCLASS="thead"><TRCLASS="row"VALIGN="TOP"><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Keyword</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1"></TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Sendmail Version</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Description </TH></TR></THEAD><TBODYCLASS="tbody"><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">LOCAL_CONFIG</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><ACLASS="xref"HREF="ch19_06.htm#SML2-CH-19-SECT-6-30"TITLE="">Section 19.6.30</A></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">V8.1 and above</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Add general information and rules</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">LOCAL_RULE_0</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><ACLASS="xref"HREF="ch19_06.htm#SML2-CH-19-SECT-6-32"TITLE="">Section 19.6.32</A></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">V8.1 and above</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Add rules to rule set 0</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">LOCAL_RULE_1</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><ACLASS="xref"HREF="ch19_06.htm#SML2-CH-19-SECT-6-34"TITLE="">Section 19.6.34</A></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">V8.1 and above</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Add rules to rule set 1</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">LOCAL_RULE_2</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><ACLASS="xref"HREF="ch19_06.htm#SML2-CH-19-SECT-6-34"TITLE="">Section 19.6.34</A></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">V8.1 and above</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Add rules to rule set 2</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">LOCAL_RULE_3</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><ACLASS="xref"HREF="ch19_06.htm#SML2-CH-19-SECT-6-35"TITLE="">Section 19.6.35</A></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">V8.1 and above</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Add rules to rule set 3</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">LOCAL_RULESETS</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><ACLASS="xref"HREF="ch19_06.htm#SML2-CH-19-SECT-6-36"TITLE="">Section 19.6.36</A></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">V8.8 and above</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Group local rules with others</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">LOCAL_NET_CONFIG</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><ACLASS="xref"HREF="ch19_06.htm#SML2-CH-19-SECT-6-37"TITLE="">Section 19.6.37</A></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">V8.6 and above</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Add rules for SMART_HOST</TD></TR></TBODY></TABLE><PCLASS="para">To illustrate, consider the following technique for adding a rule to rule set 0:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">LOCAL_RULE_0R$* &lt;@ $=w . $=m&gt; $*        $#local $: $1      @here.ourdomain</PRE></BLOCKQUOTE></P><PCLASS="para">Here, we add a rule to rule set 0 that accepts any address with a host partin the class <CODECLASS="literal">$=w</CODE> (see <ACLASS="xref"HREF="ch32_05.htm#SML2-CH-32-SECT-5-8"TITLE="">Section 32.5.8, $=w</A>) that is also in one of the localdomains as listed in the class <CODECLASS="literal">$=m</CODE> (see <ACLASS="xref"HREF="ch32_05.htm#SML2-CH-32-SECT-5-3"TITLE="">Section 32.5.3, $=m</A>) as local address.</P></DIV><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="SML2-CH-19-SECT-4-4">19.4.4 Masquerading</A></H3><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-13835"></A>Masquerading is the process of transforming the local hostname in addressesinto that of another host. This results in the mail message appearing tocome from that other host rather than from the local host. Masqueradingis most often used in domains where email is addressed to the domainrather than to individual hosts inside the domain.</P><PCLASS="para">Masquerading usually rewritesheader-sender addresses. Some <EMCLASS="emphasis">m4</EM> features allow you also to rewrite envelope addresses.The complete list of all definitions and features that affect masqueradingis shown in<ACLASS="xref"HREF="ch19_04.htm#SML2-CH-19-TAB-5"TITLE="Defines and Features Affecting Masquerading">Table 19.6</A>.</P><TABLECLASS="table"><CAPTIONCLASS="table"><ACLASS="title"NAME="SML2-CH-19-TAB-5">Table 19.6: Defines and Features Affecting Masquerading</A></CAPTION><THEADCLASS="thead"><TRCLASS="row"VALIGN="TOP"><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">What</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1"></TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Version</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Masquerade</TH></TR></THEAD><TBODYCLASS="tbody"><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">EXPOSED_USER</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><ACLASS="xref"HREF="ch19_06.htm#SML2-CH-19-SECT-6-4"TITLE="">Section 19.6.4, EXPOSED-USER</A></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">V8.6 and above</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">All but these</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">FEATURE(allmasquerade)</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><ACLASS="xref"HREF="ch19_06.htm#SML2-CH-19-SECT-6-6"TITLE="">Section 19.6.6</A></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">V8.2 and above</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">The recipient too</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">FEATURE(limited_masquerade)</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><ACLASS="xref"HREF="ch19_06.htm#SML2-CH-19-SECT-6-12"TITLE="">Section 19.6.12</A></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">V8.8 and above</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Only $=M hosts</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">FEATURE(masquerade_entire_domain)</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><ACLASS="xref"HREF="ch19_06.htm#SML2-CH-19-SECT-6-15"TITLE="">Section 19.6.15</A></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">V8.8 and above</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">All of a domain</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">FEATURE(masquerade_envelope)</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><ACLASS="xref"HREF="ch19_06.htm#SML2-CH-19-SECT-6-16"TITLE="">Section 19.6.16</A></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">V8.7 and above</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">The envelope too</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">MASQUERADE_AS</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><ACLASS="xref"HREF="ch19_06.htm#SML2-CH-19-SECT-6-42"TITLE="">Section 19.6.42</A></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">V8.6 and above</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Another host</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">MASQUERADE_DOMAIN</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><ACLASS="xref"HREF="ch19_06.htm#SML2-CH-19-SECT-6-43"TITLE="">Section 19.6.43, MASQUERADE-DOMAIN</A></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">V8.6 and above</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Other domains</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">MASQUERADE_DOMAIN_FILE</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><ACLASS="xref"HREF="ch19_06.htm#SML2-CH-19-SECT-6-44"TITLE="">Section 19.6.44, MASQUERADE-DOMAIN-FILE</A></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">V8.6 and above</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Other domains</TD></TR></TBODY></TABLE></DIV><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="SML2-CH-19-SECT-4-5">19.4.5 Relays</A></H3><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-13901"></A><ACLASS="indexterm"NAME="AUTOID-13903"></A><ACLASS="indexterm"NAME="AUTOID-13906"></A><ACLASS="indexterm"NAME="AUTOID-13909"></A>A relay is a rule that sends all of one type of mail to a specificdestination. One example would be email FAX transmissions.Clearly, even though local mail should be delivered locally, mail tothe pseudo-user <EMCLASS="emphasis">fax</EM> should always be sent to a special FAX-handling machine.</P><PCLASS="para">The complete list of relays supported by the V8 <EMCLASS="emphasis">sendmail</EM> <EMCLASS="emphasis">m4</EM>technique is shown in<ACLASS="xref"HREF="ch19_04.htm#SML2-CH-19-TAB-6"TITLE="Relays">Table 19.7</A>.</P><TABLECLASS="table"><CAPTIONCLASS="table"><ACLASS="title"NAME="SML2-CH-19-TAB-6">Table 19.7: Relays</A></CAPTION><THEADCLASS="thead"><TRCLASS="row"VALIGN="TOP"><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Relay</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1"></TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Version</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Description </TH></TR></THEAD><TBODYCLASS="tbody"><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">BITNET_RELAY</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><ACLASS="xref"HREF="ch31_10.htm#SML2-CH-31-SECT-10-5"TITLE="">Section 31.10.5, $B</A></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">V8.1 and above</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">The BITNET relay</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">DECNET_RELAY</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><ACLASS="xref"HREF="ch31_10.htm#SML2-CH-31-SECT-10-9"TITLE="">Section 31.10.9, $C</A></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">V8.7 and above</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">The DECnet relay</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">FAX_RELAY</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><ACLASS="xref"HREF="ch31_10.htm#SML2-CH-31-SECT-10-15"TITLE="">Section 31.10.15, $F</A></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">V8.6 and above</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">The FAX relay</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">LOCAL_RELAY</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><ACLASS="xref"HREF="ch19_06.htm#SML2-CH-19-SECT-6-31"TITLE="">Section 19.6.31, LOCAL-RELAY</A></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">V8.1 and above</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Relay for unqualified users</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">LUSER_RELAY</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><ACLASS="xref"HREF="ch31_10.htm#SML2-CH-31-SECT-10-23"TITLE="">Section 31.10.23, $L</A></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">V8.7 and above</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Relay for unknown local users</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">MAIL_HUB</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><ACLASS="xref"HREF="ch19_06.htm#SML2-CH-19-SECT-6-41"TITLE="">Section 19.6.41, MAIL-HUB</A></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">V8.6 and above</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">All local delivery on a central server</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">SMART_HOST</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><ACLASS="xref"HREF="ch19_06.htm#SML2-CH-19-SECT-6-47"TITLE="">Section 19.6.47, SMART-HOST</A></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">V8.6 and above</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">The ultimate relay</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">UUCP_RELAY</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><ACLASS="xref"HREF="ch19_06.htm#SML2-CH-19-SECT-6-48"TITLE="">Section 19.6.48, UUCP-RELAY</A></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">V8.1 and above</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">The UUCP relay</TD></TR></TBODY></TABLE><PCLASS="para">All relays are declared in the same fashion. For example,</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">define(`LOCAL_RELAY',`<CODECLASS="replaceable"><I>agent</I></CODE>:<CODECLASS="replaceable"><I>host</I></CODE>')</PRE></BLOCKQUOTE></P><PCLASS="para">Here, <CODECLASS="replaceable"><I>agent</I></CODE> is the name of a delivery agent to use, and <CODECLASS="replaceable"><I>host</I></CODE>is the name of the machine to which all such mail will be relayed.If <CODECLASS="replaceable"><I>agent</I></CODE><CODECLASS="literal">:</CODE> is missing, it defaults to a literal <CODECLASS="literal">relay:</CODE>.</P><PCLASS="para">If the <CODECLASS="replaceable"><I>host</I></CODE> is listed under a domain that uses wild-card MXrecords (see <ACLASS="xref"HREF="ch21_03.htm#SML2-CH-21-SECT-3-4"TITLE="Wildcard MX Records">Section 21.3.4, "Wildcard MX Records"</A>), you should specify itwith a trailing dot; for example,</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">define(`LOCAL_RELAY', `smtp:relay.sub.domain.')                                            <ICLASS="lineannotation"><IMGSRC="../chars/uarr.gif"ALT="-^"></I>                                        <ICLASS="lineannotation">trailing dot</I></PRE></BLOCKQUOTE></P><PCLASS="para">Relays fit into the flow of rules through rule set 0 like this:</P><BLOCKQUOTECLASS="blockquote"><PCLASS="para"><OLCLASS="orderedlist"><LICLASS="listitem"><PCLASS="para"><EMCLASS="emphasis">1.</EM> Basic canonicalization (list syntax, delete local host, etc.)</P></LI><LICLASS="listitem"><PCLASS="para"><EMCLASS="emphasis">1.</EM> Basic canonicalization (list syntax, delete local host, etc.)</P></LI><LICLASS="listitem"><PCLASS="para"><EMCLASS="emphasis">1.</EM> Basic canonicalization (list syntax, delete local host, etc.)</P></LI><LICLASS="listitem"><PCLASS="para"><EMCLASS="emphasis">2.</EM> LOCAL_RULE_0 (see <ACLASS="xref"HREF="ch19_06.htm#SML2-CH-19-SECT-6-32"TITLE="">Section 19.6.32</A>) </P></LI><LICLASS="listitem"><PCLASS="para"><EMCLASS="emphasis">3.</EM> FEATURE(mailertable) (see <ACLASS="xref"HREF="ch19_06.htm#SML2-CH-19-SECT-6-14"TITLE="">Section 19.6.14</A>)</P></LI><LICLASS="listitem"><PCLASS="para"><EMCLASS="emphasis">4.</EM> UUCP_RELAY, BITNET_RELAY, FAX_RELAY, DECNET_RELAY</P></LI><LICLASS="listitem"><PCLASS="para"><EMCLASS="emphasis">5.</EM> LOCAL_NET_CONFIG (see <ACLASS="xref"HREF="ch19_06.htm#SML2-CH-19-SECT-6-37"TITLE="">Section 19.6.37</A>)</P></LI><LICLASS="listitem"><PCLASS="para"><EMCLASS="emphasis">6.</EM> SMART_HOST</P></LI><LICLASS="listitem"><PCLASS="para"><EMCLASS="emphasis">7.</EM> SMTP, local, etc. delivery agents</P></LI></OL></P></BLOCKQUOTE></DIV><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="SML2-CH-19-SECT-4-6">19.4.6 UUCP</A></H3><PCLASS="para"><ACLASS="indexterm"NAME="SML2-CH-19-IX-UUCP-M4-CONFIGURATION-OPTIONS"></A>The <EMCLASS="emphasis">m4</EM> configuration technique includes fourUUCP options to choose from.They are listed in<ACLASS="xref"HREF="ch19_04.htm#SML2-CH-19-TAB-7"TITLE="UUCP Support">Table 19.8</A>.</P><TABLECLASS="table"><CAPTIONCLASS="table"><ACLASS="title"NAME="SML2-CH-19-TAB-7">Table 19.8: UUCP Support</A></CAPTION><THEADCLASS="thead"><TRCLASS="row"VALIGN="TOP"><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Relay</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1"></TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Version</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Description </TH></TR></THEAD><TBODYCLASS="tbody"><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">SITE</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><ACLASS="xref"HREF="ch19_06.htm#SML2-CH-19-SECT-6-45"TITLE="">Section 19.6.45, SITE</A></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">V8.1 and above</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Declare sites for SITECONFIG (obsolete)</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">SITECONFIG</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><ACLASS="xref"HREF="ch19_06.htm#SML2-CH-19-SECT-6-46"TITLE="">Section 19.6.46, SITECONFIG</A></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">V8.1 and above</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Local UUCP connections (obsolete)</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">UUCP_RELAY</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><ACLASS="xref"HREF="ch19_06.htm#SML2-CH-19-SECT-6-48"TITLE="">Section 19.6.48</A></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">V8.1 and above</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">The UUCP relay</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">UUCPSMTP</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><ACLASS="xref"HREF="ch19_06.htm#SML2-CH-19-SECT-6-49"TITLE="">Section 19.6.49, UUCPSMTP</A></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">V8.1 and above</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Individual UUCP to network translations</TD></TR></TBODY></TABLE><PCLASS="para">Note that two items in the table are marked as obsolete. This is becauseall of their functions have been moved into the <CODECLASS="literal">mailertable</CODE> feature(see <ACLASS="xref"HREF="ch19_06.htm#SML2-CH-19-SECT-6-14"TITLE="">Section 19.6.14</A>). They are included for backwardcompatibility with early configuration file versions.</P><PCLASS="para">Support for UUCP can be included in your <EMCLASS="emphasis">mc</EM> file with the MAILERcommand (see <ACLASS="xref"HREF="ch19_03.htm#SML2-CH-19-SECT-3-2"TITLE="MAILER()">Section 19.3.2</A>):</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">MAILER(uucp)</PRE></BLOCKQUOTE></P><PCLASS="para">This declares six[3]delivery agents and the rules to support them. They arelisted in<ACLASS="xref"HREF="ch19_04.htm#SML2-CH-19-TAB-8"TITLE="UUCP Delivery Agents">Table 19.9</A>.<ACLASS="indexterm"NAME="AUTOID-14086"></A></P><BLOCKQUOTECLASS="footnote"><PCLASS="para">[3] Actually, there are only four; <CODECLASS="literal">uucp</CODE> and <CODECLASS="literal">uucp-old</CODE> are synonymsfor the same agents, as are <CODECLASS="literal">suucp</CODE> and <CODECLASS="literal">uucp-new</CODE>.</P></BLOCKQUOTE><TABLECLASS="table"><CAPTIONCLASS="table"><ACLASS="title"NAME="SML2-CH-19-TAB-8">Table 19.9: UUCP Delivery Agents</A></CAPTION><THEADCLASS="thead"><TRCLASS="row"VALIGN="TOP"><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Agent</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1"></TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Version</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Description </TH></TR></THEAD><TBODYCLASS="tbody"><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><CODECLASS="literal">uucp-old</CODE></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><ACLASS="xref"HREF="ch19_04.htm#SML2-CH-19-SECT-4-6-1"TITLE="uucp-old (aka uucp)">Section 19.4.6.1, "uucp-old (aka uucp)"</A></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">V8.6 and above</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Old-style, all ! form of UUCP</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><CODECLASS="literal">uucp</CODE></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><ACLASS="xref"HREF="ch19_04.htm#SML2-CH-19-SECT-4-6-1"TITLE="uucp-old (aka uucp)">Section 19.4.6.1</A></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">V8.1 and above</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Synonym for the above (obsolete)</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><CODECLASS="literal">uucp-new</CODE></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><ACLASS="xref"HREF="ch19_04.htm#SML2-CH-19-SECT-4-6-2"TITLE="uucp-new (aka suucp)">Section 19.4.6.2, "uucp-new (aka suucp)"</A></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">V8.6 and above</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Old-style with multiple recipients</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><CODECLASS="literal">suucp</CODE></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><ACLASS="xref"HREF="ch19_04.htm#SML2-CH-19-SECT-4-6-2"TITLE="uucp-new (aka suucp)">Section 19.4.6.2</A></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">V8.1 and above</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Synonym for the above (obsolete)</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><CODECLASS="literal">uucp-uudom</CODE></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><ACLASS="xref"HREF="ch19_04.htm#SML2-CH-19-SECT-4-6-3"TITLE="uucp-uudom">Section 19.4.6.3, "uucp-uudom"</A></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">V8.6 and above</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Domain-form headers, old-form envelope</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">uucp-dom</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><ACLASS="xref"HREF="ch19_04.htm#SML2-CH-19-SECT-4-6-4"TITLE="uucp-dom">Section 19.4.6.4, "uucp-dom"</A></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">V8.6 and above</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Domain-form headers and envelope</TD></TR></TBODY></TABLE><PCLASS="para">If support for SMTP delivery agents is also included prior toUUCP, then the last two additional delivery agents are included (<CODECLASS="literal">uucp-dom</CODE>and <CODECLASS="literal">uucp-uudom</CODE>). Note that <CODECLASS="literal">smtp</CODE> must be first for this to happen:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">MAILER(smtp)MAILER(uucp)</PRE></BLOCKQUOTE></P><PCLASS="para">If <CODECLASS="literal">uucp</CODE> is first, <CODECLASS="literal">uucp-dom</CODE> and <CODECLASS="literal">uucp-uudom</CODE> are excluded.</P><PCLASS="para">When processing UUCP mail (addresses that contain a <CODECLASS="literal">!</CODE> and thosethat end in a .UUCP suffix), <EMCLASS="emphasis">sendmail</EM> routes to those hostson the basis of the class in which they were found. Hosts that are found in <CODECLASS="literal">$=U</CODE> deliver via <CODECLASS="literal">uucp-old</CODE>,hosts in <CODECLASS="literal">$=Y</CODE> deliver via <CODECLASS="literal">uucp-new</CODE>, andhosts in <CODECLASS="literal">$=Z</CODE> deliver via <CODECLASS="literal">uucp-uudom</CODE>.</P><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-14160"></A>The choice of which delivery agent to use for UUCP delivery is under the controlof the SITECONFIG <EMCLASS="emphasis">m4</EM> macro described above (see <ACLASS="xref"HREF="ch19_06.htm#SML2-CH-19-SECT-6-46"TITLE="">Section 19.6.46</A>).Which you choose depends on what version of UUCP you are running locallyand what version is being run at the other end of the connection. There are fartoo many variations on UUCP to allow specific recommendations here.In general, you need to choose between a domain form of address (<EMCLASS="emphasis">gw@wash.dc.gov</EM>) and  a UUCP form (<EMCLASS="emphasis">wash!gw</EM>) and then go with the delivery agentthat makes the most sense for you.We recommend that you start with the most domain-correct agent, <CODECLASS="literal">uucp-dom</CODE>, andsee if it works for you. If not, scale back to <CODECLASS="literal">uucp-uudom</CODE>, then to <CODECLASS="literal">uucp-new</CODE>and finally to <CODECLASS="literal">uucp-old</CODE> as a last resort.</P><DIVCLASS="sect3"><H4CLASS="sect3"><ACLASS="title"NAME="SML2-CH-19-SECT-4-6-1">19.4.6.1 uucp-old (aka uucp)</A></H4><PCLASS="para">If you are running an old version of UUCP, you may have to use thisdelivery agent. All addresses are turned into the <CODECLASS="literal">!</CODE> form even ifthey were in domain form:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">user                <ICLASS="lineannotation"><IMGSRC="../chars/rarr.gif"ALT="-&gt;"> becomes <IMGSRC="../chars/rarr.gif"ALT="-&gt;"></I>      yourhost!useruser@host.domain    <ICLASS="lineannotation"><IMGSRC="../chars/rarr.gif"ALT="-&gt;"> becomes <IMGSRC="../chars/rarr.gif"ALT="-&gt;"></I>      yourhost!host.domain!user</PRE></BLOCKQUOTE></P><PCLASS="para">This delivery agent can deliver only to one recipient at a time, soit can spend a lot of time transmitting duplicate messages.If at all possible, avoid using this delivery agent.</P></DIV><DIVCLASS="sect3"><H4CLASS="sect3"><ACLASS="title"NAME="SML2-CH-19-SECT-4-6-2">19.4.6.2 uucp-new (aka suucp)</A></H4><PCLASS="para">Newer releases of UUCP can send to multiple recipients at once.If yours is such a release, you may use the <CODECLASS="literal">uucp-new</CODE> deliveryagent. It is just like <CODECLASS="literal">uucp-old</CODE> except thatit can perform multiple deliveries.</P></DIV><DIVCLASS="sect3"><H4CLASS="sect3"><ACLASS="title"NAME="SML2-CH-19-SECT-4-6-3">19.4.6.3 uucp-uudom</A></H4><PCLASS="para">More modern implementations of UUCP can understand and correctlyhandle domain style addresses in headers (although they stillrequire the <CODECLASS="literal">!</CODE> form in the envelope). If yours is such an implementation,you may use the <CODECLASS="literal">uucp-uudom</CODE> delivery agent.</P><PCLASS="para">At the receiving end, the message mail arrives with the five character &quot;<CODECLASS="literal">From </CODE>&quot;line showing the sender address in the <CODECLASS="literal">!</CODE> form. The &quot;<CODECLASS="literal">From </CODE>&quot; linereflects the envelope address.</P></DIV><DIVCLASS="sect3"><H4CLASS="sect3"><ACLASS="title"NAME="SML2-CH-19-SECT-4-6-4">19.4.6.4 uucp-dom</A></H4><PCLASS="para">The <CODECLASS="literal">uucp-dom</CODE> is the most domain-correct form of the availableUUCP delivery agents. All addresses, envelope and header, no matter whether or not they began in the <CODECLASS="literal">!</CODE> form, are sent out in domain form.Essentially, this uses UUCP as a transport mechanism, but in all other respects itadheres to the Internet standards.<ACLASS="indexterm"NAME="AUTOID-14198"></A></P></DIV></DIV></DIV><DIVCLASS="htmlnav"><P></P><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch19_03.htm"TITLE="19.3 The Minimal mc File"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 19.3 The Minimal mc File"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="book"HREF="index.htm"TITLE="sendmail"><IMGSRC="../gifs/txthome.gif"ALT="sendmail"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch19_05.htm"TITLE="19.5 Pitfalls"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 19.5 Pitfalls"BORDER="0"></A></TD></TR><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172">19.3 The Minimal mc File</TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="index"HREF="index/idx_0.htm"TITLE="Book Index"><IMGSRC="../gifs/index.gif"ALT="Book Index"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172">19.5 Pitfalls</TD></TR></TABLE><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><PCLASS="nav"><FONTSIZE="-1">[ <AHREF="../index.htm"TITLE="The Networking CD Bookshelf">Library Home</A> | <AHREF="../dnsbind/index.htm"TITLE="DNS &amp; BIND">DNS &amp; BIND</A> | <AHREF="../tcpip/index.htm"TITLE="TCP/IP Network Administration">TCP/IP</A> | <AHREF="index.htm"TITLE="sendmail">sendmail</A> | <AHREF="../smdref/index.htm"TITLE="sendmail Desktop Reference">sendmail Reference</A> | <AHREF="../firewall/index.htm"TITLE="Building Internet Firewalls">Firewalls</A> | <AHREF="../puis/index.htm"TITLE="Practical UNIX &amp; Internet Security">Practical Security</A> ]</FONT></P></DIV></BODY></HTML>