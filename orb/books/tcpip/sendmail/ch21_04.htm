<HTML><HEAD><TITLE>[Chapter 21] 21.4 How to Use nslookup</TITLE><METANAME="DC.title"CONTENT="sendmail"><METANAME="DC.creator"CONTENT="Bryan Costales &amp; Eric Allman"><METANAME="DC.publisher"CONTENT="O'Reilly &amp; Associates, Inc."><METANAME="DC.date"CONTENT="1999-01-06T19:28:29Z"><METANAME="DC.type"CONTENT="Text.Monograph"><METANAME="DC.format"CONTENT="text/html"SCHEME="MIME"><METANAME="DC.source"CONTENT="1-56592-222-0"SCHEME="ISBN"><METANAME="DC.language"CONTENT="en-US"><METANAME="generator"CONTENT="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><LINKREV="made"HREF="mailto:online-books@oreilly.com"TITLE="Online Books Comments"><LINKREL="up"HREF="ch21_01.htm"TITLE="21. DNS and sendmail"><LINKREL="prev"HREF="ch21_03.htm"TITLE="21.3 Set Up MX Records"><LINKREL="next"HREF="ch21_05.htm"TITLE="21.5 Prepare for Disaster"></HEAD><BODYBGCOLOR="#FFFFFF"TEXT="#000000"><DIVCLASS="htmlnav"><H1><IMGSRC="gifs/smbanner.gif"ALT="sendmail"USEMAP="#srchmap"BORDER="0"></H1><MAPNAME="srchmap"><AREASHAPE="RECT"COORDS="0,0,466,65"HREF="index.htm"ALT="sendmail"><AREASHAPE="RECT"COORDS="467,0,514,18"HREF="../search/ssrch.htm"ALT="Search this book"></MAP><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch21_03.htm"TITLE="21.3 Set Up MX Records"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 21.3 Set Up MX Records"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><B><FONTFACE="ARIEL,HELVETICA,HELV,SANSERIF"SIZE="-1">Chapter 21<BR>DNS and sendmail</FONT></B></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch21_05.htm"TITLE="21.5 Prepare for Disaster"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 21.5 Prepare for Disaster"BORDER="0"></A></TD></TR></TABLE>&nbsp;<HRALIGN="LEFT"WIDTH="515"TITLE="footer"></DIV><DIVCLASS="SECT1"><H2CLASS="sect1"><ACLASS="title"NAME="SML2-CH-21-SECT-4">21.4 How to Use nslookup</A></H2><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-17800"></A>If your site is connected to the Internet, you can use the<EMCLASS="emphasis">nslookup</EM>(1) program to interactively find MX and other records.To run <EMCLASS="emphasis">nslookup</EM>, just type its name:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">% <CODECLASS="userinput"><B>nslookup</B></CODE></PRE></BLOCKQUOTE></P><PCLASS="para">Note that you may have to give the full pathname.Under SunOS, <EMCLASS="emphasis">nslookup</EM> lives in the <EMCLASS="emphasis">/usr/etc</EM> directory; underUltrix, in <EMCLASS="emphasis">/usr/ucb</EM>; and under HP-UX,in <EMCLASS="emphasis">/usr/bin</EM>.</P><PCLASS="para">Once <EMCLASS="emphasis">nslookup</EM> is running, it prints the name of your default name serverand the IP address for that machine, then a <CODECLASS="literal">&gt;</CODE>character as a prompt and awaits input:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">Server:  Your.Main.ServerAddress:  123.45.67.8&gt;</PRE></BLOCKQUOTE></P><PCLASS="para">To tell <EMCLASS="emphasis">nslookup</EM> to look up only MX records,[14]use the <EMCLASS="emphasis">set</EM> command:</P><BLOCKQUOTECLASS="footnote"><PCLASS="para">[14] Beginning with V8.7 <EMCLASS="emphasis">sendmail</EM>, you can also use the <CODECLASS="literal">/mx</CODE> commandin <CODECLASS="literal">-bt</CODE> rule-testing mode (see <ACLASS="xref"HREF="ch38_05.htm#SML2-CH-38-SECT-5-2"TITLE="Look Up MX Records with /mx">Section 38.5.2, "Look Up MX Records with /mx"</A>) to look upMX records.</P></BLOCKQUOTE><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">&gt; <CODECLASS="userinput"><B>set type=mx</B></CODE>&gt;</PRE></BLOCKQUOTE></P><PCLASS="para">&#13;Now look up some real hosts and domains. First lookup the domain <EMCLASS="emphasis">sendmail.org</EM>by entering its name at the prompt:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">&gt; <CODECLASS="userinput"><B>sendmail.org.</B></CODE></PRE></BLOCKQUOTE></P><PCLASS="para">Note the trailing dot that tells <EMCLASS="emphasis">nslookup</EM>(1) that the local,default domain should not be appended prior to the lookup.The output produced by the above lookup looks like this:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">&gt; <CODECLASS="userinput"><B>sendmail.org.</B></CODE>Server:  Address:  123.45.67.8sendmail.org    preference = 20, mail exchanger = mail1.reference.comsendmail.org    preference = 30, mail exchanger = mail2.reference.comsendmail.org    preference = 10, mail exchanger = knecht.oxford.reference.commail1.reference.com     inet address = 206.171.3.24mail2.reference.com     inet address = 128.102.240.18knecht.oxford.reference.com     inet address = 204.247.98.2&gt;</PRE></BLOCKQUOTE></P><PCLASS="para">The first two lines again show the name and IP address of thelocal DNS server. The next three lines show thatthe domain <CODECLASS="literal">sendmail.org</CODE> has three MX records. Mail addressed to that domain is sentto the machine with the lowest preference (cost), which happens tobe <CODECLASS="literal">knecht.oxford.reference.com</CODE>.[15]If that machine is down (or not accepting mail), the messageis sent to the machine with the next higher cost,<CODECLASS="literal">mail1.reference.com</CODE>. The last three lines showthe IP addresses (A records) for those machines.</P><BLOCKQUOTECLASS="footnote"><PCLASS="para">[15] Note that case is not significant in domain names; all ofthe following are the same: <CODECLASS="literal">org</CODE>, <CODECLASS="literal">OrG</CODE>, <CODECLASS="literal">ORG</CODE>.</P></BLOCKQUOTE><PCLASS="para">Now look up a real UUCP host, <EMCLASS="emphasis">lady</EM>. Enter itsname as if it were a part of the <EMCLASS="emphasis">icsi.berkeley.edu</EM> domain:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">&gt; <CODECLASS="userinput"><B>lady.icsi.berkeley.edu.</B></CODE></PRE></BLOCKQUOTE></P><PCLASS="para">The output produced shows that <EMCLASS="emphasis">lady</EM> has an MX record:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">lady.icsi.berkeley.edu   preference = 5, mail exchanger = icsib.ICSI.Berkeley.EDUicsib.ICSI.Berkeley.EDU inet address = 128.32.201.15&gt;</PRE></BLOCKQUOTE></P><PCLASS="para">Mail sent to <CODECLASS="literal">lady.icsi.berkeley.edu</CODE> is instead delivered to themachine named <CODECLASS="literal">icsib.ICSI.Berkeley.EDU</CODE>, which in turn forwardsthat mail over a dial-up line to the UUCP host <EMCLASS="emphasis">lady</EM>.</P><PCLASS="para">&#13;Machines that have MX records do not necessarily have A records.The host <EMCLASS="emphasis">lady</EM> is such a machine.You tell <EMCLASS="emphasis">nslookup</EM>(1) to look up an A record with the<EMCLASS="emphasis">set</EM> command:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">&gt; <CODECLASS="userinput"><B>set type=a</B></CODE>&gt; <CODECLASS="userinput"><B>lady.berkeley.edu.</B></CODE>*** No address information available for lady.berkeley.edu.</PRE></BLOCKQUOTE></P><PCLASS="para">The <EMCLASS="emphasis">nslookup</EM>(1) program is a useful tool for performingall the same lookups that are done by <EMCLASS="emphasis">sendmail</EM>. Each type of lookupcorresponds to a <CODECLASS="replaceable"><I>set type</I></CODE>. The list of some available<EMCLASS="emphasis">nslookup</EM>(1) types is shown in<ACLASS="xref"HREF="ch21_04.htm#SML2-CH-21-TAB-0"TITLE="Some nslookup Types">Table 21.1</A>.<ACLASS="indexterm"NAME="AUTOID-17876"></A></P><TABLECLASS="table"><CAPTIONCLASS="table"><ACLASS="title"NAME="SML2-CH-21-TAB-0">Table 21.1: Some nslookup Types</A></CAPTION><THEADCLASS="thead"><TRCLASS="row"VALIGN="TOP"><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Type</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Description</TH></TR></THEAD><TBODYCLASS="tbody"><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">a</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">IP address</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">cname</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Canonical name for an alias</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">hinfo</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Host CPU and operating system type</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">mx</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Mail exchanger records</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">ns</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Name server record</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">any</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Union of all records</TD></TR></TBODY></TABLE><PCLASS="para">To exit <EMCLASS="emphasis">nslookup</EM>(1), just type <CODECLASS="replaceable"><I>exit</I></CODE> (or Control-D if that fails).&#13;</P></DIV><DIVCLASS="htmlnav"><P></P><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch21_03.htm"TITLE="21.3 Set Up MX Records"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 21.3 Set Up MX Records"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="book"HREF="index.htm"TITLE="sendmail"><IMGSRC="../gifs/txthome.gif"ALT="sendmail"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch21_05.htm"TITLE="21.5 Prepare for Disaster"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 21.5 Prepare for Disaster"BORDER="0"></A></TD></TR><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172">21.3 Set Up MX Records</TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="index"HREF="index/idx_0.htm"TITLE="Book Index"><IMGSRC="../gifs/index.gif"ALT="Book Index"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172">21.5 Prepare for Disaster</TD></TR></TABLE><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><PCLASS="nav"><FONTSIZE="-1">[ <AHREF="../index.htm"TITLE="The Networking CD Bookshelf">Library Home</A> | <AHREF="../dnsbind/index.htm"TITLE="DNS &amp; BIND">DNS &amp; BIND</A> | <AHREF="../tcpip/index.htm"TITLE="TCP/IP Network Administration">TCP/IP</A> | <AHREF="index.htm"TITLE="sendmail">sendmail</A> | <AHREF="../smdref/index.htm"TITLE="sendmail Desktop Reference">sendmail Reference</A> | <AHREF="../firewall/index.htm"TITLE="Building Internet Firewalls">Firewalls</A> | <AHREF="../puis/index.htm"TITLE="Practical UNIX &amp; Internet Security">Practical Security</A> ]</FONT></P></DIV></BODY></HTML>