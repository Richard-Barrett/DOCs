<HTML><HEAD><TITLE>[Chapter 22] 22.5 Permissions</TITLE><METANAME="DC.title"CONTENT="sendmail"><METANAME="DC.creator"CONTENT="Bryan Costales &amp; Eric Allman"><METANAME="DC.publisher"CONTENT="O'Reilly &amp; Associates, Inc."><METANAME="DC.date"CONTENT="1999-01-06T19:29:48Z"><METANAME="DC.type"CONTENT="Text.Monograph"><METANAME="DC.format"CONTENT="text/html"SCHEME="MIME"><METANAME="DC.source"CONTENT="1-56592-222-0"SCHEME="ISBN"><METANAME="DC.language"CONTENT="en-US"><METANAME="generator"CONTENT="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><LINKREV="made"HREF="mailto:online-books@oreilly.com"TITLE="Online Books Comments"><LINKREL="up"HREF="ch22_01.htm"TITLE="22. Security"><LINKREL="prev"HREF="ch22_04.htm"TITLE="22.4 The Configuration File"><LINKREL="next"HREF="ch22_06.htm"TITLE="22.6 The Aliases File"></HEAD><BODYBGCOLOR="#FFFFFF"TEXT="#000000"><DIVCLASS="htmlnav"><H1><IMGSRC="gifs/smbanner.gif"ALT="sendmail"USEMAP="#srchmap"BORDER="0"></H1><MAPNAME="srchmap"><AREASHAPE="RECT"COORDS="0,0,466,65"HREF="index.htm"ALT="sendmail"><AREASHAPE="RECT"COORDS="467,0,514,18"HREF="../search/ssrch.htm"ALT="Search this book"></MAP><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch22_04.htm"TITLE="22.4 The Configuration File"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 22.4 The Configuration File"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><B><FONTFACE="ARIEL,HELVETICA,HELV,SANSERIF"SIZE="-1">Chapter 22<BR>Security</FONT></B></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch22_06.htm"TITLE="22.6 The Aliases File"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 22.6 The Aliases File"BORDER="0"></A></TD></TR></TABLE>&nbsp;<HRALIGN="LEFT"WIDTH="515"TITLE="footer"></DIV><DIVCLASS="SECT1"><H2CLASS="sect1"><ACLASS="title"NAME="SML2-CH-22-SECT-5">22.5 Permissions</A></H2><PCLASS="para"><ACLASS="indexterm"NAME="SML2-CH-22-IX-PERMISSIONS"></A><ACLASS="indexterm"NAME="SML2-CH-22-IX-SEMIPRIVILEGED-USERS"></A><ACLASS="indexterm"NAME="SML2-CH-22-IX-USERS-SEMIPRIVILEGED"></A>One technique that attackers use to gain <EMCLASS="emphasis">root</EM> privilege is to first becomea semiprivileged user like <EMCLASS="emphasis">bin</EM> or <EMCLASS="emphasis">sys</EM>. Such semiprivilegedusers often own the directories in which <EMCLASS="emphasis">root</EM>-owned files live.By way of example, consider the following:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">drwxr-sr-x 11 bin      2560 Sep 22 18:18 /etc-rw-r-r-  1 root     8199 Aug 25 07:54 /etc/sendmail.cf</PRE></BLOCKQUOTE></P><PCLASS="para">Here, the <EMCLASS="emphasis">/etc/sendmail.cf</EM> configuration file is correctlywritable only by <EMCLASS="emphasis">root</EM>. But the directory in which that filelives is owned by <EMCLASS="emphasis">bin</EM> and writable by <EMCLASS="emphasis">bin</EM>. Havingwrite permission on that directory means that <EMCLASS="emphasis">bin</EM> canrename and create files. An individual whogains <EMCLASS="emphasis">bin</EM> permission on this machine cancreate a bogus <EMCLASS="emphasis">sendmail.cf</EM> file by issuing only two simple commands:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">% <CODECLASS="userinput"><B>mv /etc/sendmail.cf /etc/...</B></CODE>% <CODECLASS="userinput"><B>mv /tmp/sendmail.cf /etc/sendmail.cf</B></CODE></PRE></BLOCKQUOTE></P><PCLASS="para">&#13;The original <EMCLASS="emphasis">sendmail.cf</EM> is renamed <CODECLASS="literal">...</CODE> (a name thatis not likely to be randomly noticed by the real system administrator).The bogus <EMCLASS="emphasis">/tmp/sendmail.cf</EM> then replaces theoriginal:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">drwxr-sr-x 11 bin      2560 Sep 22 18:18 /etc-rw-r-r-  1 bin      4032 Nov 16 00:32 /etc/sendmail.cf</PRE></BLOCKQUOTE></P><PCLASS="para">UNIX pays less attention to semiprivileged usersthan it does <EMCLASS="emphasis">root</EM>. The user <EMCLASS="emphasis">root</EM>, for example, ismapped to <EMCLASS="emphasis">nobody</EM> over NFS, whereas the user <EMCLASS="emphasis">bin</EM>remains <EMCLASS="emphasis">bin</EM>. Consequently,the following rulesmust be observed to prevent malicious access to <EMCLASS="emphasis">root</EM>-ownedfiles:</P><ULCLASS="itemizedlist"><LICLASS="listitem"><PCLASS="para">All directories in the path leading to a <EMCLASS="emphasis">root</EM>-owned filemust be owned by <EMCLASS="emphasis">root</EM> and writable only by <EMCLASS="emphasis">root</EM>.This is true for <EMCLASS="emphasis">all</EM> files, not just <EMCLASS="emphasis">sendmail</EM> files.</P></LI><LICLASS="listitem"><PCLASS="para">Files owned by <EMCLASS="emphasis">root</EM> must be writable only by <EMCLASS="emphasis">root</EM>.Group write permission, although at times desirable, shouldconsistently be avoided.</P></LI><LICLASS="listitem"><PCLASS="para">Because <EMCLASS="emphasis">sendmail</EM> is running as<EMCLASS="emphasis">root</EM> when processing the configuration file, care shouldbe taken to ensure the safety of system files as well.All system directories and filesmust live in directories whose path componentparts are owned by and writable only by <EMCLASS="emphasis">root</EM>.All system files (except possibly <EMCLASS="emphasis">suid</EM> or <EMCLASS="emphasis">sgid</EM> files)must be owned by <EMCLASS="emphasis">root</EM> and be writable only by <EMCLASS="emphasis">root</EM>.If any program &quot;breaks&quot; after securing permissions, complain toyour vendor at once!</P></LI></UL><PCLASS="para"></P><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="SML2-CH-22-SECT-5-1">22.5.1 Dangerous Write Permissions</A></H3><PCLASS="para">The <EMCLASS="emphasis">sendmail</EM> program, of necessity, needs to trust itsconfiguration file. To aid in the detection of risks, itchecks the permissions of its configuration file when firstreading that file. If the file is writable by group or world,<EMCLASS="emphasis">sendmail</EM> logs the following message:[13]</P><BLOCKQUOTECLASS="footnote"><PCLASS="para">[13] This is done only when not in rule-testing mode to preventspurious warnings when you already know you are using aweak configuration file with <CODECLASS="literal">-C</CODE>.</P></BLOCKQUOTE><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen"><ICLASS="lineannotation">configfile</I>: WARNING: dangerous write permissions</PRE></BLOCKQUOTE></P><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-18791"></A>If <EMCLASS="emphasis">sendmail</EM> is being started as a daemon or is beingused to initialize the aliases database, it will printthe same message to its standard error output.&#13;</P></DIV><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="SML2-CH-22-SECT-5-2">22.5.2 Permissions for :include:</A></H3><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-18797"></A><ACLASS="indexterm"NAME="AUTOID-18799"></A>The <EMCLASS="emphasis">sendmail</EM> program doesn't always run as <EMCLASS="emphasis">root</EM>. When deliveringmail, it often changes its identity into that of a nonprivilegeduser. When delivering to a <CODECLASS="literal">:include:</CODE> mailing list, for example,it can change its identity to that of the owner of the list. This toocan pose security risks if permissions are not appropriate.Consider the following <EMCLASS="emphasis">aliases</EM> file entry:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">newprogs: :include:/usr/local/lists/proglist</PRE></BLOCKQUOTE></P><PCLASS="para">Here, notification of new programs are mailed to the alias <CODECLASS="literal">newprogs</CODE>.The list of recipients is taken from the following file:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">-rw-rw-r-  2 bin  prog   704 Sep 21 14:46 /usr/local/lists/proglist</PRE></BLOCKQUOTE></P><PCLASS="para">Because this file is owned by <EMCLASS="emphasis">bin</EM>, <EMCLASS="emphasis">sendmail</EM> changesits identity to <EMCLASS="emphasis">bin</EM> when delivering to the list of recipients.Unfortunately, the file is also writable by the group <EMCLASS="emphasis">prog</EM>.Anyone in the group <EMCLASS="emphasis">prog</EM> can add a recipient to that list,including one of the form</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">|/tmp/x.sh</PRE></BLOCKQUOTE></P><PCLASS="para">This tells <EMCLASS="emphasis">sendmail</EM> to deliver a copy of the message byrunning the program (a shell script) <EMCLASS="emphasis">/tmp/x.sh</EM>. The<EMCLASS="emphasis">sendmail</EM> program (which is still running as <EMCLASS="emphasis">bin</EM>)executes that program as <EMCLASS="emphasis">bin</EM>. Further, suppose theprogram <EMCLASS="emphasis">/tmp/x.sh</EM> contains the following:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">#!/bin/shcp /bin/sh /tmp/shchmod u+s /tmp/shcat - &gt; /dev/nullexit 0</PRE></BLOCKQUOTE></P><PCLASS="para">This causes <EMCLASS="emphasis">bin</EM> first to make a copy of the Bourne shell in<EMCLASS="emphasis">/tmp</EM> (a copy that will be owned by <EMCLASS="emphasis">bin</EM>), then toset the <EMCLASS="emphasis">suid</EM> bit on that copy (the <CODECLASS="literal">u+s</CODE>):</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">-rwsr-xr-x  1 bin    64668 Sep 22 07:38 /tmp/sh</PRE></BLOCKQUOTE></P><PCLASS="para">The script then throws away the incoming mail message and exits with a zero value to keep <EMCLASS="emphasis">sendmail</EM> unsuspecting.Through this process, an ordinary user in the group <EMCLASS="emphasis">prog</EM>has created an <EMCLASS="emphasis">suid</EM> shell that allows anyone to become thesemiprivileged user <EMCLASS="emphasis">bin</EM>. From the preceding discussion(see <ACLASS="xref"HREF="ch22_05.htm"TITLE="Permissions">Section 22.5, "Permissions"</A>)you can see the trouble that can cause!</P><ULCLASS="itemizedlist"><LICLASS="listitem"><PCLASS="para">Mailing lists (<CODECLASS="literal">:include:</CODE>) must live in a directory, all thecomponents of which are writable only by root. The lists themselvesmust be writable only by the owner. If the owner is an ordinaryuser, group write permissions can be enabled, provided that the user isadvised of the risks.</P></LI><LICLASS="listitem"><PCLASS="para">Mailing list (<CODECLASS="literal">:include:</CODE>) files may safely be ownedby <EMCLASS="emphasis">root</EM>. When <EMCLASS="emphasis">sendmail</EM> processes a <EMCLASS="emphasis">root</EM>-owned mailing list,it changes itself to run as the user and group specified bythe <CODECLASS="literal">DefaultUser</CODE> option (see <ACLASS="xref"HREF="ch34_08.htm#SML2-CH-34-SECT-8-15"TITLE="">Section 34.8.15</A>). That option defaults to<EMCLASS="emphasis">daemon</EM> but should be set to <EMCLASS="emphasis">nobody</EM> and <EMCLASS="emphasis">nogroup</EM>.The <CODECLASS="literal">DefaultUser</CODE> option should <EMCLASS="emphasis">never</EM> be set to <EMCLASS="emphasis">root</EM>.</P></LI></UL><PCLASS="para"></P></DIV><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="SML2-CH-22-SECT-5-3">22.5.3 Permissions for ~/.forward Files</A></H3><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-18865"></A><ACLASS="indexterm"NAME="AUTOID-18867"></A><ACLASS="indexterm"NAME="AUTOID-18870"></A>The <EMCLASS="emphasis">~/.forward</EM> file can pose a securityrisk to individual users. There isa higher degree of risk if the user is <EMCLASS="emphasis">root</EM> or one of the semiprivilegedusers (such as <EMCLASS="emphasis">bin</EM>).Because the <EMCLASS="emphasis">~/.forward</EM> file is like an individual mailinglist (<CODECLASS="literal">:include:</CODE>) for the user, risk can be encountered if thatfile is writable by anyone but the user. Consider the following for example:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">drwxr-xr-x 50 george guest        3072 Sep 27 09:19 /home/george/-rw-rw-r-  1 george guest          62 Sep 17 09:49 /home/george/.forward</PRE></BLOCKQUOTE></P><PCLASS="para">Here, the user <CODECLASS="literal">george</CODE>'s <EMCLASS="emphasis">~/.forward</EM> file is writable bythe group <CODECLASS="literal">guest</CODE>. Anyone in group <CODECLASS="literal">guest</CODE> can edit<CODECLASS="literal">george</CODE>'s <EMCLASS="emphasis">~/.forward</EM> file, possibly placing something like thisinto it:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">\george|&quot;cp /bin/sh /home/george/.x; chmod u+s /home/george/.x&quot;</PRE></BLOCKQUOTE></P><PCLASS="para">Now all the attacker has to do is send <CODECLASS="literal">george</CODE> mail tocreate an <EMCLASS="emphasis">suid</EM> <CODECLASS="literal">george</CODE> shell. Then, by executing <EMCLASS="emphasis">/home/george/.x</EM>, the attacker becomes <CODECLASS="literal">george</CODE>.</P><ULCLASS="itemizedlist"><LICLASS="listitem"><PCLASS="para">The semiprivileged users such as <EMCLASS="emphasis">bin</EM>, and <EMCLASS="emphasis">root</EM> in particular,should never have <EMCLASS="emphasis">~/.forward</EM> files. Instead, they should forwardtheir mail by means of the <EMCLASS="emphasis">aliases</EM> file directly.</P></LI><LICLASS="listitem"><PCLASS="para">User <EMCLASS="emphasis">~/.forward</EM> files must be writable only by the owning user.Similarly, user home directories must live in a directory that is owned and writableonly by <EMCLASS="emphasis">root</EM>, and must themselves be owned and writable onlyby the user.</P></LI></UL><PCLASS="para">Some users, such as the pseudo-user <EMCLASS="emphasis">uucp</EM>, have home directoriesthat must be world-writable for software to work properly. If thatsoftware is not needed (if a machine, for example, doesn't runUUCP software), that home directory should be removed. If thedirectory must exist and must be world-writable, you should createa protected <EMCLASS="emphasis">~/.forward</EM> file there before someone else does.The best protection is to create a nonemptydirectory called <EMCLASS="emphasis">~/.forward</EM>,owned by <EMCLASS="emphasis">root</EM>, and set its permissions to 000:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen"># <CODECLASS="userinput"><B>cd ~uucp</B></CODE># <CODECLASS="userinput"><B>rm -f .forward</B></CODE># <CODECLASS="userinput"><B>mkdir .forward</B></CODE># <CODECLASS="userinput"><B>touch .forward/uucp</B></CODE># <CODECLASS="userinput"><B>chown root .forward .forward/uucp</B></CODE># <CODECLASS="userinput"><B>chmod 000 .forward .forward/uucp</B></CODE># <CODECLASS="userinput"><B>chmod +t ~uucp</B></CODE># <CODECLASS="userinput"><B>chown root ~uucp</B></CODE></PRE></BLOCKQUOTE></P><PCLASS="para">Even though the <EMCLASS="emphasis">~uucp</EM> directory is world-writable (so anyonecan remove anything from it), no one but <EMCLASS="emphasis">root</EM> can removethe <EMCLASS="emphasis">~/.forward</EM> directory because it is not empty. The modeof 000 protects the file <EMCLASS="emphasis">.forward/uucp</EM> from being removed.The mode of <CODECLASS="literal">+t</CODE> prevents users from renaming files or directories thatthey do not own.Finally, <EMCLASS="emphasis">root</EM> is made to own the <EMCLASS="emphasis">~uucp</EM> directory sothat <EMCLASS="emphasis">uucp</EM> will be unable to clear the <CODECLASS="literal">+t</CODE> bit.Even with this protection, mail for <EMCLASS="emphasis">uucp</EM> should be routedto a real user with the <EMCLASS="emphasis">aliases</EM>(5) file. </P><PCLASS="para">Note that all critical dot files in a world-writable home directorymust be protected from creation by others. Each of <EMCLASS="emphasis">.forward</EM>,<EMCLASS="emphasis">.rhosts</EM>, <EMCLASS="emphasis">.login</EM>, <EMCLASS="emphasis">.cshrc</EM>, <EMCLASS="emphasis">.profile</EM>, and<EMCLASS="emphasis">.logout</EM> should be a nonempty, <EMCLASS="emphasis">root</EM>-owned directorywith mode 000. World-writable home directories must be owned by<EMCLASS="emphasis">root</EM> instead of by the user, and they must have the<CODECLASS="literal">+t</CODE> (sticky bit) set.</P><PCLASS="para">When processing a user's <EMCLASS="emphasis">~/.forward</EM> file, <EMCLASS="emphasis">sendmail</EM> requires that the file be owned by the user or by <EMCLASS="emphasis">root</EM>. If ownership is correct, it then examines the <EMCLASS="emphasis">~/.forward</EM> file'spermissions. If that file is world-writable, <EMCLASS="emphasis">sendmail</EM> ignores(and logs) attempts to run programs and to write directly to files.If the <CODECLASS="literal">UnsafeGroupWrites</CODE> option (see <ACLASS="xref"HREF="ch34_08.htm#SML2-CH-34-SECT-8-73"TITLE="">Section 34.8.73, UnsafeGroupWrites</A>)is true, <EMCLASS="emphasis">sendmail</EM> also checks for group write permissions and, if it is found,similarly ignores attempts to run programs and to write to files.&#13;</P></DIV><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="SML2-CH-22-SECT-5-4">22.5.4 Recommended Permissions</A></H3><PCLASS="para"><ACLASS="xref"HREF="ch22_05.htm#SML2-CH-22-TAB-0"TITLE="Recommended Permissions">Table 22.1</A><ACLASS="indexterm"NAME="AUTOID-18956"></A>shows the recommended ownerships andpermissions for all the files and directories in the <EMCLASS="emphasis">sendmail</EM>system. The path components will vary depending on the vendor versionof <EMCLASS="emphasis">sendmail</EM> you are running. For example, where we showthe <EMCLASS="emphasis">/usr/lib/sendmail</EM> directory, your site may use <EMCLASS="emphasis">/usr/etc/sendmail</EM>, oreven <EMCLASS="emphasis">/usr/lib/mail/sendmail</EM>.</P><TABLECLASS="table"><CAPTIONCLASS="table"><ACLASS="title"NAME="SML2-CH-22-TAB-0">Table 22.1: Recommended Permissions</A></CAPTION><THEADCLASS="thead"><TRCLASS="row"VALIGN="TOP"><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Path</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Type</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Owner</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Mode</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1"></TH></TR></THEAD><TBODYCLASS="tbody"><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><EMCLASS="emphasis">/</EM></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Directory</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><EMCLASS="emphasis">root</EM></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">0755</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><CODECLASS="literal">drwxr-xr-x</CODE></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><EMCLASS="emphasis">/usr</EM></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Directory</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><EMCLASS="emphasis">root</EM></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">0755</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><CODECLASS="literal">drwxr-xr-x</CODE></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><EMCLASS="emphasis">/usr/lib</EM>[14]</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Directory</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><EMCLASS="emphasis">root</EM></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">0755</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><CODECLASS="literal">drwxr-xr-x</CODE></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><EMCLASS="emphasis">/usr/lib/sendmail</EM></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">File</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><EMCLASS="emphasis">root</EM></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">06511</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><CODECLASS="literal">-r-s--s--x</CODE>[15]</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><EMCLASS="emphasis">/etc</EM></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Directory</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><EMCLASS="emphasis">root</EM></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">0755</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><CODECLASS="literal">drwxr-xr-x</CODE></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><EMCLASS="emphasis">/etc/sendmail.cf</EM></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">File</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><EMCLASS="emphasis">root</EM></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">0644 or 0640</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><CODECLASS="literal">OS</CODE><EMCLASS="emphasis">/etc/sendmail.st</EM></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">File</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><EMCLASS="emphasis">root</EM></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">0644</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><CODECLASS="literal">-rw-r--r--</CODE></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><CODECLASS="literal">OH</CODE><EMCLASS="emphasis">/etc/sendmail.hf</EM></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">File</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><EMCLASS="emphasis">root</EM></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">0444</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><CODECLASS="literal">-r--r--r--</CODE></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><CODECLASS="literal">OA</CODE><EMCLASS="emphasis">/etc/aliases</EM></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">File</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><EMCLASS="emphasis">root</EM></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">0644</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><CODECLASS="literal">-rw-r--r--</CODE></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><EMCLASS="emphasis">/etc/aliases.pag</EM></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">File</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><EMCLASS="emphasis">root</EM></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">0644</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><CODECLASS="literal">-rw-r--r--</CODE></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><EMCLASS="emphasis">/etc/aliases.dir</EM></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">File</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><EMCLASS="emphasis">root</EM></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">0644</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><CODECLASS="literal">-rw-r--r--</CODE></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><EMCLASS="emphasis">/etc/aliases.db</EM></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">File</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><EMCLASS="emphasis">root</EM></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">0644</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><CODECLASS="literal">-rw-r--r--</CODE></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><CODECLASS="literal">F</CODE><EMCLASS="emphasis">/path</EM></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Directory</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><EMCLASS="emphasis">root</EM></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">0755</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><CODECLASS="literal">drwxr-xr-x</CODE></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><CODECLASS="literal">F</CODE><EMCLASS="emphasis">/path/file</EM></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">File</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">n/a</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">0444 or 0644</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><EMCLASS="emphasis">/var</EM></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Directory</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><EMCLASS="emphasis">root</EM></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">0755</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><CODECLASS="literal">drwxr-xr-x</CODE></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><EMCLASS="emphasis">/var/spool</EM></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Directory</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><EMCLASS="emphasis">root</EM></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">0755</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><CODECLASS="literal">drwxr-xr-x</CODE></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><CODECLASS="literal">OQ</CODE><EMCLASS="emphasis">/var/spool/mqueue</EM></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Directory</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><EMCLASS="emphasis">root</EM></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">0700[16]</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><CODECLASS="literal">drwx---</CODE></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><CODECLASS="literal">:include:</CODE><EMCLASS="emphasis">/path</EM></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Directories</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><EMCLASS="emphasis">root</EM></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">0755</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><CODECLASS="literal">drwxr-xr-x</CODE></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><CODECLASS="literal">:include:</CODE><EMCLASS="emphasis">/path/list</EM></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">File</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">n/a</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">0644</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><CODECLASS="literal">-rw-r--r--</CODE></TD></TR></TBODY></TABLE><BLOCKQUOTECLASS="footnote"><PCLASS="para">[14] The <EMCLASS="emphasis">sendmail</EM> program sometimes lives in /usr/sbin or in someother directory. If so, adjust this path accordingly.</P><PCLASS="para">[15] The <EMCLASS="emphasis">sendmail</EM> program may need to be <EMCLASS="emphasis">sgid</EM> <EMCLASS="emphasis">kmem</EM> forthe load average to be checked on some systems.</P><PCLASS="para">[16] CERT (the Computing Emergency Response Team) recommends that the<EMCLASS="emphasis">mqueue</EM> directory be mode 0700 to prevent potential security breaches.</P></BLOCKQUOTE><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-19162"></A><ACLASS="indexterm"NAME="AUTOID-19163"></A><ACLASS="indexterm"NAME="AUTOID-19164"></A></P></DIV></DIV><DIVCLASS="htmlnav"><P></P><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch22_04.htm"TITLE="22.4 The Configuration File"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 22.4 The Configuration File"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="book"HREF="index.htm"TITLE="sendmail"><IMGSRC="../gifs/txthome.gif"ALT="sendmail"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch22_06.htm"TITLE="22.6 The Aliases File"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 22.6 The Aliases File"BORDER="0"></A></TD></TR><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172">22.4 The Configuration File</TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="index"HREF="index/idx_0.htm"TITLE="Book Index"><IMGSRC="../gifs/index.gif"ALT="Book Index"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172">22.6 The Aliases File</TD></TR></TABLE><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><PCLASS="nav"><FONTSIZE="-1">[ <AHREF="../index.htm"TITLE="The Networking CD Bookshelf">Library Home</A> | <AHREF="../dnsbind/index.htm"TITLE="DNS &amp; BIND">DNS &amp; BIND</A> | <AHREF="../tcpip/index.htm"TITLE="TCP/IP Network Administration">TCP/IP</A> | <AHREF="index.htm"TITLE="sendmail">sendmail</A> | <AHREF="../smdref/index.htm"TITLE="sendmail Desktop Reference">sendmail Reference</A> | <AHREF="../firewall/index.htm"TITLE="Building Internet Firewalls">Firewalls</A> | <AHREF="../puis/index.htm"TITLE="Practical UNIX &amp; Internet Security">Practical Security</A> ]</FONT></P></DIV></BODY></HTML>