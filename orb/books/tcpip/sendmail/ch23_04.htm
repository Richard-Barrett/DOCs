<HTML><HEAD><TITLE>[Chapter 23] 23.4 Printing the Queue</TITLE><METANAME="DC.title"CONTENT="sendmail"><METANAME="DC.creator"CONTENT="Bryan Costales &amp; Eric Allman"><METANAME="DC.publisher"CONTENT="O'Reilly &amp; Associates, Inc."><METANAME="DC.date"CONTENT="1999-01-06T19:32:44Z"><METANAME="DC.type"CONTENT="Text.Monograph"><METANAME="DC.format"CONTENT="text/html"SCHEME="MIME"><METANAME="DC.source"CONTENT="1-56592-222-0"SCHEME="ISBN"><METANAME="DC.language"CONTENT="en-US"><METANAME="generator"CONTENT="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><LINKREV="made"HREF="mailto:online-books@oreilly.com"TITLE="Online Books Comments"><LINKREL="up"HREF="ch23_01.htm"TITLE="23. The Queue"><LINKREL="prev"HREF="ch23_03.htm"TITLE="23.3 A Bogus qf File (V8 only): Qf"><LINKREL="next"HREF="ch23_05.htm"TITLE="23.5 How the Queue Is Processed"></HEAD><BODYBGCOLOR="#FFFFFF"TEXT="#000000"><DIVCLASS="htmlnav"><H1><IMGSRC="gifs/smbanner.gif"ALT="sendmail"USEMAP="#srchmap"BORDER="0"></H1><MAPNAME="srchmap"><AREASHAPE="RECT"COORDS="0,0,466,65"HREF="index.htm"ALT="sendmail"><AREASHAPE="RECT"COORDS="467,0,514,18"HREF="../search/ssrch.htm"ALT="Search this book"></MAP><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch23_03.htm"TITLE="23.3 A Bogus qf File (V8 only): Qf"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 23.3 A Bogus qf File (V8 only): Qf"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><B><FONTFACE="ARIEL,HELVETICA,HELV,SANSERIF"SIZE="-1">Chapter 23<BR>The Queue</FONT></B></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch23_05.htm"TITLE="23.5 How the Queue Is Processed"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 23.5 How the Queue Is Processed"BORDER="0"></A></TD></TR></TABLE>&nbsp;<HRALIGN="LEFT"WIDTH="515"TITLE="footer"></DIV><DIVCLASS="SECT1"><H2CLASS="sect1"><ACLASS="title"NAME="SML2-CH-23-SECT-4">23.4 Printing the Queue</A></H2><PCLASS="para"><ACLASS="indexterm"NAME="SML2-CH-23-IX-PRINTING-QUEUE"></A><ACLASS="indexterm"NAME="SML2-CH-23-IX-QUEUE-PRINTING"></A>When <EMCLASS="emphasis">sendmail</EM> is run under the name <EMCLASS="emphasis">mailq</EM>, or when it isgiven the <CODECLASS="literal">-bp</CODE> command-line switch, it prints the contentsof the queue and exits.</P><PCLASS="para">Before printing the queue's contents, <EMCLASS="emphasis">sendmail</EM> prereadsall the <CODECLASS="literal">qf</CODE> files in the queue and sorts the mail messagesinternally. This is done so that the queue's contents aredisplayed in the same order in which the messages will be processedduring a queue run.</P><PCLASS="para">If there are no messages in the queue (no <CODECLASS="literal">qf</CODE> files),<EMCLASS="emphasis">sendmail</EM> prints the following message and exits:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">Mail queue is empty</PRE></BLOCKQUOTE></P><PCLASS="para">&#13;Otherwise, <EMCLASS="emphasis">sendmail</EM> prints the number of messages (numberof <CODECLASS="literal">qf</CODE> files) in the queue:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">Mail Queue (# requests)</PRE></BLOCKQUOTE></P><PCLASS="para">The <CODECLASS="literal">#</CODE> is the number of queued messages (requests) inthe queue directory. If there are more than the maximum number of messages that may be processed at one time (defined by<ACLASS="indexterm"NAME="AUTOID-20461"></A>the <CODECLASS="literal">MaxQueueRunSize</CODE> option (see <ACLASS="xref"HREF="ch34_08.htm#SML2-CH-34-SECT-8-38"TITLE="">Section 34.8.38, MaxQueueRunSize</A>),[4]<EMCLASS="emphasis">sendmail</EM> prints</P><BLOCKQUOTECLASS="footnote"><PCLASS="para">[4] Prior to V8.7 this was determined by definingQUEUESIZE in <EMCLASS="emphasis">conf.h</EM>.</P></BLOCKQUOTE><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">Mail Queue (# requests, only ## printed)</PRE></BLOCKQUOTE></P><PCLASS="para">The <CODECLASS="literal">##</CODE> is the value of the <CODECLASS="literal">MaxQueueRunSize</CODE> option.</P><PCLASS="para">Next, <EMCLASS="emphasis">sendmail</EM> prints an attractive heading that looks likethe following:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">-Q-ID- -Size- ---Q-Time--- ------Sender/Recipient------MAA12345      354 Fri Mar 15 08:32 your@your.domain                                   george@wash.dc.govMAA12346*    1972 Fri Mar 15 08:45 your@your.domain      8BITMIME   (Timed out waiting to connect to wash.dc.gov)                                   jefferson@wash.dc.govMAA12347-      23 Fri Mar 15 09:32 your@your.domain                 (Timed out waiting to connect to wash.dc.gov)                                   jefferson@wash.dc.gov                                   bob</PRE></BLOCKQUOTE></P><PCLASS="para">The heading shows the information that is printed abouteach message in the queue. The items in that heading and their meanings are the following:<CODECLASS="literal">Q-ID</CODE> <ACLASS="indexterm"NAME="AUTOID-20480"></A><ACLASS="indexterm"NAME="AUTOID-20482"></A>The queue identifier for the message: the hour character, the clocked <CODECLASS="literal">AA</CODE>part, and the <CODECLASS="replaceable"><I>pid</I></CODE> numeric part (like <CODECLASS="literal">MAA12345</CODE>).This item can be followed by a character showing the item's status.<ACLASS="indexterm"NAME="AUTOID-20488"></A>An asterisk (<CODECLASS="literal">*</CODE> as in the second item above),means that the message is locked (an <CODECLASS="literal">lf</CODE> file was found or the<CODECLASS="literal">qf</CODE> file is locked depending on the kind of locking yourversion of <EMCLASS="emphasis">sendmail</EM> uses).<ACLASS="indexterm"NAME="AUTOID-20494"></A><ACLASS="indexterm"NAME="AUTOID-20497"></A>An <CODECLASS="literal">X</CODE> means that the load average is currently too high to allow delivery of the message.A minus (<CODECLASS="literal">-</CODE> as in the third item above)means that the message is too young to be processed (based on the <CODECLASS="literal">MinQueueAge</CODE> option, see <ACLASS="xref"HREF="ch34_08.htm#SML2-CH-34-SECT-8-41"TITLE="">Section 34.8.41, MinQueueAge</A>).<CODECLASS="literal">Size</CODE> <ACLASS="indexterm"NAME="AUTOID-20504"></A>The size in bytes of the <CODECLASS="literal">df</CODE> file. If there is no<CODECLASS="literal">df</CODE> file (because <EMCLASS="emphasis">sendmail</EM> is currently receivingthis message and hasn't created one yet), this item is absent.If the message has completed processing, this prints as:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">(job completed)</PRE></BLOCKQUOTE></P><PCLASS="para">&#13;If the <CODECLASS="literal">qf</CODE> file is empty, this prints as</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">(no control file)</PRE></BLOCKQUOTE></P><PCLASS="para"><CODECLASS="literal">Q-Time</CODE> <ACLASS="indexterm"NAME="AUTOID-20518"></A>The date and time that the message was first placed into the queue.This is the <CODECLASS="literal">T</CODE> line (see <ACLASS="xref"HREF="ch23_09.htm#SML2-CH-23-SECT-9-15"TITLE="">Section 23.9.15, T line</A>) in the <CODECLASS="literal">qf</CODE> file converted from an unsigned integer into a more understandable date and time.<CODECLASS="literal">Sender</CODE> <ACLASS="indexterm"NAME="AUTOID-20525"></A><ACLASS="indexterm"NAME="AUTOID-20527"></A>The sender of the message as taken from the <CODECLASS="literal">S</CODE> line (see <ACLASS="xref"HREF="ch23_09.htm#SML2-CH-23-SECT-9-14"TITLE="">Section 23.9.14, S line</A>)in the <CODECLASS="literal">qf</CODE> file. Only the first 45 characters of the senderaddress are printed. If there is a <CODECLASS="literal">B</CODE> line (see <ACLASS="xref"HREF="ch23_09.htm#SML2-CH-23-SECT-9-1"TITLE="">Section 23.9.1, B line</A>) in the <CODECLASS="literal">qf</CODE> file(as the 8BITMIME in the second item in the example above)<EMCLASS="emphasis">sendmail</EM> prints that body-type (see the <CODECLASS="literal">-B</CODE> switch in<ACLASS="xref"HREF="ch36_07.htm#SML2-CH-36-SECT-7-1"TITLE="">Section 36.7.1, -B</A>) on the line following the sender.If there is an <CODECLASS="literal">M</CODE> line (see <ACLASS="xref"HREF="ch23_09.htm#SML2-CH-23-SECT-9-9"TITLE="">Section 23.9.9, M line</A>) in the <CODECLASS="literal">qf</CODE>file, <EMCLASS="emphasis">sendmail</EM> prints the text of the error message in parentheses.<CODECLASS="literal">Recipient</CODE> After all of the above items have been printed, a list of the recipients(from each <CODECLASS="literal">R</CODE> line, see <ACLASS="xref"HREF="ch23_09.htm#SML2-CH-23-SECT-9-13"TITLE="">Section 23.9.13, R line</A>, in the <CODECLASS="literal">qf</CODE> file)is printed in the order in which they are found.In the above example there is one recipient for each of the first two items and two recipients for the last item.&#13;</P><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="SML2-CH-23-SECT-4-1">23.4.1 Printing the Queue in Verbose Mode</A></H3><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-20549"></A><ACLASS="indexterm"NAME="AUTOID-20551"></A>The <CODECLASS="literal">-v</CODE> command-line switch may be used in combination with the<CODECLASS="literal">-bp</CODE> switch to cause <EMCLASS="emphasis">sendmail</EM> to also printadditional details about the queued messages.To begin, the usual heading shows a new item:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">-Q-ID- -Size- -<CODECLASS="userinput"><B>Priority</B></CODE>- --Q-Time-- ------Sender/Recipient------MAA12345      354      <CODECLASS="userinput"><B>30020</B></CODE> Fri Mar 15 08:32 your@your.domain                                   george@wash.dc.govMAA12346*    1972      <CODECLASS="userinput"><B>48764</B></CODE> Fri Mar 15 08:45 your@your.domain      8BITMIME   (Timed out waiting to connect to wash.dc.gov)                                   jefferson@wash.dc.govMAA12347-      23      <CODECLASS="userinput"><B>54321+</B></CODE>Fri Mar 15 09:32 your@your.domain                 (Timed out waiting to connect to wash.dc.gov)                                   jefferson@wash.dc.gov                               <CODECLASS="userinput"><B>(--you--)</B></CODE>                                   bob</PRE></BLOCKQUOTE></P><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-20564"></A>The <CODECLASS="literal">Priority</CODE> is the value from the <CODECLASS="literal">P</CODE> line (see <ACLASS="xref"HREF="ch23_09.htm#SML2-CH-23-SECT-9-11"TITLE="">Section 23.9.11, P line</A>) in the <CODECLASS="literal">qf</CODE> file.Printing the queue does notchange a message's priority, whereas processing the queue does.See the <CODECLASS="literal">RecipientFactor</CODE> (<CODECLASS="literal">y</CODE>) option (<ACLASS="xref"HREF="ch34_08.htm#SML2-CH-34-SECT-8-53"TITLE="">Section 34.8.53, RecipientFactor (y)</A>)for a description of how the priority is calculated.</P><PCLASS="para">&#13;Verbose mode also causes a <CODECLASS="literal">+</CODE> to print after the <CODECLASS="literal">Priority</CODE>(as in the third item above)if a warning message has been sent.See the <CODECLASS="literal">Timeout.queuewarn</CODE> option (<ACLASS="xref"HREF="ch34_08.htm#SML2-CH-34-SECT-8-70"TITLE="">Section 34.8.70, Timeout (r)</A>)for a description of how messages time out.</P><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-20580"></A>If any <CODECLASS="literal">R</CODE> line is preceded by a controlling user (<CODECLASS="literal">C</CODE> line in the<CODECLASS="literal">qf</CODE> file; see <ACLASS="xref"HREF="ch23_09.htm#SML2-CH-23-SECT-9-2"TITLE="">Section 23.9.2, C line</A>), verbose mode causes that controlling user's name to be put in parenthesesand prepended to the recipient name.The third item in the preceding example illustrates this.</P><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-20587"></A>Finally, the <CODECLASS="literal">M</CODE> line error messages are normally truncated to60 characters. Beginning with V8.8 <EMCLASS="emphasis">sendmail</EM>, verbose mode causes thefull, nontruncated text of the <CODECLASS="literal">M</CODE> line error to be printed.<ACLASS="indexterm"NAME="AUTOID-20592"></A><ACLASS="indexterm"NAME="AUTOID-20593"></A>&#13;</P></DIV></DIV><DIVCLASS="htmlnav"><P></P><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch23_03.htm"TITLE="23.3 A Bogus qf File (V8 only): Qf"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 23.3 A Bogus qf File (V8 only): Qf"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="book"HREF="index.htm"TITLE="sendmail"><IMGSRC="../gifs/txthome.gif"ALT="sendmail"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch23_05.htm"TITLE="23.5 How the Queue Is Processed"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 23.5 How the Queue Is Processed"BORDER="0"></A></TD></TR><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172">23.3 A Bogus qf File (V8 only): Qf</TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="index"HREF="index/idx_0.htm"TITLE="Book Index"><IMGSRC="../gifs/index.gif"ALT="Book Index"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172">23.5 How the Queue Is Processed</TD></TR></TABLE><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><PCLASS="nav"><FONTSIZE="-1">[ <AHREF="../index.htm"TITLE="The Networking CD Bookshelf">Library Home</A> | <AHREF="../dnsbind/index.htm"TITLE="DNS &amp; BIND">DNS &amp; BIND</A> | <AHREF="../tcpip/index.htm"TITLE="TCP/IP Network Administration">TCP/IP</A> | <AHREF="index.htm"TITLE="sendmail">sendmail</A> | <AHREF="../smdref/index.htm"TITLE="sendmail Desktop Reference">sendmail Reference</A> | <AHREF="../firewall/index.htm"TITLE="Building Internet Firewalls">Firewalls</A> | <AHREF="../puis/index.htm"TITLE="Practical UNIX &amp; Internet Security">Practical Security</A> ]</FONT></P></DIV></BODY></HTML>