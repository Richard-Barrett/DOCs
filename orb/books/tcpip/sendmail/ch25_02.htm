<HTML><HEAD><TITLE>[Chapter 25] 25.2 :include: Mailing Lists</TITLE><METANAME="DC.title"CONTENT="sendmail"><METANAME="DC.creator"CONTENT="Bryan Costales &amp; Eric Allman"><METANAME="DC.publisher"CONTENT="O'Reilly &amp; Associates, Inc."><METANAME="DC.date"CONTENT="1999-01-06T19:39:08Z"><METANAME="DC.type"CONTENT="Text.Monograph"><METANAME="DC.format"CONTENT="text/html"SCHEME="MIME"><METANAME="DC.source"CONTENT="1-56592-222-0"SCHEME="ISBN"><METANAME="DC.language"CONTENT="en-US"><METANAME="generator"CONTENT="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><LINKREV="made"HREF="mailto:online-books@oreilly.com"TITLE="Online Books Comments"><LINKREL="up"HREF="ch25_01.htm"TITLE="25. Mailing Lists and ~/.forward"><LINKREL="prev"HREF="ch25_01.htm"TITLE="25.1 Internal Mailing Lists"><LINKREL="next"HREF="ch25_03.htm"TITLE="25.3 Defining a Mailing List Owner"></HEAD><BODYBGCOLOR="#FFFFFF"TEXT="#000000"><DIVCLASS="htmlnav"><H1><IMGSRC="gifs/smbanner.gif"ALT="sendmail"USEMAP="#srchmap"BORDER="0"></H1><MAPNAME="srchmap"><AREASHAPE="RECT"COORDS="0,0,466,65"HREF="index.htm"ALT="sendmail"><AREASHAPE="RECT"COORDS="467,0,514,18"HREF="../search/ssrch.htm"ALT="Search this book"></MAP><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch25_01.htm"TITLE="25.1 Internal Mailing Lists"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 25.1 Internal Mailing Lists"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><B><FONTFACE="ARIEL,HELVETICA,HELV,SANSERIF"SIZE="-1">Chapter 25<BR>Mailing Lists and ~/.forward</FONT></B></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch25_03.htm"TITLE="25.3 Defining a Mailing List Owner"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 25.3 Defining a Mailing List Owner"BORDER="0"></A></TD></TR></TABLE>&nbsp;<HRALIGN="LEFT"WIDTH="515"TITLE="footer"></DIV><DIVCLASS="SECT1"><H2CLASS="sect1"><ACLASS="title"NAME="SML2-CH-25-SECT-2">25.2 :include: Mailing Lists</A></H2><PCLASS="para"><ACLASS="indexterm"NAME="SML2-CH-25-IX-INCLUDE-DIRECTIVE-INCLUDE-DIRECTIVE"></A><ACLASS="indexterm"NAME="SML2-CH-25-IX-MAILING-LISTS-INCLUDE-DIRECTIVE-INCLUDE"></A>The special notation <CODECLASS="literal">:include:</CODE> in the right-hand sideof an alias causes <EMCLASS="emphasis">sendmail</EM> to read its list of recipientsfrom an external file.For that directive to be recognized as special, any address thatbegins with <CODECLASS="literal">:include:</CODE> must select the <CODECLASS="literal">local</CODE> delivery agent.This is automatic with most configuration files but not with others.If your configuration file does not automatically recognize the<CODECLASS="literal">:include:</CODE> directive, you will need to add a new rulenear the end of your rule set 0 (see <ACLASS="xref"HREF="ch29_06.htm"TITLE="Rule Set 0">Section 29.6, "Rule Set 0"</A>). For example,</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">R:include:$*     $@ $#local $: :include:$1</PRE></BLOCKQUOTE></P><PCLASS="para">Beginning with V8.7 <EMCLASS="emphasis">sendmail</EM>,any delivery agent for which the <CODECLASS="literal">F=:</CODE> flag (see <ACLASS="xref"HREF="ch30_08.htm#SML2-CH-30-SECT-8-7"TITLE="">Section 30.8.7, F=:</A>)is set can also process <CODECLASS="literal">:include:</CODE> files.(Note that eliminating the <CODECLASS="literal">F=:</CODE> flag for all delivery agent definitionsin your configuration file will disable this feature entirely.)</P><PCLASS="para">The <CODECLASS="literal">:include:</CODE> directive is used in <EMCLASS="emphasis">aliases</EM>(5) files likethis:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">localname:   :include:<CODECLASS="replaceable"><I>/path</I></CODE></PRE></BLOCKQUOTE></P><PCLASS="para">The expression <CODECLASS="literal">:include:</CODE> is literal. It must appear exactlyas shown, colons and all,with no space between the colons and the &quot;include.&quot; As with any right-hand side of an alias, there may bespace between the alias colon and the lead colon of the <CODECLASS="literal">:include:</CODE>.</P><PCLASS="para">The <CODECLASS="replaceable"><I>/path</I></CODE> is the full pathname of a filecontaining a list of recipients. It followsthe <CODECLASS="literal">:include:</CODE> with intervening space allowed.</P><PCLASS="para">The <CODECLASS="replaceable"><I>/path</I></CODE> should be a full pathname.If it is a relative name (such as <EMCLASS="emphasis">../file</EM>), it is relativeto the <EMCLASS="emphasis">sendmail</EM> queue directory. For all but V8 <EMCLASS="emphasis">sendmail</EM>,the <CODECLASS="replaceable"><I>/path</I></CODE> must not be quoted. If it is quoted, the quotation marks are interpretedas part of the filename. For V8 <EMCLASS="emphasis">sendmail</EM>, the <CODECLASS="replaceable"><I>/path</I></CODE> may be quoted, and the quotationmarks are automatically stripped.</P><PCLASS="para">If the <CODECLASS="replaceable"><I>/path</I></CODE>cannot be opened for reading for any reason, <EMCLASS="emphasis">sendmail</EM>prints the following warning and ignores any recipients that mighthave been in the file:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">:include: <ICLASS="lineannotation">path... Cannot open path</I>: <ICLASS="lineannotation">reason</I></PRE></BLOCKQUOTE></P><PCLASS="para">Here, <EMCLASS="emphasis">reason</EM> is &quot;no such file or directory,&quot; &quot;permissiondenied,&quot; or something similar. If <CODECLASS="replaceable"><I>/path</I></CODE> exists and can beread, <EMCLASS="emphasis">sendmail</EM> reads it one line at a time. Empty lines areignored. Beginning with V8 <EMCLASS="emphasis">sendmail</EM>, lines that begin with a <CODECLASS="literal">#</CODE> character are also ignored:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">addr# a comment                   <ICLASS="lineannotation"><IMGSRC="../chars/larr.gif"ALT="&lt;-"> empty line is ignored</I>addr2</PRE></BLOCKQUOTE></P><PCLASS="para">Each line in the <CODECLASS="literal">:include:</CODE> file is treated as a listof one or more recipient addresses. Where there is more thanone, each should be separated from the others by commas.</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">addr1addr2, addr3, addr4</PRE></BLOCKQUOTE></P><PCLASS="para">The addresses may themselves bealiases that appear to the left in the <EMCLASS="emphasis">aliases</EM> file. Theymay also be user addresses, program names, or filenames.A <CODECLASS="literal">:include:</CODE> file may also contain additional<CODECLASS="literal">:include:</CODE> lists:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">engineers                          <ICLASS="lineannotation"><IMGSRC="../chars/larr.gif"ALT="&lt;-"> to an alias</I>biff, bill@otherhost               <ICLASS="lineannotation"><IMGSRC="../chars/larr.gif"ALT="&lt;-"> to two recipients</I>|&quot;/etc/local/loglists thislist&quot;    <ICLASS="lineannotation"><IMGSRC="../chars/larr.gif"ALT="&lt;-"> to a program alias</I>/usr/local/archive/thislist.hist   <ICLASS="lineannotation"><IMGSRC="../chars/larr.gif"ALT="&lt;-"> to a file</I>:include:/yet/another/file         <ICLASS="lineannotation"><IMGSRC="../chars/larr.gif"ALT="&lt;-"> from another file</I></PRE></BLOCKQUOTE></P><PCLASS="para">Beginning with V8.7 <EMCLASS="emphasis">sendmail</EM>,the <CODECLASS="literal">TimeOut.fileopen</CODE> option (see <ACLASS="xref"HREF="ch34_08.htm#SML2-CH-34-SECT-8-70"TITLE="">Section 34.8.70, Timeout (r)</A>)controls how long <EMCLASS="emphasis">sendmail</EM> should wait for the open to complete. This is useful when files are remotely mountedas with <SPANCLASS="acronym">NFS</SPAN>. This timeout encompasses both this open andthe security checks described next.Note that the <SPANCLASS="acronym">NFS</SPAN> file system must be soft mounted (or mounted withthe <CODECLASS="literal">intr</CODE> option) for this to work.</P><PCLASS="para">Beginning with V8, <EMCLASS="emphasis">sendmail</EM> checks the file for security.If the controlling user is <EMCLASS="emphasis">root</EM>, all components of the pathleading to the file are also checked.[2]If the <EMCLASS="emphasis">suid</EM> bit ofthe file is set (telling <EMCLASS="emphasis">sendmail</EM> to run as owner of the file),<EMCLASS="emphasis">sendmail</EM> checks to be sure that the file is writable onlyby the owner. If it is group- or world-writable, <EMCLASS="emphasis">sendmail</EM> silentlyignores that <EMCLASS="emphasis">suid</EM> bit.When checking components of the path, <EMCLASS="emphasis">sendmail</EM> will print the followingwarning if it is running as <EMCLASS="emphasis">root</EM> and if any componentof the path is group- or world-writable:</P><BLOCKQUOTECLASS="footnote"><PCLASS="para">[2] The <EMCLASS="emphasis">sendmail</EM> program also performs this check for critical systemfiles, such as its configuration file.</P></BLOCKQUOTE><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">WARNING: writable directory <ICLASS="lineannotation">offending component</I></PRE></BLOCKQUOTE></P><PCLASS="para">This process is described in greater detail under the <CODECLASS="literal">-d44</CODE>debugging switch (see <ACLASS="xref"HREF="ch37_05.htm#SML2-CH-37-SECT-5-159"TITLE="">Section 37.5.159, -d44.4</A>), which can also be used toobserve this process.</P><PCLASS="para">After <EMCLASS="emphasis">sendmail</EM> opens the <CODECLASS="replaceable"><I>/path</I></CODE> for reading butbefore it reads the file, it sets the controlling user to be the owner of the file(if one is not already set and provided that file ownership cannot begiven away with <EMCLASS="emphasis">chown</EM><SPANCLASS="acronym">(1)</SPAN>).The controllinguser provides the <EMCLASS="emphasis">uid</EM> and <EMCLASS="emphasis">gid</EM> identities of the sender when deliveringmail from the queue (see <ACLASS="xref"HREF="ch23_09.htm#SML2-CH-23-SECT-9-2"TITLE="">Section 23.9.2, C line</A>).</P><PCLASS="para">The <CODECLASS="literal">:include:</CODE> file can neither deliver through programs nor append to filesif any of three situations is true:if the owner of the <CODECLASS="literal">:include:</CODE> file has a shell that is notlisted in <EMCLASS="emphasis">/etc/shells</EM> (see <ACLASS="xref"HREF="ch22_08.htm#SML2-CH-22-SECT-8-4"TITLE="The /etc/shells file">Section 22.8.4, "The /etc/shells file"</A>), if the <CODECLASS="literal">:include:</CODE> file is world-writable,or if the <CODECLASS="literal">:include:</CODE> file is group-writable and the<CODECLASS="literal">UnsafeGroupWrites</CODE> option (see <ACLASS="xref"HREF="ch34_08.htm#SML2-CH-34-SECT-8-73"TITLE="">Section 34.8.73, UnsafeGroupWrites</A>) is true.</P><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="SML2-CH-25-SECT-2-1">25.2.1 Comments in :include: Lists</A></H3><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-23518"></A><ACLASS="indexterm"NAME="AUTOID-23521"></A>IDA and V8 <EMCLASS="emphasis">sendmail</EM> allow commentsin <CODECLASS="literal">:include:</CODE> files. Comment lines beginwith a <CODECLASS="literal">#</CODE> character. If the <CODECLASS="literal">#</CODE> doesn't begin the line,it is treated as the beginning of an address, thus allowing valid usernamesthat begin with a <CODECLASS="literal">#</CODE> (such as <CODECLASS="literal">#1user</CODE>) toappear first in a line by prefixing them with a space:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen"># Management               <ICLASS="lineannotation"><IMGSRC="../chars/larr.gif"ALT="&lt;-"> a comment</I>fridageorge@wash.dc.gov# Staff                    <ICLASS="lineannotation"><IMGSRC="../chars/larr.gif"ALT="&lt;-"> a comment</I>bensteve #1user                    <ICLASS="lineannotation"><IMGSRC="../chars/larr.gif"ALT="&lt;-"> an address</I></PRE></BLOCKQUOTE></P><PCLASS="para">Note that since comments and empty lines are ignored by <EMCLASS="emphasis">sendmail</EM>,they can be used to create attractive, well-documented mailing lists.</P><PCLASS="para">Under older versions of <EMCLASS="emphasis">sendmail</EM>, comments can beemulated through the use of RFC822-style comments:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">( comment )</PRE></BLOCKQUOTE></P><PCLASS="para">By surrounding the <CODECLASS="literal">comment</CODE> in parentheses, you cause<EMCLASS="emphasis">sendmail</EM> to view it and the parentheses as an RFC-style commentand ignore them:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">( Management )fridageorge@wash.dc.gov( Staff )bensteve</PRE></BLOCKQUOTE></P><PCLASS="para">This form of comment works with both the old and new <EMCLASS="emphasis">sendmail</EM>programs.</P></DIV><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="SML2-CH-25-SECT-2-2">25.2.2 Tradeoffs</A></H3><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-23551"></A>As has been noted, the <EMCLASS="emphasis">aliases</EM> fileshould be writable only by <EMCLASS="emphasis">root</EM> for security reasons.Therefore, ordinaryusers, such as nonprivileged department heads, cannot use the<EMCLASS="emphasis">aliases</EM> file to create and manage mailing lists.Fortunately, <CODECLASS="literal">:include:</CODE> files allow ordinary users(or groups of users) to maintain mailing lists. This offloadsa great deal of work from the system administrator, whowould otherwise have to manage these lists, andgives users a sense of participation in the system.</P><PCLASS="para">Unfortunately, reading <CODECLASS="literal">:include:</CODE> lists is slower thanreading an entry from the <EMCLASS="emphasis">aliases</EM> database. At busy sitesor sites with numerous mail messages addressed to mailing lists, thisdifference in speed can become significant. Note that the <CODECLASS="literal">-bv</CODE>command-line switch (see <ACLASS="xref"HREF="ch36_07.htm#SML2-CH-36-SECT-7-13"TITLE="">Section 36.7.13, -bv</A>) can be used with <EMCLASS="emphasis">sendmail</EM> to timeand contrast the two different forms of lists.On the other hand, sometimes rebuilding the <EMCLASS="emphasis">aliases</EM>(5) databasecan also be very slow. In such instances the <CODECLASS="literal">:include:</CODE>file may be faster, since it doesn't require a rebuild each time it changes.</P><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-23567"></A>One possible disadvantage to all types of mailing lists is that they are visibleto the outside world. This means that anyone in the world cansend mail to a local list that is intended for internal use. Many lists are intended forboth internal and external use. One such list might be one fordiscussion of the O'Reilly Nutshell Handbooks, called, say, <EMCLASS="emphasis">nuts@ora.com</EM>. Anyone inside <EMCLASS="emphasis">ora.com</EM> and anyone in the outside worldcan send mail messages to this list, and those messages willbe forwarded to everyone on the <EMCLASS="emphasis">nuts</EM> mailing list.<ACLASS="indexterm"NAME="AUTOID-23573"></A><ACLASS="indexterm"NAME="AUTOID-23574"></A></P></DIV></DIV><DIVCLASS="htmlnav"><P></P><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch25_01.htm"TITLE="25.1 Internal Mailing Lists"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 25.1 Internal Mailing Lists"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="book"HREF="index.htm"TITLE="sendmail"><IMGSRC="../gifs/txthome.gif"ALT="sendmail"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch25_03.htm"TITLE="25.3 Defining a Mailing List Owner"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 25.3 Defining a Mailing List Owner"BORDER="0"></A></TD></TR><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172">25.1 Internal Mailing Lists</TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="index"HREF="index/idx_0.htm"TITLE="Book Index"><IMGSRC="../gifs/index.gif"ALT="Book Index"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172">25.3 Defining a Mailing List Owner</TD></TR></TABLE><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><PCLASS="nav"><FONTSIZE="-1">[ <AHREF="../index.htm"TITLE="The Networking CD Bookshelf">Library Home</A> | <AHREF="../dnsbind/index.htm"TITLE="DNS &amp; BIND">DNS &amp; BIND</A> | <AHREF="../tcpip/index.htm"TITLE="TCP/IP Network Administration">TCP/IP</A> | <AHREF="index.htm"TITLE="sendmail">sendmail</A> | <AHREF="../smdref/index.htm"TITLE="sendmail Desktop Reference">sendmail Reference</A> | <AHREF="../firewall/index.htm"TITLE="Building Internet Firewalls">Firewalls</A> | <AHREF="../puis/index.htm"TITLE="Practical UNIX &amp; Internet Security">Practical Security</A> ]</FONT></P></DIV></BODY></HTML>