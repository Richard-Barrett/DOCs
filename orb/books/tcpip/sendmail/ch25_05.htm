<HTML><HEAD><TITLE>[Chapter 25] 25.5 Problems with Mailing Lists</TITLE><METANAME="DC.title"CONTENT="sendmail"><METANAME="DC.creator"CONTENT="Bryan Costales &amp; Eric Allman"><METANAME="DC.publisher"CONTENT="O'Reilly &amp; Associates, Inc."><METANAME="DC.date"CONTENT="1999-01-06T19:39:25Z"><METANAME="DC.type"CONTENT="Text.Monograph"><METANAME="DC.format"CONTENT="text/html"SCHEME="MIME"><METANAME="DC.source"CONTENT="1-56592-222-0"SCHEME="ISBN"><METANAME="DC.language"CONTENT="en-US"><METANAME="generator"CONTENT="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><LINKREV="made"HREF="mailto:online-books@oreilly.com"TITLE="Online Books Comments"><LINKREL="up"HREF="ch25_01.htm"TITLE="25. Mailing Lists and ~/.forward"><LINKREL="prev"HREF="ch25_04.htm"TITLE="25.4 Exploder Mailing Lists"><LINKREL="next"HREF="ch25_06.htm"TITLE="25.6 Packages That Help"></HEAD><BODYBGCOLOR="#FFFFFF"TEXT="#000000"><DIVCLASS="htmlnav"><H1><IMGSRC="gifs/smbanner.gif"ALT="sendmail"USEMAP="#srchmap"BORDER="0"></H1><MAPNAME="srchmap"><AREASHAPE="RECT"COORDS="0,0,466,65"HREF="index.htm"ALT="sendmail"><AREASHAPE="RECT"COORDS="467,0,514,18"HREF="../search/ssrch.htm"ALT="Search this book"></MAP><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch25_04.htm"TITLE="25.4 Exploder Mailing Lists"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 25.4 Exploder Mailing Lists"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><B><FONTFACE="ARIEL,HELVETICA,HELV,SANSERIF"SIZE="-1">Chapter 25<BR>Mailing Lists and ~/.forward</FONT></B></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch25_06.htm"TITLE="25.6 Packages That Help"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 25.6 Packages That Help"BORDER="0"></A></TD></TR></TABLE>&nbsp;<HRALIGN="LEFT"WIDTH="515"TITLE="footer"></DIV><DIVCLASS="SECT1"><H2CLASS="sect1"><ACLASS="title"NAME="SML2-CH-25-SECT-5">25.5 Problems with Mailing Lists</A></H2><PCLASS="para"><ACLASS="indexterm"NAME="SML2-CH-25-IX-TROUBLESHOOTING-MAILING-LISTS"></A><ACLASS="indexterm"NAME="SML2-CH-25-IX-MAILING-LISTS-TROUBLESHOOTING"></A>At small sites that just use mailing lists internally, the problemsare few and can be easily solved locally. But as lists get to be large (over afew hundred recipients), many (over 50 lists), or complex(using exploders), problems become harder to localize andmore difficult to solve. In the following discussion we present themost common problems. It is by no means comprehensive, but itshould provide information to solve most problems.</P><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="SML2-CH-25-SECT-5-1">25.5.1 Reply Versus Bounce</A></H3><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-23663"></A><ACLASS="indexterm"NAME="AUTOID-23666"></A><ACLASS="indexterm"NAME="AUTOID-23669"></A>The eventual recipient of a mailing-list message should be able toreply to the message and have that reply go to either the originalsender or the list as a whole. Which happens is an administrativedecision. In general, replies go to the address listed inthe <CODECLASS="literal">From:</CODE> or <CODECLASS="literal">Reply-To:</CODE> headers. If the intentionis to have replies go to the list as a whole, these headersneed to be rewritten by a filter at the originating site:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">list:   &quot;|/etc/local/mailfilter list -oi -odq -flist-request list-real&quot;</PRE></BLOCKQUOTE></P><PCLASS="para">Here, the name of the filter has replaced <EMCLASS="emphasis">sendmail</EM> in the<EMCLASS="emphasis">aliases</EM> file entry. Writing such a filter is complex.The original addresses need to be preserved with appropriateheaders before they are rewritten by the filter.</P><PCLASS="para">The converse problem is that not all mail-handling programshandle replies properly. Some programs (such as UUCP and certainversions of <EMCLASS="emphasis">emacs-mail</EM>) insist on replying to the envelope sender as conveyedin the five-character &quot;<CODECLASS="literal">From&nbsp;</CODE>&quot; header. By setting up lists correctly(as we showed earlier), an administrator can at least guarantee that thosereplies are sent to the list maintainer, who can then forwardthem as required.</P><PCLASS="para">&#13;A more serious problem is the way other sites handle bounced mail. In anideal world, all sites would correctly bounce mail to the <CODECLASS="literal">Errors-To:</CODE> address[3]and (less desirably) to the envelope sender.Unfortunately, not all sites are so well-behaved. If a mailing listis not carefully set up, there is a possibility that bounced mailwill be resent to the list as a whole. To minimize such potentialcatastrophes, follow the guide in<ACLASS="xref"HREF="ch25_05.htm#SML2-CH-25-TAB-0"TITLE="Mailing List Header Use">Table 25.1</A>.<ACLASS="indexterm"NAME="AUTOID-23694"></A></P><BLOCKQUOTECLASS="footnote"><PCLASS="para">[3] The <EMCLASS="emphasis">sendmail</EM> program does use the <CODECLASS="literal">Errors-To:</CODE> header, despite the factthat it was originally a hack to get around UUCP, which confused envelope and header.The <CODECLASS="literal">Errors-To:</CODE> header is not an Internet standard (in fact it violatesthe Internet standards) and cannot be expected to work on <SPANCLASS="acronym">MTA</SPAN>s otherthan <EMCLASS="emphasis">sendmail</EM>. Beginning with V8.8, <CODECLASS="literal">Errors-To:</CODE>  is supportedonly if the <CODECLASS="literal">UseErrorsTo</CODE> (<CODECLASS="literal">l</CODE>) option is set to true.</P></BLOCKQUOTE><TABLECLASS="table"><CAPTIONCLASS="table"><ACLASS="title"NAME="SML2-CH-25-TAB-0">Table 25.1: Mailing List Header Use</A></CAPTION><THEADCLASS="thead"><TRCLASS="row"VALIGN="TOP"><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Header</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1"></TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Use</TH></TR></THEAD><TBODYCLASS="tbody"><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Envelope sender</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><ACLASS="xref"HREF="ch31_10.htm#SML2-CH-31-SECT-10-14"TITLE="">Section 31.10.14, $f</A></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Should be local list maintainer</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><CODECLASS="literal">From</CODE></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><ACLASS="xref"HREF="ch34_08.htm#SML2-CH-34-SECT-8-59"TITLE="">Section 34.8.59, SaveFromLine (f)</A></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Same as envelope sender</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><CODECLASS="literal">From:</CODE></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><ACLASS="xref"HREF="ch35_10.htm#SML2-CH-35-SECT-10-14"TITLE="">Section 35.10.14, From:</A></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Original submitter</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><CODECLASS="literal">Reply-To:</CODE></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><ACLASS="xref"HREF="ch35_10.htm#SML2-CH-35-SECT-10-33"TITLE="">Section 35.10.33, To:</A></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Local list maintainer, list as a whole, or original submitter</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><CODECLASS="literal">Errors-To:</CODE></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><ACLASS="xref"HREF="ch35_10.htm#SML2-CH-35-SECT-10-13"TITLE="">Section 35.10.13, Errors-To:</A></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Local list maintainer</TD></TR></TBODY></TABLE><PCLASS="para"></P></DIV><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="SML2-CH-25-SECT-5-2">25.5.2 Gateway Lists to News</A></H3><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-23739"></A><ACLASS="indexterm"NAME="AUTOID-23742"></A>When gatewaying a mailing list to Usenet news, the <EMCLASS="emphasis">inews</EM>(1) programbounces the message if it is for a moderated groupand lacks an <CODECLASS="literal">Approved:</CODE> header, which can be added by a filter program (see<ACLASS="xref"HREF="ch24_03.htm"TITLE="Write a Delivery Agent Script">Section 24.3, "Write a Delivery Agent Script"</A>) or by a news gateway delivery agent.</P><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-23748"></A>If your site is running (or has access to) Usenet news,the <EMCLASS="emphasis">recnews</EM>(1) program that is included therein may be usedto gateway mail to newsgroups. It inserts the <CODECLASS="literal">Approved:</CODE>header that <EMCLASS="emphasis">inews</EM> needs and generally handles its gatewayrole well. One minor pitfall to avoid with <EMCLASS="emphasis">recnews</EM> is making separatepostings when you intend cross-postings:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">mail-news: &quot;|/usr/local/recnews comp.mail comp.mail.d&quot; <ICLASS="lineannotation"><IMGSRC="../chars/larr.gif"ALT="&lt;-"> separate postings</I>mail-news: &quot;|/usr/local/recnews comp.mail,comp.mail.d&quot; <ICLASS="lineannotation"><IMGSRC="../chars/larr.gif"ALT="&lt;-"> cross-posted</I>                                         <ICLASS="lineannotation"><IMGSRC="../chars/uarr.gif"ALT="-^"></I>                                   <ICLASS="lineannotation">note the comma</I></PRE></BLOCKQUOTE></P><PCLASS="para"></P></DIV><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="SML2-CH-25-SECT-5-3">25.5.3 A list-bounced Alias</A></H3><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-23764"></A><ACLASS="indexterm"NAME="AUTOID-23767"></A><ACLASS="indexterm"NAME="AUTOID-23770"></A>There are many ways to handle bounced mail in managing a mailinglist. One of the best ways for large lists is to createa <EMCLASS="emphasis">bounce</EM> alias for a list:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">list-bounce: :include:/usr/local/lists/list-bounce</PRE></BLOCKQUOTE></P><PCLASS="para">&#13;When an address in the main list begins to bounce, move it fromthe main list's file to the corresponding <CODECLASS="literal">list-bounce</CODE>file. Then send a message to that listnightly (via <EMCLASS="emphasis">cron</EM>(8)), advising the users in it that they will soon be dropped. To preventthe bad addresses from deluging you with bounced mail, set up thereturn address and the envelope to be an alias that delivers to<EMCLASS="emphasis">/dev/null</EM>:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">black-hole:   /dev/null</PRE></BLOCKQUOTE></P><PCLASS="para">Finally, arrange to include the following header in the outgoingmessage:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">Precedence: junk</PRE></BLOCKQUOTE></P><PCLASS="para">This prevents most sites from returning the message if itcannot be delivered.</P><PCLASS="para">There are also programs available that can help to manage large and numerousmailing lists. We will cover them later in this chapter.</P></DIV><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="SML2-CH-25-SECT-5-4">25.5.4 Users Ignore list-request</A></H3><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-23789"></A>It is impossible to cause all users to interact properly witha mailing list. For example, all submissions to a listshould (strictly speaking)be mailed to <EMCLASS="emphasis">list</EM>, whereas communicationsto the list maintainer should be mailed to <EMCLASS="emphasis">list-request</EM>.As a list maintainer, you will find that usersmistakenly reverse these roles surprisingly often.</P><PCLASS="para">One possible cure is to insert instructions ineach mailing at the start of the message.In the header, for example, <CODECLASS="literal">Comment:</CODE> lines can be usedlike this:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">Comment: &quot;listname&quot; INSTRUCTIONSComment: To be added to, removed from, or have your address changedComment: in this list, send mail to &quot;listname-request&quot;.</PRE></BLOCKQUOTE></P><PCLASS="para">Unfortunately, user inattention usually dooms such schemes tofailure.You can put instructions everywhere, but some users will stillsend their requests to the wrong address.</P><PCLASS="para">A solution some sites use when the list is used only forofficial and rare mailings is to install the list namein the aliases file just before the mailing:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">list:	:include: /usr/local/lists/official.list     <ICLASS="lineannotation"><IMGSRC="../chars/larr.gif"ALT="&lt;-"> before</I></PRE></BLOCKQUOTE></P><PCLASS="para">Then run <EMCLASS="emphasis">newaliases</EM>(1) and send mail to the <EMCLASS="emphasis">list</EM>. After all the mail for the listhas been queued, edit the aliases file and comment out thatentry:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">#list:	:include: /usr/local/lists/official.list     <ICLASS="lineannotation"><IMGSRC="../chars/larr.gif"ALT="&lt;-"> after</I></PRE></BLOCKQUOTE></P><PCLASS="para">Run <EMCLASS="emphasis">newaliases</EM>(1) again, and you will have disabled that list.That way, mail that is wrongly sent to <EMCLASS="emphasis">list</EM> will bounce back to the sender who made the mistake instead of wrongly being broadcastto the list as a whole.</P></DIV><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="SML2-CH-25-SECT-5-5">25.5.5 Precedence: bulk</A></H3><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-23815"></A><ACLASS="indexterm"NAME="AUTOID-23817"></A><ACLASS="indexterm"NAME="AUTOID-23820"></A>All mass mailings, such as mailing-list mailings, should havea header <CODECLASS="literal">Precedence:</CODE> line that gives a priorityof <CODECLASS="literal">bulk</CODE>, <CODECLASS="literal">junk</CODE>, or <CODECLASS="literal">list</CODE>.On the local machine these prioritiescause the message to be processed from the queue afterhigher-priority mail. At other sites these prioritieswill cause well-designed programs (such as the newer <EMCLASS="emphasis">vacation</EM>(1)[4]program) to skip automatically replying to such messages.</P><BLOCKQUOTECLASS="footnote"><PCLASS="para">[4] The <EMCLASS="emphasis">vacation</EM>(1) program is a wonderful tool for advisingothers that mail will not be attended to for a while. Unfortunately,some older versions of that program still exist that reply to<CODECLASS="literal">bulk</CODE> mail, thereby causing problems for the mailing-list maintainer. <ACLASS="indexterm"NAME="AUTOID-23831"></A></P></BLOCKQUOTE></DIV><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="SML2-CH-25-SECT-5-6">25.5.6 X.400 Addresses</A></H3><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-23836"></A><ACLASS="indexterm"NAME="AUTOID-23838"></A>The X.400 telecommunications standard is finding increased acceptancein Europe and by the U.S. government. Addresses underX.400 always begin with a leading slash, which can cause <EMCLASS="emphasis">sendmail</EM>to think that the address is the name of a file when the <CODECLASS="literal">local</CODE>delivery agent is selected:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">/PN=MS.USER/O=CORP/PRMD=CORP/ADMD=TELE/C=US/</PRE></BLOCKQUOTE></P><PCLASS="para">To prevent this misunderstanding, all such addresses should be followed byan <EMCLASS="emphasis">@domain</EM> part to route the message to an appropriateX.400 gateway:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">/PN=MS.USER/O=CORP/PRMD=CORP/ADMD=TELE/C=US/@X.400.gateway.here</PRE></BLOCKQUOTE></P><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-23850"></A><ACLASS="indexterm"NAME="AUTOID-23851"></A></P></DIV></DIV><DIVCLASS="htmlnav"><P></P><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch25_04.htm"TITLE="25.4 Exploder Mailing Lists"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 25.4 Exploder Mailing Lists"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="book"HREF="index.htm"TITLE="sendmail"><IMGSRC="../gifs/txthome.gif"ALT="sendmail"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch25_06.htm"TITLE="25.6 Packages That Help"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 25.6 Packages That Help"BORDER="0"></A></TD></TR><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172">25.4 Exploder Mailing Lists</TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="index"HREF="index/idx_0.htm"TITLE="Book Index"><IMGSRC="../gifs/index.gif"ALT="Book Index"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172">25.6 Packages That Help</TD></TR></TABLE><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><PCLASS="nav"><FONTSIZE="-1">[ <AHREF="../index.htm"TITLE="The Networking CD Bookshelf">Library Home</A> | <AHREF="../dnsbind/index.htm"TITLE="DNS &amp; BIND">DNS &amp; BIND</A> | <AHREF="../tcpip/index.htm"TITLE="TCP/IP Network Administration">TCP/IP</A> | <AHREF="index.htm"TITLE="sendmail">sendmail</A> | <AHREF="../smdref/index.htm"TITLE="sendmail Desktop Reference">sendmail Reference</A> | <AHREF="../firewall/index.htm"TITLE="Building Internet Firewalls">Firewalls</A> | <AHREF="../puis/index.htm"TITLE="Practical UNIX &amp; Internet Security">Practical Security</A> ]</FONT></P></DIV></BODY></HTML>