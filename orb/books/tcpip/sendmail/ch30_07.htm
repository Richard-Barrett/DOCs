<HTML><HEAD><TITLE>[Chapter 30] 30.7 Pitfalls</TITLE><METANAME="DC.title"CONTENT="sendmail"><METANAME="DC.creator"CONTENT="Bryan Costales &amp; Eric Allman"><METANAME="DC.publisher"CONTENT="O'Reilly &amp; Associates, Inc."><METANAME="DC.date"CONTENT="1999-01-06T19:58:25Z"><METANAME="DC.type"CONTENT="Text.Monograph"><METANAME="DC.format"CONTENT="text/html"SCHEME="MIME"><METANAME="DC.source"CONTENT="1-56592-222-0"SCHEME="ISBN"><METANAME="DC.language"CONTENT="en-US"><METANAME="generator"CONTENT="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><LINKREV="made"HREF="mailto:online-books@oreilly.com"TITLE="Online Books Comments"><LINKREL="up"HREF="ch30_01.htm"TITLE="30. Delivery Agents"><LINKREL="prev"HREF="ch30_06.htm"TITLE="30.6 How Executed"><LINKREL="next"HREF="ch30_08.htm"TITLE="30.8 Alphabetized F= Flags"></HEAD><BODYBGCOLOR="#FFFFFF"TEXT="#000000"><DIVCLASS="htmlnav"><H1><IMGSRC="gifs/smbanner.gif"ALT="sendmail"USEMAP="#srchmap"BORDER="0"></H1><MAPNAME="srchmap"><AREASHAPE="RECT"COORDS="0,0,466,65"HREF="index.htm"ALT="sendmail"><AREASHAPE="RECT"COORDS="467,0,514,18"HREF="../search/ssrch.htm"ALT="Search this book"></MAP><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch30_06.htm"TITLE="30.6 How Executed"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 30.6 How Executed"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><B><FONTFACE="ARIEL,HELVETICA,HELV,SANSERIF"SIZE="-1">Chapter 30<BR>Delivery Agents</FONT></B></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch30_08.htm"TITLE="30.8 Alphabetized F= Flags"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 30.8 Alphabetized F= Flags"BORDER="0"></A></TD></TR></TABLE>&nbsp;<HRALIGN="LEFT"WIDTH="515"TITLE="footer"></DIV><DIVCLASS="SECT1"><H2CLASS="sect1"><ACLASS="title"NAME="SML2-CH-30-SECT-7">30.7 Pitfalls</A></H2><ULCLASS="itemizedlist"><LICLASS="listitem"><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-30868"></A><ACLASS="indexterm"NAME="AUTOID-30871"></A><ACLASS="indexterm"NAME="AUTOID-30873"></A>The <CODECLASS="literal">F=f</CODE> and <CODECLASS="literal">F=r</CODE> flags are similar in their implementationbut can differ in their result. Consider, for example, the SunOS 4.x versionof <EMCLASS="emphasis">/bin/mail</EM>. That program expectsthe <CODECLASS="literal">-r</CODE> command-line argument to specify the sender's name.Setting the <CODECLASS="literal">F=r</CODE> flag correctly causes mail to be seen as being from the sender (<CODECLASS="literal">-r sender</CODE>),but mistakenly using the <CODECLASS="literal">F=f</CODE> flag invokes<EMCLASS="emphasis">/bin/mail</EM> with <CODECLASS="literal">-f sender</CODE> instead.This fails, because the SunOS 4.x version of <EMCLASS="emphasis">/bin/mail</EM> expectsthe <CODECLASS="literal">-f</CODE> command-line argument to mean that it shouldinteractively <EMCLASS="emphasis">read</EM> mail from the mailbox named <EMCLASS="emphasis">sender</EM>.</P></LI><LICLASS="listitem"><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-30890"></A>The <CODECLASS="literal">F=C</CODE> flag can cause problems when it is specifiedfor delivery agents for which the <EMCLASS="emphasis">@domain</EM> form of addressis inappropriate. This flag should be avoided for DECNETand the <CODECLASS="literal">local</CODE> delivery agents.</P></LI><LICLASS="listitem"><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-30897"></A>A common problem with SysV versions of <EMCLASS="emphasis">/bin/mail</EM> is its annoying habitof prepending a &quot;<CODECLASS="literal">From&nbsp;</CODE>&quot; line to the beginning ofeach message, even if one is already there. This confusesusers, because it makes their mail appear to come from <EMCLASS="emphasis">uucp</EM>or <EMCLASS="emphasis">daemon</EM> insteadof the real sender.The problem stems from the fact that the SysV <EMCLASS="emphasis">/bin/mail</EM> lacksa <CODECLASS="literal">-r</CODE> command-line argument (or its equivalent) to indicatewho the sender is. Instead, that program assumes that the sender'sidentity can be taken from the identity of the person who ran the program.This works correctly with local mail; but when mail comes in fromthe outside world, <EMCLASS="emphasis">/bin/mail</EM> is being run by<EMCLASS="emphasis">root</EM>, <EMCLASS="emphasis">daemon</EM>, or <EMCLASS="emphasis">uucp</EM>.The best fix is to get a newer <EMCLASS="emphasis">/bin/mail</EM>[15]from one of the many anonymous FTP sites. A less satisfactoryfix is to delete the <CODECLASS="literal">F=n</CODE> flag from the appropriate (usually<CODECLASS="literal">local</CODE>) delivery agent. This leaves two &quot;<CODECLASS="literal">From&nbsp;</CODE>&quot;lines, the second prefixed with a <CODECLASS="literal">&gt;</CODE> character (thecorrect line).</P><BLOCKQUOTECLASS="footnote"><PCLASS="para">[15] The BSD <EMCLASS="emphasis">/bin/mail</EM> requires considerable hacking to get it towork on a SysV machine. Alternatives are <EMCLASS="emphasis">deliver</EM>,the <EMCLASS="emphasis">mh</EM> suite's <EMCLASS="emphasis">slocal</EM>, and <EMCLASS="emphasis">mail.local</EM> that is supplied withthe <EMCLASS="emphasis">sendmail</EM> source distribution.</P></BLOCKQUOTE></LI><LICLASS="listitem"><PCLASS="para">Never use either the <CODECLASS="literal">F=f</CODE> or <CODECLASS="literal">F=r</CODE> flags with the<CODECLASS="literal">prog</CODE> delivery agent. That delivery agent usually runs programsby evoking the Bourne shell, which misinterpretseither flag.The <CODECLASS="literal">-f</CODE> command-line argument tells <EMCLASS="emphasis">/bin/sh</EM> to disablefilename generation.The <CODECLASS="literal">-r</CODE> command-line argument is unknown to <EMCLASS="emphasis">/bin/sh</EM>.Both command-line arguments produce the wrong result.</P></LI></UL></DIV><DIVCLASS="htmlnav"><P></P><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch30_06.htm"TITLE="30.6 How Executed"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 30.6 How Executed"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="book"HREF="index.htm"TITLE="sendmail"><IMGSRC="../gifs/txthome.gif"ALT="sendmail"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch30_08.htm"TITLE="30.8 Alphabetized F= Flags"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 30.8 Alphabetized F= Flags"BORDER="0"></A></TD></TR><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172">30.6 How Executed</TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="index"HREF="index/idx_0.htm"TITLE="Book Index"><IMGSRC="../gifs/index.gif"ALT="Book Index"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172">30.8 Alphabetized F= Flags</TD></TR></TABLE><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><PCLASS="nav"><FONTSIZE="-1">[ <AHREF="../index.htm"TITLE="The Networking CD Bookshelf">Library Home</A> | <AHREF="../dnsbind/index.htm"TITLE="DNS &amp; BIND">DNS &amp; BIND</A> | <AHREF="../tcpip/index.htm"TITLE="TCP/IP Network Administration">TCP/IP</A> | <AHREF="index.htm"TITLE="sendmail">sendmail</A> | <AHREF="../smdref/index.htm"TITLE="sendmail Desktop Reference">sendmail Reference</A> | <AHREF="../firewall/index.htm"TITLE="Building Internet Firewalls">Firewalls</A> | <AHREF="../puis/index.htm"TITLE="Practical UNIX &amp; Internet Security">Practical Security</A> ]</FONT></P></DIV></BODY></HTML>