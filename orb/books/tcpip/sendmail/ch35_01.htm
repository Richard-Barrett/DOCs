<HTML><HEAD><TITLE>[Chapter 35] Headers</TITLE><METANAME="DC.title"CONTENT="sendmail"><METANAME="DC.creator"CONTENT="Bryan Costales &amp; Eric Allman"><METANAME="DC.publisher"CONTENT="O'Reilly &amp; Associates, Inc."><METANAME="DC.date"CONTENT="1999-01-06T21:47:42Z"><METANAME="DC.type"CONTENT="Text.Monograph"><METANAME="DC.format"CONTENT="text/html"SCHEME="MIME"><METANAME="DC.source"CONTENT="1-56592-222-0"SCHEME="ISBN"><METANAME="DC.language"CONTENT="en-US"><METANAME="generator"CONTENT="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><LINKREV="made"HREF="mailto:online-books@oreilly.com"TITLE="Online Books Comments"><LINKREL="up"HREF="part04.htm"TITLE="IV. Reference"><LINKREL="prev"HREF="ch34_08.htm"TITLE="34.8 Alphabetized Reference"><LINKREL="next"HREF="ch35_02.htm"TITLE="35.2 Header Names"></HEAD><BODYBGCOLOR="#FFFFFF"TEXT="#000000"><DIVCLASS="htmlnav"><H1><IMGSRC="gifs/smbanner.gif"ALT="sendmail"USEMAP="#srchmap"BORDER="0"></H1><MAPNAME="srchmap"><AREASHAPE="RECT"COORDS="0,0,466,65"HREF="index.htm"ALT="sendmail"><AREASHAPE="RECT"COORDS="467,0,514,18"HREF="../search/ssrch.htm"ALT="Search this book"></MAP><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch34_08.htm"TITLE="34.8 Alphabetized Reference"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 34.8 Alphabetized Reference"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><B><FONTFACE="ARIEL,HELVETICA,HELV,SANSERIF"SIZE="-1">Chapter 35</FONT></B></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch35_02.htm"TITLE="35.2 Header Names"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 35.2 Header Names"BORDER="0"></A></TD></TR></TABLE>&nbsp;<HRALIGN="LEFT"WIDTH="515"TITLE="footer"></DIV><DIVCLASS="CHAPTER"><H1CLASS="chapter"><ACLASS="title"NAME="SML2-CH-35">35. Headers</A></H1><DIVCLASS="htmltoc"><P><B>Contents:</B><BR><ACLASS="sect1"HREF="#SML2-CH-35-SECT-1"TITLE="35.1 The H Configuration Command">The H Configuration Command</A><BR><ACLASS="sect1"HREF="ch35_02.htm"TITLE="35.2 Header Names">Header Names</A><BR><ACLASS="sect1"HREF="ch35_03.htm"TITLE="35.3 Header Field Contents">Header Field Contents</A><BR><ACLASS="sect1"HREF="ch35_04.htm"TITLE="35.4 ?flags? in Header Definitions">?flags? in Header Definitions</A><BR><ACLASS="sect1"HREF="ch35_05.htm"TITLE="35.5 Header Behavior in conf.c">Header Behavior in conf.c</A><BR><ACLASS="sect1"HREF="ch35_06.htm"TITLE="35.6 Headers by Category">Headers by Category</A><BR><ACLASS="sect1"HREF="ch35_07.htm"TITLE="35.7 Forwarding with Resent-Headers">Forwarding with Resent-Headers</A><BR><ACLASS="sect1"HREF="ch35_08.htm"TITLE="35.8 Precedence">Precedence</A><BR><ACLASS="sect1"HREF="ch35_09.htm"TITLE="35.9 Pitfalls">Pitfalls</A><BR><ACLASS="sect1"HREF="ch35_10.htm"TITLE="35.10 Alphabetized Reference">Alphabetized Reference</A></P><P></P></DIV><PCLASS="para"></P><PCLASS="para">All mail messages are composed of two distinct parts:the header (containing information such as who the message is from) andthe body (the actual text of the message).The two parts are separated from each other by a single blank line(although there are exceptions, which we will cover).The header part used by <EMCLASS="emphasis">sendmail</EM>is mainly defined by RFC822 with some minor clarificationcontained in RFC1123. These two documents detail the required syntax andcontents of most header lines in mail messages.Many other RFCs define other headers, butin this chapter we will discuss header lines as they relatespecifically to <EMCLASS="emphasis">sendmail</EM>, referencing other RFCs as necessary.</P><PCLASS="para">When <EMCLASS="emphasis">sendmail</EM> receives a mail message, it gathers all theheader lines from that message and saves them internally.Then, during queueing and delivery, it recreates them and augmentsthem with any new ones that may be required either by the configuration fileor by <EMCLASS="emphasis">sendmail</EM>'s internal logic.</P><DIVCLASS="sect1"><H2CLASS="sect1"><ACLASS="title"NAME="SML2-CH-35-SECT-1">35.1 The H Configuration Command</A></H2><PCLASS="para"><ACLASS="indexterm"NAME="SML2-CH-35-IX-H-CONFIGURATION-COMMAND"></A>The <CODECLASS="literal">H</CODE> header configuration file command tells <EMCLASS="emphasis">sendmail</EM>which headers are required for inclusion in the header portionof mail messages. Some headers, such as <CODECLASS="literal">Date:</CODE>, are addedonly if one is not already present. Others, such as<CODECLASS="literal">Received:</CODE> (see <ACLASS="xref"HREF="ch35_10.htm#SML2-CH-35-SECT-10-25"TITLE="">Section 35.10.25, Received:</A>) are added even if one or more are alreadypresent.</P><PCLASS="para">The form for the header command is:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">H?<CODECLASS="replaceable"><I>flags</I></CODE>?<CODECLASS="replaceable"><I>name</I></CODE>:<CODECLASS="replaceable"><I>field</I></CODE></PRE></BLOCKQUOTE></P><PCLASS="para">The <CODECLASS="literal">H</CODE> must begin the line.The optional <CODECLASS="literal">?</CODE><CODECLASS="replaceable"><I>flags</I></CODE><CODECLASS="literal">?</CODE>(the question marks are literal),if present, must immediately follow the <CODECLASS="literal">H</CODE>with no intervening space. We will discuss header <CODECLASS="literal">?</CODE><CODECLASS="replaceable"><I>flags</I></CODE><CODECLASS="literal">?</CODE> afterthe <CODECLASS="replaceable"><I>name</I></CODE> and <CODECLASS="replaceable"><I>field</I></CODE> are explained.</P><PCLASS="para">The <CODECLASS="replaceable"><I>name</I></CODE> is the name of the header, such as <CODECLASS="literal">From</CODE>.The <CODECLASS="replaceable"><I>name</I></CODE> must immediately follow the <CODECLASS="literal">?</CODE><CODECLASS="replaceable"><I>flags</I></CODE><CODECLASS="literal">?</CODE>,if present,or the <CODECLASS="literal">H</CODE> if there are no flags.</P><PCLASS="para">A colon then follows, which may be surrounded by optional spacecharacters. The <CODECLASS="replaceable"><I>field</I></CODE> is last and constitutes everything from thefirst nonspace character following the colon to the end of the line:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">H<CODECLASS="replaceable"><I>name</I></CODE>   :   <CODECLASS="replaceable"><I>field</I></CODE>            <ICLASS="lineannotation"><IMGSRC="../chars/uarr.gif"ALT="-^"></I>            <ICLASS="lineannotation">from here to end of line is the field</I></PRE></BLOCKQUOTE></P><PCLASS="para">The colon must be present. If it is absent, <EMCLASS="emphasis">sendmail</EM> printsthe following error message and ignores that <CODECLASS="literal">H</CODE> command:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">header syntax error, line &quot;<ICLASS="lineannotation">offending H command here</I>&quot;</PRE></BLOCKQUOTE></P><PCLASS="para">The &quot;<EMCLASS="emphasis">offending H command here</EM>&quot; is the full text of the <CODECLASS="literal">H</CODE>command in the configuration file that caused the error.</P><PCLASS="para">As with all configuration commands, a line that begins with a spaceor a tab is joined to the line above. In this way, header commandscan be split over one or more lines:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">HReceived: $?sfrom $s $.by $j ($v/$V)      id $i; $b  <ICLASS="lineannotation"><IMGSRC="../chars/uarr.gif"ALT="-^"></I>  <ICLASS="lineannotation">tab</I></PRE></BLOCKQUOTE></P><PCLASS="para">When these two lines are read from the configuration file by<EMCLASS="emphasis">sendmail</EM>, they are internally joined to form the single line:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">HReceived: $?sfrom $s $.by $j ($v/$V)\n      id $i; $b                                          <ICLASS="lineannotation"><IMGSRC="../chars/uarr.gif"ALT="-^"></I>                                          <ICLASS="lineannotation">tab</I></PRE></BLOCKQUOTE></P><PCLASS="para">The <CODECLASS="literal">\n</CODE> above illustrates that when lines are joined, thenewline and tab character are retained. This results in the headerlooking the same as it did in the configuration file (minus the leading <CODECLASS="literal">H</CODE>)when it is later emitted by <EMCLASS="emphasis">sendmail</EM>.<ACLASS="indexterm"NAME="AUTOID-48062"></A></P></DIV></DIV><DIVCLASS="htmlnav"><P></P><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch34_08.htm"TITLE="34.8 Alphabetized Reference"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 34.8 Alphabetized Reference"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="book"HREF="index.htm"TITLE="sendmail"><IMGSRC="../gifs/txthome.gif"ALT="sendmail"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch35_02.htm"TITLE="35.2 Header Names"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 35.2 Header Names"BORDER="0"></A></TD></TR><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172">34.8 Alphabetized Reference</TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="index"HREF="index/idx_0.htm"TITLE="Book Index"><IMGSRC="../gifs/index.gif"ALT="Book Index"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172">35.2 Header Names</TD></TR></TABLE><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><PCLASS="nav"><FONTSIZE="-1">[ <AHREF="../index.htm"TITLE="The Networking CD Bookshelf">Library Home</A> | <AHREF="../dnsbind/index.htm"TITLE="DNS &amp; BIND">DNS &amp; BIND</A> | <AHREF="../tcpip/index.htm"TITLE="TCP/IP Network Administration">TCP/IP</A> | <AHREF="index.htm"TITLE="sendmail">sendmail</A> | <AHREF="../smdref/index.htm"TITLE="sendmail Desktop Reference">sendmail Reference</A> | <AHREF="../firewall/index.htm"TITLE="Building Internet Firewalls">Firewalls</A> | <AHREF="../puis/index.htm"TITLE="Practical UNIX &amp; Internet Security">Practical Security</A> ]</FONT></P></DIV></BODY></HTML>