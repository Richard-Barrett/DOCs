<HTML><HEAD><TITLE>[Chapter 35] 35.9 Pitfalls</TITLE><METANAME="DC.title"CONTENT="sendmail"><METANAME="DC.creator"CONTENT="Bryan Costales &amp; Eric Allman"><METANAME="DC.publisher"CONTENT="O'Reilly &amp; Associates, Inc."><METANAME="DC.date"CONTENT="1999-01-06T21:53:01Z"><METANAME="DC.type"CONTENT="Text.Monograph"><METANAME="DC.format"CONTENT="text/html"SCHEME="MIME"><METANAME="DC.source"CONTENT="1-56592-222-0"SCHEME="ISBN"><METANAME="DC.language"CONTENT="en-US"><METANAME="generator"CONTENT="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><LINKREV="made"HREF="mailto:online-books@oreilly.com"TITLE="Online Books Comments"><LINKREL="up"HREF="ch35_01.htm"TITLE="35. Headers"><LINKREL="prev"HREF="ch35_08.htm"TITLE="35.8 Precedence"><LINKREL="next"HREF="ch35_10.htm"TITLE="35.10 Alphabetized Reference"></HEAD><BODYBGCOLOR="#FFFFFF"TEXT="#000000"><DIVCLASS="htmlnav"><H1><IMGSRC="gifs/smbanner.gif"ALT="sendmail"USEMAP="#srchmap"BORDER="0"></H1><MAPNAME="srchmap"><AREASHAPE="RECT"COORDS="0,0,466,65"HREF="index.htm"ALT="sendmail"><AREASHAPE="RECT"COORDS="467,0,514,18"HREF="../search/ssrch.htm"ALT="Search this book"></MAP><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch35_08.htm"TITLE="35.8 Precedence"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 35.8 Precedence"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><B><FONTFACE="ARIEL,HELVETICA,HELV,SANSERIF"SIZE="-1">Chapter 35<BR>Headers</FONT></B></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch35_10.htm"TITLE="35.10 Alphabetized Reference"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 35.10 Alphabetized Reference"BORDER="0"></A></TD></TR></TABLE>&nbsp;<HRALIGN="LEFT"WIDTH="515"TITLE="footer"></DIV><DIVCLASS="SECT1"><H2CLASS="sect1"><ACLASS="title"NAME="SML2-CH-35-SECT-9">35.9 Pitfalls</A></H2><ULCLASS="itemizedlist"><LICLASS="listitem"><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-49417"></A>Not all MTAs are as RFC822-compliant as <EMCLASS="emphasis">sendmail</EM>.Occasionally, headers appear that were legal under thedefunct RFC733. The <CODECLASS="literal">In-Reply-To:</CODE> header (see <ACLASS="xref"HREF="ch35_10.htm#SML2-CH-35-SECT-10-16"TITLE="">Section 35.10.16</A>),for example, used to be a comma-separated list of addresses under RFC733and may cause problems. Note also thatRFC733 date and time syntax differs from that of RFC822 and RFC1123.</P></LI><LICLASS="listitem"><PCLASS="para">Prior to V8 <EMCLASS="emphasis">sendmail</EM>,if the <CODECLASS="replaceable"><I>name</I></CODE> part of a header definition was missing (the <CODECLASS="literal">H</CODE>was followed by a colon), a header whose name is the character valuezero was silently accepted and wrongly propagated.</P></LI><LICLASS="listitem"><PCLASS="para">Prior to V8 <EMCLASS="emphasis">sendmail</EM>,long header lines in messages (such as <CODECLASS="literal">To:</CODE> with manyrecipients listed) could cause the internal buffer used by <EMCLASS="emphasis">sendmail</EM>to overflow. The size of that buffer was defined in <EMCLASS="emphasis">conf.h</EM>as MAXLINE and was 1024 characters. The IDA version defined it as2048 characters. V8 <EMCLASS="emphasis">sendmail</EM> dynamically allocates memoryand so can handle headers of any size.</P></LI><LICLASS="listitem"><PCLASS="para">When generating an <CODECLASS="literal">Apparently-To:</CODE> header, <EMCLASS="emphasis">sendmail</EM>checks for the absence of only the <CODECLASS="literal">To:</CODE>, <CODECLASS="literal">Cc:</CODE>,<CODECLASS="literal">Bcc:</CODE>, and <CODECLASS="literal">Apparently-To:</CODE> headers. TheH_RCPT flag (see <ACLASS="xref"HREF="ch35_05.htm#SML2-CH-35-SECT-5-2"TITLE="H_RCPT">Section 35.5.2</A>) in <EMCLASS="emphasis">conf.c</EM> is ignored. V8.7 <EMCLASS="emphasis">sendmail</EM> will produce an <CODECLASS="literal">Apparently-To:</CODE> header only if the <CODECLASS="literal">NoRecipientAction</CODE>option is set to <EMCLASS="emphasis">add-apparently-to</EM>.</P></LI><LICLASS="listitem"><PCLASS="para">Prior to V8.7the <EMCLASS="emphasis">sendmail</EM> program's handling of unbalanced specialcharacters could lead to an explosion of error mail. Instead ofsimply bouncing the offending mail message, it bothreturned an error message and forwarded the message to the recipient.If the message was being exploded through a series of mailing lists,the error messages continued to increase, possibly drowningthe original site with mail.</P></LI><LICLASS="listitem"><PCLASS="para">Precedence values are stored in integer variables, so care should beexercised on 2 byte integer machines to avoid having prioritieswrap unexpectedly.</P></LI><LICLASS="listitem"><PCLASS="para">Macros are not expanded in the <CODECLASS="literal">P</CODE> command.That is, expressions such as <CODECLASS="literal">$U</CODE> do not have the desiredeffect. The literal text <CODECLASS="literal">$U</CODE> is wrongly listed as the nameor the value.</P></LI></UL></DIV><DIVCLASS="htmlnav"><P></P><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch35_08.htm"TITLE="35.8 Precedence"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 35.8 Precedence"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="book"HREF="index.htm"TITLE="sendmail"><IMGSRC="../gifs/txthome.gif"ALT="sendmail"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch35_10.htm"TITLE="35.10 Alphabetized Reference"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 35.10 Alphabetized Reference"BORDER="0"></A></TD></TR><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172">35.8 Precedence</TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="index"HREF="index/idx_0.htm"TITLE="Book Index"><IMGSRC="../gifs/index.gif"ALT="Book Index"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172">35.10 Alphabetized Reference</TD></TR></TABLE><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><PCLASS="nav"><FONTSIZE="-1">[ <AHREF="../index.htm"TITLE="The Networking CD Bookshelf">Library Home</A> | <AHREF="../dnsbind/index.htm"TITLE="DNS &amp; BIND">DNS &amp; BIND</A> | <AHREF="../tcpip/index.htm"TITLE="TCP/IP Network Administration">TCP/IP</A> | <AHREF="index.htm"TITLE="sendmail">sendmail</A> | <AHREF="../smdref/index.htm"TITLE="sendmail Desktop Reference">sendmail Reference</A> | <AHREF="../firewall/index.htm"TITLE="Building Internet Firewalls">Firewalls</A> | <AHREF="../puis/index.htm"TITLE="Practical UNIX &amp; Internet Security">Practical Security</A> ]</FONT></P></DIV></BODY></HTML>