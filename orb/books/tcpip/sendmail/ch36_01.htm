<HTML><HEAD><TITLE>[Chapter 36] The Command Line</TITLE><METANAME="DC.title"CONTENT="sendmail"><METANAME="DC.creator"CONTENT="Bryan Costales &amp; Eric Allman"><METANAME="DC.publisher"CONTENT="O'Reilly &amp; Associates, Inc."><METANAME="DC.date"CONTENT="1999-01-06T21:56:11Z"><METANAME="DC.type"CONTENT="Text.Monograph"><METANAME="DC.format"CONTENT="text/html"SCHEME="MIME"><METANAME="DC.source"CONTENT="1-56592-222-0"SCHEME="ISBN"><METANAME="DC.language"CONTENT="en-US"><METANAME="generator"CONTENT="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><LINKREV="made"HREF="mailto:online-books@oreilly.com"TITLE="Online Books Comments"><LINKREL="up"HREF="part04.htm"TITLE="IV. Reference"><LINKREL="prev"HREF="ch35_10.htm"TITLE="35.10 Alphabetized Reference"><LINKREL="next"HREF="ch36_02.htm"TITLE="36.2 Command-Line Switches"></HEAD><BODYBGCOLOR="#FFFFFF"TEXT="#000000"><DIVCLASS="htmlnav"><H1><IMGSRC="gifs/smbanner.gif"ALT="sendmail"USEMAP="#srchmap"BORDER="0"></H1><MAPNAME="srchmap"><AREASHAPE="RECT"COORDS="0,0,466,65"HREF="index.htm"ALT="sendmail"><AREASHAPE="RECT"COORDS="467,0,514,18"HREF="../search/ssrch.htm"ALT="Search this book"></MAP><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch35_10.htm"TITLE="35.10 Alphabetized Reference"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 35.10 Alphabetized Reference"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><B><FONTFACE="ARIEL,HELVETICA,HELV,SANSERIF"SIZE="-1">Chapter 36</FONT></B></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch36_02.htm"TITLE="36.2 Command-Line Switches"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 36.2 Command-Line Switches"BORDER="0"></A></TD></TR></TABLE>&nbsp;<HRALIGN="LEFT"WIDTH="515"TITLE="footer"></DIV><DIVCLASS="CHAPTER"><H1CLASS="chapter"><ACLASS="title"NAME="SML2-CH-36">36. The Command Line</A></H1><DIVCLASS="htmltoc"><P><B>Contents:</B><BR><ACLASS="sect1"HREF="#SML2-CH-36-SECT-1"TITLE="36.1 Alternative argv[0] Names">Alternative argv[0] Names</A><BR><ACLASS="sect1"HREF="ch36_02.htm"TITLE="36.2 Command-Line Switches">Command-Line Switches</A><BR><ACLASS="sect1"HREF="ch36_03.htm"TITLE="36.3 List of Recipient Addresses">List of Recipient Addresses</A><BR><ACLASS="sect1"HREF="ch36_04.htm"TITLE="36.4 Processing the Command Line">Processing the Command Line</A><BR><ACLASS="sect1"HREF="ch36_05.htm"TITLE="36.5 sendmail's exit() Status">sendmail's exit() Status</A><BR><ACLASS="sect1"HREF="ch36_06.htm"TITLE="36.6 Pitfalls">Pitfalls</A><BR><ACLASS="sect1"HREF="ch36_07.htm"TITLE="36.7 Alphabetized Reference">Alphabetized Reference</A></P><P></P></DIV><PCLASS="para"></P><PCLASS="para">The initial behavior of <EMCLASS="emphasis">sendmail</EM> is determined largely bythe command line used to invoke it. The command linecan, for example, cause <EMCLASS="emphasis">sendmail</EM> to use a different configuration fileor to rebuild the <EMCLASS="emphasis">aliases</EM> file rather than deliver mail.The command line can be typed at yourkeyboard, executed from a boot-time script, or even executedby an MUA when sending mail.</P><PCLASS="para">The format of the <EMCLASS="emphasis">sendmail</EM> command line is:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen"><CODECLASS="replaceable"><I>argv[0] switches recipients</I></CODE></PRE></BLOCKQUOTE></P><PCLASS="para">Here, <CODECLASS="replaceable"><I>argv[0]</I></CODE> is the name used to run <EMCLASS="emphasis">sendmail</EM>.The <CODECLASS="replaceable"><I>switches</I></CODE>, if any of them are present,must always precede the list of recipients. The <CODECLASS="replaceable"><I>recipients</I></CODE>is a list of zero or more recipient address expressions.</P><DIVCLASS="sect1"><H2CLASS="sect1"><ACLASS="title"NAME="SML2-CH-36-SECT-1">36.1 Alternative argv[0] Names</A></H2><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-50634"></A><ACLASS="indexterm"NAME="AUTOID-50637"></A>The <EMCLASS="emphasis">sendmail</EM> program may exist in any of several places, dependingon the version of the operating system you are running.Usually, it is located in the <EMCLASS="emphasis">/usr/lib</EM> directory and is called <EMCLASS="emphasis">sendmail</EM>,[1]but it can alternatively be located in the <EMCLASS="emphasis">/etc</EM>, <EMCLASS="emphasis">/usr/sbin</EM>,or <EMCLASS="emphasis">/usr/etc</EM> directory.The location of the <EMCLASS="emphasis">sendmail</EM> program can be found by examiningthe <EMCLASS="emphasis">/etc/rc</EM> files for BSD UNIX or the <EMCLASS="emphasis">/etc/init.d</EM> filesfor Sys V UNIX (see <ACLASS="xref"HREF="ch03_04.htm"TITLE="Role as a Daemon">Section 3.4, "Role as a Daemon"</A>).</P><BLOCKQUOTECLASS="footnote"><PCLASS="para">[1] On Sun systems you will find <EMCLASS="emphasis">/usr/lib/sendmail.mx</EM> for use with theDomain Name System.</P></BLOCKQUOTE><PCLASS="para">In addition to the name <EMCLASS="emphasis">sendmail</EM>, other names (in other directories)can exist that alter the behavior of <EMCLASS="emphasis">sendmail</EM>. Those alternative namesare usually symbolic links to <EMCLASS="emphasis">/usr/lib/sendmail</EM>. On somesystems they may be hard links, and in rare cases you may actuallyfind them to be copies. The complete list of other names is shown in<ACLASS="xref"HREF="ch36_01.htm#SML2-CH-36-TAB-0"TITLE="&quot;Alternative">Table 36.1</A>.<ACLASS="indexterm"NAME="AUTOID-50657"></A></P><TABLECLASS="table"><CAPTIONCLASS="table"><ACLASS="title"NAME="SML2-CH-36-TAB-0">Table 36.1: &quot;Alternative</A></CAPTION><THEADCLASS="thead"><TRCLASS="row"VALIGN="TOP"><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Name</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1"></TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Mode of Operation</TH></TR></THEAD><TBODYCLASS="tbody"><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">hoststat</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><ACLASS="xref"HREF="ch36_01.htm#SML2-CH-36-SECT-1-1"TITLE="hoststat (V8.8 and Above)">Section 36.1.1, "hoststat (V8.8 and Above)"</A></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Print persistent host status (V8.8 and above)</P></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">mailq</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><ACLASS="xref"HREF="ch36_01.htm#SML2-CH-36-SECT-1-2"TITLE="mailq">Section 36.1.2, "mailq"</A></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Print the queue contents</P></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">newaliases</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><ACLASS="xref"HREF="ch36_01.htm#SML2-CH-36-SECT-1-3"TITLE="newaliases">Section 36.1.3, "newaliases"</A></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Rebuild the <EMCLASS="emphasis">aliases</EM> file</P></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">purgestat</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><ACLASS="xref"HREF="ch36_01.htm#SML2-CH-36-SECT-1-4"TITLE="purgestat (V8.8 and Above)">Section 36.1.4, "purgestat (V8.8 and Above)"</A></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Purge persistent host status (V8.8 and above)</P></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">smtpd</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><ACLASS="xref"HREF="ch36_01.htm#SML2-CH-36-SECT-1-5"TITLE="smtpd">Section 36.1.5, "smtpd"</A></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Run in daemon mode</P></TD></TR></TBODY></TABLE><PCLASS="para">When <EMCLASS="emphasis">sendmail</EM> looks for the name under which it is running,it strips any leading directory components from <EMCLASS="emphasis">argv[0]</EM>and compares the result (in a case-sensitive fashion) to its internallist of alternative names.If a match is found, its mode of operation ischanged to conform to that of the alternative name. Ifno match is found (if, say, a link is named <EMCLASS="emphasis">Mailq</EM>, note theuppercase <EMCLASS="emphasis">M</EM>), <EMCLASS="emphasis">sendmail</EM> does not change its mode.</P><PCLASS="para">The name that is found is used tobuild an argument list for use with process listings. For example,if the name was <EMCLASS="emphasis">sendmail.mx</EM> (from SunOS), a process listingproduced with <EMCLASS="emphasis">ps</EM>(3) would look something like this:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">root  1247  620 p0 S  07:22 0:00 -AA15186 (sendmail.mx)</PRE></BLOCKQUOTE></P><PCLASS="para">Here, the <CODECLASS="literal">(sendmail.mx)</CODE> shows that <EMCLASS="emphasis">sendmail</EM> was rununder the name <EMCLASS="emphasis">sendmail.mx</EM>.</P><PCLASS="para">Note that <EMCLASS="emphasis">sendmail</EM> uses the hard-coded name &quot;<EMCLASS="emphasis">sendmail</EM>&quot;for logging purposes with <EMCLASS="emphasis">syslog</EM>(3) (see <ACLASS="xref"HREF="ch26_01.htm#SML2-CH-26-SECT-1-1"TITLE="syslog(3)">Section 26.1.1, "syslog(3)"</A>).Therefore logged errors and warnings always appear tocome from <EMCLASS="emphasis">sendmail</EM>, no matter what name was used to run it.</P><PCLASS="para">As a final note, be aware that command-line switches are processed immediatelyafter the name but before <EMCLASS="emphasis">sendmail</EM> finalizes its modeof operation. Thus the use of particular switches can completelycancel any special meaning given a name.</P><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="SML2-CH-36-SECT-1-1">36.1.1 hoststat (V8.8 and Above)</A></H3><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-50726"></A>The <EMCLASS="emphasis">hoststat</EM> command is a synonym for the <CODECLASS="literal">-bh</CODE>command-line switch. It causes <EMCLASS="emphasis">sendmail</EM> to print itspersistent host status and exit.Persistent host status is enabled with the <CODECLASS="literal">HostStatusDirectory</CODE> option (see <ACLASS="xref"HREF="ch34_08.htm#SML2-CH-34-SECT-8-31"TITLE="">Section 34.8.31, HostStatusDirectory</A>).</P><PCLASS="para">&#13;The output produced by this command begins with a heading like this:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">------- Hostname -------- How long ago -----Results-----</PRE></BLOCKQUOTE></P><PCLASS="para">Then for each host that has its status saved, <EMCLASS="emphasis">sendmail</EM> printsthis information:</P><DLCLASS="variablelist"><DTCLASS="term"><CODECLASS="literal">Hostname</CODE></DT><DDCLASS="listitem"><PCLASS="para">This is the name of the host that was connected to. It may not be the hostnamespecified for the recipient. It could easily be an MX record instead.If a message has multiple recipients, a separate status line will be producedfor each unique host that is tried. If this name is prefixed with an asterisk, thestatus file is locked and currently being updated.</P></DD><DTCLASS="term"><CODECLASS="literal">How long ago</CODE></DT><DDCLASS="listitem"><PCLASS="para">This shows how long ago this status record was updated. It is printed in the form:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">DD+HH:MM:SS</PRE></BLOCKQUOTE></P><PCLASS="para">Here, <CODECLASS="literal">DD</CODE> is the number of days. If the status was updated less thana day ago, the <CODECLASS="literal">DD+</CODE> is omitted. The <CODECLASS="literal">HH</CODE> is hours, the <CODECLASS="literal">MM</CODE>is minutes, and the <CODECLASS="literal">SS</CODE> is seconds. The colons are literal.</P></DD><DTCLASS="term"><CODECLASS="literal">Results</CODE></DT><DDCLASS="listitem"><PCLASS="para">This shows the result of the last connection attempt, failure, or success.If no reason was stored, this prints as:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">No status available</PRE></BLOCKQUOTE></P><PCLASS="para">If a result was stored, it will print in three parts:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen"><CODECLASS="replaceable"><I>smtp id msg</I></CODE></PRE></BLOCKQUOTE></P><PCLASS="para">The <CODECLASS="replaceable"><I>smtp</I></CODE> is the SMTP reply code. The <CODECLASS="replaceable"><I>msg</I></CODE> is the text of the message generated by the other endor other program.</P></DD></DL><PCLASS="para">To illustrate, consider this output:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">------- Hostname -------- How long ago -----Results----- there.ufoa.edu                              00:00:51 250 PAA27153 Message acce*books.ora.com                               07:43:39 250 GAA01255 Message acce prog.ammers.com                             06:55:08 No status available fbi.dc.gov                                  03:28:53 Connection refused</PRE></BLOCKQUOTE></P><PCLASS="para">Here, the previous connections to <EMCLASS="emphasis">there.ufoa.edu</EM> and<EMCLASS="emphasis">books.ora.com</EM> were successful. The status for<EMCLASS="emphasis">books.ora.com</EM> is currently being updated, hence theasterisk showing it is locked. The host <EMCLASS="emphasis">prog.ammers.com</EM>shows no status because connection to it could not be made.The last example show that the connection to <EMCLASS="emphasis">fbi.dc.gov</EM>was refused by that host.</P><PCLASS="para">Note that the results are limited to 27 characters unless the <CODECLASS="literal">-v</CODE>command-line flag is also used. In that case, results are limitedto 79 characters, thus providing more complete information.</P></DIV><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="SML2-CH-36-SECT-1-2">36.1.2 mailq</A></H3><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-50785"></A>The name <EMCLASS="emphasis">mailq</EM> (a synonym for the <CODECLASS="literal">-bp</CODE> command-line switch)causes <EMCLASS="emphasis">sendmail</EM> to print the contents of themail queue and then exit (see <ACLASS="xref"HREF="ch23_04.htm"TITLE="Printing the Queue">Section 23.4, "Printing the Queue"</A>).</P><PCLASS="para">Note that the location of the queue is set with the <CODECLASS="literal">QueueDirectory</CODE> (<CODECLASS="literal">Q</CODE>) option (see <ACLASS="xref"HREF="ch34_08.htm#SML2-CH-34-SECT-8-48"TITLE="">Section 34.8.48, QueueDirectory (Q)</A>).That location can be overridden from the command line, but if it is,<EMCLASS="emphasis">sendmail</EM> may give up its <EMCLASS="emphasis">root</EM> privilege (unless it wasrun by <EMCLASS="emphasis">root</EM>).</P></DIV><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="SML2-CH-36-SECT-1-3">36.1.3 newaliases</A></H3><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-50801"></A>The name <EMCLASS="emphasis">newaliases</EM> (a synonym for the <CODECLASS="literal">-bi</CODE> command-line switch)causes <EMCLASS="emphasis">sendmail</EM> to rebuild the<EMCLASS="emphasis">aliases</EM> database files, print summary information, and thenimmediately exit (see <ACLASS="xref"HREF="ch24_05.htm#SML2-CH-24-SECT-5-1"TITLE="Rebuild the Alias Database">Section 24.5.1, "Rebuild the Alias Database"</A>).In this mode the <CODECLASS="literal">-v</CODE> command-line switch (see <ACLASS="xref"HREF="ch36_07.htm#SML2-CH-36-SECT-7-41"TITLE="">Section 36.7.41, -v</A>)is automatically implied, and <EMCLASS="emphasis">sendmail</EM> runs in verbose mode.</P><PCLASS="para">The location of the <EMCLASS="emphasis">aliases</EM> file is given in the configurationfile with the <CODECLASS="literal">AliasFile</CODE> (<CODECLASS="literal">A</CODE>) option (see <ACLASS="xref"HREF="ch34_08.htm#SML2-CH-34-SECT-8-1"TITLE="">Section 34.8.1, AliasFile (A)</A>).That location can be overriddenfrom the command line, but if it is,<EMCLASS="emphasis">sendmail</EM> gives up its <EMCLASS="emphasis">root</EM> privilege (unlessit was run by <EMCLASS="emphasis">root</EM>).</P></DIV><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="SML2-CH-36-SECT-1-4">36.1.4 purgestat (V8.8 and Above)</A></H3><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-50822"></A>The name <EMCLASS="emphasis">purgestat</EM> is a synonym for the V8.8 and above <CODECLASS="literal">-bH</CODE>command-line switch (see <ACLASS="xref"HREF="ch36_07.htm#SML2-CH-36-SECT-7-6"TITLE="">Section 36.7.6, -bH</A>).It causes <EMCLASS="emphasis">sendmail</EM> to clear (purge) all the host-status informationthat was being saved under the <CODECLASS="literal">HostStatusDirectory</CODE> option's directory(see <ACLASS="xref"HREF="ch34_08.htm#SML2-CH-34-SECT-8-31"TITLE="">Section 34.8.31</A>).Clearing is done by removing all the directories under the <CODECLASS="literal">HostStatusDirectory</CODE> directory.Note that the <CODECLASS="literal">HostStatusDirectory</CODE> directory is not itself removed.</P></DIV><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="SML2-CH-36-SECT-1-5">36.1.5 smtpd</A></H3><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-50835"></A>The name <EMCLASS="emphasis">smtpd</EM> is a synonym for the <CODECLASS="literal">-bd</CODE> command-lineswitch (see <ACLASS="xref"HREF="ch36_07.htm#SML2-CH-36-SECT-7-5"TITLE="">Section 36.7.5, -bd</A>). It causes <EMCLASS="emphasis">sendmail</EM> to run in the backgroundas a daemon, listening for incoming SMTP mail (see <ACLASS="xref"HREF="ch04_01.htm#SML2-CH-4-SECT-1-1"TITLE="Daemon Mode (-bd)">Section 4.1.1, "Daemon Mode (-bd)"</A>).This mode of operatingis usually combined with the <CODECLASS="literal">-q</CODE> command-line switch(see <ACLASS="xref"HREF="ch23_06.htm#SML2-CH-23-SECT-6-1"TITLE="Periodically with -q">Section 23.6.1, "Periodically with -q"</A>), which causes<EMCLASS="emphasis">sendmail</EM> to periodically process the queue.</P></DIV></DIV></DIV><DIVCLASS="htmlnav"><P></P><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch35_10.htm"TITLE="35.10 Alphabetized Reference"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 35.10 Alphabetized Reference"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="book"HREF="index.htm"TITLE="sendmail"><IMGSRC="../gifs/txthome.gif"ALT="sendmail"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch36_02.htm"TITLE="36.2 Command-Line Switches"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 36.2 Command-Line Switches"BORDER="0"></A></TD></TR><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172">35.10 Alphabetized Reference</TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="index"HREF="index/idx_0.htm"TITLE="Book Index"><IMGSRC="../gifs/index.gif"ALT="Book Index"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172">36.2 Command-Line Switches</TD></TR></TABLE><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><PCLASS="nav"><FONTSIZE="-1">[ <AHREF="../index.htm"TITLE="The Networking CD Bookshelf">Library Home</A> | <AHREF="../dnsbind/index.htm"TITLE="DNS &amp; BIND">DNS &amp; BIND</A> | <AHREF="../tcpip/index.htm"TITLE="TCP/IP Network Administration">TCP/IP</A> | <AHREF="index.htm"TITLE="sendmail">sendmail</A> | <AHREF="../smdref/index.htm"TITLE="sendmail Desktop Reference">sendmail Reference</A> | <AHREF="../firewall/index.htm"TITLE="Building Internet Firewalls">Firewalls</A> | <AHREF="../puis/index.htm"TITLE="Practical UNIX &amp; Internet Security">Practical Security</A> ]</FONT></P></DIV></BODY></HTML>