<HTML><HEAD><TITLE>[Chapter 38] Rule-Set Testing with -bt</TITLE><METANAME="DC.title"CONTENT="sendmail"><METANAME="DC.creator"CONTENT="Bryan Costales &amp; Eric Allman"><METANAME="DC.publisher"CONTENT="O'Reilly &amp; Associates, Inc."><METANAME="DC.date"CONTENT="1999-01-06T22:47:03Z"><METANAME="DC.type"CONTENT="Text.Monograph"><METANAME="DC.format"CONTENT="text/html"SCHEME="MIME"><METANAME="DC.source"CONTENT="1-56592-222-0"SCHEME="ISBN"><METANAME="DC.language"CONTENT="en-US"><METANAME="generator"CONTENT="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><LINKREV="made"HREF="mailto:online-books@oreilly.com"TITLE="Online Books Comments"><LINKREL="up"HREF="part04.htm"TITLE="IV. Reference"><LINKREL="prev"HREF="ch37_05.htm"TITLE="37.5 Reference in Numerical Order"><LINKREL="next"HREF="ch38_02.htm"TITLE="38.2 Configuration Lines"></HEAD><BODYBGCOLOR="#FFFFFF"TEXT="#000000"><DIVCLASS="htmlnav"><H1><IMGSRC="gifs/smbanner.gif"ALT="sendmail"USEMAP="#srchmap"BORDER="0"></H1><MAPNAME="srchmap"><AREASHAPE="RECT"COORDS="0,0,466,65"HREF="index.htm"ALT="sendmail"><AREASHAPE="RECT"COORDS="467,0,514,18"HREF="../search/ssrch.htm"ALT="Search this book"></MAP><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch37_05.htm"TITLE="37.5 Reference in Numerical Order"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 37.5 Reference in Numerical Order"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><B><FONTFACE="ARIEL,HELVETICA,HELV,SANSERIF"SIZE="-1">Chapter 38</FONT></B></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch38_02.htm"TITLE="38.2 Configuration Lines"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 38.2 Configuration Lines"BORDER="0"></A></TD></TR></TABLE>&nbsp;<HRALIGN="LEFT"WIDTH="515"TITLE="footer"></DIV><DIVCLASS="CHAPTER"><H1CLASS="chapter"><ACLASS="title"NAME="SML2-CH-38">38. Rule-Set Testing with -bt</A></H1><DIVCLASS="htmltoc"><P><B>Contents:</B><BR><ACLASS="sect1"HREF="#SML2-CH-38-SECT-1"TITLE="38.1 Overview">Overview</A><BR><ACLASS="sect1"HREF="ch38_02.htm"TITLE="38.2 Configuration Lines">Configuration Lines</A><BR><ACLASS="sect1"HREF="ch38_03.htm"TITLE="38.3 Dump a Macro">Dump a Macro</A><BR><ACLASS="sect1"HREF="ch38_04.htm"TITLE="38.4 Show an Item">Show an Item</A><BR><ACLASS="sect1"HREF="ch38_05.htm"TITLE="38.5 Complex Actions">Complex Actions</A><BR><ACLASS="sect1"HREF="ch38_06.htm"TITLE="38.6 Process-Specified Addresses">Process-Specified Addresses</A><BR><ACLASS="sect1"HREF="ch38_07.htm"TITLE="38.7 Add Debugging for Detail">Add Debugging for Detail</A><BR><ACLASS="sect1"HREF="ch38_08.htm"TITLE="38.8 Batch Rule-Set Testing">Batch Rule-Set Testing</A><BR><ACLASS="sect1"HREF="ch38_09.htm"TITLE="38.9 Pitfalls">Pitfalls</A></P><P></P></DIV><PCLASS="para"></P><PCLASS="para">The <EMCLASS="emphasis">sendmail</EM> program offers a mode of operation (called rule testingmode) that allows you to observe the flow of addresses through rule sets.The <CODECLASS="literal">-bt</CODE> command-line switch causes <EMCLASS="emphasis">sendmail</EM> to run inrule-testing mode. This mode is interactive. Youenter rule set numbers, addresses, and other commands, and <EMCLASS="emphasis">sendmail</EM>processes them and prints the results. The <CODECLASS="literal">-bt</CODE>switch's chief use is in testing changes inthe configuration file.It is also useful for learning how rules and rule sets work.<ACLASS="indexterm"NAME="SML2-CH-38-IX-B-SWITCH-BT-SWITCH"></A><ACLASS="indexterm"NAME="SML2-CH-38-IX-TESTING-RULE-TESTING-MODE"></A><ACLASS="indexterm"NAME="SML2-CH-38-IX-RULE-TESTING-MODE"></A>&#13;</P><DIVCLASS="sect1"><H2CLASS="sect1"><ACLASS="title"NAME="SML2-CH-38-SECT-1">38.1 Overview</A></H2><PCLASS="para">The following command runs <EMCLASS="emphasis">sendmail</EM> in rule-testing mode:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">% <CODECLASS="userinput"><B>/usr/lib/sendmail -bt</B></CODE></PRE></BLOCKQUOTE></P><PCLASS="para">At first, the output produced by this command line prompts you like this:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">ADDRESS TEST MODE (ruleset 3 NOT automatically invoked)Enter &lt;ruleset&gt; &lt;address&gt;&gt;</PRE></BLOCKQUOTE></P><PCLASS="para">The &quot;ruleset 3&quot; statement says that, beginning with V8 (and IDA)<EMCLASS="emphasis">sendmail</EM>, rule set 3 is no longer automatically called whenrule sets are listed at the prompt. We cover this new property in detailin  <ACLASS="xref"HREF="ch38_06.htm#SML2-CH-38-SECT-6-2"TITLE="The Address">Section 38.6.2, "The Address"</A>.</P><PCLASS="para">Prior to V8 <EMCLASS="emphasis">sendmail</EM>, rule-testing mode could be used only to test addresses. But beginningwith V8.7 <EMCLASS="emphasis">sendmail</EM> new functions have been added.To see a summary of those functions, enter a <CODECLASS="literal">?</CODE> characterfollowed by a RETURN at the <CODECLASS="literal">&gt;</CODE> prompt. The output,which we reproduce below, lists and gives a brief descriptionof each function. Note that the numbers to the right refer to the sections in this chapterand are not a part of <EMCLASS="emphasis">sendmail</EM>'s output.</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">&gt; <CODECLASS="userinput"><B>?</B></CODE>Help for test mode:?                :this help message..Dmvalue         :define macro `m' to `value'.                          <ICLASS="lineannotation"><IMGSRC="../chars/larr.gif"ALT="&lt;-"> <ACLASS="xref"HREF="ch38_02.htm#SML2-CH-38-SECT-2-1"TITLE="Define a Macro with .D">Section 38.2.1, "Define a Macro with .D"</A></I>.Ccvalue         :add `value' to class `c'.                             <ICLASS="lineannotation"><IMGSRC="../chars/larr.gif"ALT="&lt;-"> <ACLASS="xref"HREF="ch38_02.htm#SML2-CH-38-SECT-2-2"TITLE="Add to a Class with .C">Section 38.2.2, "Add to a Class with .C"</A></I>=Sruleset        :dump the contents of the indicated ruleset.           <ICLASS="lineannotation"><IMGSRC="../chars/larr.gif"ALT="&lt;-"> <ACLASS="xref"HREF="ch38_04.htm#SML2-CH-38-SECT-4-1"TITLE="Show Rules in a Rule Set with =S">Section 38.4.1, "Show Rules in a Rule Set with =S"</A></I>=M               :display the known mailers.                            <ICLASS="lineannotation"><IMGSRC="../chars/larr.gif"ALT="&lt;-"> <ACLASS="xref"HREF="ch38_04.htm#SML2-CH-38-SECT-4-2"TITLE="Show Delivery Agents with =M">Section 38.4.2, "Show Delivery Agents with =M"</A></I>-ddebug-spec     :equivalent to the command-line -d debug flag.$m               :print the value of macro $m.                          <ICLASS="lineannotation"><IMGSRC="../chars/larr.gif"ALT="&lt;-"> <ACLASS="xref"HREF="ch38_03.htm#SML2-CH-38-SECT-3-1"TITLE="Dump a Defined Macro with $">Section 38.3.1, "Dump a Defined Macro with $"</A></I>$=c              :print the contents of class $=c.                      <ICLASS="lineannotation"><IMGSRC="../chars/larr.gif"ALT="&lt;-"> <ACLASS="xref"HREF="ch38_03.htm#SML2-CH-38-SECT-3-2"TITLE="Dump a Class Macro with $=">Section 38.3.2, "Dump a Class Macro with $="</A></I>/mx host         :returns the MX records for `host'.                    <ICLASS="lineannotation"><IMGSRC="../chars/larr.gif"ALT="&lt;-"> <ACLASS="xref"HREF="ch38_05.htm#SML2-CH-38-SECT-5-2"TITLE="Look Up MX Records with /mx">Section 38.5.2, "Look Up MX Records with /mx"</A></I>/parse address   :parse address, returning the value of crackaddr, and  <ICLASS="lineannotation"><IMGSRC="../chars/larr.gif"ALT="&lt;-"> <ACLASS="xref"HREF="ch38_05.htm#SML2-CH-38-SECT-5-5"TITLE="Parse an Address with /parse">Section 38.5.5, "Parse an Address with /parse"</A></I>                  the parsed address (same as -bv)./try mailer addr :rewrite address into the form it will have when       <ICLASS="lineannotation"><IMGSRC="../chars/larr.gif"ALT="&lt;-"> <ACLASS="xref"HREF="ch38_05.htm#SML2-CH-38-SECT-5-6"TITLE="Try a Delivery Agent with /try">Section 38.5.6, "Try a Delivery Agent with /try"</A></I>                  presented to the indicated mailer./tryflags flags  :set flags used by parsing.  The flags can be `H' for  <ICLASS="lineannotation"><IMGSRC="../chars/larr.gif"ALT="&lt;-"> <ACLASS="xref"HREF="ch38_05.htm#SML2-CH-38-SECT-5-4"TITLE="Select Whom to /parse or /try with /tryflags">Section 38.5.4, "Select Whom to /parse or /try with /tryflags"</A></I>                  Header or `E' for Envelope, and `S' for Sender or `R'                  for Recipient.  These can be combined, `HR' sets                  flags for header recipients./canon hostname  :try to canonify hostname.                             <ICLASS="lineannotation"><IMGSRC="../chars/larr.gif"ALT="&lt;-"> <ACLASS="xref"HREF="ch38_05.htm#SML2-CH-38-SECT-5-1"TITLE="Canonify a Host with /canon">Section 38.5.1, "Canonify a Host with /canon"</A></I>/map mapname key :look up `key' in the indicated `mapname'.             <ICLASS="lineannotation"><IMGSRC="../chars/larr.gif"ALT="&lt;-"> <ACLASS="xref"HREF="ch38_05.htm#SML2-CH-38-SECT-5-3"TITLE="Look up a Database Item with /map">Section 38.5.3, "Look up a Database Item with /map"</A></I>rules addr       :run the indicated address through the named rules.    <ICLASS="lineannotation"><IMGSRC="../chars/larr.gif"ALT="&lt;-"> <ACLASS="xref"HREF="ch38_06.htm"TITLE="Process-Specified Addresses">Section 38.6, "Process-Specified Addresses"</A></I>                  Rules can be a comma separated list of rules.End of HELP info&gt;</PRE></BLOCKQUOTE></P><PCLASS="para">This help output is contained in the <EMCLASS="emphasis">sendmail.hf</EM> file, the locationof which is defined by the <CODECLASS="literal">HelpFile</CODE> (<CODECLASS="literal">H</CODE>) option(see <ACLASS="xref"HREF="ch34_08.htm#SML2-CH-34-SECT-8-28"TITLE="">Section 34.8.28, HelpFile (H)</A>).If that option is not defined or if the file that is specified in it does notexist, you will get the following error message instead of help:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">Sendmail 8.8.4 - HELP not implemented</PRE></BLOCKQUOTE></P><PCLASS="para">Help for rule-testing mode requires that the help file both exist andcontain lines that begin with:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">-bt</PRE></BLOCKQUOTE></P><PCLASS="para">If you installed a new <EMCLASS="emphasis">sendmail</EM> but did not install the new help file(thus causing the old file to be used), you may see this error:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">HELP topic &quot;-bt&quot; unknown</PRE></BLOCKQUOTE></P><PCLASS="para">The solution here is to upgrade your <EMCLASS="emphasis">sendmail.hf</EM> file to the newestversion.</P><PCLASS="para">Note that each of the functions listed in the help output will also produce a usagemessage if it is executed with no arguments. Consider the<CODECLASS="literal">/try</CODE> function, for example:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">&gt; <CODECLASS="userinput"><B>/try</B></CODE>Usage: /try mailer address&gt;</PRE></BLOCKQUOTE></P><PCLASS="para">This parallels the syntax shown in the help output above. These miniusagemessages can effectively replace the <EMCLASS="emphasis">sendmail.hf</EM> file in caseit is missing.</P><PCLASS="para">Finally note that, although address testing was not listed in the help outputfor V8.7 <EMCLASS="emphasis">sendmail</EM>,it still existed. We will cover it in <ACLASS="xref"HREF="ch38_06.htm"TITLE="Process-Specified Addresses">Section 38.6</A>.&#13;</P></DIV></DIV><DIVCLASS="htmlnav"><P></P><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch37_05.htm"TITLE="37.5 Reference in Numerical Order"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 37.5 Reference in Numerical Order"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="book"HREF="index.htm"TITLE="sendmail"><IMGSRC="../gifs/txthome.gif"ALT="sendmail"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch38_02.htm"TITLE="38.2 Configuration Lines"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 38.2 Configuration Lines"BORDER="0"></A></TD></TR><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172">37.5 Reference in Numerical Order</TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="index"HREF="index/idx_0.htm"TITLE="Book Index"><IMGSRC="../gifs/index.gif"ALT="Book Index"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172">38.2 Configuration Lines</TD></TR></TABLE><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><PCLASS="nav"><FONTSIZE="-1">[ <AHREF="../index.htm"TITLE="The Networking CD Bookshelf">Library Home</A> | <AHREF="../dnsbind/index.htm"TITLE="DNS &amp; BIND">DNS &amp; BIND</A> | <AHREF="../tcpip/index.htm"TITLE="TCP/IP Network Administration">TCP/IP</A> | <AHREF="index.htm"TITLE="sendmail">sendmail</A> | <AHREF="../smdref/index.htm"TITLE="sendmail Desktop Reference">sendmail Reference</A> | <AHREF="../firewall/index.htm"TITLE="Building Internet Firewalls">Firewalls</A> | <AHREF="../puis/index.htm"TITLE="Practical UNIX &amp; Internet Security">Practical Security</A> ]</FONT></P></DIV></BODY></HTML>