<HTML><HEAD><TITLE>[Chapter 38] 38.3 Dump a Macro</TITLE><METANAME="DC.title"CONTENT="sendmail"><METANAME="DC.creator"CONTENT="Bryan Costales &amp; Eric Allman"><METANAME="DC.publisher"CONTENT="O'Reilly &amp; Associates, Inc."><METANAME="DC.date"CONTENT="1999-01-06T22:48:07Z"><METANAME="DC.type"CONTENT="Text.Monograph"><METANAME="DC.format"CONTENT="text/html"SCHEME="MIME"><METANAME="DC.source"CONTENT="1-56592-222-0"SCHEME="ISBN"><METANAME="DC.language"CONTENT="en-US"><METANAME="generator"CONTENT="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><LINKREV="made"HREF="mailto:online-books@oreilly.com"TITLE="Online Books Comments"><LINKREL="up"HREF="ch38_01.htm"TITLE="38. Rule-Set Testing with -bt"><LINKREL="prev"HREF="ch38_02.htm"TITLE="38.2 Configuration Lines"><LINKREL="next"HREF="ch38_04.htm"TITLE="38.4 Show an Item"></HEAD><BODYBGCOLOR="#FFFFFF"TEXT="#000000"><DIVCLASS="htmlnav"><H1><IMGSRC="gifs/smbanner.gif"ALT="sendmail"USEMAP="#srchmap"BORDER="0"></H1><MAPNAME="srchmap"><AREASHAPE="RECT"COORDS="0,0,466,65"HREF="index.htm"ALT="sendmail"><AREASHAPE="RECT"COORDS="467,0,514,18"HREF="../search/ssrch.htm"ALT="Search this book"></MAP><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch38_02.htm"TITLE="38.2 Configuration Lines"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 38.2 Configuration Lines"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><B><FONTFACE="ARIEL,HELVETICA,HELV,SANSERIF"SIZE="-1">Chapter 38<BR>Rule-Set Testing with -bt</FONT></B></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch38_04.htm"TITLE="38.4 Show an Item"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 38.4 Show an Item"BORDER="0"></A></TD></TR></TABLE>&nbsp;<HRALIGN="LEFT"WIDTH="515"TITLE="footer"></DIV><DIVCLASS="SECT1"><H2CLASS="sect1"><ACLASS="title"NAME="SML2-CH-38-SECT-3">38.3 Dump a Macro</A></H2><PCLASS="para"><ACLASS="indexterm"NAME="SML2-CH-38-IX-MACROS-DUMPING"></A><ACLASS="indexterm"NAME="SML2-CH-38-IX-DUMPING-MACROS"></A>Beginning with V8.7, the new rule testing commands allow you to printthe value of a defined macro and the members of a class.With either command, you may use single-character or multicharactermacro names.Both commands begin with a <CODECLASS="literal">$</CODE> character. An error is causedif nothing follows that <CODECLASS="literal">$</CODE>:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">Name required for macro/class</PRE></BLOCKQUOTE></P><PCLASS="para">If an <CODECLASS="literal">=</CODE> character follows, <EMCLASS="emphasis">sendmail</EM> will display therequested class. Otherwise, the value of the macro is displayed:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">$X              <ICLASS="lineannotation"><IMGSRC="../chars/larr.gif"ALT="&lt;-"> display the value of the X macro</I>$=X             <ICLASS="lineannotation"><IMGSRC="../chars/larr.gif"ALT="&lt;-"> list the members of the class X</I></PRE></BLOCKQUOTE></P><PCLASS="para"></P><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="SML2-CH-38-SECT-3-1">38.3.1 Dump a Defined Macro with $</A></H3><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-61805"></A>The <CODECLASS="literal">$</CODE> rule-testing command causes <EMCLASS="emphasis">sendmail</EM> to print thevalue of a defined macro. The form for this command looks like this:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">$X               <ICLASS="lineannotation"><IMGSRC="../chars/larr.gif"ALT="&lt;-"> show value of the single character macro name X</I>${YYY}           <ICLASS="lineannotation"><IMGSRC="../chars/larr.gif"ALT="&lt;-"> show value of the multi-character macro name YYY</I></PRE></BLOCKQUOTE></P><PCLASS="para">Only one macro may be listed per line. If more than one is listed,all but the first is ignored:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">$X $Y   <ICLASS="lineannotation"><IMGSRC="../chars/uarr.gif"ALT="-^"></I>   <ICLASS="lineannotation">ignored</I></PRE></BLOCKQUOTE></P><PCLASS="para">One use for this command might be in solving the problem of duplicate domains.For example, suppose you just installed a new configuration file anddiscovered that your host was no longer known as <EMCLASS="emphasis">here.our.domain</EM> butinstead wrongly had an extra domain attached like this: <EMCLASS="emphasis">here.our.domain.our.domain</EM>.To check the value of<CODECLASS="literal">$j</CODE> (see <ACLASS="xref"HREF="ch31_10.htm#SML2-CH-31-SECT-10-20"TITLE="">Section 31.10.20, $j</A>), which should contain the canonicalname of your host, you could run <EMCLASS="emphasis">sendmail</EM> in rule-testing mode:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">ADDRESS TEST MODE (ruleset 3 NOT automatically invoked)Enter &lt;ruleset&gt; &lt;address&gt;&gt; <CODECLASS="userinput"><B>$j</B></CODE>$w.our.domain&gt;</PRE></BLOCKQUOTE></P><PCLASS="para">This looks right because <CODECLASS="literal">$w</CODE> (see <ACLASS="xref"HREF="ch31_10.htm#SML2-CH-31-SECT-10-40"TITLE="">Section 31.10.40, $w</A>)is supposed to contain our short hostname.But just to check, you could also print the value of <CODECLASS="literal">$w</CODE>:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">&gt; <CODECLASS="userinput"><B>$w</B></CODE>here.our.domain</PRE></BLOCKQUOTE></P><PCLASS="para">Aha! Somehow, <CODECLASS="literal">$w</CODE> got the full canonical name. A quick scan of your <EMCLASS="emphasis">.mc</EM> file (see <ACLASS="xref"HREF="ch19_02.htm"TITLE="Build with m4">Section 19.2, "Build with m4"</A>)turns up this error:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">LOCAL_CONFIGDwhere.our.domain           # $w is supposed to be full - joachim</PRE></BLOCKQUOTE></P><PCLASS="para">Apparently, your assistant, Joachim, mistakenly thought that new <EMCLASS="emphasis">sendmail</EM> was wrong.By deleting the offending line and creating a new configuration file, you cantake care of the problem.&#13;</P></DIV><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="SML2-CH-38-SECT-3-2">38.3.2 Dump a Class Macro with $=</A></H3><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-61846"></A>The <CODECLASS="literal">$=</CODE> rule-testing command tells <EMCLASS="emphasis">sendmail</EM> to print all themembers for a class. The class name must immediately follow the<CODECLASS="literal">=</CODE> with no intervening space, or the name is ignored. Both single-character and multicharacternames may be used:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">$= X            <ICLASS="lineannotation"><IMGSRC="../chars/larr.gif"ALT="&lt;-"> the X is ignored</I>$=X             <ICLASS="lineannotation"><IMGSRC="../chars/larr.gif"ALT="&lt;-"> list the members of the class X</I>$={xxx}         <ICLASS="lineannotation"><IMGSRC="../chars/larr.gif"ALT="&lt;-"> list the members of the class xxx</I></PRE></BLOCKQUOTE></P><PCLASS="para">The list of members (if any) is printed one per line:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">&gt; $=where.our.domainhere[123.45.67.89]faxfax.our.domain&gt;</PRE></BLOCKQUOTE></P><PCLASS="para">To illustrate one use for this command, imagine that you just madethe local host the FTP server for your site. Of course, you were carefulto modify the configuration file and add <EMCLASS="emphasis">fax</EM> and <EMCLASS="emphasis">fax.our.domain</EM>to the <CODECLASS="literal">$=w</CODE> class in it. But incoming mail to <EMCLASS="emphasis">fax.our.domain</EM>is still failing. You run <EMCLASS="emphasis">sendmail</EM> in rule-testing mode, as above,to verify that the correct entries are in <CODECLASS="literal">$=w</CODE>:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">here.our.domainhere[123.45.67.89]fax                    <ICLASS="lineannotation"><IMGSRC="../chars/larr.gif"ALT="&lt;-"> correct</I>fax.our.domain         <ICLASS="lineannotation"><IMGSRC="../chars/larr.gif"ALT="&lt;-"> correct</I></PRE></BLOCKQUOTE></P><PCLASS="para">Since they are correct, it could be that you made the mistake of changing the configuration fileand failing to restart the daemon (see <ACLASS="xref"HREF="ch04_01.htm#SML2-CH-4-SECT-1-1"TITLE="Daemon Mode (-bd)">Section 4.1.1, "Daemon Mode (-bd)"</A>). The following command line fixesthe problem (see <ACLASS="xref"HREF="ch26_03.htm#SML2-CH-26-SECT-3-2"TITLE="SIGHUP  Restart">Section 26.3.2, "SIGHUP  Restart"</A>):</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen"># <CODECLASS="userinput"><B>kill -HUP `head -1 /etc/sendmail.pid`</B></CODE></PRE></BLOCKQUOTE></P><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-61877"></A><ACLASS="indexterm"NAME="AUTOID-61878"></A></P></DIV></DIV><DIVCLASS="htmlnav"><P></P><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch38_02.htm"TITLE="38.2 Configuration Lines"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 38.2 Configuration Lines"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="book"HREF="index.htm"TITLE="sendmail"><IMGSRC="../gifs/txthome.gif"ALT="sendmail"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch38_04.htm"TITLE="38.4 Show an Item"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 38.4 Show an Item"BORDER="0"></A></TD></TR><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172">38.2 Configuration Lines</TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="index"HREF="index/idx_0.htm"TITLE="Book Index"><IMGSRC="../gifs/index.gif"ALT="Book Index"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172">38.4 Show an Item</TD></TR></TABLE><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><PCLASS="nav"><FONTSIZE="-1">[ <AHREF="../index.htm"TITLE="The Networking CD Bookshelf">Library Home</A> | <AHREF="../dnsbind/index.htm"TITLE="DNS &amp; BIND">DNS &amp; BIND</A> | <AHREF="../tcpip/index.htm"TITLE="TCP/IP Network Administration">TCP/IP</A> | <AHREF="index.htm"TITLE="sendmail">sendmail</A> | <AHREF="../smdref/index.htm"TITLE="sendmail Desktop Reference">sendmail Reference</A> | <AHREF="../firewall/index.htm"TITLE="Building Internet Firewalls">Firewalls</A> | <AHREF="../puis/index.htm"TITLE="Practical UNIX &amp; Internet Security">Practical Security</A> ]</FONT></P></DIV></BODY></HTML>