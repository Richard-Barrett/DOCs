<HTML><HEAD><TITLE>[Chapter 38] 38.4 Show an Item</TITLE><METANAME="DC.title"CONTENT="sendmail"><METANAME="DC.creator"CONTENT="Bryan Costales &amp; Eric Allman"><METANAME="DC.publisher"CONTENT="O'Reilly &amp; Associates, Inc."><METANAME="DC.date"CONTENT="1999-01-06T22:48:18Z"><METANAME="DC.type"CONTENT="Text.Monograph"><METANAME="DC.format"CONTENT="text/html"SCHEME="MIME"><METANAME="DC.source"CONTENT="1-56592-222-0"SCHEME="ISBN"><METANAME="DC.language"CONTENT="en-US"><METANAME="generator"CONTENT="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><LINKREV="made"HREF="mailto:online-books@oreilly.com"TITLE="Online Books Comments"><LINKREL="up"HREF="ch38_01.htm"TITLE="38. Rule-Set Testing with -bt"><LINKREL="prev"HREF="ch38_03.htm"TITLE="38.3 Dump a Macro"><LINKREL="next"HREF="ch38_05.htm"TITLE="38.5 Complex Actions"></HEAD><BODYBGCOLOR="#FFFFFF"TEXT="#000000"><DIVCLASS="htmlnav"><H1><IMGSRC="gifs/smbanner.gif"ALT="sendmail"USEMAP="#srchmap"BORDER="0"></H1><MAPNAME="srchmap"><AREASHAPE="RECT"COORDS="0,0,466,65"HREF="index.htm"ALT="sendmail"><AREASHAPE="RECT"COORDS="467,0,514,18"HREF="../search/ssrch.htm"ALT="Search this book"></MAP><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch38_03.htm"TITLE="38.3 Dump a Macro"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 38.3 Dump a Macro"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><B><FONTFACE="ARIEL,HELVETICA,HELV,SANSERIF"SIZE="-1">Chapter 38<BR>Rule-Set Testing with -bt</FONT></B></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch38_05.htm"TITLE="38.5 Complex Actions"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 38.5 Complex Actions"BORDER="0"></A></TD></TR></TABLE>&nbsp;<HRALIGN="LEFT"WIDTH="515"TITLE="footer"></DIV><DIVCLASS="SECT1"><H2CLASS="sect1"><ACLASS="title"NAME="SML2-CH-38-SECT-4">38.4 Show an Item</A></H2><PCLASS="para">Beginning with V8.7 <EMCLASS="emphasis">sendmail</EM>, two rule-testing commands are available:the <CODECLASS="literal">=S</CODE> command displays all the rules in a given rule set,and the <CODECLASS="literal">=M</CODE> command displays all the delivery agents.Both display their items after the configuration has been read. Thus in thecase of rules, all the macros will have already been expanded.</P><PCLASS="para">Both are triggered by the leading <CODECLASS="literal">=</CODE> character. If nothingfollows the <CODECLASS="literal">=</CODE>, this usage message is printed:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">Usage: =Sruleset or =M</PRE></BLOCKQUOTE></P><PCLASS="para">If any character other than <CODECLASS="literal">S</CODE> or <CODECLASS="literal">M</CODE> follows the <CODECLASS="literal">=</CODE> character, thefollowing error is printed:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">Unknown &quot;=&quot; command =<ICLASS="lineannotation">bad character here</I></PRE></BLOCKQUOTE></P><PCLASS="para"></P><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="SML2-CH-38-SECT-4-1">38.4.1 Show Rules in a Rule Set with =S</A></H3><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-61901"></A><ACLASS="indexterm"NAME="AUTOID-61903"></A>The <CODECLASS="literal">=S</CODE> rule-testing command causes <EMCLASS="emphasis">sendmail</EM> to show allthe rules of a rule set. The form of this command looks like this:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">=S<CODECLASS="replaceable"><I>ruleset</I></CODE></PRE></BLOCKQUOTE></P><PCLASS="para">Optional whitespace may separate the <CODECLASS="replaceable"><I>ruleset</I></CODE> from the <CODECLASS="literal">S</CODE>.The <CODECLASS="replaceable"><I>ruleset</I></CODE> may be a number or a symbolic name (see <ACLASS="xref"HREF="ch29_01.htm#SML2-CH-29-SECT-1-2"TITLE="Rule-Set Names">Section 29.1.2, "Rule-Set Names"</A>):</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">=S0                    <ICLASS="lineannotation"><IMGSRC="../chars/larr.gif"ALT="&lt;-"> a number</I>=SMyrule               <ICLASS="lineannotation"><IMGSRC="../chars/larr.gif"ALT="&lt;-"> a name</I></PRE></BLOCKQUOTE></P><PCLASS="para">Note that althoughmacros may be used in defining rule sets (see <ACLASS="xref"HREF="ch29_01.htm#SML2-CH-29-SECT-1-4"TITLE="Macros in Rule-Set Names">Section 29.1.4, "Macros in Rule-Set Names"</A>),they may not be used with the <CODECLASS="literal">=S</CODE> command:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">&gt; =S$Xinvalid ruleset name: &quot;$X&quot;: No such file or directoryUndefined ruleset $X&gt;</PRE></BLOCKQUOTE></P><PCLASS="para">One use for the <CODECLASS="literal">=S</CODE> command is to determine why a rule set is not behaving as expected.Consider a rule set 1 that is intended to rewrite all sending addresses so that thelocal hostname makes the message appear as though it came from the mail hub machine.Suppose that, when testing, you send an address through that rule but it comesout unchanged:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">&gt; <CODECLASS="userinput"><B>1 bob@localhost</B></CODE>rewrite: ruleset   1   input: bob @ localhostrewrite: ruleset   1 returns: bob @ localhost&gt;</PRE></BLOCKQUOTE></P><PCLASS="para">Puzzled, you look at the actual rule with the <CODECLASS="literal">=S</CODE>rule-testing command:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">&gt; <CODECLASS="userinput"><B>=S1</B></CODE>R$* &lt; @ $=w &gt; $*                $@ $1 &lt; @ mailhub . our . domain &gt; $3 &gt;</PRE></BLOCKQUOTE></P><PCLASS="para">Aha! Rule set 1[1]expects the host part of the address to be surroundedby angle brackets! Knowing this, you run the address through the rule again,this time using angle brackets, and it succeeds:</P><BLOCKQUOTECLASS="footnote"><PCLASS="para">[1] For the sake of the example we limited this rule set to a single rule.Most rule sets will have many rules.</P></BLOCKQUOTE><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">&gt;  <CODECLASS="userinput"><B>1 bob&lt;@localhost&gt;</B></CODE>rewrite: ruleset   1   input: bob &lt; @ localhost &gt;rewrite: ruleset   1 returns: bob &lt; @ mailhub . our . domain &gt;&gt;</PRE></BLOCKQUOTE></P></DIV><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="SML2-CH-38-SECT-4-2">38.4.2 Show Delivery Agents with =M</A></H3><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-61944"></A><ACLASS="indexterm"NAME="AUTOID-61946"></A><ACLASS="indexterm"NAME="AUTOID-61949"></A>The <CODECLASS="literal">=M</CODE> rule testing command causes <EMCLASS="emphasis">sendmail</EM> to printits list of delivery agents. This command takes no argument.Note that in the following example the lines are wrapped to fit on the page:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">&gt; <CODECLASS="userinput"><B>=M</B></CODE>mailer 0 (prog): P=/bin/sh S=10/30 R=20/40 M=0 U=0:0 F=DFMelosu L=0 E=\n T=X-Unix/rfc822/smtp A=sh -c $umailer 1 (*file*): P=[FILE] S=0/0 R=0/0 M=0 U=0:0 F=DEFMPlosu L=0 E=\n T=DNS/RFC822/X-Unix A=FILEmailer 2 (*include*): P=/dev/null S=0/0 R=0/0 M=0 U=0:0 F=su L=0 E=\n T=&lt;undefined&gt;/&lt;undefined&gt;/&lt;undefined&gt; A=INCLUDEmailer 3 (local): P=/bin/mail S=10/30 R=20/40 M=0 U=0:0 F=/5:@ADFMlmnrsw| L=0 E=\n T=DNS/RFC822/X-Unix A=mail -d $umailer 4 (smtp): P=[IPC] S=11/31 R=21/21 M=0 U=0:0 F=DFMXmu L=990 E=\r\n T=DNS/RFC822/SMTP A=IPC $hmailer 5 (esmtp): P=[IPC] S=11/31 R=21/21 M=0 U=0:0 F=DFMXamu L=990 E=\r\n T=DNS/RFC822/SMTP A=IPC $hmailer 6 (smtp8): P=[IPC] S=11/31 R=21/21 M=0 U=0:0 F=8DFMXmu L=990 E=\r\n T=DNS/RFC822/SMTP A=IPC $hmailer 7 (relay): P=[IPC] S=11/31 R=61/61 M=0 U=0:0 F=8DFMXamu L=2040 E=\r\n T=DNS/RFC822/SMTP A=IPC $h</PRE></BLOCKQUOTE></P><PCLASS="para">This output is the same as that produced with the <CODECLASS="literal">-d0.15</CODE> debugging switch(see <ACLASS="xref"HREF="ch37_05.htm#SML2-CH-37-SECT-5-4"TITLE="">Section 37.5.4, -d0.15</A>). The individual items in each line are explained in<ACLASS="xref"HREF="ch30_01.htm"TITLE="Delivery Agents">Chapter 30, <CITECLASS="chapter">Delivery Agents</CITE></A>.</P><PCLASS="para">Internally, the <CODECLASS="literal">=M</CODE> rule testing command calls <EMCLASS="emphasis">printmailer</EM>()to print the contents of each delivery agent.&#13;</P></DIV></DIV><DIVCLASS="htmlnav"><P></P><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch38_03.htm"TITLE="38.3 Dump a Macro"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 38.3 Dump a Macro"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="book"HREF="index.htm"TITLE="sendmail"><IMGSRC="../gifs/txthome.gif"ALT="sendmail"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch38_05.htm"TITLE="38.5 Complex Actions"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 38.5 Complex Actions"BORDER="0"></A></TD></TR><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172">38.3 Dump a Macro</TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="index"HREF="index/idx_0.htm"TITLE="Book Index"><IMGSRC="../gifs/index.gif"ALT="Book Index"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172">38.5 Complex Actions</TD></TR></TABLE><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><PCLASS="nav"><FONTSIZE="-1">[ <AHREF="../index.htm"TITLE="The Networking CD Bookshelf">Library Home</A> | <AHREF="../dnsbind/index.htm"TITLE="DNS &amp; BIND">DNS &amp; BIND</A> | <AHREF="../tcpip/index.htm"TITLE="TCP/IP Network Administration">TCP/IP</A> | <AHREF="index.htm"TITLE="sendmail">sendmail</A> | <AHREF="../smdref/index.htm"TITLE="sendmail Desktop Reference">sendmail Reference</A> | <AHREF="../firewall/index.htm"TITLE="Building Internet Firewalls">Firewalls</A> | <AHREF="../puis/index.htm"TITLE="Practical UNIX &amp; Internet Security">Practical Security</A> ]</FONT></P></DIV></BODY></HTML>