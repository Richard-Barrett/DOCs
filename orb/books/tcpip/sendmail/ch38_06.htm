<HTML><HEAD><TITLE>[Chapter 38] 38.6 Process-Specified Addresses</TITLE><METANAME="DC.title"CONTENT="sendmail"><METANAME="DC.creator"CONTENT="Bryan Costales &amp; Eric Allman"><METANAME="DC.publisher"CONTENT="O'Reilly &amp; Associates, Inc."><METANAME="DC.date"CONTENT="1999-01-06T22:49:39Z"><METANAME="DC.type"CONTENT="Text.Monograph"><METANAME="DC.format"CONTENT="text/html"SCHEME="MIME"><METANAME="DC.source"CONTENT="1-56592-222-0"SCHEME="ISBN"><METANAME="DC.language"CONTENT="en-US"><METANAME="generator"CONTENT="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><LINKREV="made"HREF="mailto:online-books@oreilly.com"TITLE="Online Books Comments"><LINKREL="up"HREF="ch38_01.htm"TITLE="38. Rule-Set Testing with -bt"><LINKREL="prev"HREF="ch38_05.htm"TITLE="38.5 Complex Actions"><LINKREL="next"HREF="ch38_07.htm"TITLE="38.7 Add Debugging for Detail"></HEAD><BODYBGCOLOR="#FFFFFF"TEXT="#000000"><DIVCLASS="htmlnav"><H1><IMGSRC="gifs/smbanner.gif"ALT="sendmail"USEMAP="#srchmap"BORDER="0"></H1><MAPNAME="srchmap"><AREASHAPE="RECT"COORDS="0,0,466,65"HREF="index.htm"ALT="sendmail"><AREASHAPE="RECT"COORDS="467,0,514,18"HREF="../search/ssrch.htm"ALT="Search this book"></MAP><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch38_05.htm"TITLE="38.5 Complex Actions"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 38.5 Complex Actions"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><B><FONTFACE="ARIEL,HELVETICA,HELV,SANSERIF"SIZE="-1">Chapter 38<BR>Rule-Set Testing with -bt</FONT></B></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch38_07.htm"TITLE="38.7 Add Debugging for Detail"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 38.7 Add Debugging for Detail"BORDER="0"></A></TD></TR></TABLE>&nbsp;<HRALIGN="LEFT"WIDTH="515"TITLE="footer"></DIV><DIVCLASS="SECT1"><H2CLASS="sect1"><ACLASS="title"NAME="SML2-CH-38-SECT-6">38.6 Process-Specified Addresses</A></H2><PCLASS="para">The <EMCLASS="emphasis">sendmail</EM> rule-testing mode has always had the abilityto test individual rule sets, but prior to V8.7 <EMCLASS="emphasis">sendmail</EM>, rulesets could be specified only by number. Beginning with V8.7,rule sets may also be specified by name. Prior to V8 <EMCLASS="emphasis">sendmail</EM>,rule set 3 was always called first, even if you did not specify it.[3]&#13;</P><BLOCKQUOTECLASS="footnote"><PCLASS="para">[3] This was adopted from IDA sendmail.</P></BLOCKQUOTE><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="SML2-CH-38-SECT-6-1">38.6.1 Syntax</A></H3><PCLASS="para">The <CODECLASS="literal">&gt;</CODE> prompt expects rule sets and addresses to bespecified like this:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">&gt; <CODECLASS="replaceable"><I>ident</I></CODE>,<CODECLASS="replaceable"><I>ident</I></CODE>,<CODECLASS="replaceable"><I>ident</I></CODE>... <CODECLASS="replaceable"><I>address</I></CODE></PRE></BLOCKQUOTE></P><PCLASS="para">Each <CODECLASS="replaceable"><I>ident</I></CODE> is a rule-set name or number. When there is more thanone rule set, they must be separated from each otherby commas (with no spaces between them).</P><PCLASS="para">For numbered rule sets, the number must be in the rangeof 0 through the highest number allowed.A number that is too largecauses <EMCLASS="emphasis">sendmail</EM> to print the following two errors:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">bad ruleset <ICLASS="lineannotation">number</I> (<CODECLASS="replaceable"><I>max</I></CODE> max)Undefined ruleset <ICLASS="lineannotation">number</I></PRE></BLOCKQUOTE></P><PCLASS="para">A rule set whose number is below the maximum but that was never definedwill act as though it was defined but lacks rules.</P><PCLASS="para">Named rule sets must exist in the symbol table. If the name specifiedwas never defined, the following error is printed:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">Undefined ruleset <ICLASS="lineannotation">ident</I></PRE></BLOCKQUOTE></P><PCLASS="para">If any rule set number in the comma-separatedlist of rule sets is omitted (e.g., <CODECLASS="replaceable"><I>ident,,ident</I></CODE>), <EMCLASS="emphasis">sendmail</EM>interprets the second comma as part of the second identifier, thusproducing this error:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">Undefined ruleset ,<ICLASS="lineannotation">identifier</I></PRE></BLOCKQUOTE></P><PCLASS="para">The <CODECLASS="replaceable"><I>address</I></CODE> is everything following the first whitespace (space andtab characters) to the end of the line.If whitespace characters appear anywhere in the list of rule sets,the rule sets to the right of the whitespace are interpreted aspart of the address.&#13;</P></DIV><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="SML2-CH-38-SECT-6-2">38.6.2 The Address</A></H3><PCLASS="para">Each address that is specified is processedby <EMCLASS="emphasis">sendmail</EM> in the same way that mail addresses areprocessed when actualmail is being sent. Each is parsed and normalized so thateverything but the actual address is thrown away. Each is then tokenizedand placed into the workspace for rule-set processing.To illustrate, observe the following rule-testing session:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">ADDRESS TEST MODE (ruleset 3 NOT automatically invoked)Enter &lt;ruleset&gt; &lt;address&gt;&gt; <CODECLASS="userinput"><B>0 bill (Bill Bix)</B></CODE>rewrite: ruleset  0   input: billrewrite: ruleset  0 returns: $# local $: bill&gt; <CODECLASS="userinput"><B>0 Bill Bix &lt;bill&gt;</B></CODE>rewrite: ruleset  0   input: Bill Bix &lt; bill &gt;rewrite: ruleset  0 returns: $# local $: Bill Bix &lt; bill &gt;&gt; <CODECLASS="userinput"><B>3,0 Bill Bix &lt;bill&gt;</B></CODE>rewrite: ruleset  3   input: Bill Bix &lt; bill &gt;rewrite: ruleset  3 returns: billrewrite: ruleset  0   input: billrewrite: ruleset  0 returns: $# local $: bill&gt;</PRE></BLOCKQUOTE></P><PCLASS="para">The first test illustrates that <EMCLASS="emphasis">sendmail</EM> strips RFC822-stylecomments from addresses before tokenizing them. This results in the<CODECLASS="literal">(Bill Bix)</CODE> being thrown away so thatrule set 0 sees only the address <CODECLASS="literal">bill</CODE>.</P><PCLASS="para">The second test illustrates that <EMCLASS="emphasis">sendmail</EM> does not internallyrecognize addresses in angle brackets. Instead,rule set 3 throws away everything but the address in angle brackets,as shown in the third test.</P><PCLASS="para">Note that in many actual configuration files, rule set 3 also focuseson the host part of the address. For this reason, you should <EMCLASS="emphasis">always</EM>begin with rule set 3 unless you are tuning a particular rule for whichyou know the precise input required.&#13;</P></DIV><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="SML2-CH-38-SECT-6-3">38.6.3 Rule 3 Always Called First with -bt</A></H3><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-62499"></A>When <EMCLASS="emphasis">sendmail</EM> starts to run in rule-testing mode, itsappearance and initial behavior vary from vendor to vendorand from version to version.When rule-testing mode begins, <EMCLASS="emphasis">sendmail</EM> always prints an introductorybanner. Pre-V8 <EMCLASS="emphasis">sendmail</EM> printed the following banner:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">ADDRESS TEST MODEEnter &lt;ruleset&gt; &lt;address&gt;&gt;</PRE></BLOCKQUOTE></P><PCLASS="para">It is important to note that (unless a bannersays otherwise) <EMCLASS="emphasis">sendmail</EM> always calls rule set 3 first. That is, even ifyou try to test rule set 0, you always first see the effectsof rule set 3.</P><PCLASS="para">Beginning with V8 <EMCLASS="emphasis">sendmail</EM>, rule set 3 is no longer automatically called.To ensure that there is no confusion, V8 <EMCLASS="emphasis">sendmail</EM> prints this banner:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">ADDRESS TEST MODE (ruleset 3 NOT automatically invoked)Enter &lt;ruleset&gt; &lt;address&gt;&gt;</PRE></BLOCKQUOTE></P><PCLASS="para">Note that in all versions the last line (the <CODECLASS="literal">&gt;</CODE>) is a prompt.At this prompt, you can specify a rule set and an addressor, beginning with V8.7, any of the commands shown in <ACLASS="xref"HREF="ch38_01.htm#SML2-CH-38-SECT-1"TITLE="Overview">Section 38.1, "Overview"</A>.&#13;</P></DIV><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="SML2-CH-38-SECT-6-4">38.6.4 The Output</A></H3><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-62520"></A>Each line of output that is produced when rule testing begins withan indication of the rule set number being processed:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen"><CODECLASS="userinput"><B>rewrite: ruleset  3</B></CODE>   input: Bill Bix &lt; bill &gt;</PRE></BLOCKQUOTE></P><PCLASS="para">The word <CODECLASS="literal">input</CODE> precedes each address that is aboutto be processed by a rule set:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">rewrite: ruleset  3   <CODECLASS="userinput"><B>input</B></CODE>: Bill Bix &lt; bill &gt;</PRE></BLOCKQUOTE></P><PCLASS="para">The word <CODECLASS="literal">returns</CODE> precedes each address that is the result ofrewriting by a rule set:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">rewrite: ruleset  3 <CODECLASS="userinput"><B>returns</B></CODE>: bill</PRE></BLOCKQUOTE></P><PCLASS="para">When rule sets call other rule sets as subroutines,those calls are shown in the output with<CODECLASS="literal">input</CODE> and <CODECLASS="literal">returns</CODE> pairs.In the following, rule set 11 is called as a subroutine rule set from insiderule set 3:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">rewrite: ruleset  3   input: Bill Bix &lt; bill &gt;<CODECLASS="userinput"><B>rewrite: ruleset  11  input: bill</B></CODE><CODECLASS="userinput"><B>rewrite: ruleset  11 returns: bill</B></CODE>rewrite: ruleset  3  returns: bill</PRE></BLOCKQUOTE></P><PCLASS="para">The output can also contain rule set operators:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">rewrite: ruleset  0 returns: <CODECLASS="userinput"><B>$#</B></CODE> local <CODECLASS="userinput"><B>$:</B></CODE> bill</PRE></BLOCKQUOTE></P><PCLASS="para">In this output,the operators are printed as they would appear in the configurationfile. The <CODECLASS="literal">$#</CODE> selects a delivery agent, and the <CODECLASS="literal">$:</CODE>specifies the user. Under old versions of <EMCLASS="emphasis">sendmail</EM> those operatorsare printed in the output as control characters:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">rewrite: ruleset  0 returns: <CODECLASS="userinput"><B>^V</B></CODE> local <CODECLASS="userinput"><B>^X</B></CODE> bill</PRE></BLOCKQUOTE></P><PCLASS="para">The correspondence between control characters in the outputand <EMCLASS="emphasis">sendmail</EM> configuration file operators is given in<ACLASS="xref"HREF="ch38_06.htm#SML2-CH-38-TAB-1"TITLE="Control Characters Versus Operators">Table 38.2</A>.</P><TABLECLASS="table"><CAPTIONCLASS="table"><ACLASS="title"NAME="SML2-CH-38-TAB-1">Table 38.2: Control Characters Versus Operators</A></CAPTION><THEADCLASS="thead"><TRCLASS="row"VALIGN="TOP"><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Control</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Operator</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Meaning</TH></TR></THEAD><TBODYCLASS="tbody"><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><CODECLASS="literal">^V</CODE></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><CODECLASS="literal">$#</CODE></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Select delivery agent</P></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><CODECLASS="literal">^W</CODE></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><CODECLASS="literal">$@</CODE></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Specify host for delivery agent</P></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><CODECLASS="literal">^X</CODE></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><CODECLASS="literal">$:</CODE></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para">Specify user for delivery agent</P></TD></TR></TBODY></TABLE><PCLASS="para"></P></DIV></DIV><DIVCLASS="htmlnav"><P></P><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch38_05.htm"TITLE="38.5 Complex Actions"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 38.5 Complex Actions"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="book"HREF="index.htm"TITLE="sendmail"><IMGSRC="../gifs/txthome.gif"ALT="sendmail"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch38_07.htm"TITLE="38.7 Add Debugging for Detail"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 38.7 Add Debugging for Detail"BORDER="0"></A></TD></TR><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172">38.5 Complex Actions</TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="index"HREF="index/idx_0.htm"TITLE="Book Index"><IMGSRC="../gifs/index.gif"ALT="Book Index"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172">38.7 Add Debugging for Detail</TD></TR></TABLE><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><PCLASS="nav"><FONTSIZE="-1">[ <AHREF="../index.htm"TITLE="The Networking CD Bookshelf">Library Home</A> | <AHREF="../dnsbind/index.htm"TITLE="DNS &amp; BIND">DNS &amp; BIND</A> | <AHREF="../tcpip/index.htm"TITLE="TCP/IP Network Administration">TCP/IP</A> | <AHREF="index.htm"TITLE="sendmail">sendmail</A> | <AHREF="../smdref/index.htm"TITLE="sendmail Desktop Reference">sendmail Reference</A> | <AHREF="../firewall/index.htm"TITLE="Building Internet Firewalls">Firewalls</A> | <AHREF="../puis/index.htm"TITLE="Practical UNIX &amp; Internet Security">Practical Security</A> ]</FONT></P></DIV></BODY></HTML>