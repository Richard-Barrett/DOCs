<HTML><HEAD><TITLE>[Chapter 4] 4.4 Virtual User Tables</TITLE><METANAME="DC.title"CONTENT="sendmail Desktop Reference"><METANAME="DC.creator"CONTENT="Bryan Costales &amp; Eric Allman"><METANAME="DC.publisher"CONTENT="O'Reilly &amp; Associates, Inc."><METANAME="DC.date"CONTENT="1999-02-04T00:04:36Z"><METANAME="DC.type"CONTENT="Text.Monograph"><METANAME="DC.format"CONTENT="text/html"SCHEME="MIME"><METANAME="DC.source"CONTENT="1-56592-278-6"SCHEME="ISBN"><METANAME="DC.language"CONTENT="en-US"><METANAME="generator"CONTENT="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><LINKREV="made"HREF="mailto:online-books@oreilly.com"TITLE="Online Books Comments"><LINKREL="up"HREF="ch04_01.htm"TITLE="4. Configuring with m4"><LINKREL="prev"HREF="ch04_03.htm"TITLE="4.3 MAILER Declarations"><LINKREL="next"HREF="ch04_05.htm"TITLE="4.5 Mailer Tables"></HEAD><BODYBGCOLOR="#FFFFFF"TEXT="#000000"><DIVCLASS="htmlnav"><H1><IMGSRC="gifs/smbanner.gif"ALT="sendmail Desktop Reference"USEMAP="#srchmap"BORDER="0"></H1><MAPNAME="srchmap"><AREASHAPE="RECT"COORDS="0,0,466,65"HREF="index.htm"ALT="sendmail Desktop Reference"><AREASHAPE="RECT"COORDS="467,0,514,18"HREF="../search/rsrch.htm"ALT="Search this book"></MAP><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch04_03.htm"TITLE="4.3 MAILER Declarations"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 4.3 MAILER Declarations"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><B><FONTFACE="ARIEL,HELVETICA,HELV,SANSERIF"SIZE="-1">Chapter 4<BR>Configuring with m4</FONT></B></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch04_05.htm"TITLE="4.5 Mailer Tables"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 4.5 Mailer Tables"BORDER="0"></A></TD></TR></TABLE>&nbsp;<HRALIGN="LEFT"WIDTH="515"TITLE="footer"></DIV><DIVCLASS="SECT1"><H2CLASS="sect1"><ACLASS="title"NAME="SMQR-CH-4-SECT-4">4.4 Virtual User Tables</A></H2><PCLASS="para">When using FEATURE(virtusertable),<EMCLASS="emphasis">sendmail</EM> will do translation based on the entire domain namewhen the address is first read.This is similar, but not identical, to aliasing.It is commonly used to host multiple domains with different(and possibly even overlapping) userson one machine using MX records.The format of the input file (e.g., <EMCLASS="emphasis">/etc/virtusertable</EM>)is:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">[<CODECLASS="replaceable"><I>virtuser</I></CODE>]<BCLASS="emphasis.bold">@</B><CODECLASS="replaceable"><I>virtdomain   address</I></CODE></PRE></BLOCKQUOTE></P><PCLASS="para">For example, an input file might read:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">info@foo.com    foo-infoinfo@bar.com    bar-infojohn@foo.com    jdoejane@foo.com    jroe@elsewhere.com@bar.com        mary</PRE></BLOCKQUOTE></P><PCLASS="para">The first two entries translate <EMCLASS="emphasis">info@foo.com</EM> and <EMCLASS="emphasis">info@bar.com</EM>into different names, which may be user names or aliases.The third and fourth entries alias users to other names.The fifth entry says that <EMCLASS="emphasis">anything@bar.com</EM>that wasn't otherwise recognizedshould go to <EMCLASS="emphasis">mary</EM>.</P><PCLASS="para">You build the database from the input file using the <EMCLASS="emphasis">makemap</EM>(1) program:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">% <CODECLASS="userinput"><B>makemap hash </B></CODE><CODECLASS="replaceable"><I>/etc/virtusertable </I></CODE><CODECLASS="userinput"><B>&lt; </B></CODE><CODECLASS="replaceable"><I>/etc/virtusertable</I></CODE></PRE></BLOCKQUOTE></P><PCLASS="para">You declare the database for use with your <EMCLASS="emphasis">.mc</EM> file, like this:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">FEATURE(virtusertable, hash <CODECLASS="replaceable"><I>/etc/virtusertable</I></CODE>)</PRE></BLOCKQUOTE></P></DIV><DIVCLASS="htmlnav"><P></P><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch04_03.htm"TITLE="4.3 MAILER Declarations"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 4.3 MAILER Declarations"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="book"HREF="index.htm"TITLE="sendmail Desktop Reference"><IMGSRC="../gifs/txthome.gif"ALT="sendmail Desktop Reference"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch04_05.htm"TITLE="4.5 Mailer Tables"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 4.5 Mailer Tables"BORDER="0"></A></TD></TR><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172">4.3 MAILER Declarations</TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171">&nbsp;</TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172">4.5 Mailer Tables</TD></TR></TABLE><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><PCLASS="nav"><FONTSIZE="-1">[ <AHREF="../index.htm"TITLE="The Networking CD Bookshelf">Library Home</A> | <AHREF="../dnsbind/index.htm"TITLE="DNS &amp; BIND">DNS &amp; BIND</A> | <AHREF="../tcpip/index.htm"TITLE="TCP/IP Network Administration">TCP/IP</A> | <AHREF="../sendmail/index.htm"TITLE="sendmail">sendmail</A> | <AHREF="index.htm"TITLE="sendmail Desktop Reference">sendmail Reference</A> | <AHREF="../firewall/index.htm"TITLE="Building Internet Firewalls">Firewalls</A> | <AHREF="../puis/index.htm"TITLE="Practical UNIX &amp; Internet Security">Practical Security</A> ]</FONT></P></DIV></BODY></HTML>