<HTML><HEAD><TITLE>[Appendix B] B.11 The Aggregate Statements</TITLE><METANAME="DC.title"CONTENT="TCP/IP Network Administration"><METANAME="DC.creator"CONTENT="Craig Hunt"><METANAME="DC.publisher"CONTENT="O'Reilly &amp; Associates, Inc."><METANAME="DC.date"CONTENT="1999-02-04T01:43:29Z"><METANAME="DC.type"CONTENT="Text.Monograph"><METANAME="DC.format"CONTENT="text/html"SCHEME="MIME"><METANAME="DC.source"CONTENT="1-56592-322-7"SCHEME="ISBN"><METANAME="DC.language"CONTENT="en-US"><METANAME="generator"CONTENT="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><LINKREV="made"HREF="mailto:online-books@oreilly.com"TITLE="Online Books Comments"><LINKREL="up"HREF="appb_01.htm"TITLE="B. A gated Reference"><LINKREL="prev"HREF="appb_10.htm"TITLE="B.10 Control Statements"><LINKREL="next"HREF="appc_01.htm"TITLE="C. A named Reference"></HEAD><BODYBGCOLOR="#FFFFFF"TEXT="#000000"><DIVCLASS="htmlnav"><H1><IMGSRC="gifs/smbanner.gif"ALT="TCP/IP Network Administration"USEMAP="#srchmap"BORDER="0"></H1><MAPNAME="srchmap"><AREASHAPE="RECT"COORDS="0,0,466,65"HREF="index.htm"ALT="TCP/IP Network Administration"><AREASHAPE="RECT"COORDS="467,0,514,18"HREF="../search/tsrch.htm"ALT="Search this book"></MAP><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="appb_10.htm"TITLE="B.10 Control Statements"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: B.10 Control Statements"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><B><FONTFACE="ARIEL,HELVETICA,HELV,SANSERIF"SIZE="-1">Appendix B<BR>A gated Reference</FONT></B></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="APPENDIX"HREF="appc_01.htm"TITLE="C. A named Reference"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: C. A named Reference"BORDER="0"></A></TD></TR></TABLE>&nbsp;<HRALIGN="LEFT"WIDTH="515"TITLE="footer"></DIV><DIVCLASS="SECT1"><H2CLASS="sect1"><ACLASS="title"NAME="TCP2-AP-2-SECT-11">B.11 The Aggregate Statements</A></H2><PCLASS="para"><ACLASS="indexterm"NAME="TCP2-AP-2-IX-AGGREGATE-STATEMENTS-IN-GATED"></A>Route aggregation is used by regional and national networks to reducethe number of routes advertised. With careful planning, large networkproviders can announce a few aggregate routes instead of hundreds ofclient network routes. Enabling aggregation is the main reason that<ACLASS="indexterm"NAME="AUTOID-23844"></A><ACLASS="indexterm"NAME="AUTOID-23847"></A>CIDR blocks are allocated as contiguous address blocks.</P><PCLASS="para">Most of us don't have hundreds of routes to advertise. But we may havea classless address composed of a few class C address and we may needto tell <BCLASS="emphasis.bold">gated</B> how to handle it. Older versions of <BCLASS="emphasis.bold">gated</B>automatically generated an aggregate route to a natural network usingthe old Class A, B, and C concept; i.e., interface address192.168.16.1 created a route to 192.168.16.0. With the advent ofclassless interdomain routing, this can be the wrong thing todo. <BCLASS="emphasis.bold">gated</B> does not aggregate routes unless it is explicitlyconfigured with the aggregate statement:</P><BLOCKQUOTECLASS="literallayout"><PCLASS="literallayout"><BCLASS="emphasis.bold">aggregate default </B>| <BCLASS="emphasis.bold">address </B>[<BCLASS="emphasis.bold">mask</B> <CODECLASS="replaceable"><I>mask </I></CODE>| <BCLASS="emphasis.bold">masklen</B> <CODECLASS="replaceable"><I>number</I></CODE>]<BR>    [<BCLASS="emphasis.bold">preference</B> <CODECLASS="replaceable"><I>preference</I></CODE>] [<BCLASS="emphasis.bold">brief</B>] <BCLASS="emphasis.bold">{<BR>    proto</B> <CODECLASS="replaceable"><I>proto</I></CODE><BR>        [<BCLASS="emphasis.bold">as</B> <CODECLASS="replaceable"><I>as_number</I></CODE> | <BCLASS="emphasis.bold">tag</B> <CODECLASS="replaceable"><I>tag</I></CODE> | <BCLASS="emphasis.bold">aspath</B> <CODECLASS="replaceable"><I>aspath_regexp</I></CODE>]<BR>        [<BCLASS="emphasis.bold">restrict</B>] |<BR>        [[<BCLASS="emphasis.bold">preference</B> <CODECLASS="replaceable"><I>preference</I></CODE>] <BCLASS="emphasis.bold">{</B><BR>        <CODECLASS="replaceable"><I>route_filter </I></CODE>[<BCLASS="emphasis.bold">restrict </B>| (<BCLASS="emphasis.bold">preference</B> <CODECLASS="replaceable"><I>preference</I></CODE>)]] <BCLASS="emphasis.bold">;<BR>} ;</B></P></BLOCKQUOTE><PCLASS="para">Several options are available for the aggregate statement:</P><DLCLASS="variablelist"><DTCLASS="term"><BCLASS="emphasis.bold">preference</B> <CODECLASS="replaceable"><I>preference;</I></CODE></DT><DDCLASS="listitem"><PCLASS="para">Defines the preference of the resulting aggregate route. The defaultis 130.</P></DD><DTCLASS="term"><BCLASS="emphasis.bold">brief</B></DT><DDCLASS="listitem"><PCLASS="para">Specifies that the AS path of the agregate route should be the longestcommon AS path. The default is to build an AS path consisting of allcontributing AS paths.</P></DD><DTCLASS="term"><BCLASS="emphasis.bold">proto</B> <CODECLASS="replaceable"><I>proto</I></CODE></DT><DDCLASS="listitem"><PCLASS="para">Only aggregate routes learned from the specified protocol. The valueof <CODECLASS="replaceable"><I>proto</I></CODE> may be any currently configured protocol. This includes the&quot;protocols&quot; <BCLASS="emphasis.bold">direct</B>, <BCLASS="emphasis.bold">static</B>, and <BCLASS="emphasis.bold">kernel</B>, discussedin the previous section; <BCLASS="emphasis.bold">all</B> for all possible protocols; and<BCLASS="emphasis.bold">aggregate</B> for other route aggregations.</P></DD><DTCLASS="term"><BCLASS="emphasis.bold">as</B> <CODECLASS="replaceable"><I>as_number</I></CODE></DT><DDCLASS="listitem"><PCLASS="para">Only aggregate routes learned from the specified autonomous system.</P></DD><DTCLASS="term"><BCLASS="emphasis.bold">tag</B> <CODECLASS="replaceable"><I>tag</I></CODE></DT><DDCLASS="listitem"><PCLASS="para">Only aggregate routes with the specified tag. </P></DD><DTCLASS="term"><BCLASS="emphasis.bold">aspath</B> <CODECLASS="replaceable"><I>aspath_regexp</I></CODE></DT><DDCLASS="listitem"><PCLASS="para">Only aggregate routes that match the specified AS path. </P></DD><DTCLASS="term"><BCLASS="emphasis.bold">restrict</B></DT><DDCLASS="listitem"><PCLASS="para">Indicates routes that are not to be aggregated.</P></DD></DL><PCLASS="para">Routes that match the route filters may contribute to the aggregateroute. A route may only contribute to an aggregate route that is moregeneral than itself. Any given route may only contribute to one aggregateroute, but an aggregate route may contribute to a more general aggregate.</P><PCLASS="para">A slight variation of aggregation is the generation of a route basedon the existence of certain conditions. The most common usage for thisis to create a default based on the presence of a route from a peer ona neighboring backbone.  This is done with the <BCLASS="emphasis.bold">generate</B>statement.</P><BLOCKQUOTECLASS="literallayout"><PCLASS="literallayout"><BCLASS="emphasis.bold">generate default </B>| <BCLASS="emphasis.bold">address </B>[<BCLASS="emphasis.bold">mask</B> <CODECLASS="replaceable"><I>mask </I></CODE>| <BCLASS="emphasis.bold">masklen</B> <CODECLASS="replaceable"><I>number</I></CODE>]<BR>    [<BCLASS="emphasis.bold">preference</B> <CODECLASS="replaceable"><I>preference</I></CODE>] <BCLASS="emphasis.bold">{</B><BR>    <BCLASS="emphasis.bold">proto</B> <CODECLASS="replaceable"><I>proto</I></CODE><BR>        [<BCLASS="emphasis.bold">as</B> <CODECLASS="replaceable"><I>as_number</I></CODE> | <BCLASS="emphasis.bold">tag</B> <CODECLASS="replaceable"><I>tag</I></CODE> | <BCLASS="emphasis.bold">aspath</B> <CODECLASS="replaceable"><I>aspath_regexp</I></CODE>]<BR>        [<BCLASS="emphasis.bold">restrict</B>] |<BR>        [[<BCLASS="emphasis.bold">preference</B> <CODECLASS="replaceable"><I>preference</I></CODE>] <BCLASS="emphasis.bold">{</B><BR>        <CODECLASS="replaceable"><I>route_filter </I></CODE>[<BCLASS="emphasis.bold">restrict</B> | <BCLASS="emphasis.bold">preference</B> <CODECLASS="replaceable"><I>preference</I></CODE>]] <BCLASS="emphasis.bold">;<BR>    } ;<BR>} ;</B></P></BLOCKQUOTE><PCLASS="para">The <BCLASS="emphasis.bold">generate</B> statement uses many of the same options as the<BCLASS="emphasis.bold">aggregate</B> statement. These options are described earlier in thisappendix.<ACLASS="indexterm"NAME="AUTOID-23963"></A><ACLASS="indexterm"NAME="AUTOID-23964"></A></P></DIV><DIVCLASS="htmlnav"><P></P><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="appb_10.htm"TITLE="B.10 Control Statements"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: B.10 Control Statements"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="book"HREF="index.htm"TITLE="TCP/IP Network Administration"><IMGSRC="../gifs/txthome.gif"ALT="TCP/IP Network Administration"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="APPENDIX"HREF="appc_01.htm"TITLE="C. A named Reference"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: C. A named Reference"BORDER="0"></A></TD></TR><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172">B.10 Control Statements</TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="index"HREF="index/idx_0.htm"TITLE="Book Index"><IMGSRC="../gifs/index.gif"ALT="Book Index"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172">C. A named Reference</TD></TR></TABLE><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><PCLASS="nav"><FONTSIZE="-1">[ <AHREF="../index.htm"TITLE="The Networking CD Bookshelf">Library Home</A> | <AHREF="../dnsbind/index.htm"TITLE="DNS &amp; BIND">DNS &amp; BIND</A> | <AHREF="index.htm"TITLE="TCP/IP Network Administration">TCP/IP</A> | <AHREF="../sendmail/index.htm"TITLE="sendmail">sendmail</A> | <AHREF="../smdref/index.htm"TITLE="sendmail Desktop Reference">sendmail Reference</A> | <AHREF="../firewall/index.htm"TITLE="Building Internet Firewalls">Firewalls</A> | <AHREF="../puis/index.htm"TITLE="Practical UNIX &amp; Internet Security">Practical Security</A> ]</FONT></P></DIV></BODY></HTML>