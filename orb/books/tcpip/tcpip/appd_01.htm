<HTML><HEAD><TITLE>[Appendix D] A dhcpd Reference</TITLE><METANAME="DC.title"CONTENT="TCP/IP Network Administration"><METANAME="DC.creator"CONTENT="Craig Hunt"><METANAME="DC.publisher"CONTENT="O'Reilly &amp; Associates, Inc."><METANAME="DC.date"CONTENT="1999-02-04T01:43:50Z"><METANAME="DC.type"CONTENT="Text.Monograph"><METANAME="DC.format"CONTENT="text/html"SCHEME="MIME"><METANAME="DC.source"CONTENT="1-56592-322-7"SCHEME="ISBN"><METANAME="DC.language"CONTENT="en-US"><METANAME="generator"CONTENT="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><LINKREV="made"HREF="mailto:online-books@oreilly.com"TITLE="Online Books Comments"><LINKREL="up"HREF="index.htm"TITLE="TCP/IP Network Administration"><LINKREL="prev"HREF="appc_03.htm"TITLE="C.3 Zone File Records"><LINKREL="next"HREF="appd_02.htm"TITLE="D.2 The dhcpd Command"></HEAD><BODYBGCOLOR="#FFFFFF"TEXT="#000000"><DIVCLASS="htmlnav"><H1><IMGSRC="gifs/smbanner.gif"ALT="TCP/IP Network Administration"USEMAP="#srchmap"BORDER="0"></H1><MAPNAME="srchmap"><AREASHAPE="RECT"COORDS="0,0,466,65"HREF="index.htm"ALT="TCP/IP Network Administration"><AREASHAPE="RECT"COORDS="467,0,514,18"HREF="../search/tsrch.htm"ALT="Search this book"></MAP><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="appc_03.htm"TITLE="C.3 Zone File Records"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: C.3 Zone File Records"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><B><FONTFACE="ARIEL,HELVETICA,HELV,SANSERIF"SIZE="-1">Appendix D</FONT></B></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="appd_02.htm"TITLE="D.2 The dhcpd Command"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: D.2 The dhcpd Command"BORDER="0"></A></TD></TR></TABLE>&nbsp;<HRALIGN="LEFT"WIDTH="515"TITLE="footer"></DIV><DIVCLASS="APPENDIX"><H1CLASS="appendix"><ACLASS="title"NAME="TCP2-AP-4">D. A dhcpd Reference</A></H1><DIVCLASS="htmltoc"><P><B>Contents:</B><BR><ACLASS="SECT1"HREF="#TCP2-AP-4-SECT-1"TITLE="D.1 Compiling dhcpd">Compiling dhcpd</A><BR><ACLASS="SECT1"HREF="appd_02.htm"TITLE="D.2 The dhcpd Command">The dhcpd Command</A><BR><ACLASS="SECT1"HREF="appd_03.htm"TITLE="D.3 The dhcpd.conf Configuration File">The dhcpd.conf Configuration File</A></P><P></P></DIV><PCLASS="para"><ACLASS="indexterm"NAME="TCP2-AP-4-IX-DYNAMIC-HOST-CONFIGURATION-PROTOCOL-DHCP-DAEMON-DHCPD-TOOLS-REFERENCE"></A>This appendix covers the syntax of the <BCLASS="emphasis.bold">dhcpd</B> command and the<EMCLASS="emphasis">dhcpd.conf</EM> configuration file. It is a reference to the InternetSoftware Consortium (ISC) Dynamic Host Configuration Protocol (DHCP)server, ISC <BCLASS="emphasis.bold">dhcpd</B>. To fully understand how to configure and use<BCLASS="emphasis.bold">dhcpd</B> in realistic network environments, see the tutorial andsample configuration files in <ACLASS="xref"HREF="ch09_01.htm"TITLE="Configuring Network Servers ">Chapter 9, <CITECLASS="chapter">Configuring Network Servers </CITE></A>.</P><PCLASS="para"><BCLASS="emphasis.bold">dhcpd</B> is under development.<ACLASS="indexterm"NAME="AUTOID-25125"></A>The information in this appendixis based on Beta Release 5 Patch Level 16. As a beta release, thissoftware is bound to be upgraded and changed. Refer to the Web page<ACLASS="systemitem.sitename"HREF="http://www.isc.org/dhcp.html">http://www.isc.org/dhcp.html</A> for the most recent information about<BCLASS="emphasis.bold">dhcpd</B>. And remember, a DHCP implementation from another vendorwill probably be configured in a completely different manner.</P><DIVCLASS="sect1"><H2CLASS="sect1"><ACLASS="title"NAME="TCP2-AP-4-SECT-1">D.1 Compiling dhcpd</A></H2><PCLASS="para"><ACLASS="indexterm"NAME="TCP2-AP-4-IX-DYNAMIC-HOST-CONFIGURATION-PROTOCOL-DHCP-DAEMON-DHCPD-COMPILING"></A>The source code for <BCLASS="emphasis.bold">dhcpd</B> can be obtained through the ISCWeb site<ACLASS="indexterm"NAME="AUTOID-25139"></A>at <EMCLASS="emphasis">www.isc.org</EM> or via anonymous FTP at <ACLASS="systemitem.url"HREF="ftp://ftp.isc.org/isc/dhcp">ftp://ftp.isc.org/isc/dhcp</A>.The compressed <BCLASS="emphasis.bold">tar</B> file at the time of this writing was<EMCLASS="emphasis">DHCPD-BETA-5.16.tar.gz</EM>, though this name will change as newversions are released. Download, gunzip, and untar the file:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">&gt; <CODECLASS="userinput"><B>ftp ftp.isc.org</B></CODE>Connected to pub1.bryant.vix.com.220 pub1.bryant.vix.com FTP server ready.Name (ftp.isc.org:craig): <CODECLASS="userinput"><B>anonymous</B></CODE>331 Guest login ok, send your complete email address as password.Password:230 Guest login ok, access restrictions apply.ftp&gt; <CODECLASS="userinput"><B>cd isc/dhcp</B></CODE>250 CWD command successful.ftp&gt; <CODECLASS="userinput"><B>binary</B></CODE>200 Type set to I.ftp&gt; <CODECLASS="userinput"><B>get DHCPD-BETA-5.16.tar.gz</B></CODE>200 PORT command successful.150 Opening BINARY mode data connection for DHCPD-BETA-5.16.tar.gz226 Transfer complete.181892 bytes received in 17 secs (10 Kbytes/sec)ftp&gt; <CODECLASS="userinput"><B>quit</B></CODE>221 Goodbye.&gt; <CODECLASS="userinput"><B>gunzip DHCPD-BETA-5.16.tar.gz</B></CODE>&gt; <CODECLASS="userinput"><B>tar -xvf DHCPD-BETA-5.16.tar</B></CODE>DHCPD-BETA-5.16/DHCPD-BETA-5.16/cf/DHCPD-BETA-5.16/cf/alphaosf.hDHCPD-BETA-5.16/cf/bsdos.hDHCPD-BETA-5.16/cf/freebsd.h.<BR>.<BR>.<BR>DHCPD-BETA-5.16/includes/DHCPD-BETA-5.16/includes/netinet/DHCPD-BETA-5.16/includes/netinet/if_ether.hDHCPD-BETA-5.16/includes/netinet/ip.hDHCPD-BETA-5.16/includes/netinet/udp.h</PRE></BLOCKQUOTE></P><PCLASS="para">Change to the newly created directory, DHCPD-BETA-5.16 in the example,and run <BCLASS="emphasis.bold">configure</B>. <BCLASS="emphasis.bold">configure</B> determines the type of UNIXsystem you're running and creates the correct Makefile for that system.If <BCLASS="emphasis.bold">configure</B> cannot determine what version of UNIX you're running,you must build your own Makefile by hand. Next, type <BCLASS="emphasis.bold">make</B> tocompile the daemon. Finally, copy the daemon and the manpagesto the correct directories:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen"># <CODECLASS="userinput"><B>cd DHCPD-BETA-5.16</B></CODE># <CODECLASS="userinput"><B>configure</B></CODE>System Type: linux# <CODECLASS="userinput"><B>make</B></CODE>cc -g      -c dhcpd.c -o dhcpd.occ -g      -c dhcp.c -o dhcp.occ -g      -c bootp.c -o bootp.o.<BR>.<BR>.<BR>nroff -man dhcpd.conf.5 &gt;dhcpd.conf.cat5# <CODECLASS="userinput"><B>make install</B></CODE></PRE></BLOCKQUOTE></P><PCLASS="para">The DHCP daemon should compile without errors. If you get compileerrors or <BCLASS="emphasis.bold">configure</B> cannot determine your system configuration, youshould consider abandoning the compile and notifying the support group.Join the support group mailing list by going to<ACLASS="systemitem.sitename"HREF="http://www.fugue.com/dhcp">http://www.fugue.com/dhcp</A>.<ACLASS="indexterm"NAME="AUTOID-25169"></A>Once you join, send mail to the <EMCLASS="emphasis">dhcp-server@fugue.com</EM> mailinglist describing your configuration and the exact problem you have.The list is read by most of the people using <BCLASS="emphasis.bold">dhcpd</B>. Someone mayhave already solved your problem.</P><PCLASS="para">Simply installing <BCLASS="emphasis.bold">dhcpd</B> may not be all that is required. Remember,<BCLASS="emphasis.bold">dhcpd</B> is beta software. Read the <EMCLASS="emphasis">README</EM> file very carefully.<BCLASS="emphasis.bold">dhcpd</B> runs on a wide variety of systems, including OSF/1, most recentBSD derivatives, Solaris, and Linux. It runs best on OSF/1 and BSD. Onother systems it may have some limitations. For example, on both Solarisand Linux it can support only one network interface. <BCLASS="emphasis.bold">dhcpd</B> alsomay require some system-specific configuration. Our sample Linux 2.0.0system is an excellent example of this. To successfully run <BCLASS="emphasis.bold">dhcpd</B>we had to add the following entry to the <EMCLASS="emphasis">/etc/hosts</EM> table:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">255.255.255.255		all-ones</PRE></BLOCKQUOTE></P><PCLASS="para">And we had to add a specific route for the limited broadcast address,255.255.255.255:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen"># route add -host all-ones dev eth0</PRE></BLOCKQUOTE></P><PCLASS="para">To reinstall the limited broadcast address in the kernelrouting table after each boot, we added the following code to the<EMCLASS="emphasis">/etc/rc.d/rc.inet2</EM> startup script:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen"># Install the limited broadcast route and start DHCP  if [ -f /etc/dhcpd.conf ]; then    echo -n &quot; dhcpd&quot;    route add -host all-ones dev eth0    /usr/sbin/dhcpd  fi</PRE></BLOCKQUOTE></P><PCLASS="para">The information needed to complete these extra configuration steps wasclearly defined in the <EMCLASS="emphasis">README</EM> file. Read it before you try torun <BCLASS="emphasis.bold">dhcpd</B>.<ACLASS="indexterm"NAME="AUTOID-25193"></A></P></DIV></DIV><DIVCLASS="htmlnav"><P></P><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="appc_03.htm"TITLE="C.3 Zone File Records"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: C.3 Zone File Records"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="book"HREF="index.htm"TITLE="TCP/IP Network Administration"><IMGSRC="../gifs/txthome.gif"ALT="TCP/IP Network Administration"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="appd_02.htm"TITLE="D.2 The dhcpd Command"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: D.2 The dhcpd Command"BORDER="0"></A></TD></TR><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172">C.3 Zone File Records</TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="index"HREF="index/idx_0.htm"TITLE="Book Index"><IMGSRC="../gifs/index.gif"ALT="Book Index"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172">D.2 The dhcpd Command</TD></TR></TABLE><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><PCLASS="nav"><FONTSIZE="-1">[ <AHREF="../index.htm"TITLE="The Networking CD Bookshelf">Library Home</A> | <AHREF="../dnsbind/index.htm"TITLE="DNS &amp; BIND">DNS &amp; BIND</A> | <AHREF="index.htm"TITLE="TCP/IP Network Administration">TCP/IP</A> | <AHREF="../sendmail/index.htm"TITLE="sendmail">sendmail</A> | <AHREF="../smdref/index.htm"TITLE="sendmail Desktop Reference">sendmail Reference</A> | <AHREF="../firewall/index.htm"TITLE="Building Internet Firewalls">Firewalls</A> | <AHREF="../puis/index.htm"TITLE="Practical UNIX &amp; Internet Security">Practical Security</A> ]</FONT></P></DIV></BODY></HTML>