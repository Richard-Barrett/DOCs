<HTML><HEAD><TITLE>[Appendix F] Selected TCP/IP Headers</TITLE><METANAME="DC.title"CONTENT="TCP/IP Network Administration"><METANAME="DC.creator"CONTENT="Craig Hunt"><METANAME="DC.publisher"CONTENT="O'Reilly &amp; Associates, Inc."><METANAME="DC.date"CONTENT="1999-02-04T01:46:31Z"><METANAME="DC.type"CONTENT="Text.Monograph"><METANAME="DC.format"CONTENT="text/html"SCHEME="MIME"><METANAME="DC.source"CONTENT="1-56592-322-7"SCHEME="ISBN"><METANAME="DC.language"CONTENT="en-US"><METANAME="generator"CONTENT="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><LINKREV="made"HREF="mailto:online-books@oreilly.com"TITLE="Online Books Comments"><LINKREL="up"HREF="index.htm"TITLE="TCP/IP Network Administration"><LINKREL="prev"HREF="appe_05.htm"TITLE="E.5 Sample Configurations"><LINKREL="next"HREF="appf_02.htm"TITLE="F.2 TCP Segment Header"></HEAD><BODYBGCOLOR="#FFFFFF"TEXT="#000000"><DIVCLASS="htmlnav"><H1><IMGSRC="gifs/smbanner.gif"ALT="TCP/IP Network Administration"USEMAP="#srchmap"BORDER="0"></H1><MAPNAME="srchmap"><AREASHAPE="RECT"COORDS="0,0,466,65"HREF="index.htm"ALT="TCP/IP Network Administration"><AREASHAPE="RECT"COORDS="467,0,514,18"HREF="../search/tsrch.htm"ALT="Search this book"></MAP><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="appe_05.htm"TITLE="E.5 Sample Configurations"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: E.5 Sample Configurations"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><B><FONTFACE="ARIEL,HELVETICA,HELV,SANSERIF"SIZE="-1">Appendix F</FONT></B></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="appf_02.htm"TITLE="F.2 TCP Segment Header"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: F.2 TCP Segment Header"BORDER="0"></A></TD></TR></TABLE>&nbsp;<HRALIGN="LEFT"WIDTH="515"TITLE="footer"></DIV><DIVCLASS="APPENDIX"><H1CLASS="appendix"><ACLASS="title"NAME="TCP2-AP-6">F. Selected TCP/IP Headers</A></H1><DIVCLASS="htmltoc"><P><B>Contents:</B><BR><ACLASS="SECT1"HREF="#TCP2-AP-6-SECT-1"TITLE="F.1 IP Datagram Header">IP Datagram Header</A><BR><ACLASS="SECT1"HREF="appf_02.htm"TITLE="F.2 TCP Segment Header">TCP Segment Header</A><BR><ACLASS="SECT1"HREF="appf_03.htm"TITLE="F.3 ICMP Parameter Problem Message Header">ICMP Parameter Problem Message Header</A></P><P></P></DIV><PCLASS="para"><ACLASS="indexterm"NAME="TCP2-AP-6-IX-TCP-IP-PROTOCOL-SELECTED-HEADERS"></A>In <ACLASS="xref"HREF="ch11_01.htm"TITLE="Troubleshooting TCP/IP ">Chapter 11, <CITECLASS="chapter">Troubleshooting TCP/IP </CITE></A>,  several references aremade to specific TCP/IP headers. Those headers are documented here. This is not an exhaustive list of headers; only the headersused in the troubleshooting examples in <ACLASS="xref"HREF="ch11_01.htm"TITLE="Troubleshooting TCP/IP ">Chapter 11</A> are covered:</P><ULCLASS="itemizedlist"><LICLASS="listitem"><PCLASS="para">IP Datagram Header, as defined in RFC 791, <EMCLASS="emphasis">InternetProtocol</EM></P></LI><LICLASS="listitem"><PCLASS="para">TCP Segment Header, as defined in RFC 793, <EMCLASS="emphasis">Transmission ControlProtocol</EM></P></LI><LICLASS="listitem"><PCLASS="para">ICMP Parameter Problem Message Header, as defined in RFC 792,<EMCLASS="emphasis">Internet Control Message Protocol</EM></P></LI></UL><PCLASS="para">Each header is presented using an excerpt from the RFC that defines theheader. These are not exact quotes; the excerpts have been slightly edited tobetter fit this text. However, we still want to emphasize theimportance of using primary sources for troubleshooting protocolproblems. These headers are provided here to help you follow theexamples in <ACLASS="xref"HREF="ch11_01.htm"TITLE="Troubleshooting TCP/IP ">Chapter 11</A>. For real troubleshooting, use the real RFCs.You can obtain your own copies of the RFCs by following theinstructions in <ACLASS="xref"HREF="ch13_01.htm"TITLE="Internet Information Resources ">Chapter 13, <CITECLASS="chapter">Internet Information Resources </CITE></A>.</P><DIVCLASS="sect1"><H2CLASS="sect1"><ACLASS="title"NAME="TCP2-AP-6-SECT-1">F.1 IP Datagram Header</A></H2><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-29202"></A>This description is taken from pages 11 to 15 of RFC 791,<EMCLASS="emphasis">Internet Protocol</EM>, by JonPostel, Information Sciences Institute, University of SouthernCalifornia.</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">Internet Header Format                                        0                   1                   2                   3       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+   |Version|  IHL  |Type of Service|          Total Length         |   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+   |         Identification        |Flags|      Fragment Offset    |   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+   |  Time to Live |    Protocol   |         Header Checksum       |   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+   |                       Source Address                          |   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+   |                    Destination Address                        |   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+   |                    Options                    |    Padding    |   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+  Version:  4 bits    The Version field indicates the format of the internet header.     This document describes version 4.  IHL:  4 bits    Internet Header Length is the length of the internet header in 32    bit words.  The minimum value for a correct header is 5.  Type of Service:  8 bits    The Type of Service indication the quality of service desired.    The meaning of the bits is explained below.      Bits 0-2:  Precedence.      Bit    3:  0 = Normal Delay,      1 = Low Delay.      Bits   4:  0 = Normal Throughput, 1 = High Throughput.      Bits   5:  0 = Normal Reliability 1 = High Reliability.      Bit  6-7:  Reserved for Future Use.         0     1     2     3     4     5     6     7      +-----+-----+-----+-----+-----+-----+-----+-----+      |                 |     |     |     |     |     |      |   PRECEDENCE    |  D  |  T  |  R  |  0  |  0  |      |                 |     |     |     |     |     |      +-----+-----+-----+-----+-----+-----+-----+-----+        Precedence          111 - Network Control          110 - Internetwork Control          101 - CRITIC/ECP          100 - Flash Override          011 - Flash          010 - Immediate          001 - Priority          000 - Routine  Total Length:  16 bits    Total Length is the length of the datagram, measured in octets     (bytes), including internet header and data.  Identification:  16 bits    An identifying value assigned by the sender to aid in assembling    the fragments of a datagram.  Flags:  3 bits    Various Control Flags.  The Flag bits are explained below:      Bit 0: reserved, must be zero      Bit 1: (DF) 0 = May Fragment,  1 = Don't Fragment.      Bit 2: (MF) 0 = Last Fragment, 1 = More Fragments.          0   1   2        +---+---+---+        |   | D | M |        | 0 | F | F |        +---+---+---+  Fragment Offset:  13 bits    This field indicates where in the datagram this fragment belongs.    The fragment offset is measured in units of 8 octets (64 bits).    The first fragment has offset zero.  Time to Live:  8 bits    This field indicates the maximum time the datagram is allowed to    remain in the internet system.   Protocol:  8 bits    This field indicates the Transport Layer protocol that the data    portion of this datagram is passed to.  The values for various    protocols are specified in the &quot;Assigned Numbers&quot; RFC.  Header Checksum:  16 bits    A checksum on the header only.  Since some header fields change    (e.g., time to live), this is recomputed and verified at each    point that the internet header is processed.  The checksum    algorithm is:      The checksum field is the 16 bit one's complement of the one's      complement sum of all 16 bit words in the header.  For purposes      of computing the checksum, the value of the checksum field is      zero.  Source Address:  32 bits    The source IP address.  See <ACLASS="xref"HREF="ch02_01.htm"TITLE="Delivering the Data">Chapter 2, <CITECLASS="chapter">Delivering the Data</CITE></A>, for a    description of IP addresses.  Destination Address:  32 bits    The destination IP address.  See <ACLASS="xref"HREF="ch02_01.htm"TITLE="Delivering the Data">Chapter 2</A> for a description of IP    addresses.  Options:  variable    The options may or may not appear in datagrams, but they must be    implemented by all IP modules (host and gateways).  No options    were used in any of the datagrams examined in <ACLASS="xref"HREF="ch11_01.htm"TITLE="Troubleshooting TCP/IP ">Chapter 11</A>.</PRE></BLOCKQUOTE></P></DIV></DIV><DIVCLASS="htmlnav"><P></P><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="appe_05.htm"TITLE="E.5 Sample Configurations"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: E.5 Sample Configurations"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="book"HREF="index.htm"TITLE="TCP/IP Network Administration"><IMGSRC="../gifs/txthome.gif"ALT="TCP/IP Network Administration"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="appf_02.htm"TITLE="F.2 TCP Segment Header"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: F.2 TCP Segment Header"BORDER="0"></A></TD></TR><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172">E.5 Sample Configurations</TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="index"HREF="index/idx_0.htm"TITLE="Book Index"><IMGSRC="../gifs/index.gif"ALT="Book Index"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172">F.2 TCP Segment Header</TD></TR></TABLE><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><PCLASS="nav"><FONTSIZE="-1">[ <AHREF="../index.htm"TITLE="The Networking CD Bookshelf">Library Home</A> | <AHREF="../dnsbind/index.htm"TITLE="DNS &amp; BIND">DNS &amp; BIND</A> | <AHREF="index.htm"TITLE="TCP/IP Network Administration">TCP/IP</A> | <AHREF="../sendmail/index.htm"TITLE="sendmail">sendmail</A> | <AHREF="../smdref/index.htm"TITLE="sendmail Desktop Reference">sendmail Reference</A> | <AHREF="../firewall/index.htm"TITLE="Building Internet Firewalls">Firewalls</A> | <AHREF="../puis/index.htm"TITLE="Practical UNIX &amp; Internet Security">Practical Security</A> ]</FONT></P></DIV></BODY></HTML>