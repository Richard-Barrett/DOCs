<HTML><HEAD><TITLE>[Appendix F] F.2 TCP Segment Header</TITLE><METANAME="DC.title"CONTENT="TCP/IP Network Administration"><METANAME="DC.creator"CONTENT="Craig Hunt"><METANAME="DC.publisher"CONTENT="O'Reilly &amp; Associates, Inc."><METANAME="DC.date"CONTENT="1999-02-04T01:46:34Z"><METANAME="DC.type"CONTENT="Text.Monograph"><METANAME="DC.format"CONTENT="text/html"SCHEME="MIME"><METANAME="DC.source"CONTENT="1-56592-322-7"SCHEME="ISBN"><METANAME="DC.language"CONTENT="en-US"><METANAME="generator"CONTENT="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><LINKREV="made"HREF="mailto:online-books@oreilly.com"TITLE="Online Books Comments"><LINKREL="up"HREF="appf_01.htm"TITLE="F. Selected TCP/IP Headers"><LINKREL="prev"HREF="appf_01.htm"TITLE="F.1 IP Datagram Header"><LINKREL="next"HREF="appf_03.htm"TITLE="F.3 ICMP Parameter Problem Message Header"></HEAD><BODYBGCOLOR="#FFFFFF"TEXT="#000000"><DIVCLASS="htmlnav"><H1><IMGSRC="gifs/smbanner.gif"ALT="TCP/IP Network Administration"USEMAP="#srchmap"BORDER="0"></H1><MAPNAME="srchmap"><AREASHAPE="RECT"COORDS="0,0,466,65"HREF="index.htm"ALT="TCP/IP Network Administration"><AREASHAPE="RECT"COORDS="467,0,514,18"HREF="../search/tsrch.htm"ALT="Search this book"></MAP><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="appf_01.htm"TITLE="F.1 IP Datagram Header"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: F.1 IP Datagram Header"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><B><FONTFACE="ARIEL,HELVETICA,HELV,SANSERIF"SIZE="-1">Appendix F<BR>Selected TCP/IP Headers</FONT></B></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="appf_03.htm"TITLE="F.3 ICMP Parameter Problem Message Header"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: F.3 ICMP Parameter Problem Message Header"BORDER="0"></A></TD></TR></TABLE>&nbsp;<HRALIGN="LEFT"WIDTH="515"TITLE="footer"></DIV><DIVCLASS="SECT1"><H2CLASS="sect1"><ACLASS="title"NAME="TCP2-AP-6-SECT-2">F.2 TCP Segment Header</A></H2><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-29214"></A>This description is taken from pages 15 to 17of RFC 793, <EMCLASS="emphasis">Transmission ControlProtocol</EM>, by Jon Postel, Information Sciences Institute, Universityof Southern California.</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">TCP Header Format                                        0                   1                   2                   3       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+   |          Source Port          |       Destination Port        |   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+   |                        Sequence Number                        |   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+   |                    Acknowledgment Number                      |   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+   |  Data |           |U|A|P|R|S|F|                               |   | Offset| Reserved  |R|C|S|S|Y|I|            Window             |   |       |           |G|K|H|T|N|N|                               |   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+   |           Checksum            |         Urgent Pointer        |   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+   |                    Options                    |    Padding    |   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+   |                             data                              |   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+  Source Port:  16 bits    The source port number.  Destination Port:  16 bits    The destination port number.  Sequence Number:  32 bits    The sequence number of the first data octet (byte) in this segment    (except when SYN is present). If SYN is present the sequence    number is the initial sequence number (ISN) and the first data    octet is ISN+1.  Acknowledgment Number:  32 bits    If the ACK control bit is set, this field contains the value of    the next sequence number the sender of the segment is expecting to    receive.  Once a connection is established this is always sent.  Data Offset:  4 bits    The number of 32 bit words in the TCP Header.  This indicates    where the data begins.  The TCP header (even one including options)    is an integral number of 32 bits long.  Reserved:  6 bits    Reserved for future use.  Must be zero.  Control Bits:  6  single-bit values (from left to right):    URG:  Urgent Pointer field significant    ACK:  Acknowledgment field significant    PSH:  Push Function    RST:  Reset the connection    SYN:  Synchronize sequence numbers    FIN:  No more data from sender  Window:  16 bits    The number of data octets (bytes) the sender of this segment is    willing to accept.  Checksum:  16 bits    The checksum field is the 16 bit one's complement of the one's    complement sum of all 16 bit words in the header and text.  Urgent Pointer:  16 bits    This field contains the current value of the urgent pointer as a    positive offset from the sequence number in this segment.  The    urgent pointer points to the sequence number of the octet    following the urgent data.  This field is only be interpreted    in segments with the URG control bit set.  Options:  variable    Options may occupy space at the end of the TCP header and are a    multiple of 8 bits in length.</PRE></BLOCKQUOTE></P></DIV><DIVCLASS="htmlnav"><P></P><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="appf_01.htm"TITLE="F.1 IP Datagram Header"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: F.1 IP Datagram Header"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="book"HREF="index.htm"TITLE="TCP/IP Network Administration"><IMGSRC="../gifs/txthome.gif"ALT="TCP/IP Network Administration"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="appf_03.htm"TITLE="F.3 ICMP Parameter Problem Message Header"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: F.3 ICMP Parameter Problem Message Header"BORDER="0"></A></TD></TR><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172">F.1 IP Datagram Header</TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="index"HREF="index/idx_0.htm"TITLE="Book Index"><IMGSRC="../gifs/index.gif"ALT="Book Index"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172">F.3 ICMP Parameter Problem Message Header</TD></TR></TABLE><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><PCLASS="nav"><FONTSIZE="-1">[ <AHREF="../index.htm"TITLE="The Networking CD Bookshelf">Library Home</A> | <AHREF="../dnsbind/index.htm"TITLE="DNS &amp; BIND">DNS &amp; BIND</A> | <AHREF="index.htm"TITLE="TCP/IP Network Administration">TCP/IP</A> | <AHREF="../sendmail/index.htm"TITLE="sendmail">sendmail</A> | <AHREF="../smdref/index.htm"TITLE="sendmail Desktop Reference">sendmail Reference</A> | <AHREF="../firewall/index.htm"TITLE="Building Internet Firewalls">Firewalls</A> | <AHREF="../puis/index.htm"TITLE="Practical UNIX &amp; Internet Security">Practical Security</A> ]</FONT></P></DIV></BODY></HTML>