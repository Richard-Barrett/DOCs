<HTML><HEAD><TITLE>[Chapter 7] 7.5 Exterior Routing Protocols </TITLE><METANAME="DC.title"CONTENT="TCP/IP Network Administration"><METANAME="DC.creator"CONTENT="Craig Hunt"><METANAME="DC.publisher"CONTENT="O'Reilly &amp; Associates, Inc."><METANAME="DC.date"CONTENT="1999-02-04T01:35:49Z"><METANAME="DC.type"CONTENT="Text.Monograph"><METANAME="DC.format"CONTENT="text/html"SCHEME="MIME"><METANAME="DC.source"CONTENT="1-56592-322-7"SCHEME="ISBN"><METANAME="DC.language"CONTENT="en-US"><METANAME="generator"CONTENT="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><LINKREV="made"HREF="mailto:online-books@oreilly.com"TITLE="Online Books Comments"><LINKREL="up"HREF="ch07_01.htm"TITLE="7. Configuring Routing "><LINKREL="prev"HREF="ch07_04.htm"TITLE="7.4 Interior Routing Protocols "><LINKREL="next"HREF="ch07_06.htm"TITLE="7.6 Gateway Routing Daemon "></HEAD><BODYBGCOLOR="#FFFFFF"TEXT="#000000"><DIVCLASS="htmlnav"><H1><IMGSRC="gifs/smbanner.gif"ALT="TCP/IP Network Administration"USEMAP="#srchmap"BORDER="0"></H1><MAPNAME="srchmap"><AREASHAPE="RECT"COORDS="0,0,466,65"HREF="index.htm"ALT="TCP/IP Network Administration"><AREASHAPE="RECT"COORDS="467,0,514,18"HREF="../search/tsrch.htm"ALT="Search this book"></MAP><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch07_04.htm"TITLE="7.4 Interior Routing Protocols "><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 7.4 Interior Routing Protocols "BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><B><FONTFACE="ARIEL,HELVETICA,HELV,SANSERIF"SIZE="-1">Chapter 7<BR>Configuring Routing </FONT></B></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch07_06.htm"TITLE="7.6 Gateway Routing Daemon "><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 7.6 Gateway Routing Daemon "BORDER="0"></A></TD></TR></TABLE>&nbsp;<HRALIGN="LEFT"WIDTH="515"TITLE="footer"></DIV><DIVCLASS="SECT1"><H2CLASS="sect1"><ACLASS="title"NAME="TCP2-CH-7-SECT-5">7.5 Exterior Routing Protocols </A></H2><PCLASS="para"><ACLASS="indexterm"NAME="TCP2-CH-7-IX-EXTERIOR-ROUTING-PROTOCOLS"></A>Exterior routing protocols are used to exchange routing informationbetween autonomous systems. The routing information passed betweenautonomous systems is called <EMCLASS="emphasis">reachability information</EM>.<ACLASS="indexterm"NAME="AUTOID-8434"></A>Reachability information is simply information about which networks canbe reached through a specific autonomous system.</P><PCLASS="para">RFC 1771 defines Border Gateway Protocol, the leading exterior routing<ACLASS="indexterm"NAME="AUTOID-8437"></A>protocol, and provides the following description of the routingfunction of an autonomous system:<BLOCKQUOTECLASS="blockquote"><PCLASS="para">The classic definition of an Autonomous System is a set of routers<ACLASS="indexterm"NAME="AUTOID-8441"></A>under a single technical administration, using an interior gatewayprotocol and common metrics to route packets within the AS, and usingan exterior gateway protocol to route packets to other ASs....The administration of an AS appears to other ASs to have a singlecoherent interior routing plan and presents a consistent picture ofwhat networks are reachable through it. From the standpoint of exteriorrouting, an AS can be viewed as monolithic...</P></BLOCKQUOTE>Moving routing information into and out of these monoliths is thefunction of exterior routing protocols. Exterior routing protocols arealso called exterior gateway protocols. Don't confuse <EMCLASS="emphasis">an</EM>exterior gateway protocol with <EMCLASS="emphasis">the</EM> Exterior Gateway Protocol(EGP). EGP is not a generic term; it is a particular exteriorrouting protocol, and an old one at that.</P><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="TCP2-CH-7-SECT-5.1">7.5.1 Exterior Gateway Protocol </A></H3><PCLASS="para"><ACLASS="indexterm"NAME="TCP2-CH-7-IX-EXTERIOR-GATEWAY-PROTOCOL-EGP"></A>A gateway running EGP announces that it can reach networks that arepart of its autonomous system. It does not announce that it can reachnetworks outside its autonomous system. For example, the exteriorgateway for our imaginary autonomous system <EMCLASS="emphasis">nuts-as</EM> can reach theentire Internet through its external connection, but only one networkis contained in its autonomous system. Therefore, it would onlyannounce one network (172.16.0.0) if it ran EGP.</P><PCLASS="para">Before sending routing information, the systems first exchange EGP<ACLASS="indexterm"NAME="AUTOID-8453"></A><EMCLASS="emphasis">Hello</EM> and <EMCLASS="emphasis">I-Heard-You</EM> (I-H-U) messages. These messages<ACLASS="indexterm"NAME="AUTOID-8458"></A>establish a dialog between two EGP gateways. Computers communicatingvia EGP are called <EMCLASS="emphasis">EGP neighbors</EM>, and the exchange of Hello and<ACLASS="indexterm"NAME="AUTOID-8461"></A>I-H-U messages is called <EMCLASS="emphasis">acquiring a neighbor</EM>.<ACLASS="indexterm"NAME="AUTOID-8465"></A></P><PCLASS="para">Once a neighbor is acquired, routing information is requested via a<ACLASS="indexterm"NAME="AUTOID-8469"></A><EMCLASS="emphasis">poll</EM>. The neighbor responds by sending a packet of reachabilityinformation called an <EMCLASS="emphasis">update</EM>. The local system includes the<ACLASS="indexterm"NAME="AUTOID-8473"></A>routes from the update into its local routing table. If the neighborfails to respond to three consecutive polls, the system assumes thatthe neighbor is down and removes the neighbor's routes from its table.If the system receives a poll from its EGP neighbor, it responds withits own update packet.</P><PCLASS="para">Unlike the interior protocols discussed above, EGP does not attempt tochoose the &quot;best&quot; route. EGP updates contain distance-vector information,but EGP does not evaluate this information. The routing metrics fromdifferent autonomous systems are not directly comparable. Each AS mayuse different criteria for developing these values. Therefore, EGP leavesthe choice of a &quot;best&quot; route to someone else.</P><PCLASS="para">When EGP was designed, the network relied upon a group of trusted coregateways to process and distribute the routes received from all of theautonomous systems. These core gateways were expected to have the<ACLASS="indexterm"NAME="AUTOID-8477"></A>information necessary to choose the best external routes. EGPreachability information was passed into the core gateways, where theinformation was combined and passed back out to the autonomoussystems.</P><PCLASS="para">A routing structure that depends on a centrally controlled group ofgateways does not scale well and is therefore inadequate for the<ACLASS="indexterm"NAME="AUTOID-8480"></A>rapidly growing Internet. As the number of autonomous systems and<ACLASS="indexterm"NAME="AUTOID-8482"></A>networks connected to the Internet grew, it becamedifficult for the core gateways to keep up with the expanding workload.This is one reason why the Internet moved to a more distributedarchitecture that places a share of the burden of processing routes oneach autonomous system. Another reason is that no central authoritycontrols the commercialized Internet. The Internet is composed of manyequal networks. In a distributed architecture, the autonomous systems<ACLASS="indexterm"NAME="AUTOID-8485"></A>require routing protocols, both interior and exterior, that can makeintelligent routing choices. Because of this, EGP is no longer popular.<ACLASS="indexterm"NAME="AUTOID-8488"></A></P></DIV><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="TCP2-CH-7-SECT-5.2">7.5.2 Border Gateway Protocol </A></H3><PCLASS="para"><ACLASS="indexterm"NAME="TCP2-CH-7-IX-BORDER-GATEWAY-PROTOCOL-BGP"></A><EMCLASS="emphasis">Border Gateway Protocol</EM> (BGP) is the leading exterior routingprotocol of the Internet. It is based on the OSI <EMCLASS="emphasis">InterDomain Routing<ACLASS="indexterm"NAME="AUTOID-8496"></A><ACLASS="indexterm"NAME="AUTOID-8498"></A>Protocol</EM> (IDRP). BGP supports <EMCLASS="emphasis">policy-based routing</EM>, which uses<ACLASS="indexterm"NAME="AUTOID-8501"></A>non-technical reasons (for example, political, organizational, orsecurity considerations) to make routing decisions. Thus BGP enhancesan autonomous system's ability to choose between routes and to implementrouting policies without relying on a central routing authority. Thisfeature is important in the absence of core gateways to perform thesetasks.</P><PCLASS="para">Routing policies are not part of the BGP protocol. Policies areprovided externally as configuration information. As described in<ACLASS="xref"HREF="ch02_01.htm"TITLE="Delivering the Data">Chapter 2</A>, the National Science Foundation provides Routing Arbiters<ACLASS="indexterm"NAME="AUTOID-8505"></A><ACLASS="indexterm"NAME="AUTOID-8507"></A>(RAs) at the Network Access Points (NAPs) where large Internet Service<ACLASS="indexterm"NAME="AUTOID-8509"></A><ACLASS="indexterm"NAME="AUTOID-8511"></A>Providers (ISPs) interconnect. The RAs can be queried for routingpolicy information. Most ISPs also develop private policies based onthe bilateral agreements they have with other ISPs. BGP can be used toimplement these policies by controlling the routes it announces toothers and the routes it accepts from others. In the <BCLASS="emphasis.bold">gated</B>section of this chapter we discuss the <BCLASS="emphasis.bold">import</B> command and the <BCLASS="emphasis.bold">export</B> command, which control what routes are accepted (import) and what routes are announced (export). The network administrator enforces the routing policy through configuring the router.</P><PCLASS="para">BGP is implemented on top of TCP, which provides BGP with a reliabledelivery service. BGP uses well-known TCP port 179. It acquires itsneighbors through the standard TCP three-way handshake. BGP neighbors are<ACLASS="indexterm"NAME="AUTOID-8518"></A>called <EMCLASS="emphasis">peers</EM>. Once connected, BGP peers exchange OPEN messages to<ACLASS="indexterm"NAME="AUTOID-8522"></A>negotiate session parameters, such as the version of BGP that is to beused.</P><PCLASS="para">The UPDATE message lists the destinations that can be reached through a<ACLASS="indexterm"NAME="AUTOID-8525"></A>specific path and the attributes of the path. BGP is a <EMCLASS="emphasis">path vectorprotocol</EM>. It is called a path vector protocol because it provides<ACLASS="indexterm"NAME="AUTOID-8528"></A>the entire end-to-end path of a route in the form of a sequence of<ACLASS="indexterm"NAME="AUTOID-8530"></A>autonomous system numbers. Having the complete AS path eliminates thepossibility of routing loops and count-to-infinity problems. A BGPUPDATE contains a single path vector and all of the destinationsreachable through that path. Multiple UPDATE packets may be sent tobuild a routing table.</P><PCLASS="para">BGP peers send each other complete routing table updates when theconnection is first established. After that, only changes are sent.If there are no changes, just a small (19-byte) KEEPALIVE message is<ACLASS="indexterm"NAME="AUTOID-8534"></A>sent to indicate that the peer and the link are still operational. BGPis very efficient in its use of network bandwidth and systemresources.<ACLASS="indexterm"NAME="AUTOID-8536"></A></P><PCLASS="para">By far the most important thing to remember about exterior protocols isthat most systems never run them. Exterior protocols are only requiredwhen an AS must exchange routing information with another AS. Mostrouters within an AS run an interior protocol such as OSPF. Only thosegateways that connect the AS to another AS need to run an exteriorrouting protocol. Your network is probably an independent part of an ASrun by someone else. Internet Service Providers are good examples ofautonomous systems made up of many independent networks. Unless youprovide a similar level of service, you probably don't need to run anexterior routing protocol.<ACLASS="indexterm"NAME="AUTOID-8538"></A></P></DIV><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="TCP2-CH-7-SECT-5.3">7.5.3 Choosing a Routing Protocol </A></H3><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-8542"></A>Although there are many routing protocols, choosing oneis usually easy. Most of the interior routing protocols mentionedabove were developed to handle the special routing problems of verylarge networks. Some of the protocols have only been used by largenational and regional networks. For local area networks, RIP is stillthe most common choice. For larger networks, OSPF is thechoice.</P><PCLASS="para">If you must run an exterior routing protocol, the protocol that you useis often not a matter of choice. For two autonomous systems to exchangerouting information, they must use the same exterior protocol. If theother AS is already in operation, its administrators have probablydecided which protocol to use, and you will be expected to conform totheir choice. Most often this choice is BGP.</P><PCLASS="para">The type of equipment affects the choice of protocols. Routers supporta wide range of protocols, though individual vendors may have apreferred protocol. Hosts don't usually run routing protocols at all,and most UNIX systems are delivered with only RIP. Allowing host<ACLASS="indexterm"NAME="AUTOID-8548"></A>systems to participate in dynamic routing could limit your choices.<BCLASS="emphasis.bold">gated</B>, however, gives you the option to run many differentrouting protocols on a UNIX system. While the performance of hardwaredesigned specifically to be a router is generally better,<BCLASS="emphasis.bold">gated</B> gives you the option of using a UNIX system as a router.</P><PCLASS="para">In the following sections we discuss the Gateway Routing Daemon(<BCLASS="emphasis.bold">gated</B>) software that combines interior and exterior routingprotocols into one software package. We look at examples of running RIP,RIPv2, OSPF, and BGP with <BCLASS="emphasis.bold">gated</B>.</P></DIV></DIV><DIVCLASS="htmlnav"><P></P><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch07_04.htm"TITLE="7.4 Interior Routing Protocols "><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 7.4 Interior Routing Protocols "BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="book"HREF="index.htm"TITLE="TCP/IP Network Administration"><IMGSRC="../gifs/txthome.gif"ALT="TCP/IP Network Administration"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch07_06.htm"TITLE="7.6 Gateway Routing Daemon "><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 7.6 Gateway Routing Daemon "BORDER="0"></A></TD></TR><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172">7.4 Interior Routing Protocols </TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="index"HREF="index/idx_0.htm"TITLE="Book Index"><IMGSRC="../gifs/index.gif"ALT="Book Index"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172">7.6 Gateway Routing Daemon </TD></TR></TABLE><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><PCLASS="nav"><FONTSIZE="-1">[ <AHREF="../index.htm"TITLE="The Networking CD Bookshelf">Library Home</A> | <AHREF="../dnsbind/index.htm"TITLE="DNS &amp; BIND">DNS &amp; BIND</A> | <AHREF="index.htm"TITLE="TCP/IP Network Administration">TCP/IP</A> | <AHREF="../sendmail/index.htm"TITLE="sendmail">sendmail</A> | <AHREF="../smdref/index.htm"TITLE="sendmail Desktop Reference">sendmail Reference</A> | <AHREF="../firewall/index.htm"TITLE="Building Internet Firewalls">Firewalls</A> | <AHREF="../puis/index.htm"TITLE="Practical UNIX &amp; Internet Security">Practical Security</A> ]</FONT></P></DIV></BODY></HTML>