<HTML><HEAD><TITLE>[Chapter 7] 7.6 Gateway Routing Daemon </TITLE><METANAME="DC.title"CONTENT="TCP/IP Network Administration"><METANAME="DC.creator"CONTENT="Craig Hunt"><METANAME="DC.publisher"CONTENT="O'Reilly &amp; Associates, Inc."><METANAME="DC.date"CONTENT="1999-02-04T01:35:54Z"><METANAME="DC.type"CONTENT="Text.Monograph"><METANAME="DC.format"CONTENT="text/html"SCHEME="MIME"><METANAME="DC.source"CONTENT="1-56592-322-7"SCHEME="ISBN"><METANAME="DC.language"CONTENT="en-US"><METANAME="generator"CONTENT="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><LINKREV="made"HREF="mailto:online-books@oreilly.com"TITLE="Online Books Comments"><LINKREL="up"HREF="ch07_01.htm"TITLE="7. Configuring Routing "><LINKREL="prev"HREF="ch07_05.htm"TITLE="7.5 Exterior Routing Protocols "><LINKREL="next"HREF="ch07_07.htm"TITLE="7.7 Configuring gated "></HEAD><BODYBGCOLOR="#FFFFFF"TEXT="#000000"><DIVCLASS="htmlnav"><H1><IMGSRC="gifs/smbanner.gif"ALT="TCP/IP Network Administration"USEMAP="#srchmap"BORDER="0"></H1><MAPNAME="srchmap"><AREASHAPE="RECT"COORDS="0,0,466,65"HREF="index.htm"ALT="TCP/IP Network Administration"><AREASHAPE="RECT"COORDS="467,0,514,18"HREF="../search/tsrch.htm"ALT="Search this book"></MAP><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch07_05.htm"TITLE="7.5 Exterior Routing Protocols "><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 7.5 Exterior Routing Protocols "BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><B><FONTFACE="ARIEL,HELVETICA,HELV,SANSERIF"SIZE="-1">Chapter 7<BR>Configuring Routing </FONT></B></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch07_07.htm"TITLE="7.7 Configuring gated "><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 7.7 Configuring gated "BORDER="0"></A></TD></TR></TABLE>&nbsp;<HRALIGN="LEFT"WIDTH="515"TITLE="footer"></DIV><DIVCLASS="SECT1"><H2CLASS="sect1"><ACLASS="title"NAME="TCP2-CH-7-SECT-6">7.6 Gateway Routing Daemon </A></H2><PCLASS="para"><ACLASS="indexterm"NAME="TCP2-CH-7-IX-GATEWAY-ROUTING-DAEMON-GATED"></A>Routing software development for general purpose UNIX systems islimited. Most sites use UNIX systems only for simple routing tasks forwhich RIP is usually adequate. Large and complex routing applications,which require advanced routing protocols, are handled by dedicatedrouter hardware that is optimized specifically for routing. Many ofthe advanced routing protocols are only available for UNIX systems in<BCLASS="emphasis.bold">gated</B>. <BCLASS="emphasis.bold">gated</B> combines several different routing protocolsin a single software package.&#13;</P><PCLASS="para">Additionally, <BCLASS="emphasis.bold">gated</B> provides otherfeatures that are usually only associated with dedicated routers:</P><ULCLASS="itemizedlist"><LICLASS="listitem"><PCLASS="para">Systems can run more than one routing protocol. <BCLASS="emphasis.bold">gated</B> combinesthe routing information learned from different protocols, and selectsthe &quot;best&quot; routes.</P></LI><LICLASS="listitem"><PCLASS="para">Routes learned through an interior routing protocol can be announcedvia an exterior routing protocol, which allows the reachability<ACLASS="indexterm"NAME="AUTOID-8571"></A>information announced externally to adjust dynamically to changinginterior routes.</P></LI><LICLASS="listitem"><PCLASS="para">Routing policies can be implemented to control what routes are accepted<ACLASS="indexterm"NAME="AUTOID-8575"></A>and what routes are advertised.</P></LI><LICLASS="listitem"><PCLASS="para">All protocols are configured from a single file(<EMCLASS="emphasis">/etc/gated.conf</EM>) using a single consistent syntax for the<ACLASS="indexterm"NAME="AUTOID-8581"></A><ACLASS="indexterm"NAME="AUTOID-8584"></A>configuration commands.</P></LI><LICLASS="listitem"><PCLASS="para"><BCLASS="emphasis.bold">gated</B> is constantly being upgraded. Using <BCLASS="emphasis.bold">gated</B> ensuresthat you're running the most up-to-date routing software.</P></LI></UL><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="TCP2-CH-7-SECT-6.1">7.6.1 gated's Preference Value </A></H3><PCLASS="para">There are two sides to every routing protocol implementation. One side,the external side, exchanges routing information with remote systems.The other side, the internal side, uses the information received fromthe remote systems to update the routing table. For example, when OSPFexchanges Hello packets to discover a neighbor, it is an externalprotocol function. When OSPF adds a route to the routing table, it isan internal function.</P><PCLASS="para">The external protocol functions implemented in <BCLASS="emphasis.bold">gated</B> are the sameas those in other implementations of the protocols. However, theinternal side of <BCLASS="emphasis.bold">gated</B> is unique for UNIX systems. Internally,<BCLASS="emphasis.bold">gated</B> processes routing information from different routingprotocols, each of which has its own metric for determining the bestroute, and combines that information to update the routing table.Before <BCLASS="emphasis.bold">gated</B> was written, if a UNIX system ran multiple routingprotocols each would write routes into the routing table withoutknowledge of the other's action. The route found in the table was thelast one written&nbsp;- not necessarily the best route.</P><PCLASS="para">With multiple routing protocols and multiple network interfaces, it ispossible for a system to receive routes to the same destination fromdifferent protocols. <BCLASS="emphasis.bold">gated</B> compares these routes and attempts toselect the best one. However, the metrics used by different protocols<ACLASS="indexterm"NAME="AUTOID-8600"></A>are not directly comparable. Each routing protocol has its own metric.It might be a hop count, the delay on the route, or an arbitrary valueset by the administrator. <BCLASS="emphasis.bold">gated</B> needs more than that protocol'smetric to select the best route. It uses its own value to preferroutes from one protocol or interface over another. This value iscalled <EMCLASS="emphasis">preference</EM>.</P><PCLASS="para"><ACLASS="indexterm"NAME="TCP2-CH-7-IX-PREFERENCE-VALUES"></A>Preference values help <BCLASS="emphasis.bold">gated</B> combine routing information fromseveral different sources into a single routing table. <ACLASS="xref"HREF="ch07_06.htm#TCP2-CH-7-TAB-0"TITLE="Default Preference Values">Table 7.1</A>liststhe sources from which <BCLASS="emphasis.bold">gated</B> receives routes, and the defaultpreference given to each source. Preference values range from 0 to 255,with the lowest number indicating the most preferred route. From thistable you can see that <BCLASS="emphasis.bold">gated</B> prefers a route learned from OSPFover the same route learned from BGP.</P><TABLECLASS="table"><CAPTIONCLASS="table"><ACLASS="title"NAME="TCP2-CH-7-TAB-0">Table 7.1: Default Preference Values</A></CAPTION><THEADCLASS="thead"><TRCLASS="row"VALIGN="TOP"><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Route Type</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Default Preference</TH></TR></THEAD><TBODYCLASS="tbody"><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">direct route</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">0</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">OSPF</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">10</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Internally generated default</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">20</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">ICMP redirect</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">30</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">static route</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">60</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Hello protocol</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">90</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">RIP</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">100</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">OSPF ASE routes</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">150</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">BGP</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">170</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">EGP</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">200</TD></TR></TBODY></TABLE><PCLASS="para">Preference can be set in several different configuration statements. Itcan be used to prefer routes from one network interface over another,from one protocol over another, or from one remote gateway overanother. Preference values are not transmitted or modified by theprotocols. Preference is used only in the configuration file. In thenext section we'll look at the <BCLASS="emphasis.bold">gated</B> configuration file(<EMCLASS="emphasis">/etc/gated.conf</EM>) andthe configuration commands it contains.<ACLASS="indexterm"NAME="AUTOID-8653"></A></P></DIV></DIV><DIVCLASS="htmlnav"><P></P><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch07_05.htm"TITLE="7.5 Exterior Routing Protocols "><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 7.5 Exterior Routing Protocols "BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="book"HREF="index.htm"TITLE="TCP/IP Network Administration"><IMGSRC="../gifs/txthome.gif"ALT="TCP/IP Network Administration"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch07_07.htm"TITLE="7.7 Configuring gated "><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 7.7 Configuring gated "BORDER="0"></A></TD></TR><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172">7.5 Exterior Routing Protocols </TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="index"HREF="index/idx_0.htm"TITLE="Book Index"><IMGSRC="../gifs/index.gif"ALT="Book Index"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172">7.7 Configuring gated </TD></TR></TABLE><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><PCLASS="nav"><FONTSIZE="-1">[ <AHREF="../index.htm"TITLE="The Networking CD Bookshelf">Library Home</A> | <AHREF="../dnsbind/index.htm"TITLE="DNS &amp; BIND">DNS &amp; BIND</A> | <AHREF="index.htm"TITLE="TCP/IP Network Administration">TCP/IP</A> | <AHREF="../sendmail/index.htm"TITLE="sendmail">sendmail</A> | <AHREF="../smdref/index.htm"TITLE="sendmail Desktop Reference">sendmail Reference</A> | <AHREF="../firewall/index.htm"TITLE="Building Internet Firewalls">Firewalls</A> | <AHREF="../puis/index.htm"TITLE="Practical UNIX &amp; Internet Security">Practical Security</A> ]</FONT></P></DIV></BODY></HTML>