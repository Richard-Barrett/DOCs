<HTML><HEAD><TITLE>[Chapter 8] 8.4 Using nslookup </TITLE><METANAME="DC.title"CONTENT="TCP/IP Network Administration"><METANAME="DC.creator"CONTENT="Craig Hunt"><METANAME="DC.publisher"CONTENT="O'Reilly &amp; Associates, Inc."><METANAME="DC.date"CONTENT="1999-02-04T01:37:01Z"><METANAME="DC.type"CONTENT="Text.Monograph"><METANAME="DC.format"CONTENT="text/html"SCHEME="MIME"><METANAME="DC.source"CONTENT="1-56592-322-7"SCHEME="ISBN"><METANAME="DC.language"CONTENT="en-US"><METANAME="generator"CONTENT="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><LINKREV="made"HREF="mailto:online-books@oreilly.com"TITLE="Online Books Comments"><LINKREL="up"HREF="ch08_01.htm"TITLE="8. Configuring DNS Name Service "><LINKREL="prev"HREF="ch08_03.htm"TITLE="8.3 Configuring named "><LINKREL="next"HREF="ch08_05.htm"TITLE="8.5 Summary "></HEAD><BODYBGCOLOR="#FFFFFF"TEXT="#000000"><DIVCLASS="htmlnav"><H1><IMGSRC="gifs/smbanner.gif"ALT="TCP/IP Network Administration"USEMAP="#srchmap"BORDER="0"></H1><MAPNAME="srchmap"><AREASHAPE="RECT"COORDS="0,0,466,65"HREF="index.htm"ALT="TCP/IP Network Administration"><AREASHAPE="RECT"COORDS="467,0,514,18"HREF="../search/tsrch.htm"ALT="Search this book"></MAP><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch08_03.htm"TITLE="8.3 Configuring named "><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 8.3 Configuring named "BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><B><FONTFACE="ARIEL,HELVETICA,HELV,SANSERIF"SIZE="-1">Chapter 8<BR>Configuring DNS Name Service </FONT></B></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch08_05.htm"TITLE="8.5 Summary "><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 8.5 Summary "BORDER="0"></A></TD></TR></TABLE>&nbsp;<HRALIGN="LEFT"WIDTH="515"TITLE="footer"></DIV><DIVCLASS="SECT1"><H2CLASS="sect1"><ACLASS="title"NAME="TCP2-CH-8-SECT-4">8.4 Using nslookup </A></H2><PCLASS="para"><ACLASS="indexterm"NAME="TCP2-CH-8-IX-NSLOOKUP"></A><ACLASS="indexterm"NAME="TCP2-CH-8-IX-BERKELEY-INTERNET-NAME-DOMAIN-BIND-DEBUGGING"></A><BCLASS="emphasis.bold">nslookup</B> is a debugging toolprovided as part of the BIND software package. It allows anyone todirectly query a nameserver and retrieve any of the information knownto the DNS system. It is helpful for determining if the server isrunning correctly and is properly configured, or for querying forinformation provided by remote servers.</P><PCLASS="para">The <BCLASS="emphasis.bold">nslookup</B> program is used to resolve queries eitherinteractively or directly from the command line. Below is a command-lineexample of using <BCLASS="emphasis.bold">nslookup</B> to query for the IP address of a host:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">% <CODECLASS="userinput"><B>nslookup almond.nuts.com</B></CODE>Server:  peanut.nuts.comAddress:  172.16.12.2Name:    almond.nuts.comAddress:  172.16.12.1</PRE></BLOCKQUOTE></P><PCLASS="para">Here, a user asks <BCLASS="emphasis.bold">nslookup</B> to provide the address of<EMCLASS="emphasis">almond.nuts.com</EM>. <BCLASS="emphasis.bold">nslookup</B> displays the name and address ofthe server used to resolve the query, and then it displays the answerto the query. This is useful, but <BCLASS="emphasis.bold">nslookup</B> is more often usedinteractively.</P><PCLASS="para">The real power of <BCLASS="emphasis.bold">nslookup</B> is seen in interactive mode. To enter<ACLASS="indexterm"NAME="AUTOID-10106"></A>interactive mode, type <BCLASS="emphasis.bold">nslookup</B> on the command line without anyarguments. Terminate an interactive session by enteringCTRL-D (^D) or the <BCLASS="emphasis.bold">exit</B> command at the <BCLASS="emphasis.bold">nslookup</B> prompt.Redone in an interactive session, the previous query shown is:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">% <CODECLASS="userinput"><B>nslookup</B></CODE>Default Server:  peanut.nuts.comAddress:  172.16.12.2&gt; <CODECLASS="userinput"><B>almond.nuts.com</B></CODE>Server:  peanut.nuts.comAddress:  172.16.12.2Name:    almond.nuts.comAddress:  172.16.12.1&gt; <CODECLASS="userinput"><B>^D</B></CODE></PRE></BLOCKQUOTE></P><PCLASS="para">By default, <BCLASS="emphasis.bold">nslookup</B> queries for A records, but youcan usethe <BCLASS="emphasis.bold">set type</B> command to change the query to anotherresource record type, or to the special query type &quot;ANY.&quot; ANY is used toretrieve all available resource records for the specified host.</P><PCLASS="para">The following example checks MX records <ACLASS="indexterm"NAME="AUTOID-10121"></A><ACLASS="indexterm"NAME="AUTOID-10123"></A>for <EMCLASS="emphasis">almond</EM> and<EMCLASS="emphasis">peanut</EM>. Note that once the query type is set to MX, it staysMX. It doesn't revert to the default A-type query. Another <BCLASS="emphasis.bold">settype</B> command is required to reset the query type.</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">% <CODECLASS="userinput"><B>nslookup</B></CODE>Default Server:  peanut.nuts.comAddress:  172.16.12.2&gt; <CODECLASS="userinput"><B>set type=MX</B></CODE>&gt; <CODECLASS="userinput"><B>almond.nuts.com</B></CODE>Server:  peanut.nuts.comAddress:  172.16.12.2almond.nuts.com    preference = 5, mail exchanger = almond.nuts.comalmond.nuts.com    inet address = 172.16.12.1&gt; <CODECLASS="userinput"><B>peanut.nuts.com</B></CODE>Server:  peanut.nuts.comAddress:  172.16.12.2peanut.nuts.com    preference = 5, mail exchanger = peanut.nuts.compeanut.nuts.com    inet address = 172.16.12.2&gt; <CODECLASS="userinput"><B>exit</B></CODE></PRE></BLOCKQUOTE></P><PCLASS="para">You can use the <BCLASS="emphasis.bold">server</B> command to control the server used toresolve queries.  This is particularly useful for going directly to anauthoritative server to check some information. The following exampledoes just that. In fact, this example contains several interestingcommands:&#13;</P><ULCLASS="itemizedlist"><LICLASS="listitem"><PCLASS="para">First we <BCLASS="emphasis.bold">set type=NS</B> and get the NS records for the<EMCLASS="emphasis">zoo.edu</EM> domain.</P></LI><LICLASS="listitem"><PCLASS="para">From the information returned by this query, we select a server anduse the <BCLASS="emphasis.bold">server</B> command to direct <ACLASS="indexterm"NAME="AUTOID-10145"></A><BCLASS="emphasis.bold">nslookup</B> to use that server.</P></LI><LICLASS="listitem"><PCLASS="para">Next, using the <BCLASS="emphasis.bold">set domain</B> command, <ACLASS="indexterm"NAME="AUTOID-10152"></A>we set the default domain to<EMCLASS="emphasis">zoo.edu</EM>. <BCLASS="emphasis.bold">nslookup</B> uses this default domain name to expandthe hostnames in its queries, in the same way that the resolver usesthe default domain name defined in <EMCLASS="emphasis">resolv.conf</EM>.</P></LI><LICLASS="listitem"><PCLASS="para">We reset the query type to ANY. If the query type is not reset,<BCLASS="emphasis.bold">nslookup</B> still queries for NS records.</P></LI><LICLASS="listitem"><PCLASS="para">Finally, we query for information about the host <EMCLASS="emphasis">tiger.zoo.edu</EM>.Because the default domain is set to <EMCLASS="emphasis">zoo.edu</EM>, we simply enter<EMCLASS="emphasis">tiger</EM> at the prompt.</P></LI></UL><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">% <CODECLASS="userinput"><B>nslookup</B></CODE>Default Server:  peanut.nuts.comAddress:  172.16.12.2&gt; <CODECLASS="userinput"><B>set type=NS</B></CODE>&gt; <CODECLASS="userinput"><B>zoo.edu</B></CODE>Server:  peanut.nuts.comAddress:  172.16.12.2Non-authoritative answer:zoo.edu nameserver = NOC.ZOO.EDUzoo.edu nameserver = NI.ZOO.EDUzoo.edu nameserver = NAMESERVER.AGENCY.GOVAuthoritative answers can be found from:NOC.ZOO.EDU     inet address = 172.28.2.200NI.ZOO.EDU      inet address = 172.28.2.240NAMESERVER.AGENCY.GOV inet address = 172.21.18.31&gt; <CODECLASS="userinput"><B>server NOC.ZOO.EDU</B></CODE>Default Server:  NOC.ZOO.EDUAddress:  172.28.2.200&gt; <CODECLASS="userinput"><B>set domain=zoo.edu</B></CODE>&gt; <CODECLASS="userinput"><B>set type=any</B></CODE>&gt; <CODECLASS="userinput"><B>tiger</B></CODE>Server:  NOC.ZOO.EDUAddress:  172.28.2.200tiger.zoo.edu   inet address = 172.28.172.8tiger.zoo.edu   preference = 10, mail exchanger = tiger.ZOO.EDUtiger.zoo.edu   CPU=ALPHA OS=UNIXtiger.zoo.edu   inet address = 172.28.172.8, protocol = 6         7 21 23 25 79tiger.ZOO.EDU   inet address = 172.28.172.8&gt; <CODECLASS="userinput"><B>exit</B></CODE></PRE></BLOCKQUOTE></P><PCLASS="para">The final example shows how to download an entire domain <ACLASS="indexterm"NAME="AUTOID-10176"></A>from an authoritative server and examine it on your local system. The<BCLASS="emphasis.bold">ls</B> command <ACLASS="indexterm"NAME="AUTOID-10180"></A><ACLASS="indexterm"NAME="AUTOID-10182"></A>requests a zone transfer and displays the contents of the zone itreceives.[12]If the zone file is more than a few lines long, redirect the output toa file, and use the <BCLASS="emphasis.bold">view</B> command <ACLASS="indexterm"NAME="AUTOID-10191"></A>to examine the contents of thefile.  (<BCLASS="emphasis.bold">view</B> sorts a file and displays it using the UNIX<ACLASS="indexterm"NAME="AUTOID-10194"></A><BCLASS="emphasis.bold">more</B> command.)  The combination of <BCLASS="emphasis.bold">ls</B> and <BCLASS="emphasis.bold">view</B> arehelpful when tracking down a remote hostname. In the example thatfollows, the <BCLASS="emphasis.bold">ls</B> command retrieves the <EMCLASS="emphasis">big.com</EM> zone andstores the information in <EMCLASS="emphasis">temp.file</EM>. Then <BCLASS="emphasis.bold">view</B> is used toexamine <EMCLASS="emphasis">temp.file</EM>.</P><BLOCKQUOTECLASS="footnote"><PCLASS="para">[12] For security reasons, many nameservers do not respond to the <BCLASS="emphasis.bold">ls</B>command. See the <BCLASS="emphasis.bold">xfrnets</B> command in <ACLASS="xref"HREF="appc_01.htm"TITLE="A named Reference">Appendix C</A> forinformation on how to limit access to zone transfers.</P></BLOCKQUOTE><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">peanut% <CODECLASS="userinput"><B>nslookup</B></CODE>Default Server:  peanut.nuts.comAddress:  172.16.12.2&gt; <CODECLASS="userinput"><B>server minerals.big.com</B></CODE>Default Server:  minerals.big.comAddress:  192.168.20.1&gt; <CODECLASS="userinput"><B>ls big.com &gt; temp.file</B></CODE>[minerals.big.com]########Received 406 records.&gt; <CODECLASS="userinput"><B>view temp.file</B></CODE> acmite                         192.168.20.28 adamite                        192.168.20.29 adelite                        192.168.20.11 agate                          192.168.20.30 alabaster                      192.168.20.31 albite                         192.168.20.32 allanite                       192.168.20.20 altaite                        192.168.20.33 alum                           192.168.20.35 aluminum                       192.168.20.8 amaranth                       192.168.20.85 amethyst                       192.168.20.36 andorite                       192.168.20.37 apatite                        192.168.20.38 beryl                          192.168.20.23--More-- q&gt; <CODECLASS="userinput"><B>exit</B></CODE></PRE></BLOCKQUOTE></P><PCLASS="para">These examples show that <BCLASS="emphasis.bold">nslookup</B> allows you to: </P><ULCLASS="itemizedlist"><LICLASS="listitem"><PCLASS="para">Query for any specific type of standard resourcerecord.</P></LI><LICLASS="listitem"><PCLASS="para">Directly query the authoritative servers for a domain.</P></LI><LICLASS="listitem"><PCLASS="para">Get the entire contents of a domain into a fileso you can view it.</P></LI></UL><PCLASS="para">&#13;Use <BCLASS="emphasis.bold">nslookup</B>'s <BCLASS="emphasis.bold">help</B> command <ACLASS="indexterm"NAME="AUTOID-10223"></A>to see its other features.  Turn on debugging (with <BCLASS="emphasis.bold">set debug</B>)<ACLASS="indexterm"NAME="AUTOID-10227"></A>and examine the additional information this provides. As you play withthis tool, you'll find many helpful features.<ACLASS="indexterm"NAME="AUTOID-10229"></A><ACLASS="indexterm"NAME="AUTOID-10230"></A></P></DIV><DIVCLASS="htmlnav"><P></P><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch08_03.htm"TITLE="8.3 Configuring named "><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 8.3 Configuring named "BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="book"HREF="index.htm"TITLE="TCP/IP Network Administration"><IMGSRC="../gifs/txthome.gif"ALT="TCP/IP Network Administration"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch08_05.htm"TITLE="8.5 Summary "><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 8.5 Summary "BORDER="0"></A></TD></TR><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172">8.3 Configuring named </TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="index"HREF="index/idx_0.htm"TITLE="Book Index"><IMGSRC="../gifs/index.gif"ALT="Book Index"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172">8.5 Summary </TD></TR></TABLE><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><PCLASS="nav"><FONTSIZE="-1">[ <AHREF="../index.htm"TITLE="The Networking CD Bookshelf">Library Home</A> | <AHREF="../dnsbind/index.htm"TITLE="DNS &amp; BIND">DNS &amp; BIND</A> | <AHREF="index.htm"TITLE="TCP/IP Network Administration">TCP/IP</A> | <AHREF="../sendmail/index.htm"TITLE="sendmail">sendmail</A> | <AHREF="../smdref/index.htm"TITLE="sendmail Desktop Reference">sendmail Reference</A> | <AHREF="../firewall/index.htm"TITLE="Building Internet Firewalls">Firewalls</A> | <AHREF="../puis/index.htm"TITLE="Practical UNIX &amp; Internet Security">Practical Security</A> ]</FONT></P></DIV></BODY></HTML>