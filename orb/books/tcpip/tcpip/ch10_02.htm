<HTML><HEAD><TITLE>[Chapter 10] 10.2 Running sendmail as a Daemon </TITLE><METANAME="DC.title"CONTENT="TCP/IP Network Administration"><METANAME="DC.creator"CONTENT="Craig Hunt"><METANAME="DC.publisher"CONTENT="O'Reilly &amp; Associates, Inc."><METANAME="DC.date"CONTENT="1999-02-04T01:38:28Z"><METANAME="DC.type"CONTENT="Text.Monograph"><METANAME="DC.format"CONTENT="text/html"SCHEME="MIME"><METANAME="DC.source"CONTENT="1-56592-322-7"SCHEME="ISBN"><METANAME="DC.language"CONTENT="en-US"><METANAME="generator"CONTENT="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><LINKREV="made"HREF="mailto:online-books@oreilly.com"TITLE="Online Books Comments"><LINKREL="up"HREF="ch10_01.htm"TITLE="10. sendmail "><LINKREL="prev"HREF="ch10_01.htm"TITLE="10.1 sendmail's Function "><LINKREL="next"HREF="ch10_03.htm"TITLE="10.3 sendmail Aliases "></HEAD><BODYBGCOLOR="#FFFFFF"TEXT="#000000"><DIVCLASS="htmlnav"><H1><IMGSRC="gifs/smbanner.gif"ALT="TCP/IP Network Administration"USEMAP="#srchmap"BORDER="0"></H1><MAPNAME="srchmap"><AREASHAPE="RECT"COORDS="0,0,466,65"HREF="index.htm"ALT="TCP/IP Network Administration"><AREASHAPE="RECT"COORDS="467,0,514,18"HREF="../search/tsrch.htm"ALT="Search this book"></MAP><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch10_01.htm"TITLE="10.1 sendmail's Function "><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 10.1 sendmail's Function "BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><B><FONTFACE="ARIEL,HELVETICA,HELV,SANSERIF"SIZE="-1">Chapter 10<BR>sendmail </FONT></B></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch10_03.htm"TITLE="10.3 sendmail Aliases "><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 10.3 sendmail Aliases "BORDER="0"></A></TD></TR></TABLE>&nbsp;<HRALIGN="LEFT"WIDTH="515"TITLE="footer"></DIV><DIVCLASS="SECT1"><H2CLASS="sect1"><ACLASS="title"NAME="TCP2-CH-10-SECT-2">10.2 Running sendmail as a Daemon </A></H2><PCLASS="para"><ACLASS="indexterm"NAME="TCP2-CH-10-IX-SENDMAIL-RUNNING-AS-A-DAEMON"></A>To receive SMTP mail from the network,  run sendmail as adaemon during system startup. The sendmail daemon listens to TCPport 25 and processes incoming mail. In most cases the code to startsendmail is already in one of your boot scripts. If it isn't, addit. The following code is from the Slackware<ACLASS="indexterm"NAME="AUTOID-12900"></A>Linux <EMCLASS="emphasis">/etc/rc.d/rc.M</EM>startup script:<ACLASS="indexterm"NAME="AUTOID-12903"></A><ACLASS="indexterm"NAME="AUTOID-12905"></A></P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen"># Start the sendmail daemon:if [ -x /usr/sbin/sendmail ]; then  echo &quot;Starting sendmail daemon (/usr/sbin/sendmail -bd -q 15m)...&quot;  /usr/sbin/sendmail -bd -q 15mfi</PRE></BLOCKQUOTE></P><PCLASS="para">First, this code checks for the existence of the sendmail program.If the program is found, the code displays a startup message onthe console and runs sendmail with two command-line options.One option, the <BCLASS="emphasis.bold">-q</B> option, tells sendmail how often toprocess the mail queue. In the sample code, the queue is processedevery 15 minutes (<BCLASS="emphasis.bold">-q15m</B>), which is a good setting to process thequeue frequently. Don't set this time too low. Processing the queue toooften can cause problems if the queue grows very large, due to a deliveryproblem such as a network outage. For the average desktop system, everyhour (<BCLASS="emphasis.bold">-q1h</B>) or half hour (<BCLASS="emphasis.bold">-q30m</B>) is an adequate setting.</P><PCLASS="para">The other option relates directly to receiving SMTP mail. The option(<BCLASS="emphasis.bold">-bd</B>) tells sendmail to run as a daemon and to listen toTCP port 25 for incoming mail. Use this option if you want your systemto accept incoming TCP/IP mail.</P><PCLASS="para">The Linux example is a simple one. Some systems have a morecomplex startup script.<ACLASS="indexterm"NAME="AUTOID-12918"></A>Solaris 2.5, which dedicates the entire<EMCLASS="emphasis">/etc/init.d/sendmail</EM><ACLASS="indexterm"NAME="AUTOID-12921"></A><ACLASS="indexterm"NAME="AUTOID-12923"></A>script to starting sendmail, is anotable example. The mail queue directory holds mail that has not yetbeen delivered. It is possible that the system went down while the mailqueue was being processed. Versions of sendmail prior to sendmailV8, such as the version that comes with Solaris 2.5, create lock files whenprocessing the queue. Therefore lock files may have been leftbehind inadvertently and should be removed during the boot. Solaris checksfor the existence of the mail queue directory and removes any lock filesfound there. If a mail queue directory doesn't exist, it creates one.The additional code found in some startup scripts is not required when running sendmail V8.All you really need is the sendmail command with the<BCLASS="emphasis.bold">-bd</B> option.<ACLASS="indexterm"NAME="AUTOID-12928"></A></P></DIV><DIVCLASS="htmlnav"><P></P><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch10_01.htm"TITLE="10.1 sendmail's Function "><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 10.1 sendmail's Function "BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="book"HREF="index.htm"TITLE="TCP/IP Network Administration"><IMGSRC="../gifs/txthome.gif"ALT="TCP/IP Network Administration"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch10_03.htm"TITLE="10.3 sendmail Aliases "><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 10.3 sendmail Aliases "BORDER="0"></A></TD></TR><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172">10.1 sendmail's Function </TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="index"HREF="index/idx_0.htm"TITLE="Book Index"><IMGSRC="../gifs/index.gif"ALT="Book Index"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172">10.3 sendmail Aliases </TD></TR></TABLE><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><PCLASS="nav"><FONTSIZE="-1">[ <AHREF="../index.htm"TITLE="The Networking CD Bookshelf">Library Home</A> | <AHREF="../dnsbind/index.htm"TITLE="DNS &amp; BIND">DNS &amp; BIND</A> | <AHREF="index.htm"TITLE="TCP/IP Network Administration">TCP/IP</A> | <AHREF="../sendmail/index.htm"TITLE="sendmail">sendmail</A> | <AHREF="../smdref/index.htm"TITLE="sendmail Desktop Reference">sendmail Reference</A> | <AHREF="../firewall/index.htm"TITLE="Building Internet Firewalls">Firewalls</A> | <AHREF="../puis/index.htm"TITLE="Practical UNIX &amp; Internet Security">Practical Security</A> ]</FONT></P></DIV></BODY></HTML>