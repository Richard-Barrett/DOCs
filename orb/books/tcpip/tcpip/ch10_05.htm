<HTML><HEAD><TITLE>[Chapter 10] 10.5 sendmail Configuration </TITLE><METANAME="DC.title"CONTENT="TCP/IP Network Administration"><METANAME="DC.creator"CONTENT="Craig Hunt"><METANAME="DC.publisher"CONTENT="O'Reilly &amp; Associates, Inc."><METANAME="DC.date"CONTENT="1999-02-04T01:38:55Z"><METANAME="DC.type"CONTENT="Text.Monograph"><METANAME="DC.format"CONTENT="text/html"SCHEME="MIME"><METANAME="DC.source"CONTENT="1-56592-322-7"SCHEME="ISBN"><METANAME="DC.language"CONTENT="en-US"><METANAME="generator"CONTENT="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><LINKREV="made"HREF="mailto:online-books@oreilly.com"TITLE="Online Books Comments"><LINKREL="up"HREF="ch10_01.htm"TITLE="10. sendmail "><LINKREL="prev"HREF="ch10_04.htm"TITLE="10.4 The sendmail.cf File "><LINKREL="next"HREF="ch10_06.htm"TITLE="10.6 Rewriting the Mail Address "></HEAD><BODYBGCOLOR="#FFFFFF"TEXT="#000000"><DIVCLASS="htmlnav"><H1><IMGSRC="gifs/smbanner.gif"ALT="TCP/IP Network Administration"USEMAP="#srchmap"BORDER="0"></H1><MAPNAME="srchmap"><AREASHAPE="RECT"COORDS="0,0,466,65"HREF="index.htm"ALT="TCP/IP Network Administration"><AREASHAPE="RECT"COORDS="467,0,514,18"HREF="../search/tsrch.htm"ALT="Search this book"></MAP><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch10_04.htm"TITLE="10.4 The sendmail.cf File "><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 10.4 The sendmail.cf File "BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><B><FONTFACE="ARIEL,HELVETICA,HELV,SANSERIF"SIZE="-1">Chapter 10<BR>sendmail </FONT></B></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch10_06.htm"TITLE="10.6 Rewriting the Mail Address "><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 10.6 Rewriting the Mail Address "BORDER="0"></A></TD></TR></TABLE>&nbsp;<HRALIGN="LEFT"WIDTH="515"TITLE="footer"></DIV><DIVCLASS="SECT1"><H2CLASS="sect1"><ACLASS="title"NAME="TCP2-CH-10-SECT-5">10.5 sendmail Configuration </A></H2><PCLASS="para"><ACLASS="indexterm"NAME="TCP2-CH-10-IX-SENDMAIL-CONFIGURING"></A>Every time sendmail starts up, it reads <EMCLASS="emphasis">sendmail.cf</EM>. Forthis reason, the syntax of the <EMCLASS="emphasis">sendmail.cf</EM> commands is designedto be easy for sendmail to parse&nbsp;- not necessarily easy for humansto read. As a consequence, sendmail commands are very terse,even by UNIX standards.</P><PCLASS="para">The configuration command is not separated from its variable or valueby any spaces. This &quot;run together&quot; format makes the commands hard toread. <ACLASS="xref"HREF="ch10_05.htm#TCP2-CH-10-FIG-1"TITLE="A sendmail.cf configuration command">Figure 10.2</A>illustrates the format of a command. In the figure,a <BCLASS="emphasis.bold">define macro</B> command assigns the value <EMCLASS="emphasis">nuts.com</EM> to the macroD.</P><H4CLASS="figure"><ACLASS="title"NAME="TCP2-CH-10-FIG-1">Figure 10.2: A sendmail.cf configuration command</A></H4><IMGCLASS="graphic"SRC="figs/tcp2_1002.gif"ALT="Figure 10.2"><PCLASS="para">Starting with version 8 of sendmail, variable names are no longerrestricted to a single character. Long variable names, enclosed in<ACLASS="indexterm"NAME="AUTOID-13365"></A><ACLASS="indexterm"NAME="AUTOID-13368"></A><ACLASS="indexterm"NAME="AUTOID-13371"></A>braces, are now acceptable. For example, the define macro shown in<ACLASS="xref"HREF="ch10_05.htm#TCP2-CH-10-FIG-1"TITLE="A sendmail.cf configuration command">Figure 10.2</A>could be written:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">D{Domain}nuts.com</PRE></BLOCKQUOTE></P><PCLASS="para">However, a quick check of the <EMCLASS="emphasis">sendmail.cf</EM> delivered with myLinux system shows that not a single long variable name was used.The traditional, short variable names are still the most common.<ACLASS="indexterm"NAME="TCP2-CH-10-IX-SENDMAIL-CF-FILE-COMMANDS-LISTED"></A>This terse syntax can be very hard to decipher, but it helps toremember that the first character on the line is always the command.From this single character you can determine what the command is andtherefore its structure. <ACLASS="xref"HREF="ch10_05.htm#TCP2-CH-10-TAB-0"TITLE="sendmail Configuration Commands">Table 10.1</A>lists the <EMCLASS="emphasis">sendmail.cf</EM>commands and their syntax.</P><TABLECLASS="table"><CAPTIONCLASS="table"><ACLASS="title"NAME="TCP2-CH-10-TAB-0">Table 10.1: sendmail Configuration Commands</A></CAPTION><THEADCLASS="thead"><TRCLASS="row"VALIGN="TOP"><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Command</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Syntax</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Meaning</TH></TR></THEAD><TBODYCLASS="tbody"><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Version Level</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><BCLASS="emphasis.bold">V</B><CODECLASS="replaceable"><I>level</I></CODE>[<BCLASS="emphasis.bold">/</B><CODECLASS="replaceable"><I>vendor</I></CODE>]</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Specify version level.</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Define Macro</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><BCLASS="emphasis.bold">D</B><CODECLASS="replaceable"><I>xvalue</I></CODE></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Set macro <CODECLASS="replaceable"><I>x</I></CODE> to <CODECLASS="replaceable"><I>value</I></CODE>.</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Define Class</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><BCLASS="emphasis.bold">C</B><CODECLASS="replaceable"><I>cword1</I></CODE>[<CODECLASS="replaceable"><I> word2</I></CODE>]...</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Set class <CODECLASS="replaceable"><I>c</I></CODE> to <CODECLASS="replaceable"><I>word1 word2...</I></CODE>.</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Define Class</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><BCLASS="emphasis.bold">F</B><CODECLASS="replaceable"><I>cfile</I></CODE></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Load class <CODECLASS="replaceable"><I>c</I></CODE> from <CODECLASS="replaceable"><I>file</I></CODE>.</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Set Option</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><BCLASS="emphasis.bold">O</B><CODECLASS="replaceable"><I>option</I></CODE><BCLASS="emphasis.bold">=</B><CODECLASS="replaceable"><I>value</I></CODE></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Set <CODECLASS="replaceable"><I>option</I></CODE> to <CODECLASS="replaceable"><I>value</I></CODE>.</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Trusted Users</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><BCLASS="emphasis.bold">T</B><CODECLASS="replaceable"><I>user1</I></CODE>[<CODECLASS="replaceable"><I> user2...</I></CODE>]</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Trusted users are <CODECLASS="replaceable"><I>user1</I></CODE> <CODECLASS="replaceable"><I>user2...</I></CODE>.</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Set Precedence</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><BCLASS="emphasis.bold">P</B><CODECLASS="replaceable"><I>name</I></CODE>=<CODECLASS="replaceable"><I>number</I></CODE></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Set <CODECLASS="replaceable"><I>name</I></CODE> to precedence <CODECLASS="replaceable"><I>number</I></CODE>.</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Define Mailer</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><BCLASS="emphasis.bold">M</B><CODECLASS="replaceable"><I>name</I></CODE>, {<CODECLASS="replaceable"><I>field=value</I></CODE>}</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Define mailer <CODECLASS="replaceable"><I>name</I></CODE>.</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Define Header</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><BCLASS="emphasis.bold">H</B>[<BCLASS="emphasis.bold">?</B><CODECLASS="replaceable"><I>mflag</I></CODE><BCLASS="emphasis.bold">?</B>]<CODECLASS="replaceable"><I>name</I></CODE><BCLASS="emphasis.bold">:</B><CODECLASS="replaceable"><I>format</I></CODE></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Set header format.</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Set Ruleset</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><BCLASS="emphasis.bold">S</B><CODECLASS="replaceable"><I>n</I></CODE></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Start ruleset number <CODECLASS="replaceable"><I>n</I></CODE>.</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Define Rule</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><BCLASS="emphasis.bold">R</B><CODECLASS="replaceable"><I>lhs rhs comment</I></CODE></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Rewrite <CODECLASS="replaceable"><I>lhs</I></CODE> patterns to <CODECLASS="replaceable"><I>rhs</I></CODE> format.</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Key File</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><BCLASS="emphasis.bold">K</B><CODECLASS="replaceable"><I>name type</I></CODE> [<CODECLASS="replaceable"><I>argument</I></CODE>]</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Define database <CODECLASS="replaceable"><I>name</I></CODE>.</TD></TR></TBODY></TABLE><PCLASS="para">The following sections describe each configuration commandin more detail.<ACLASS="indexterm"NAME="AUTOID-13497"></A></P><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="TCP2-CH-10-SECT-5.1">10.5.1 The Version Level Command </A></H3><PCLASS="para"><ACLASS="indexterm"NAME="TCP2-CH-10-IX-SENDMAIL-CF-FILE-VERSION-LEVEL-COMMAND-V"></A>The version level command is an optional command not found in all<EMCLASS="emphasis">sendmail.cf</EM> files. You don't add a <BCLASS="emphasis.bold">V</B> command to the<EMCLASS="emphasis">sendmail.cf</EM> file or change one if it is already there. The<BCLASS="emphasis.bold">V</B> command is inserted into the configuration file when it is firstbuilt from <BCLASS="emphasis.bold">m4</B> macros or by the vendor.</P><PCLASS="para">The <CODECLASS="replaceable"><I>level</I></CODE> number on the <BCLASS="emphasis.bold">V</B> command line indicates theversion level of the configuration syntax. V1 is the oldestconfiguration syntax and V7 is the version supported bysendmail V8.8.5. Every level in between adds some feature extensions.The <CODECLASS="replaceable"><I>vendor</I></CODE> part of the <BCLASS="emphasis.bold">V</B> command identifies if any vendorspecific syntax<ACLASS="indexterm"NAME="AUTOID-13514"></A>is supported. The default <CODECLASS="replaceable"><I>vendor</I></CODE> value for thesendmail distribution is &quot;Berkeley&quot;.</P><PCLASS="para">The <BCLASS="emphasis.bold">V</B> command tells the sendmail executable the level ofsyntax and commands required to support this configuration. If thesendmail program cannot support the requested commands and syntax,it displays the following error message:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen"># /usr/lib/sendmail -Ctest.cftest.cf: line 63: Bad V line: Only V1/sun syntax is supported in     this release</PRE></BLOCKQUOTE></P><PCLASS="para">The error message shown above indicates that this sendmailprogram supports level 1 configuration files with Sun syntaxextensions.[12]The example was produced on a Solaris 2.5.1 running the sendmailprogram that came with the operating system. In the example weattempted to read a <EMCLASS="emphasis">sendmail.cf</EM> that was created by the <BCLASS="emphasis.bold">m4</B>macros that came with sendmail 8.8.5. The syntax and functions neededby the <EMCLASS="emphasis">sendmail.cf</EM> file are not available in the sendmailprogram. To use this configuration file, we would have to compile anewer version of the sendmail program. See <ACLASS="xref"HREF="appe_01.htm"TITLE="A sendmail Reference">Appendix E</A> for anexample of compiling sendmail.</P><BLOCKQUOTECLASS="footnote"><PCLASS="para">[12] See Table 10-4 for Sun-specific syntax.</P></BLOCKQUOTE><PCLASS="para">You will never change the values on a <BCLASS="emphasis.bold">V</B> command. You might,however, need to customize some <BCLASS="emphasis.bold">D</B> commands.<ACLASS="indexterm"NAME="AUTOID-13531"></A></P></DIV><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="TCP2-CH-10-SECT-5.2">10.5.2 The Define Macro Command </A></H3><PCLASS="para"><ACLASS="indexterm"NAME="TCP2-CH-10-IX-SENDMAIL-CF-FILE-DEFINE-MACRO-COMMAND-D"></A>The define macro command (<BCLASS="emphasis.bold">D</B>) defines a macro and stores a valuein it. Once the macro is defined, it is used to provide the storedvalue to other <EMCLASS="emphasis">sendmail.cf</EM> commands and directly tosendmail itself. This allows sendmail configurations to beshared by many systems, simply by modifying a few system-specificmacros.</P><PCLASS="para"><ACLASS="indexterm"NAME="TCP2-CH-10-IX-SENDMAIL-INTERNAL-MACROS-LISTED"></A>A macro name can be any single ASCII character or, as of sendmail V8,a word enclosed in curly braces.<ACLASS="indexterm"NAME="AUTOID-13544"></A><ACLASS="indexterm"NAME="AUTOID-13547"></A><ACLASS="indexterm"NAME="AUTOID-13550"></A>User-created macros use uppercaseletters as names. sendmail's own internal macros use lowercaseletters and special characters as names. This does not mean that youwon't be called upon to define a value for a macro with a lowercase name.A few of these internal macros are sometimes defined inthe <EMCLASS="emphasis">sendmail.cf</EM> file. <ACLASS="xref"HREF="ch10_05.htm#TCP2-CH-10-TAB-1"TITLE="sendmail's Internal Macros">Table 10.2</A>provides a complete list ofsendmail's internal macros.</P><TABLECLASS="table"><CAPTIONCLASS="table"><ACLASS="title"NAME="TCP2-CH-10-TAB-1">Table 10.2: sendmail's Internal Macros</A></CAPTION><THEADCLASS="thead"><TRCLASS="row"VALIGN="TOP"><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Name</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Function</TH></TR></THEAD><TBODYCLASS="tbody"><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">a</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Origination date in RFC 822 format</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">b</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Current date in RFC 822 format</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">c</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Hop count</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">d</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Date in UNIX (ctime) format</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">e</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">SMTP entry message</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">f</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Sender \(lqfrom\(rq address</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">g</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Sender address relative to the recipient</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">h</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Recipient host</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">i</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Queue id</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">j</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Fully qualified domain name (host plus domain)</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">k</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">UUCP node name</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">l</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Format of the UNIX from line</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">m</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Name of this domain (domain only)</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">n</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Name of the daemon (for error messages)</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">o</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Set of &quot;operators&quot; in addresses[13]</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">p</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Sendmail's pid</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">q</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Default format of sender address[13]</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">r</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Protocol used</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">s</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Sender's hostname</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">t</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Numeric representation of the current time</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">u</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Recipient user</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">v</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Version number of sendmail</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">w</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Hostname of this site (host only)</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">x</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Full name of the sender</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">z</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Home directory of the recipient</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">-</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Validated sender address</TD></TR></TBODY></TABLE><BLOCKQUOTECLASS="footnote"><PCLASS="para">[13] Obsolete in sendmail V8.</P></BLOCKQUOTE><PCLASS="para">To retrieve the value stored in a macro, reference it as <BCLASS="emphasis.bold">$</B><EMCLASS="emphasis">x</EM>,where <EMCLASS="emphasis">x</EM> is the macro name. Macros are expanded whenthe <EMCLASS="emphasis">sendmail.cf</EM> file is read. A special syntax, <BCLASS="emphasis.bold">$&amp;</B><EMCLASS="emphasis">x</EM>,is used to expand macros when they are referenced. The <BCLASS="emphasis.bold">$&amp;</B><EMCLASS="emphasis">x</EM>syntax is only used with certain internal macros that change at runtime.<ACLASS="indexterm"NAME="AUTOID-13653"></A></P><PCLASS="para">The code below defines the macros R, M, and Q. After this code executes,$R returns <EMCLASS="emphasis">almond</EM>, <BCLASS="emphasis.bold">$M</B> returns <EMCLASS="emphasis">nuts.com</EM>, and <BCLASS="emphasis.bold">$Q</B> returns<EMCLASS="emphasis">almond.nuts.com</EM>. This sample code defines Q as containing thevalue of R (<BCLASS="emphasis.bold">$R</B>), plus a literal dot, plus the value of M (<BCLASS="emphasis.bold">$M</B>).</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">DRalmondDMnuts.comDQ$R.$M</PRE></BLOCKQUOTE></P><PCLASS="para">If you customize your <EMCLASS="emphasis">sendmail.cf</EM> file, it will probably benecessary to modify some macro definitions. The macros thatusually require modification define site-specificinformation, such as hostnames and domain names.</P><DIVCLASS="sect3"><H4CLASS="sect3"><ACLASS="title"NAME="TCP2-CH-10-SECT-5.2.1">10.5.2.1 Conditionals </A></H4><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-13669"></A>A macro definition can contain a conditional. Here's a conditional:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">DX$g$?x ($x)$.</PRE></BLOCKQUOTE></P><PCLASS="para">The <CODECLASS="literal">D</CODE> is the define macro command; <CODECLASS="literal">X</CODE> is the macrobeing defined; and <CODECLASS="literal">$g</CODE> says to use the value stored in macro<CODECLASS="literal">g</CODE>. But what does &quot;<CODECLASS="literal">$?x ($x)$.</CODE>&quot; mean? The construct<CODECLASS="literal">$?x</CODE> is a conditional. It tests whether macro <CODECLASS="literal">x</CODE> has a valueset. If the macro has been set, the text following the conditional isinterpreted. The <CODECLASS="literal">$</CODE>. construct ends the conditional.</P><PCLASS="para">Given this, the assignment of macro X is interpreted as follows: X isassigned the value of g; and if x is set, it is also assigned a literalblank, a literal left parenthesis, the value of x, and a literal right parenthesis.&#13;</P><PCLASS="para">So if g contains <EMCLASS="emphasis">chunt@nuts.com</EM> and x contains<EMCLASS="emphasis">Craig Hunt</EM>, X will contain:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">chunt@nuts.com (Craig Hunt)</PRE></BLOCKQUOTE></P><PCLASS="para">The conditional can be used with an &quot;else&quot; construct, which is<CODECLASS="literal">$|</CODE>.  The full syntax of the conditional is:<ACLASS="indexterm"NAME="AUTOID-13690"></A></P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen"><BCLASS="emphasis.bold">$?</B><CODECLASS="replaceable"><I>x text1 </I></CODE><BCLASS="emphasis.bold">$|</B><CODECLASS="replaceable"><I> text2 </I></CODE><BCLASS="emphasis.bold">$.</B></PRE></BLOCKQUOTE></P><PCLASS="para">This is interpreted as:</P><ULCLASS="itemizedlist"><LICLASS="listitem"><PCLASS="para">if (<CODECLASS="literal">$?</CODE>) <CODECLASS="replaceable"><I>x</I></CODE> is set;</P></LI><LICLASS="listitem"><PCLASS="para">use <CODECLASS="replaceable"><I>text1</I></CODE>;</P></LI><LICLASS="listitem"><PCLASS="para">else (<CODECLASS="literal">$|</CODE>);</P></LI><LICLASS="listitem"><PCLASS="para">use <CODECLASS="replaceable"><I>text2</I></CODE>;</P></LI><LICLASS="listitem"><PCLASS="para">end if (<CODECLASS="literal">$.</CODE>).</P></LI></UL></DIV></DIV><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="TCP2-CH-10-SECT-5.3">10.5.3 The Define Class Command </A></H3><PCLASS="para"><ACLASS="indexterm"NAME="TCP2-CH-10-IX-SENDMAIL-CF-FILE-DEFINE-CLASS-COMMAND-C-AND-F"></A>Two commands, <BCLASS="emphasis.bold">C</B> and <BCLASS="emphasis.bold">F</B>, define sendmail classes. A classis similar to an array of values. Classes are used for anything withmultiple values that are handled in the same way, such as multiple namesfor the local host or a list of <BCLASS="emphasis.bold">uucp</B> hostnames. Classes allowsendmail to compare against a list of values, instead of againsta single value. Special pattern matching symbols<ACLASS="indexterm"NAME="AUTOID-13725"></A>are used with classes.The <BCLASS="emphasis.bold">$=</B> symbol matches any value in a class, and the <BCLASS="emphasis.bold">$~</B> symbolmatches any value not in a class. (More on pattern matching later.)</P><PCLASS="para">Like macros, classes usually have single-character names, anduser-created classes use uppercase letters for names. Class values canbe defined on a single line, on multiple lines, or loaded from a file.For example, class w is used to define all of the hostnames by which thelocal host is known. To assign class w the values <EMCLASS="emphasis">goober</EM> and<EMCLASS="emphasis">pea</EM>, you can enter the values on a single line:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">Cwgoober pea</PRE></BLOCKQUOTE></P><PCLASS="para">Or you can enter the values on multiple lines:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">CwgooberCwpea</PRE></BLOCKQUOTE></P><PCLASS="para">You can also use the <BCLASS="emphasis.bold">F</B> command to load the class values from afile. The  <BCLASS="emphasis.bold">F</B> command reads a file and stores the words foundthere in a class variable. For example, to define class w andassign it all of the strings found in <EMCLASS="emphasis">/etc/sendmail.cw</EM>, use:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">Fw/etc/sendmail.cw</PRE></BLOCKQUOTE></P><PCLASS="para">You may need to modify a few class definitions when creating your<EMCLASS="emphasis">sendmail.cf</EM> file. Frequently information relating to <BCLASS="emphasis.bold">uucp</B>,to alias hostnames, and to special domains for mail routing is definedin class statements. If your system has a <BCLASS="emphasis.bold">uucp</B> connection as<ACLASS="indexterm"NAME="AUTOID-13748"></A>well as a TCP/IP connection, pay particular attention to the classdefinitions. But in any case, check the class definitions carefully andmake sure they apply to your configuration.</P><PCLASS="para">Here we <BCLASS="emphasis.bold">grep</B> the Linux sample configuration file for lines beginningwith <BCLASS="emphasis.bold">C</B> or <BCLASS="emphasis.bold">F</B>:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">% <CODECLASS="userinput"><B>grep '^[CF]' linux.smtp.cf</B></CODE>CwlocalhostCP.CO @ % C..CE root</PRE></BLOCKQUOTE></P><PCLASS="para"></P><PCLASS="para">This <BCLASS="emphasis.bold">grep</B> shows that <EMCLASS="emphasis">linux.smtp.cf</EM> defines classes w, P,O, ., and E. w contains the host's alias hostnames. P holds pseudo-domains used for mail routing. O stores operators that cannot be part ofa valid username. The class . (dot) is primarily of interest becauseit shows that variable names do not have to be alphabetic characters.E lists the usernames that should always be associated with the localhost's fully qualified domain name, even if simplified email addresses<ACLASS="indexterm"NAME="AUTOID-13762"></A>are being used for all other users. (More on simplified addresses later.)In our sample file, the variables are all assigned default values.</P><PCLASS="para">Remember that your system will be different. The uppercase letters usedfor some of these class names mean that they are user-created classes.These same class names may be used for other purposes on your system,and are only presented here as an example. Carefully read the commentsin your <EMCLASS="emphasis">sendmail.cf</EM> file for guidance as to how classes and macrosare used in your configuration.</P><PCLASS="para">The class names that are lowercase letters or special charactersare reserved for internal sendmail use. All internal classesdefined in sendmail versions after 8.8 are shown in <ACLASS="xref"HREF="appe_01.htm"TITLE="A sendmail Reference">Appendix E</A>.Most of these can be ignored. Only class w, which defines all of thehostnames the system will accept as its own, is commonly modified inthe <EMCLASS="emphasis">sendmail.cf</EM> file.<ACLASS="indexterm"NAME="AUTOID-13771"></A></P></DIV><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="TCP2-CH-10-SECT-5.4">10.5.4 The Set Option Command </A></H3><PCLASS="para"><ACLASS="indexterm"NAME="TCP2-CH-10-IX-SENDMAIL-CF-FILE-SET-OPTION-COMMAND-O"></A>The set option commands (<BCLASS="emphasis.bold">O</B>) command is used to define thesendmail environment. Use the <BCLASS="emphasis.bold">O</B> command to set valuesappropriate for your installation. The value assigned to an option isa string, an integer, a Boolean, or a time interval, as appropriatefor the individual option. All options define values used directlyby sendmail.</P><PCLASS="para">There are no user-created options. The meaning of each sendmailoption is defined within sendmail itself. <ACLASS="xref"HREF="appe_01.htm"TITLE="A sendmail Reference">Appendix E</A> lists themeaning and use of each option, and there are plenty of them.</P><PCLASS="para">A few sample options from the <EMCLASS="emphasis">linux.smtp.cf</EM> file are shown below.The <BCLASS="emphasis.bold">AliasFile</B> option<ACLASS="indexterm"NAME="AUTOID-13785"></A>defines the name of the sendmail <EMCLASS="emphasis">aliases</EM>file as <EMCLASS="emphasis">/etc/aliases</EM>. If you want to put the <EMCLASS="emphasis">aliases</EM> fileelsewhere, change this option. The <BCLASS="emphasis.bold">TempFileMode</B> option<ACLASS="indexterm"NAME="AUTOID-13791"></A>defines thedefault file mode as 0600 for temporary files created by sendmail<ACLASS="indexterm"NAME="AUTOID-13793"></A><ACLASS="indexterm"NAME="AUTOID-13795"></A>in <EMCLASS="emphasis">/var/spool/mqueue</EM>. The <BCLASS="emphasis.bold">Timeout.queuereturn</B> option<ACLASS="indexterm"NAME="AUTOID-13799"></A>sets thetimeout interval for undeliverable mail, here set to five days (5d).These options show the kind of general configuration parameters set bythe <BCLASS="emphasis.bold">option</B> command.</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen"># location of alias fileO AliasFile=/etc/aliases# temporary file modeO TempFileMode=0600# default timeout intervalO Timeout.queuereturn=5d</PRE></BLOCKQUOTE></P><PCLASS="para">The syntax of the option command shown in this example and in <ACLASS="xref"HREF="ch10_05.htm#TCP2-CH-10-TAB-0"TITLE="sendmail Configuration Commands">Table 10.1</A>was introduced in sendmail version 8.7.5. Prior to that theoption command used a syntax more like the other sendmailcommands.  The old syntax is: <BCLASS="emphasis.bold">O</B><EMCLASS="emphasis">ovalue</EM>, where <BCLASS="emphasis.bold">O</B> is thecommand, <EMCLASS="emphasis">o</EM> is the single character option name, and <EMCLASS="emphasis">value</EM>is the value assigned to the option. The options shown in the previousdiscussion, if written in the old syntax, would be:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen"># location of alias fileOA/etc/aliases# temporary file modeOF0600# default timeout intervalOT5d</PRE></BLOCKQUOTE></P><PCLASS="para"><ACLASS="xref"HREF="appe_01.htm"TITLE="A sendmail Reference">Appendix E</A> contains a full listing of the old options as well as the newoptions.</P><PCLASS="para">Most of the options defined in a sample file don't require modification.People change options settings because they want to change thesendmail environment, not because they have to. The options inyour configuration file are almost certainly correct for your system.<ACLASS="indexterm"NAME="AUTOID-13816"></A></P></DIV><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="TCP2-CH-10-SECT-5.5">10.5.5 Defining Trusted Users </A></H3><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-13820"></A>The <BCLASS="emphasis.bold">T</B> command defines a list of users who are trusted to overridethe sender address using the mailer <BCLASS="emphasis.bold">-f</B> flag.[14]Normally the trusted users are defined as <EMCLASS="emphasis">root</EM>, <EMCLASS="emphasis">uucp</EM>, and<EMCLASS="emphasis">daemon</EM>. Trusted users can be specified as a list of usernameson a single command line, or on multiple command lines. The users mustbe valid usernames from the <EMCLASS="emphasis">/etc/passwd</EM> file.&#13;</P><BLOCKQUOTECLASS="footnote"><PCLASS="para">[14] Mailer flags are listed in <ACLASS="xref"HREF="appe_01.htm"TITLE="A sendmail Reference">Appendix E</A>.</P></BLOCKQUOTE><PCLASS="para">The most commonly defined trusted users are:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">TrootTdaemonTuucp</PRE></BLOCKQUOTE></P><PCLASS="para">Most sites do not need to modify this list.</P></DIV><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="TCP2-CH-10-SECT-5.6">10.5.6 Defining Mail Precedence </A></H3><PCLASS="para"><ACLASS="indexterm"NAME="TCP2-CH-10-IX-SENDMAIL-CF-FILE-DEFINE-MAIL-PRECEDENCE-COMMAND-P"></A><ACLASS="indexterm"NAME="AUTOID-13842"></A>Precedence is one of the factors used by sendmail to assign<ACLASS="indexterm"NAME="AUTOID-13844"></A><ACLASS="indexterm"NAME="AUTOID-13846"></A>priority to messages entering its queue. The <BCLASS="emphasis.bold">P</B> command definesthe message precedence values available to sendmail users. Thehigher the precedence number, the greater the precedence of themessage. The default precedence of a message is 0. Negativeprecedence numbers indicate especially low-priority mail.Error messages are not generated formail with a negative precedence number, making low priorities attractive for mass mailings.Some commonly used precedence values are:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">Pfirst-class=0Pspecial-delivery=100Plist=-30Pbulk=-60Pjunk=-100</PRE></BLOCKQUOTE></P><PCLASS="para">To specify the precedence he desires, a user adds a Precedenceheader to his message. He uses the text name from the <BCLASS="emphasis.bold">P</B>command in the Precedence header to set the specificprecedence of the message. Given the precedence definitionsshown above, a user who wanted to avoid receiving error messages for alarge mailing could select a message precedence of -60 by including thefollowing header line in his mail:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">Precedence: bulk</PRE></BLOCKQUOTE></P><PCLASS="para">The five precedence values shown above are probably more than you'llever need.<ACLASS="indexterm"NAME="AUTOID-13857"></A></P></DIV><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="TCP2-CH-10-SECT-5.7">10.5.7 Defining Mail Headers </A></H3><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-13861"></A>The <BCLASS="emphasis.bold">H</B> command defines the format of header lines that sendmailinserts into messages. The  format of the header command is the <BCLASS="emphasis.bold">H</B>command, optional header flags enclosed in question marks, a header name,a colon, and a header template. The header template is a combination ofliterals and macros that are included in the header line. Macros in theheader template are expanded before the header is inserted in a message.The same conditional syntax used in macro definitions can be used inheader templates, and it functions in exactly the same way: it allowsyou to test whether a macro is set and to use another value if it is not set.</P><PCLASS="para">The header flags often arouse morequestions than they merit. The function of the flags is very simple.The header flags control whether or not the header is inserted intomail bound for a specific mailer. If no flags are specified, theheader is used for all mailers. If a flag is specified, the header isused only for a mailer that has the same flag set in the mailer'sdefinition. (Mailer flags are listed in <ACLASS="xref"HREF="appe_01.htm"TITLE="A sendmail Reference">Appendix E</A>.) Header flagsonly control header <EMCLASS="emphasis">insertion</EM>. If a header is received in theinput, it is passed to the output, regardless of the flag settings.</P><PCLASS="para">Some sample header definitions from the <EMCLASS="emphasis">linux.smtp.cf</EM> sample file are:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">H?P?Return-Path: $gH?D?Date: $aH?F?From: $?x$x &lt;$g&gt;$|$g$.H?x?Full-Name: $xHSubject:H?M?Message-Id: &lt;$t.$i@$j&gt;</PRE></BLOCKQUOTE></P><PCLASS="para">The headers provided in your system's <EMCLASS="emphasis">sendmail.cf</EM> are sufficientfor most installations. It's unlikely you'll ever need to change them.</P></DIV><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="TCP2-CH-10-SECT-5.8">10.5.8 Defining Mailers </A></H3><PCLASS="para"><ACLASS="indexterm"NAME="TCP2-CH-10-IX-SENDMAIL-CF-FILE-DEFINE-MAILERS-COMMAND-M"></A>The <BCLASS="emphasis.bold">M</B> commands define the mail delivery programs used bysendmail. The syntax of the command is:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen"><BCLASS="emphasis.bold">M</B><CODECLASS="replaceable"><I>name</I></CODE>, {<CODECLASS="replaceable"><I>field=value</I></CODE>}</PRE></BLOCKQUOTE></P><PCLASS="para"><CODECLASS="replaceable"><I>name</I></CODE> is an arbitrary name used internally by sendmailto refer to this mailer. The name doesn't matter as long as it is usedconsistently within the <EMCLASS="emphasis">sendmail.cf</EM> file to refer to thismailer. For example, the mailer used to deliver SMTP mail within thelocal domain might be called <EMCLASS="emphasis">smtp</EM> on one system, and it might becalled <EMCLASS="emphasis">ether</EM> on another system. The function of both mailers isthe same, only the names are different.</P><PCLASS="para">There are a few exceptions to this freedom of choice. The mailer thatdelivers local mail to users on the same machine must be called<ACLASS="indexterm"NAME="AUTOID-13893"></A><EMCLASS="emphasis">local</EM>, and a mailer named <EMCLASS="emphasis">local</EM> must be defined in the<EMCLASS="emphasis">sendmail.cf</EM> file. Three other special mailer names are:</P><DLCLASS="variablelist"><DTCLASS="term"><EMCLASS="emphasis">prog</EM></DT><DDCLASS="listitem"><PCLASS="para">Delivers mail to programs.</P></DD><DTCLASS="term"><EMCLASS="emphasis">*file*</EM></DT><DDCLASS="listitem"><PCLASS="para">Sends mail to files.</P></DD><DTCLASS="term"><EMCLASS="emphasis">*include*</EM></DT><DDCLASS="listitem"><PCLASS="para">Directs mail to <CODECLASS="literal">:include:</CODE> lists.</P></DD></DL><PCLASS="para">Of these, only the <EMCLASS="emphasis">prog</EM> mailer must be defined in the<EMCLASS="emphasis">sendmail.cf</EM> file. The other two are defined internally bysendmail.</P><PCLASS="para">The mailer name is followed by a comma-separated list of<EMCLASS="emphasis">field=value</EM> pairs that define the characteristics of the mailer.<ACLASS="xref"HREF="ch10_05.htm#TCP2-CH-10-TAB-2"TITLE="Mailer Definition Fields">Table 10.3</A>shows the single character <EMCLASS="emphasis">field</EM> identifiers and thecontents of the <EMCLASS="emphasis">value</EM> field associated with each of them.Most mailers don't require all of these fields.<ACLASS="indexterm"NAME="AUTOID-13924"></A></P><TABLECLASS="table"><CAPTIONCLASS="table"><ACLASS="title"NAME="TCP2-CH-10-TAB-2">Table 10.3: Mailer Definition Fields</A></CAPTION><THEADCLASS="thead"><TRCLASS="row"VALIGN="TOP"><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Field</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Meaning</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Contents</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Example</TH></TR></THEAD><TBODYCLASS="tbody"><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">P</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Path</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Path of the mailer</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">P=/bin/mail</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">F</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Flags</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">sendmail flags for this mailer</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">F=lsDFMe</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">S</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Sender</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Rulesets for sender addresses</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">S=10</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">R</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Recipient</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Rulesets for recipient addresses</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">R=20</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">A</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Argv</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">The mailer's argument vector</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">A=sh -c $u</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">E</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Eol</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">End-of-line string for the mailer</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">E=\r\n</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">M</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Maxsize</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Maximum message length</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">M=100000</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">L</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Linelimit</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Maximum line length</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">L=990</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">D</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Directory</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><EMCLASS="emphasis">prog</EM> mailer's execution directory</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">D=$z:/</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">U</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Userid</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">User and group ID used to run mailer</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">U=uucp:wheel</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">N</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Nice</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><BCLASS="emphasis.bold">nice</B> value used to run mailer</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">N=10</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">C</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Charset</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Content-type for 8-bit MIME characters</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">C=iso8859-1</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">T</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Type</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Type information for MIME errors</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">T=dns/rfc822/smtp</TD></TR></TBODY></TABLE><PCLASS="para">The Path (P) fields contain either the path to the mail delivery programor the literal string [IPC].  Mailer definitions that specify P=[IPC]use sendmail to deliver mail via SMTP.[15]The path to a mail delivery program varies from system to system depending on where the systems store the programs. Make sure you know where the programs are stored before you modify the Path field. Ifyou use a sample configuration from another computer, such as thesamples we use in this chapter, make sure that the mailer paths arevalid for your system.</P><BLOCKQUOTECLASS="footnote"><PCLASS="para">[15] Sun systems use [TCP] as well as [IPC].</P></BLOCKQUOTE><PCLASS="para">The Flags (F) field contains the sendmail flags used for thismailer. These are the mailer flags referenced earlier in this chapterunder &quot;Defining Mail Headers,&quot; but mailer flags do more thanjust control header insertion. There are a large number offlags. <ACLASS="xref"HREF="appe_01.htm"TITLE="A sendmail Reference">Appendix E</A> describes all of them and their functions.</P><PCLASS="para">The Sender (S) and the Recipient (R) fields identify the rulesets usedto rewrite the sender and recipient addresses for this mailer. Eachruleset is identified by its number. We'll have more to say aboutrulesets later in this chapter, and we will refer to the S and R valueswhen troubleshooting the sendmail configuration.</P><PCLASS="para">The Argv (A) field defines the argument vector passed to the mailer.It contains, among other things, macro expansions that provide therecipient username (which is<BCLASS="emphasis.bold">$u</B>),[16]the recipient hostname (<BCLASS="emphasis.bold">$h</B>), and the sender's from address (<BCLASS="emphasis.bold">$f</B>). These macros are expanded before theargument vector is passed to the mailer.</P><BLOCKQUOTECLASS="footnote"><PCLASS="para">[16] In the <EMCLASS="emphasis">prog</EM> mailer definition, <BCLASS="emphasis.bold">$u</B> actually passes a program namein the argument vector.</P></BLOCKQUOTE><PCLASS="para">The End-of-line (E) field defines the characters used to mark the endof a line. A carriage return and a line feed (CRLF) is the default forSMTP mailers.</P><PCLASS="para">Maxsize (M) defines, in bytes, the longest messagethat this mailer will handle. This field is used most frequently indefinitions of UUCP mailers.<ACLASS="indexterm"NAME="AUTOID-14020"></A></P><PCLASS="para">Linelimit (L) defines, in bytes, the maximum length of a line that canbe contained in a message handled by this mailer. This mailer fieldwas introduced in sendmail V8. Previous versions of sendmaillimited lines to 80 characters because this was the limit for SMTP mailbefore MIME mail was introduced.</P><PCLASS="para">The Directory (D) field specifies the working directory for the<EMCLASS="emphasis">prog</EM> mailer. More than one directory can be specified forthe directory field by separating the directory paths with colons.The example in <ACLASS="xref"HREF="ch10_05.htm#TCP2-CH-10-TAB-2"TITLE="Mailer Definition Fields">Table 10.3</A>tells <EMCLASS="emphasis">prog</EM> to use the recipient's homedirectory, which is the value returned by the internal macro <BCLASS="emphasis.bold">$z</B>. If thatdirectory is not available, it should use the root (/) directory.</P><PCLASS="para">Specify the default user and the group ID used to execute the mailer withthe Userid (U) field. The example <BCLASS="emphasis.bold">U=uucp:wheel</B> says that the mailershould be run under the user ID <EMCLASS="emphasis">uucp</EM> and the group ID <EMCLASS="emphasis">wheel</EM>.If no value is specified for the Userid field, the value defined by the<BCLASS="emphasis.bold">DefaultUser</B> option is used.</P><PCLASS="para">Use Nice (N) to change the <BCLASS="emphasis.bold">nice</B> value for the execution of themailer. This allows you to change the scheduling priority of the mailer.This is rarely used. If you're interested, see the <BCLASS="emphasis.bold">nice</B> manpagefor appropriate values.</P><PCLASS="para">The last two fields are used only for MIME mail.<ACLASS="indexterm"NAME="AUTOID-14037"></A>Charset (C) definesthe character set used in the Content-type header when an 8-bit messageis converted to MIME. If Charset is not defined, the value defined inthe <BCLASS="emphasis.bold">DefaultCharset</B> option is used. If that option is not defined,<EMCLASS="emphasis">unknown-8bit</EM> is used as the default value.</P><PCLASS="para">The Type (T) field defines the type information used in MIME errormessages. MIME-type information defines the mailer transfer agenttype, the mail address type, and the error code type. The default is<EMCLASS="emphasis">dns/rfc822/smtp</EM>.</P><DIVCLASS="sect3"><H4CLASS="sect3"><ACLASS="title"NAME="TCP2-CH-10-SECT-5.8.1">10.5.8.1 Some common mailer definitions </A></H4><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-14047"></A>The following mailer definitions are from <EMCLASS="emphasis">linux.smtp.cf</EM>:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">Mlocal,	P=/usr/bin/procmail, F=lsDFMAw5:/|@ShP, S=10/30, R=20/40,	T=DNS/RFC822/X-Unix, A=procmail -a $h -d $uMprog,	P=/bin/sh, F=lsDFMoeu, S=10/30, R=20/40, D=$z:/,	T=X-Unix, A=sh -c $uMsmtp,	P=[IPC], F=mDFMuX, S=11/31, R=21, E=\r\n, L=990,	T=DNS/RFC822/SMTP, A=IPC $hMesmtp,	P=[IPC], F=mDFMuXa, S=11/31, R=21, E=\r\n, L=990,	T=DNS/RFC822/SMTP, A=IPC $hMsmtp8,	P=[IPC], F=mDFMuX8, S=11/31, R=21, E=\r\n, L=990,	T=DNS/RFC822/SMTP, A=IPC $hMrelay,	P=[IPC], F=mDFMuXa8, S=11/31, R=61, E=\r\n, L=2040,	T=DNS/RFC822/SMTP, A=IPC $h</PRE></BLOCKQUOTE></P><PCLASS="para">This example contains the following mailer definitions:</P><ULCLASS="itemizedlist"><LICLASS="listitem"><PCLASS="para">A definition for local mail delivery, always called <EMCLASS="emphasis">local</EM>.This definition is required by sendmail.</P></LI><LICLASS="listitem"><PCLASS="para">A definition for delivering mail to programs, always called <EMCLASS="emphasis">prog</EM>.This definition is found in most configurations.</P></LI><LICLASS="listitem"><PCLASS="para">A definition for TCP/IP mail delivery, here called<EMCLASS="emphasis">smtp</EM>.</P></LI><LICLASS="listitem"><PCLASS="para">A definition for an Extended SMTP mailer, here called <EMCLASS="emphasis">esmtp</EM>.</P></LI><LICLASS="listitem"><PCLASS="para">A definition for an SMTP mailer that handles unencoded 8-bit data,here called <EMCLASS="emphasis">smtp8</EM>.</P></LI><LICLASS="listitem"><PCLASS="para">A definition for a mailer that relays TCP/IP mail through an externalmail relay host, here called <EMCLASS="emphasis">relay</EM>.</P></LI></UL><PCLASS="para">A close examination of the fields in one of these mailer entries, forexample the entry for the <EMCLASS="emphasis">smtp</EM> mailer, shows the following:</P><DLCLASS="variablelist"><DTCLASS="term"><EMCLASS="emphasis">Msmtp</EM></DT><DDCLASS="listitem"><PCLASS="para">A mailer, arbitrarily named <EMCLASS="emphasis">smtp</EM>, is being defined.</P></DD><DTCLASS="term"><EMCLASS="emphasis">P=[IPC]</EM></DT><DDCLASS="listitem"><PCLASS="para">The path to the program used for this mailer is [IPC], which means deliverof this mail is handled internally by sendmail.</P></DD><DTCLASS="term"><EMCLASS="emphasis">F=mDFMuX</EM></DT><DDCLASS="listitem"><PCLASS="para">The sendmail flags for this mailer say that this mailer can sendto multiple recipients at once; that Date, From, and Message-Id headersare needed; that uppercase should be preserved in hostnames and usernames; and that lines beginning with a dot have an extra dot prepended.Refer to <ACLASS="xref"HREF="appe_01.htm"TITLE="A sendmail Reference">Appendix E</A> for more details.</P></DD><DTCLASS="term"><EMCLASS="emphasis">S=11/31</EM></DT><DDCLASS="listitem"><PCLASS="para">The sender address in the mail &quot;envelope&quot; is processed through ruleset11 and the sender address in the message is processed through ruleset 31.More on this later.</P></DD><DTCLASS="term"><EMCLASS="emphasis">R=21</EM></DT><DDCLASS="listitem"><PCLASS="para">All recipient addresses are processed through ruleset 21.</P></DD><DTCLASS="term"><EMCLASS="emphasis">E=\r\n</EM></DT><DDCLASS="listitem"><PCLASS="para">Lines are terminated with a carriage return and a line feed. </P></DD><DTCLASS="term"><EMCLASS="emphasis">L=990</EM></DT><DDCLASS="listitem"><PCLASS="para">This mailer will handle lines up to 990 bytes long.</P></DD><DTCLASS="term"><EMCLASS="emphasis">T=DNS/RFC822/SMTP</EM></DT><DDCLASS="listitem"><PCLASS="para">The MIME-type information for this mailer says that DNS is used forhostnames, RFC 822 email addresses are used, and SMTP error codesare used.</P></DD><DTCLASS="term"><EMCLASS="emphasis">A=IPC $h</EM></DT><DDCLASS="listitem"><PCLASS="para">The meaning of each option in an argument vector is exactly as definedon the manpage for the command; see the <EMCLASS="emphasis">local</EM> mailer asan example. In the case of the <EMCLASS="emphasis">smtp</EM> mailer, however, the argumentrefers to an internal <EMCLASS="emphasis">sendmail</EM> process. The macro <BCLASS="emphasis.bold">$h</B> is expandedto provide the recipient host (<BCLASS="emphasis.bold">$h</B>) address.</P></DD></DL><PCLASS="para">Despite this long discussion, don't worry about mailer definitions.The sample configuration file that comes with your operating systemcontains the correct mailer definitions to run sendmail in a TCP/IPnetwork environment. You shouldn't need to modify any mailer definitions.<ACLASS="indexterm"NAME="AUTOID-14130"></A><ACLASS="indexterm"NAME="AUTOID-14131"></A></P></DIV></DIV></DIV><DIVCLASS="htmlnav"><P></P><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch10_04.htm"TITLE="10.4 The sendmail.cf File "><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 10.4 The sendmail.cf File "BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="book"HREF="index.htm"TITLE="TCP/IP Network Administration"><IMGSRC="../gifs/txthome.gif"ALT="TCP/IP Network Administration"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch10_06.htm"TITLE="10.6 Rewriting the Mail Address "><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 10.6 Rewriting the Mail Address "BORDER="0"></A></TD></TR><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172">10.4 The sendmail.cf File </TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="index"HREF="index/idx_0.htm"TITLE="Book Index"><IMGSRC="../gifs/index.gif"ALT="Book Index"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172">10.6 Rewriting the Mail Address </TD></TR></TABLE><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><PCLASS="nav"><FONTSIZE="-1">[ <AHREF="../index.htm"TITLE="The Networking CD Bookshelf">Library Home</A> | <AHREF="../dnsbind/index.htm"TITLE="DNS &amp; BIND">DNS &amp; BIND</A> | <AHREF="index.htm"TITLE="TCP/IP Network Administration">TCP/IP</A> | <AHREF="../sendmail/index.htm"TITLE="sendmail">sendmail</A> | <AHREF="../smdref/index.htm"TITLE="sendmail Desktop Reference">sendmail Reference</A> | <AHREF="../firewall/index.htm"TITLE="Building Internet Firewalls">Firewalls</A> | <AHREF="../puis/index.htm"TITLE="Practical UNIX &amp; Internet Security">Practical Security</A> ]</FONT></P></DIV></BODY></HTML>