<HTML><HEAD><TITLE>[Chapter 11] Troubleshooting TCP/IP </TITLE><METANAME="DC.title"CONTENT="TCP/IP Network Administration"><METANAME="DC.creator"CONTENT="Craig Hunt"><METANAME="DC.publisher"CONTENT="O'Reilly &amp; Associates, Inc."><METANAME="DC.date"CONTENT="1999-02-04T01:40:11Z"><METANAME="DC.type"CONTENT="Text.Monograph"><METANAME="DC.format"CONTENT="text/html"SCHEME="MIME"><METANAME="DC.source"CONTENT="1-56592-322-7"SCHEME="ISBN"><METANAME="DC.language"CONTENT="en-US"><METANAME="generator"CONTENT="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><LINKREV="made"HREF="mailto:online-books@oreilly.com"TITLE="Online Books Comments"><LINKREL="up"HREF="index.htm"TITLE="TCP/IP Network Administration"><LINKREL="prev"HREF="ch10_09.htm"TITLE="10.9 Summary "><LINKREL="next"HREF="ch11_02.htm"TITLE="11.2 Diagnostic Tools "></HEAD><BODYBGCOLOR="#FFFFFF"TEXT="#000000"><DIVCLASS="htmlnav"><H1><IMGSRC="gifs/smbanner.gif"ALT="TCP/IP Network Administration"USEMAP="#srchmap"BORDER="0"></H1><MAPNAME="srchmap"><AREASHAPE="RECT"COORDS="0,0,466,65"HREF="index.htm"ALT="TCP/IP Network Administration"><AREASHAPE="RECT"COORDS="467,0,514,18"HREF="../search/tsrch.htm"ALT="Search this book"></MAP><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch10_09.htm"TITLE="10.9 Summary "><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 10.9 Summary "BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><B><FONTFACE="ARIEL,HELVETICA,HELV,SANSERIF"SIZE="-1">Chapter 11</FONT></B></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch11_02.htm"TITLE="11.2 Diagnostic Tools "><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 11.2 Diagnostic Tools "BORDER="0"></A></TD></TR></TABLE>&nbsp;<HRALIGN="LEFT"WIDTH="515"TITLE="footer"></DIV><DIVCLASS="CHAPTER"><H1CLASS="chapter"><ACLASS="title"NAME="TCP2-CH-11">11. Troubleshooting TCP/IP </A></H1><DIVCLASS="htmltoc"><P><B>Contents:</B><BR><ACLASS="SECT1"HREF="#TCP2-CH-11-SECT-1"TITLE="11.1 Approaching a Problem ">Approaching a Problem </A><BR><ACLASS="SECT1"HREF="ch11_02.htm"TITLE="11.2 Diagnostic Tools ">Diagnostic Tools </A><BR><ACLASS="SECT1"HREF="ch11_03.htm"TITLE="11.3 Testing Basic Connectivity ">Testing Basic Connectivity </A><BR><ACLASS="SECT1"HREF="ch11_04.htm"TITLE="11.4 Troubleshooting Network Access ">Troubleshooting Network Access </A><BR><ACLASS="SECT1"HREF="ch11_05.htm"TITLE="11.5 Checking Routing ">Checking Routing </A><BR><ACLASS="SECT1"HREF="ch11_06.htm"TITLE="11.6 Checking Name Service ">Checking Name Service </A><BR><ACLASS="SECT1"HREF="ch11_07.htm"TITLE="11.7 Analyzing Protocol Problems ">Analyzing Protocol Problems </A><BR><ACLASS="SECT1"HREF="ch11_08.htm"TITLE="11.8 Protocol Case Study ">Protocol Case Study </A><BR><ACLASS="SECT1"HREF="ch11_09.htm"TITLE="11.9 Simple Network Management Protocol ">Simple Network Management Protocol </A><BR><ACLASS="SECT1"HREF="ch11_10.htm"TITLE="11.10 Summary ">Summary </A></P><P></P></DIV><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-15183"></A>Network administration tasks fall into two very different categories:configuration and troubleshooting. Configuration tasks prepare for theexpected; they require detailed knowledge of command syntax,but are usually simple and predictable. Once a system is properlyconfigured, there is rarely any reason to change it. The configurationprocess is repeated each time a new operating system release isinstalled, but with very few changes.</P><PCLASS="para">In contrast, network troubleshooting deals with the unexpected.<ACLASS="indexterm"NAME="AUTOID-15188"></A>Troubleshooting frequently requires knowledge that is conceptual ratherthan detailed. Network problems are usually unique and sometimesdifficult to resolve. Troubleshooting is an important part ofmaintaining a stable, reliable network service.</P><PCLASS="para"><ACLASS="indexterm"NAME="TCP2-CH-11-IX-NETWORK-PROBLEMS-HOW-TO-APPROACH"></A>In this chapter, we discuss the tools you will use to ensure that thenetwork is in good running condition. However, good tools are notenough. No troubleshooting tool is effective if appliedhaphazardly. Effective troubleshooting requires a methodical approachto the problem, and a basic understanding of how the networkworks. We'll start our discussion by looking at ways to approach anetwork problem.</P><DIVCLASS="sect1"><H2CLASS="sect1"><ACLASS="title"NAME="TCP2-CH-11-SECT-1">11.1 Approaching a Problem </A></H2><PCLASS="para">To approach a problem properly, you need a basic understanding of<ACLASS="indexterm"NAME="AUTOID-15197"></A>TCP/IP. The first few chapters of this book discuss the basics ofTCP/IP and provide enough background information to troubleshoot mostnetwork problems. Knowledge of how TCP/IP routes data through thenetwork, between individual hosts, and between the layers in the<ACLASS="indexterm"NAME="AUTOID-15200"></A>protocol stack, is important for understanding a network problem. Butdetailed knowledge of each protocol usually isn't necessary. When you need these details, look them up in a definitive reference&nbsp;- don't try torecall them from memory.</P><PCLASS="para">Not all TCP/IP problems are alike, and not all problems can beapproached in the same manner. But the key to solving any problem isunderstanding what the problem is. This is not as easy as it mayseem. The &quot;surface&quot; problem is sometimes misleading, and the &quot;real&quot;problem is frequently obscured by many layers of software. Once you understand thetrue nature of the problem, the solution to the problemis often obvious.</P><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-15205"></A>First, gather detailed information about exactly what's happening.When a user reports a problem, talk to her. Find out whichapplication failed. What is the remote host's name and IP address?What is the user's hostname and address? What error message wasdisplayed? If possible, verify the problem by having the user run theapplication while you talk her through it. If possible, duplicate theproblem on your own system.</P><PCLASS="para">Testing from the user's system, and other systems, find out:</P><ULCLASS="itemizedlist"><LICLASS="listitem"><PCLASS="para">Does the problem occur in other applications on the user's host, or isonly one application having trouble? If only one application isinvolved, the application may be misconfigured or disabled on theremote host. Because of security concerns, many systems disable someservices.</P></LI><LICLASS="listitem"><PCLASS="para">Does the problem occur with only one remote host, all remote hosts, oronly certain &quot;groups&quot; of remote hosts? If only one remote host isinvolved, the problem could easily be with that host. If all remotehosts are involved, the problem is probably with the user's system(particularly if no other hosts on your local network are experiencingthe same problem). If only hosts on certain subnets or externalnetworks are involved, the problem may be related to routing.</P></LI><LICLASS="listitem"><PCLASS="para">Does the problem occur on other local systems? Make sure you checkother systems on the same subnet. If the problem only occurs on theuser's host, concentrate testing on that system. Ifthe problemaffects every system on a subnet, concentrate on the router for thatsubnet.</P></LI></UL><PCLASS="para">Once you know the symptoms of the problem, visualize each protocol anddevice that handles the data. Visualizing the problem will help youavoid oversimplification, and keep you from assuming that you know thecause even before you start testing. Using your TCP/IP knowledge,narrow your attack to the most likely causes of the problem, but keepan open mind.<ACLASS="indexterm"NAME="AUTOID-15217"></A></P><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="TCP2-CH-11-SECT-1.1">11.1.1 Troubleshooting Hints </A></H3><PCLASS="para"><ACLASS="indexterm"NAME="TCP2-CH-11-IX-TROUBLESHOOTING-HINTS"></A>Below we offer several useful troubleshooting hints. Theyare not part of a troubleshooting methodology&nbsp;- just good ideas to keep inmind.</P><ULCLASS="itemizedlist"><LICLASS="listitem"><PCLASS="para">Approach problems methodically. Allow the information gathered fromeach test to guide your testing. Don't jump on a hunch into another testscenario without ensuring that you can pick up youroriginal scenario where you left off.</P></LI><LICLASS="listitem"><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-15229"></A>Work carefully through the problem, dividing it into manageable pieces.Test each piece before moving on to the next. For example, whentesting a network connection, test each part of the network until youfind the problem.</P></LI><LICLASS="listitem"><PCLASS="para">Keep good records of the tests you have completed and their results.<ACLASS="indexterm"NAME="AUTOID-15233"></A>Keep a historical record of the problem in case it reappears.</P></LI><LICLASS="listitem"><PCLASS="para">Keep an open mind. Don't assume too much about the cause of the<ACLASS="indexterm"NAME="AUTOID-15238"></A>problem. Some people believe their networkis always at fault, while others assume the remote end is always theproblem. Some are so sure they know the cause of a problem thatthey ignore the evidence of the tests. Don't fall into these traps.Test each possibility and base your actions on the evidence of thetests.</P></LI><LICLASS="listitem"><PCLASS="para">Be aware of security barriers. Security firewalls sometimes block<ACLASS="indexterm"NAME="AUTOID-15242"></A><BCLASS="emphasis.bold">ping</B>, <BCLASS="emphasis.bold">traceroute</B>, and even ICMP error messages. If problemsseem to cluster around a specific remote site, find out if they have afirewall.</P></LI><LICLASS="listitem"><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-15249"></A>Pay attention to error messages. Error messages are often vague, butthey frequently contain important hints for solving the problem.</P></LI><LICLASS="listitem"><PCLASS="para">Duplicate the reported problem yourself. Don't rely too heavily on theuser's problem report. The user has probably only seen this problemfrom the application level. If necessary, obtain the user's data filesto duplicate the problem. Even if you cannot duplicate the problem,log the details of the reported problem for your records.</P></LI><LICLASS="listitem"><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-15257"></A><ACLASS="indexterm"NAME="AUTOID-15259"></A>Most problems are caused by human error. You can prevent some of these errors<ACLASS="indexterm"NAME="AUTOID-15262"></A>by providing information and training on network configuration andusage.</P></LI><LICLASS="listitem"><PCLASS="para">Keep your users informed. This reduces the number of duplicatedtrouble reports, and the duplication of effort when several systemadministrators work on the same problem without knowing others arealready working on it. If you're lucky, someone may have seen theproblem before and have a helpful suggestion about how to resolve it.</P></LI><LICLASS="listitem"><PCLASS="para">Don't speculate about the cause of the problem while talking to theuser. Save your speculations for discussions with your networkingcolleagues. Your speculations may be accepted by the user as gospel,and become rumors. These rumors can cause users to avoid usinglegitimate network services and may undermine confidence in your<ACLASS="indexterm"NAME="AUTOID-15269"></A>network. Users want solutions to their problems; they're notinterested in speculative techno-babble.</P></LI><LICLASS="listitem"><PCLASS="para">Stick to a few simple troubleshooting tools. For most TCP/IP softwareproblems, the tools discussed in this chapter are sufficient. Just learning how to use a new tool is often more time-consuming than solving the problem with an old familiar tool.</P></LI><LICLASS="listitem"><PCLASS="para">Thoroughly test the problem at your end of the network before locatingthe owner of the remote system to coordinate testing with him. Thegreatest difficulty of network troubleshooting is that you do notalways control the systems at both ends of the network. In many cases,<ACLASS="indexterm"NAME="AUTOID-15275"></A>you may not even know who does control the remote system.[1]The more information you have about your end, the simpler the job will be whenyou have to contact the remote administrator.</P><BLOCKQUOTECLASS="footnote"><PCLASS="para">[1] <ACLASS="xref"HREF="ch13_01.htm"TITLE="Internet Information Resources ">Chapter 13, <CITECLASS="chapter">Internet Information Resources </CITE></A> explains how to find out who is responsible for a remotenetwork</P></BLOCKQUOTE></LI><LICLASS="listitem"><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-15284"></A>Don't neglect the obvious. A loose or damaged cable is always apossible problem. Check plugs, connectors, cables, and switches.Small things can cause big problems.<ACLASS="indexterm"NAME="AUTOID-15287"></A></P></LI></UL></DIV></DIV></DIV><DIVCLASS="htmlnav"><P></P><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch10_09.htm"TITLE="10.9 Summary "><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 10.9 Summary "BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="book"HREF="index.htm"TITLE="TCP/IP Network Administration"><IMGSRC="../gifs/txthome.gif"ALT="TCP/IP Network Administration"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch11_02.htm"TITLE="11.2 Diagnostic Tools "><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 11.2 Diagnostic Tools "BORDER="0"></A></TD></TR><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172">10.9 Summary </TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="index"HREF="index/idx_0.htm"TITLE="Book Index"><IMGSRC="../gifs/index.gif"ALT="Book Index"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172">11.2 Diagnostic Tools </TD></TR></TABLE><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><PCLASS="nav"><FONTSIZE="-1">[ <AHREF="../index.htm"TITLE="The Networking CD Bookshelf">Library Home</A> | <AHREF="../dnsbind/index.htm"TITLE="DNS &amp; BIND">DNS &amp; BIND</A> | <AHREF="index.htm"TITLE="TCP/IP Network Administration">TCP/IP</A> | <AHREF="../sendmail/index.htm"TITLE="sendmail">sendmail</A> | <AHREF="../smdref/index.htm"TITLE="sendmail Desktop Reference">sendmail Reference</A> | <AHREF="../firewall/index.htm"TITLE="Building Internet Firewalls">Firewalls</A> | <AHREF="../puis/index.htm"TITLE="Practical UNIX &amp; Internet Security">Practical Security</A> ]</FONT></P></DIV></BODY></HTML>