<HTML><HEAD><TITLE>[Chapter 11] 11.9 Simple Network Management Protocol </TITLE><METANAME="DC.title"CONTENT="TCP/IP Network Administration"><METANAME="DC.creator"CONTENT="Craig Hunt"><METANAME="DC.publisher"CONTENT="O'Reilly &amp; Associates, Inc."><METANAME="DC.date"CONTENT="1999-02-04T01:41:27Z"><METANAME="DC.type"CONTENT="Text.Monograph"><METANAME="DC.format"CONTENT="text/html"SCHEME="MIME"><METANAME="DC.source"CONTENT="1-56592-322-7"SCHEME="ISBN"><METANAME="DC.language"CONTENT="en-US"><METANAME="generator"CONTENT="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><LINKREV="made"HREF="mailto:online-books@oreilly.com"TITLE="Online Books Comments"><LINKREL="up"HREF="ch11_01.htm"TITLE="11. Troubleshooting TCP/IP "><LINKREL="prev"HREF="ch11_08.htm"TITLE="11.8 Protocol Case Study "><LINKREL="next"HREF="ch11_10.htm"TITLE="11.10 Summary "></HEAD><BODYBGCOLOR="#FFFFFF"TEXT="#000000"><DIVCLASS="htmlnav"><H1><IMGSRC="gifs/smbanner.gif"ALT="TCP/IP Network Administration"USEMAP="#srchmap"BORDER="0"></H1><MAPNAME="srchmap"><AREASHAPE="RECT"COORDS="0,0,466,65"HREF="index.htm"ALT="TCP/IP Network Administration"><AREASHAPE="RECT"COORDS="467,0,514,18"HREF="../search/tsrch.htm"ALT="Search this book"></MAP><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch11_08.htm"TITLE="11.8 Protocol Case Study "><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 11.8 Protocol Case Study "BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><B><FONTFACE="ARIEL,HELVETICA,HELV,SANSERIF"SIZE="-1">Chapter 11<BR>Troubleshooting TCP/IP </FONT></B></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch11_10.htm"TITLE="11.10 Summary "><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 11.10 Summary "BORDER="0"></A></TD></TR></TABLE>&nbsp;<HRALIGN="LEFT"WIDTH="515"TITLE="footer"></DIV><DIVCLASS="SECT1"><H2CLASS="sect1"><ACLASS="title"NAME="TCP2-CH-11-SECT-9">11.9 Simple Network Management Protocol </A></H2><PCLASS="para"><ACLASS="indexterm"NAME="TCP2-CH-11-IX-SIMPLE-NETWORK-MANAGEMENT-PROTOCOL-SNMP"></A>Troubleshooting is necessary to recover from problems, but the ultimate<ACLASS="indexterm"NAME="AUTOID-16624"></A><ACLASS="indexterm"NAME="AUTOID-16628"></A>goal of the network administrator is to avoid problems. That is alsothe goal of network management software. The network managementsoftware used on TCP/IP networks is based on the <EMCLASS="emphasis">Simple NetworkManagement Protocol</EM> (SNMP).</P><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-16633"></A><ACLASS="indexterm"NAME="AUTOID-16636"></A>SNMP is a client/server protocol. In SNMP terminology, it is describedas a <EMCLASS="emphasis">manager/agent protocol</EM>. The <EMCLASS="emphasis">agent</EM> (the server) runs onthe device being managed, which is called the <EMCLASS="emphasis">Managed NetworkEntity</EM>. The agent monitors the status of the device and reports thatstatus to the manager.</P><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-16643"></A><ACLASS="indexterm"NAME="AUTOID-16645"></A>The <EMCLASS="emphasis">manager</EM> (the client) runs on the <EMCLASS="emphasis">Network ManagementStation</EM> (NMS). The NMS collects information from all of thedifferent devices that are being managed, consolidates it, and presentsit to the network administrator. This design places all of the datamanipulation tools and most of the human interaction on the NMS.Concentrating the bulk of the work on the manager means that the agentsoftware is small and easy to implement. Correspondingly, most TCP/IPnetwork equipment comes with an SNMP management agent.</P><PCLASS="para">SNMP is a request/response protocol. UDP port 161 is its well-knownport. SNMP uses UDP as its transport protocol because it has no needfor the overhead of TCP. &quot;Reliability&quot; is not required because eachrequest generates a response. If the SNMP application does not receivea response, it simply re-issues the request. &quot;Sequencing&quot; is notneeded because each request and each response travels as a singledatagram.</P><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-16651"></A><ACLASS="indexterm"NAME="AUTOID-16653"></A>The request and response messages that SNMP sends in the datagrams arecalled <EMCLASS="emphasis">Protocol Data Units</EM> (PDU). The five PDUs used by SNMP arelisted in <ACLASS="xref"HREF="ch11_09.htm#TCP2-CH-11-TAB-2"TITLE="SNMP Protocol Data Units">Table 11.3</A>These message types allow the manager to requestmanagement information, and when appropriate, to modify thatinformation. The messages also allow the agent to respond to managerrequests and to notify the manager of unusual situations.</P><TABLECLASS="table"><CAPTIONCLASS="table"><ACLASS="title"NAME="TCP2-CH-11-TAB-2">Table 11.3: SNMP Protocol Data Units</A></CAPTION><THEADCLASS="thead"><TRCLASS="row"VALIGN="TOP"><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">PDU</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Use</TH></TR></THEAD><TBODYCLASS="tbody"><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">GetRequest</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Manager requests an update.</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">GetNextRequest</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Manager requests the next entry in a table.</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">GetResponse</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Agent answers a manager request.</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">SetRequest</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Manager modifies data on the managed device.</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Trap</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Agent alerts manager of an unusual event.</TD></TR></TBODY></TABLE><PCLASS="para">The NMS periodically requests the status of each managed device(GetRequest) and each agent responds with the status of its device<ACLASS="indexterm"NAME="AUTOID-16681"></A>(GetResponse). Making periodic requests is called <EMCLASS="emphasis">polling</EM>.Polling reduces the burden on the agent because the NMS decides whenpolls are needed, and the agent simply responds. Pollingalso reduces the burden on the network because the polls originate froma single system at a predictable rate. The shortcoming of polling isthat it does not allow for real-time updates. If a problem occurs on amanaged device, the manager does not find out until the agent is polled. Tohandle this, SNMP uses a modified polling system called<EMCLASS="emphasis">trap-directed polling</EM>.<ACLASS="indexterm"NAME="AUTOID-16685"></A></P><PCLASS="para">A <EMCLASS="emphasis">trap</EM> is an interrupt signaled by a predefined event. When atrap event occurs, the SNMP agent does not wait for the manager to poll;instead it immediately sends information to the manager. Traps allowthe agent to inform the manager of unusual events while allowing themanager to maintain control of polling. SNMP traps are sent on UDPport 162.The manager sends polls on port 161 and listens for traps on port 162. <ACLASS="xref"HREF="ch11_09.htm#TCP2-CH-11-TAB-3"TITLE="Generic Traps Defined in the RFCs">Table 11.4</A>lists the trap events defined in the RFCs.</P><TABLECLASS="table"><CAPTIONCLASS="table"><ACLASS="title"NAME="TCP2-CH-11-TAB-3">Table 11.4: Generic Traps Defined in the RFCs</A></CAPTION><THEADCLASS="thead"><TRCLASS="row"VALIGN="TOP"><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Trap</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Meaning</TH></TR></THEAD><TBODYCLASS="tbody"><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">coldStart</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Agent restarted; possible configuration changes</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">warmStart</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Agent reinitialized without configuration changes</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">enterpriseSpecific</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">An event significant to this hardware or software</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">authenticationFailure</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Agent received an unauthenticated message</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">linkDown</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Agent detected a network link failure</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">linkUp</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Agent detected a network link coming up</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">egpNeighborLoss</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">The device's EGP neighbor is down</TD></TR></TBODY></TABLE><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-16721"></A>The last three entries in this table show the roots of SNMP in <EMCLASS="emphasis">SimpleGateway Management Protocol</EM> (SGMP), which was a toolfor tracking the status of network routers. Routers aregenerally the only devices that have multiple network links to keep trackof and are the only devices that run <EMCLASS="emphasis">Exterior Gateway Protocol</EM> (EGP).<ACLASS="indexterm"NAME="AUTOID-16725"></A>[12]These traps are not significant for most systems.</P><BLOCKQUOTECLASS="footnote"><PCLASS="para">[12] EGP is covered in <ACLASS="xref"HREF="ch07_01.htm"TITLE="Configuring Routing ">Chapter 7</A>.</P></BLOCKQUOTE><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-16731"></A>The most important trap may be the <BCLASS="emphasis.bold">enterpriseSpecific</B> trap. Theevents that signal this trap are defined differently by every vendor'sSNMP agent software. Therefore it is possible for the trap to be tunedto events that are significant for that system. SNMP uses the term&quot;enterprise&quot; to refer to something that is privately defined by avendor or organization as opposed to something that is globally definedby an RFC.</P><PCLASS="para">SNMP has twice as much jargon as the rest of networking&nbsp;- and that'ssaying something! Managed Network Entity, NMS, PDU, trap, polling,enterprise&nbsp;- that's just the beginning! We also need to mention (below)what SMI is, what a MIB is, and what ANS.1 is used for. Why thisbewildering array of acronyms and buzzwords? I think there are twomain reasons:</P><ULCLASS="itemizedlist"><LICLASS="listitem"><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-16738"></A>Network management covers a wide range of different devices, fromrepeaters to mainframe computers. A &quot;vendor-neutral&quot; language isneeded to define terms for the manufacturers of all of this differentequipment.</P></LI><LICLASS="listitem"><PCLASS="para">SNMP is based on the <EMCLASS="emphasis">Common Management Information Protocol</EM>(CMIP) that was created by the <EMCLASS="emphasis">International Standards<ACLASS="indexterm"NAME="AUTOID-16744"></A>Organization</EM> (ISO). Formal international standards always spend alot of time defining terms because it is important to make terms clearwhen they are used by people from many different cultures who speakmany different languages.</P></LI></UL><PCLASS="para">Now that you know why you have to suffer through all of this jargon, let'sdefine a few more important terms.</P><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-16748"></A><ACLASS="indexterm"NAME="AUTOID-16750"></A>The <EMCLASS="emphasis">Structure of Management Information</EM> (SMI) defines how datashould be presented in an SNMP environment. The SMI is documented inRFC 1155 and RFC 1065, <EMCLASS="emphasis">Structure and Identification of Management Information forTCP/IP-based Internets</EM>. The SMI defines how managed objects arenamed, the syntax in which they are defined, and how they are encodedfor transmission over the network. The SMI is based onprevious ISO work.</P><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-16755"></A>Each managed object is given a globally unique name called an <EMCLASS="emphasis">objectidentifier</EM>. The object identifier is part of a hierarchical name spacethat is managed by the ISO. The hierarchical name structure is used,just like it is in DNS, to guarantee that each name is globally unique.In an object identifier, each level of the hierarchy is identified bya number.</P><PCLASS="para">Objects are defined just as formally as they are named. The syntax used<ACLASS="indexterm"NAME="AUTOID-16759"></A>to define managed objects is <EMCLASS="emphasis">Abstract Syntax Notation One</EM><EMCLASS="emphasis"> (ASN.1)</EM>.ASN.1 is ISO Standard 8824, <EMCLASS="emphasis">Specification of Abstract Syntax NotationOne (ASN.1)</EM>. It is a very formal set of language rules for defining data. It makes the data definition independent of incompatibilitiesbetween systems and character sets. ASN.1 also includes a set of rulesfor encoding data for transfer over a network. These rules are definedin ISO Standard 8825, <EMCLASS="emphasis">Specification of Basic Encoding Rules for Abstract<ACLASS="indexterm"NAME="AUTOID-16765"></A>Syntax Notation One (ASN.1)</EM>. The <EMCLASS="emphasis">Basic Encoding Rules</EM> (BER) definethat bit 8 of an octet is sent first, that 2's complement is used for signedintegers, and other nitty-gritty details of data transmission.</P><PCLASS="para">Every object managed by SNMP has a unique object identifierdefined by the ASN.1 syntax and encoding defined by BER. When all of theseunique objects are grouped together, they are called the <EMCLASS="emphasis">Management<ACLASS="indexterm"NAME="AUTOID-16770"></A><ACLASS="indexterm"NAME="AUTOID-16772"></A>Information Base</EM> (MIB). The MIB refers to all information thatis managed by SNMP. However, we usually refer to &quot;a MIB&quot; or &quot;the MIBs&quot; (plural), meaning theindividual databases of management information formally defined by anRFC or privately defined by a vendor.</P><PCLASS="para">MIBI and MIBII are standards defined by RFCs. MIBII is a superset ofMIBI, and is the standard MIB for monitoring TCP/IP. It provides suchinformation as the number of packets transmitted into and out of aninterface, and the number of errors that occurred sending and receivingthose packets&nbsp;- useful information for spotting usage trends andpotential trouble spots. Every agent supports MIBI or MIBII.<ACLASS="indexterm"NAME="AUTOID-16775"></A></P><PCLASS="para">Some systems also provide a private MIB in addition to the standardMIBII. Private MIBs add to the monitoring capability by providingsystem-specific information. Most UNIX systems do not provide privateMIBs. Private MIBs are most common on network hardware like routers,hubs, and switches.</P><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-16779"></A>No matter what MIBs are provided by the agents, it is the monitoringsoftware that displays the information for the system administrator. Aprivate MIB won't do you any good unless your network monitoringsoftware also supports that MIB. For this reason, most administratorsprefer to purchase a monitor from the vendor that supplies the bulk oftheir network equipment. Another possibility is to select a monitorthat includes a <EMCLASS="emphasis">MIB compiler</EM>, which gives you the most flexibility.A MIB compiler reads in the ASN.1 description of a MIB and adds the MIB<ACLASS="indexterm"NAME="AUTOID-16782"></A>to the monitor. A MIB compiler makes the monitor <EMCLASS="emphasis">extensible</EM>because if you can get the ASN.1 source from the network equipmentvendor, you can add the vendor's private MIB to your monitor.</P><PCLASS="para">MIB compilers are only part of the advanced features offered by somemonitors. Some of the features offered are:</P><DLCLASS="variablelist"><DTCLASS="term"><EMCLASS="emphasis">Network maps</EM></DT><DDCLASS="listitem"><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-16793"></A>Some monitors automatically draw a map of the network.Colors are used to indicate the state (up, down, etc.) of the deviceson the network. At a glance, the network manager sees the overall stateof the network.</P></DD><DTCLASS="term"><EMCLASS="emphasis">Tabular data displays</EM></DT><DDCLASS="listitem"><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-16801"></A>Data displayed in tables or rendered intocharts is used to make comparisons between different devices. Somemonitors output data that can then be read into a standard spreadsheetor graphing program.</P></DD><DTCLASS="term"><EMCLASS="emphasis">Filters</EM></DT><DDCLASS="listitem"><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-16808"></A>Filters sift the data coming in from the agents in order todetect certain conditions.</P></DD><DTCLASS="term"><EMCLASS="emphasis">Alarms</EM></DT><DDCLASS="listitem"><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-16815"></A><ACLASS="indexterm"NAME="AUTOID-16817"></A>Alarms indicate when &quot;thresholds&quot; are exceeded or specialevents occur. For example, you may want an alarm to trigger when yourserver exceeds some specified number of transmit errors.</P></DD></DL><PCLASS="para">Don't be put off by the jargon. All of this detail is necessary toformally define a network management scheme that is independent of themanaged systems, but you don't need to memorize it. You need to knowthat a MIB is a collection of management information, that an NMS isthe network management station, and that an agent runs in each manageddevice in order to make intelligent decisions when selecting an SNMPmonitor. This information provides that necessary background. Thefeatures available in network monitors vary widely; so does the price.Select an SNMP monitor that is suitable for the complexity of yournetwork and the size of your budget.<ACLASS="indexterm"NAME="AUTOID-16820"></A></P></DIV><DIVCLASS="htmlnav"><P></P><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch11_08.htm"TITLE="11.8 Protocol Case Study "><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 11.8 Protocol Case Study "BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="book"HREF="index.htm"TITLE="TCP/IP Network Administration"><IMGSRC="../gifs/txthome.gif"ALT="TCP/IP Network Administration"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch11_10.htm"TITLE="11.10 Summary "><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 11.10 Summary "BORDER="0"></A></TD></TR><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172">11.8 Protocol Case Study </TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="index"HREF="index/idx_0.htm"TITLE="Book Index"><IMGSRC="../gifs/index.gif"ALT="Book Index"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172">11.10 Summary </TD></TR></TABLE><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><PCLASS="nav"><FONTSIZE="-1">[ <AHREF="../index.htm"TITLE="The Networking CD Bookshelf">Library Home</A> | <AHREF="../dnsbind/index.htm"TITLE="DNS &amp; BIND">DNS &amp; BIND</A> | <AHREF="index.htm"TITLE="TCP/IP Network Administration">TCP/IP</A> | <AHREF="../sendmail/index.htm"TITLE="sendmail">sendmail</A> | <AHREF="../smdref/index.htm"TITLE="sendmail Desktop Reference">sendmail Reference</A> | <AHREF="../firewall/index.htm"TITLE="Building Internet Firewalls">Firewalls</A> | <AHREF="../puis/index.htm"TITLE="Practical UNIX &amp; Internet Security">Practical Security</A> ]</FONT></P></DIV></BODY></HTML>