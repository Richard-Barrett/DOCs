<HTML><HEAD><TITLE>[Chapter 2] 2.2 The History File</TITLE><METANAME="DC.title"CONTENT="Learning the Korn Shell"><METANAME="DC.creator"CONTENT="Bill Rosenblatt"><METANAME="DC.publisher"CONTENT="O'Reilly &amp; Associates, Inc."><METANAME="DC.date"CONTENT="1998-08-03T20:55:56Z"><METANAME="DC.type"CONTENT="Text.Monograph"><METANAME="DC.format"CONTENT="text/html"SCHEME="MIME"><METANAME="DC.source"CONTENT="1-56592-054-6"SCHEME="ISBN"><METANAME="DC.language"CONTENT="en-US"><METANAME="generator"CONTENT="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><LINKREV="made"HREF="mailto:online-books@oreilly.com"TITLE="Online Books Comments"><LINKREL="up"HREF="ch02_01.htm"TITLE="2. Command-line Editing"><LINKREL="prev"HREF="ch02_01.htm"TITLE="2.1 Enabling Command-line Editing"><LINKREL="next"HREF="ch02_03.htm"TITLE="2.3 Emacs Editing Mode"></HEAD><BODYBGCOLOR="#FFFFFF"TEXT="#000000"><DIVCLASS="htmlnav"><H1><IMGSRC="gifs/smbanner.gif"ALT="Learning the Korn Shell"USEMAP="#srchmap"BORDER="0"></H1><MAPNAME="srchmap"><AREASHAPE="RECT"COORDS="0,0,466,66"HREF="index.htm"ALT="Learning the Korn Shell"><AREASHAPE="RECT"COORDS="467,0,514,18"HREF="../search/ksrch.htm"ALT="Search this book"></MAP><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch02_01.htm"TITLE="2.1 Enabling Command-line Editing"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 2.1 Enabling Command-line Editing"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><B><FONTFACE="ARIEL,HELVETICA,HELV,SANSERIF"SIZE="-1">Chapter 2<BR>Command-line Editing</FONT></B></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch02_03.htm"TITLE="2.3 Emacs Editing Mode"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 2.3 Emacs Editing Mode"BORDER="0"></A></TD></TR></TABLE>&nbsp;<HRALIGN="LEFT"WIDTH="515"TITLE="footer"></DIV><DIVCLASS="SECT1"><H2CLASS="sect1"><ACLASS="title"NAME="KSH-CH-2-SECT-1">2.2 The History File</A></H2><PCLASS="para"><ACLASS="indexterm"NAME="KSH-CH-2-IX-HIST-FILE"></A>All of the Korn shell's command history facilities depend on a filethat contains commands as you type them in. This file is normally <EMCLASS="emphasis">.sh_history</EM> in your home directory,but you can call it whatever you like by setting theenvironment variable HISTFILE (see <ACLASS="xref"HREF="ch03_01.htm"TITLE="Customizing Your Environment">Chapter 3</A>). <ACLASS="indexterm"NAME="AUTOID-2166"></A><ACLASS="indexterm"NAME="AUTOID-2168"></A>When you run one of the Korn shell's editing modes, you are actuallyrunning a mini-editor on your history file.</P><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-2172"></A><ACLASS="indexterm"NAME="AUTOID-2174"></A>If you run more than one loginsession at a time (e.g., more than one <EMCLASS="emphasis">xterm</EM> on an X Windowsworkstation), you may find it advantageous to maintain a separatehistory file for each login session.  <ACLASS="indexterm"NAME="AUTOID-2177"></A><ACLASS="indexterm"NAME="AUTOID-2180"></A><ACLASS="indexterm"NAME="AUTOID-2183"></A><ACLASS="indexterm"NAME="AUTOID-2186"></A>Put the following line in your <EMCLASS="emphasis">.profile</EM>:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">HISTFILE=~/.hist$$</PRE></BLOCKQUOTE></P><PCLASS="para">This creates a history file whose namebegins with <BCLASS="emphasis.bold">.hist</B> and ends with a number that is essentially guaranteedto be unique; see <ACLASS="xref"HREF="ch08_01.htm"TITLE="Process Handling">Chapter 8</A> for anexplanation of why <EMCLASS="emphasis">.hist$$</EM> generates a unique name.Unfortunately, if you do this,you will end up with lots ofstray history files hanging around. One way to clean up the unneededhistory files is to clean up after yourself at logout time, as explainedin <ACLASS="xref"HREF="ch04_01.htm"TITLE="Basic Shell Programming">Chapter 4</A>. <ACLASS="indexterm"NAME="AUTOID-2196"></A>Another way is to put an entry inyour personal <EMCLASS="emphasis">crontab</EM> file (see the man page <EMCLASS="emphasis">crontab</EM>(1))[4]that removes all history files every day at some benign time like2 A.M. The following line will do it:</P><BLOCKQUOTECLASS="footnote"><PCLASS="para">[4] Some versions of UNIX do not support personal <EMCLASS="emphasis">crontab</EM> files,though all versions derived from AT&amp;T System V should. If yoursdoes not, you have two options: either use <EMCLASS="emphasis">at</EM> with a scriptthat reschedules itself at the end, or ask your system administratorto put an appropriate command in the system's <EMCLASS="emphasis">crontab</EM> file.</P></BLOCKQUOTE><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">0 2 * * * rm ~/.hist*</PRE></BLOCKQUOTE></P><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-2208"></A><ACLASS="indexterm"NAME="AUTOID-2210"></A>Another environment variable, HISTSIZE, can be used to determinethe maximum number of commands kept in the history file. Thedefault is 128 (i.e., the 128 most recent commands),which should be more than adequate.<ACLASS="indexterm"NAME="AUTOID-2213"></A></P></DIV><DIVCLASS="htmlnav"><P></P><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch02_01.htm"TITLE="2.1 Enabling Command-line Editing"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 2.1 Enabling Command-line Editing"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="book"HREF="index.htm"TITLE="Learning the Korn Shell"><IMGSRC="../gifs/txthome.gif"ALT="Learning the Korn Shell"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch02_03.htm"TITLE="2.3 Emacs Editing Mode"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 2.3 Emacs Editing Mode"BORDER="0"></A></TD></TR><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172">2.1 Enabling Command-line Editing</TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="index"HREF="index/idx_0.htm"TITLE="Book Index"><IMGSRC="../gifs/index.gif"ALT="Book Index"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172">2.3 Emacs Editing Mode</TD></TR></TABLE><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><IMGSRC="../gifs/smnavbar.gif"USEMAP="#map"BORDER="0"ALT="The UNIX CD Bookshelf Navigation"><MAPNAME="map"><AREASHAPE="RECT"COORDS="0,0,73,21"HREF="../index.htm"ALT="The UNIX CD Bookshelf"><AREASHAPE="RECT"COORDS="74,0,163,21"HREF="../upt/index.htm"ALT="UNIX Power Tools"><AREASHAPE="RECT"COORDS="164,0,257,21"HREF="../unixnut/index.htm"ALT="UNIX in a Nutshell"><AREASHAPE="RECT"COORDS="258,0,321,21"HREF="../vi/index.htm"ALT="Learning the vi Editor"><AREASHAPE="RECT"COORDS="322,0,378,21"HREF="../sedawk/index.htm"ALT="sed &amp; awk"><AREASHAPE="RECT"COORDS="379,0,438,21"HREF="index.htm"ALT="Learning the Korn Shell"><AREASHAPE="RECT"COORDS="439,0,514,21"HREF="../lrnunix/index.htm"ALT="Learning the UNIX Operating System"></MAP></DIV></BODY></HTML>