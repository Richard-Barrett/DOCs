<HTML><HEAD><TITLE>[Chapter 8] The Vi Editor</TITLE><METANAME="DC.title"CONTENT="UNIX in a Nutshell: System V Edition"><METANAME="DC.creator"CONTENT="Daniel Gilly &amp; the Staff of O'Reilly &amp; Associates"><METANAME="DC.publisher"CONTENT="O'Reilly &amp; Associates, Inc."><METANAME="DC.date"CONTENT="1998-08-06T21:59:54Z"><METANAME="DC.type"CONTENT="Text.Monograph"><METANAME="DC.format"CONTENT="text/html"SCHEME="MIME"><METANAME="DC.source"CONTENT="1-56592-001-5"SCHEME="ISBN"><METANAME="DC.language"CONTENT="en-US"><METANAME="generator"CONTENT="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><LINKREV="made"HREF="mailto:online-books@oreilly.com"TITLE="Online Books Comments"><LINKREL="up"HREF="index.htm"TITLE="UNIX in a Nutshell: System V Edition"><LINKREL="prev"HREF="ch07_04.htm"TITLE="7.4 Summary of Commands by Name"><LINKREL="next"HREF="ch08_02.htm"TITLE="8.2 Movement Commands"></HEAD><BODYBGCOLOR="#FFFFFF"TEXT="#000000"><DIVCLASS="htmlnav"><H1><IMGSRC="gifs/smbanner.gif"ALT="UNIX in a Nutshell: System V Edition"USEMAP="#srchmap"BORDER="0"></H1><MAPNAME="srchmap"><AREASHAPE="RECT"COORDS="0,0,466,71"HREF="index.htm"ALT="UNIX in a Nutshell: System V Edition"><AREASHAPE="RECT"COORDS="467,0,514,18"HREF="../search/usrch.htm"ALT="Search this book"></MAP><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch07_04.htm"TITLE="7.4 Summary of Commands by Name"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 7.4 Summary of Commands by Name"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><B><FONTFACE="ARIEL,HELVETICA,HELV,SANSERIF"SIZE="-1">Chapter 8</FONT></B></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch08_02.htm"TITLE="8.2 Movement Commands"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 8.2 Movement Commands"BORDER="0"></A></TD></TR></TABLE>&nbsp;<HRALIGN="LEFT"WIDTH="515"TITLE="footer"></DIV><DIVCLASS="CHAPTER"><H1CLASS="chapter"><ACLASS="title"NAME="UNUT-CH-8">8. The Vi Editor</A></H1><DIVCLASS="htmltoc"><P><B>Contents:</B><BR><ACLASS="sect1"HREF="#UNUT-CH-8-SECT-1"TITLE="8.1 Review of Vi Operations">Review of Vi Operations</A><BR><ACLASS="sect1"HREF="ch08_02.htm"TITLE="8.2 Movement Commands">Movement Commands</A><BR><ACLASS="sect1"HREF="ch08_03.htm"TITLE="8.3 Edit Commands">Edit Commands</A><BR><ACLASS="sect1"HREF="ch08_04.htm"TITLE="8.4 Saving and Exiting">Saving and Exiting</A><BR><ACLASS="sect1"HREF="ch08_05.htm"TITLE="8.5 Accessing Multiple Files">Accessing Multiple Files</A><BR><ACLASS="sect1"HREF="ch08_06.htm"TITLE="8.6 Interacting with UNIX">Interacting with UNIX</A><BR><ACLASS="sect1"HREF="ch08_07.htm"TITLE="8.7 Macros">Macros</A><BR><ACLASS="sect1"HREF="ch08_08.htm"TITLE="8.8 Miscellaneous Commands">Miscellaneous Commands</A><BR><ACLASS="sect1"HREF="ch08_09.htm"TITLE="8.9 Alphabetical List of Keys">Alphabetical List of Keys</A><BR><ACLASS="sect1"HREF="ch08_10.htm"TITLE="8.10 Setting Up Vi">Setting Up Vi</A></P><P></P></DIV><PCLASS="para"><ACLASS="indexterm"NAME="UNUT-CH-8-IX-VI-EDITOR"></A>This section presents the following topics:</P><ULCLASS="itemizedlist"><LICLASS="listitem"><PCLASS="para">Review of vi operations</P></LI><LICLASS="listitem"><PCLASS="para">Movement commands</P></LI><LICLASS="listitem"><PCLASS="para">Edit commands</P></LI><LICLASS="listitem"><PCLASS="para">Saving and exiting</P></LI><LICLASS="listitem"><PCLASS="para">Accessing multiple files</P></LI><LICLASS="listitem"><PCLASS="para">Interacting with UNIX</P></LI><LICLASS="listitem"><PCLASS="para">Macros</P></LI><LICLASS="listitem"><PCLASS="para">Miscellaneous commands</P></LI><LICLASS="listitem"><PCLASS="para">Alphabetical list of keys</P></LI><LICLASS="listitem"><PCLASS="para">Setting up vi</P></LI></UL><DIVCLASS="sect1"><H2CLASS="sect1"><ACLASS="title"NAME="UNUT-CH-8-SECT-1">8.1 Review of Vi Operations</A></H2><PCLASS="para">This subsection provides a review of the following:</P><ULCLASS="itemizedlist"><LICLASS="listitem"><PCLASS="para">Command-line syntax</P></LI><LICLASS="listitem"><PCLASS="para">Vi modes</P></LI><LICLASS="listitem"><PCLASS="para">Syntax of vi commands</P></LI><LICLASS="listitem"><PCLASS="para">Status-line commands</P></LI></UL><PCLASS="para">For more information on <EMCLASS="emphasis">vi</EM>, refer to the Nutshell Handbook<EMCLASS="emphasis">Learning the vi Editor</EM>.</P><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="UNUT-CH-8-SECT-1.1">8.1.1 Command-line Syntax</A></H3><PCLASS="para">The three most common ways of starting a vi session are:</P><BLOCKQUOTECLASS="blockquote"><PCLASS="para"><CODECLASS="literal">vi  </CODE><CODECLASS="replaceable"><I>file</I></CODE><CODECLASS="literal">vi  +</CODE><CODECLASS="replaceable"><I>n  file</I></CODE><CODECLASS="literal">vi  +/</CODE><CODECLASS="replaceable"><I>pattern  file</I></CODE></P></BLOCKQUOTE><PCLASS="para">You can open <CODECLASS="replaceable"><I>file</I></CODE> for editing, optionally at line <CODECLASS="replaceable"><I>n</I></CODE> or at thefirst line matching <CODECLASS="replaceable"><I>pattern</I></CODE>.  If no <CODECLASS="replaceable"><I>file</I></CODE> is specified,vi opens with an empty buffer.See Section 2 for more information on command-line options forvi.</P></DIV><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="UNUT-CH-8-SECT-1.2">8.1.2 Command Mode</A></H3><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-26739"></A>Once the file is opened, you are in command mode.From command mode, you can:</P><ULCLASS="itemizedlist"><LICLASS="listitem"><PCLASS="para">Invoke insert mode</P></LI><LICLASS="listitem"><PCLASS="para">Issue editing commands</P></LI><LICLASS="listitem"><PCLASS="para">Move the cursor to a different position in the file</P></LI><LICLASS="listitem"><PCLASS="para">Invoke ex commands</P></LI><LICLASS="listitem"><PCLASS="para">Invoke a UNIX shell</P></LI><LICLASS="listitem"><PCLASS="para">Save or exit the current version of the file</P></LI></UL></DIV><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="UNUT-CH-8-SECT-1.3">8.1.3 Insert Mode</A></H3><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-26757"></A>In insert mode, you can enter new text in the file.Press the ESCAPE key to exit insert mode and return to command mode.The following commands invoke insert mode: </P><TABLECLASS="informaltable"><TBODYCLASS="tbody"><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><CODECLASS="userinput"><B>a</B></CODE></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Append after cursor.</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><CODECLASS="userinput"><B>A</B></CODE></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Append at end of line.</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><CODECLASS="userinput"><B>c</B></CODE></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Begin change operation.</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><CODECLASS="userinput"><B>C</B></CODE></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Change to end of line.</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><CODECLASS="userinput"><B>i</B></CODE></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Insert before cursor.</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><CODECLASS="userinput"><B>I</B></CODE></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Insert at beginning of line.</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><CODECLASS="userinput"><B>o</B></CODE></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Open a line below current line.</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><CODECLASS="userinput"><B>O</B></CODE></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Open a line above current line.</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><CODECLASS="userinput"><B>R</B></CODE></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Begin overwriting text.</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><CODECLASS="userinput"><B>s</B></CODE></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Substitute a character.</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><CODECLASS="userinput"><B>S</B></CODE></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Substitute entire line.</TD></TR></TBODY></TABLE></DIV><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="UNUT-CH-8-SECT-1.4">8.1.4 Syntax of Vi Commands</A></H3><PCLASS="para"><ACLASS="indexterm"NAME="UNUT-CH-8-IX-COMMANDS-VI-EDITOR"></A>In vi, commands have the following general form:</P><BLOCKQUOTECLASS="blockquote"><PCLASS="para">[<CODECLASS="replaceable"><I>n</I></CODE>] <CODECLASS="replaceable"><I>operator</I></CODE> [<CODECLASS="replaceable"><I>m</I></CODE>] <CODECLASS="replaceable"><I>object</I></CODE></P></BLOCKQUOTE><PCLASS="para">The basic editing <CODECLASS="replaceable"><I>operators</I></CODE> are:</P><TABLECLASS="informaltable"><TBODYCLASS="tbody"><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><CODECLASS="userinput"><B>c</B></CODE></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Begin a change.</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><CODECLASS="userinput"><B>d</B></CODE></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Begin a deletion.</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><CODECLASS="userinput"><B>y</B></CODE></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Begin a yank (or copy).</TD></TR></TBODY></TABLE><PCLASS="para">If the current line is the object of the operation, then the operatoris the same as the object:  <CODECLASS="literal">cc</CODE>, <CODECLASS="literal">dd</CODE>, <CODECLASS="literal">yy</CODE>.  Otherwise, the editing operators act on objects specified by cursor-movement commands orpattern-matching commands.<EMCLASS="emphasis">n</EM> and <EMCLASS="emphasis">m</EM> are the number of times the operation is performed, or thenumber of objects the operation is performed on.  If both <EMCLASS="emphasis">n</EM> and <EMCLASS="emphasis">m</EM>are specified, the effect is <EMCLASS="emphasis">n</EM> X <EMCLASS="emphasis">m</EM>. </P><PCLASS="para">An object can represent any of the following text blocks:</P><TABLECLASS="informaltable"><TBODYCLASS="tbody"><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><EMCLASS="emphasis">word</EM></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Includes characters up to a space or punctuation mark.  A capitalized object is a variant form that recognizes only blank spaces.</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><EMCLASS="emphasis">sentence</EM></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Is up to <CODECLASS="literal">.</CODE>, <CODECLASS="literal">!</CODE>, <CODECLASS="literal">?</CODE> followed by two spaces.</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><EMCLASS="emphasis">paragraph</EM></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Is up to next blank line or paragraph macro defined by <CODECLASS="literal">para=</CODE> option.</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><EMCLASS="emphasis">section</EM></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Is up to next section heading defined by <CODECLASS="literal">sect=</CODE> option.</TD></TR></TBODY></TABLE><DIVCLASS="sect3"><H4CLASS="sect3"><ACLASS="title"NAME="UNUT-CH-8-SECT-1.4.1">8.1.4.1 Examples</A></H4><TABLECLASS="informaltable"><TBODYCLASS="tbody"><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><CODECLASS="userinput"><B>2cw</B></CODE></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Change the next two words.</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><CODECLASS="userinput"><B>d}</B></CODE></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Delete up to next paragraph.</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><CODECLASS="userinput"><B>d^</B></CODE></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Delete back to beginning of line.</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><CODECLASS="userinput"><B>5yy</B></CODE></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Copy the next five lines.</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><CODECLASS="userinput"><B>y]]</B></CODE></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Copy up to the next section.</TD></TR></TBODY></TABLE></DIV></DIV><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="UNUT-CH-8-SECT-1.5">8.1.5 Status-line Commands</A></H3><PCLASS="para">Most commands are not echoed on the screen as you input them.However, the status line at the bottom of the screen is usedto echo input for the following commands:</P><TABLECLASS="informaltable"><TBODYCLASS="tbody"><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><CODECLASS="userinput"><B>/</B></CODE></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Search forward for a pattern.</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><CODECLASS="userinput"><B>?</B></CODE></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Search backward for a pattern.</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><CODECLASS="userinput"><B>:</B></CODE></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Invoke an ex command.</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><CODECLASS="userinput"><B>!</B></CODE></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Invoke a UNIX command that takes as its input an object in the buffer and replaces it with output from the command.</TD></TR></TBODY></TABLE><PCLASS="para">Commands that are input on the status line must be entered bypressing the RETURN key.In addition, error messages and output from the <CODECLASS="literal">CTRL-G</CODE> command aredisplayed on the status line.</P></DIV></DIV></DIV><DIVCLASS="htmlnav"><P></P><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch07_04.htm"TITLE="7.4 Summary of Commands by Name"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 7.4 Summary of Commands by Name"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="book"HREF="index.htm"TITLE="UNIX in a Nutshell: System V Edition"><IMGSRC="../gifs/txthome.gif"ALT="UNIX in a Nutshell: System V Edition"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch08_02.htm"TITLE="8.2 Movement Commands"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 8.2 Movement Commands"BORDER="0"></A></TD></TR><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172">7.4 Summary of Commands by Name</TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="index"HREF="index/idx_0.htm"TITLE="Book Index"><IMGSRC="../gifs/index.gif"ALT="Book Index"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172">8.2 Movement Commands</TD></TR></TABLE><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><IMGSRC="../gifs/smnavbar.gif"USEMAP="#map"BORDER="0"ALT="The UNIX CD Bookshelf Navigation"><MAPNAME="map"><AREASHAPE="RECT"COORDS="0,0,73,21"HREF="../index.htm"ALT="The UNIX CD Bookshelf"><AREASHAPE="RECT"COORDS="74,0,163,21"HREF="../upt/index.htm"ALT="UNIX Power Tools"><AREASHAPE="RECT"COORDS="164,0,257,21"HREF="index.htm"ALT="UNIX in a Nutshell"><AREASHAPE="RECT"COORDS="258,0,321,21"HREF="../vi/index.htm"ALT="Learning the vi Editor"><AREASHAPE="RECT"COORDS="322,0,378,21"HREF="../sedawk/index.htm"ALT="sed &amp; awk"><AREASHAPE="RECT"COORDS="379,0,438,21"HREF="../ksh/index.htm"ALT="Learning the Korn Shell"><AREASHAPE="RECT"COORDS="439,0,514,21"HREF="../lrnunix/index.htm"ALT="Learning the UNIX Operating System"></MAP></DIV></BODY></HTML>