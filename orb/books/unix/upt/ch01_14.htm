<HTML><HEAD><TITLE>[Chapter 1] 1.14 The Kernel and Daemons </TITLE><METANAME="DC.title"CONTENT="UNIX Power Tools"><METANAME="DC.creator"CONTENT="Jerry Peek, Tim O'Reilly &amp; Mike Loukides"><METANAME="DC.publisher"CONTENT="O'Reilly &amp; Associates, Inc."><METANAME="DC.date"CONTENT="1998-08-04T21:31:12Z"><METANAME="DC.type"CONTENT="Text.Monograph"><METANAME="DC.format"CONTENT="text/html"SCHEME="MIME"><METANAME="DC.source"CONTENT="1-56592-260-3"SCHEME="ISBN"><METANAME="DC.language"CONTENT="en-US"><METANAME="generator"CONTENT="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><LINKREV="made"HREF="mailto:online-books@oreilly.com"TITLE="Online Books Comments"><LINKREL="up"HREF="ch01_01.htm"TITLE="1. Introduction"><LINKREL="prev"HREF="ch01_13.htm"TITLE="1.13 Why Fundamentals Are Important "><LINKREL="next"HREF="ch01_15.htm"TITLE="1.15 Filenames "></HEAD><BODYBGCOLOR="#FFFFFF"TEXT="#000000"><DIVCLASS="htmlnav"><H1><IMGSRC="gifs/smbanner.gif"ALT="UNIX Power Tools"USEMAP="#srchmap"BORDER="0"></H1><MAPNAME="srchmap"><AREASHAPE="RECT"COORDS="0,0,466,58"HREF="index.htm"ALT="UNIX Power Tools"><AREASHAPE="RECT"COORDS="467,0,514,18"HREF="../search/psrch.htm"ALT="Search this book"></MAP><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch01_13.htm"TITLE="1.13 Why Fundamentals Are Important "><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 1.13 Why Fundamentals Are Important "BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><B><FONTFACE="ARIEL,HELVETICA,HELV,SANSERIF"SIZE="-1">Chapter 1<BR>Introduction</FONT></B></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch01_15.htm"TITLE="1.15 Filenames "><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 1.15 Filenames "BORDER="0"></A></TD></TR></TABLE>&nbsp;<HRALIGN="LEFT"WIDTH="515"TITLE="footer"></DIV><DIVCLASS="SECT1"><H2CLASS="sect1"><ACLASS="title"NAME="UPT-ART-1007">1.14 The Kernel and Daemons </A></H2><PCLASS="para"><ACLASS="indexterm"NAME="UPT-ART-1007-IX-KERNEL-DESCRIBED"></A><ACLASS="indexterm"NAME="UPT-ART-1007-IX-DAEMONS-DESCRIBED"></A>If you have arrived at UNIX via DOS or some otherpersonal computer operating system, you will notice some bigdifferences. UNIX is, was, and always will be a multiuser operatingsystem. It is a multiuser operating system even when you're the onlyperson using it. It is a multiuser operating system even when it isrunning on a PC with a single keyboard. And this fact has importantramifications for everything that you do.</P><PCLASS="para">Why does this make a difference? Well, for one thing, you're neverthe only one using the system, even when you think you are. Don'tbother to look under your desk to see if there's an extra terminalhidden down there. There isn't. But UNIX is always doing things&quot;behind your back,&quot; running programs of its own, whether or not youare aware of it. The most important of these programs, the<EMCLASS="emphasis">kernel</EM>, is the heart of the UNIX operating system itself.The kernelassigns memory to each of the programs that are running, partitionstime fairly so that each program can get its job done, handles all I/O(input/output) operations, and so on.Another important group of programs, called<EMCLASS="emphasis">daemons</EM>, are the system's &quot;helpers.&quot; They run from time totime performing small but important tasks like handling mail, runningnetwork communications, feeding data to your printer, keeping track ofthe time, and so on.</P><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-1338"></A>You can use UNIX for a long time without being aware of the kernel orany of the daemons. If you suddenly see a &quot;panic&quot; message on yourterminal and your system stops in its tracks (crashes), you'vejust had a run-in with the kernel. Something has gotten the kernelconfused, and it has decided to give up rather than risk doingsomething foolish. And there's not much you can doto remedy a panic; the problem usually isn't your fault. But youshould know where they're coming from. Similarly, daemons mayoccasionally bombard you with messages. And when you give the<EMCLASS="emphasis">ps</EM> command (see the following list), there may be some names that you don't recognize.These are probably the names of daemons that happen to be doingsomething benevolent at the moment. Right now, we won't worryabout them. But you should know that they are there.</P><PCLASS="para">Not only are you sharing the computer with the kernel and somemysterious daemons, you're also sharing it with yourself.I am currently using a Sun 3 workstation. If I give the command<SPANCLASS="link"><EMCLASS="emphasis">ps</EM> (<ACLASS="linkend"HREF="ch38_05.htm"TITLE="The ps Command ">38.5</A>)</SPAN>,<ACLASS="indexterm"NAME="AUTOID-1344"></A>which lists all the programs I am running, I get the following report:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">PID TT STAT  TIME COMMAND 1449 co IW    0:01 sunview 1453 co S     0:27 clock -Wp 497 32 -WP 704 0 -Wi -Wh 1 1451 p0 IW    0:04 shelltool 1452 p0 IW    0:00 -bin/csh (csh) 1454 p1 R     2:52 shelltool 1455 p1 S     0:01 -bin/csh (csh) 2217 p1 R     0:00 ps 1504 p2 S     1:54 shelltool 1505 p2 IW    0:01 -bin/csh (csh) 1884 p2 S     1:32 emacs princip3.otl</PRE></BLOCKQUOTE></P><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-1350"></A>I may think that I'm only running the editor Emacs, but thecomputer is actually doing a lot more for me. I'm also running<EMCLASS="emphasis">sunview</EM>, which keeps track of Sun's display, and I'm running aprogram that displays a little clock in one corner of my screen.I'm running several &quot;command tools,&quot; which are windows (or areas ofthe screen) that act like separate terminals. Each command tool has a<EMCLASS="emphasis">shell</EM> (<EMCLASS="emphasis">csh</EM>), which is a command interpreter that decipherseverything I type at the keyboard. And I'm running the <EMCLASS="emphasis">ps</EM>command. And, waiting patiently somewhere, my lonelyEmacs editor is waiting for me to type some more.</P><PCLASS="para">If you are running the<SPANCLASS="link">X window system (<ACLASS="linkend"HREF="ch01_31.htm"TITLE="The X Window System ">1.31</A>)</SPAN>or if you're using acomputer with the System V <EMCLASS="emphasis">layers</EM> facility, you willsee something different. But we guarantee thatyou're running at least two programs, and quite likely many more. Ifyou want to see everything that's running, including the daemons, typethe command <CODECLASS="literal">ps&nbsp;-aux</CODE> (for BSD) or <CODECLASS="literal">ps&nbsp;-el</CODE>(for many other flavors of <EMCLASS="emphasis">UNIX</EM>). You'll be impressed.</P><PCLASS="para">Because there is so much going on at once, you have to get used to adifferent way of thinking about UNIX. The UNIX kernel is a trafficcop that mediates different demands for time, for memory, for disks,and so on. Not only does thekernel need to run your programs, but it also needs to run thedaemons, any programs that other users might want to start, or anyprograms that you may have scheduled to<SPANCLASS="link">run automatically (<ACLASS="linkend"HREF="ch40_01.htm#UPT-ART-2313"TITLE="Off-Peak Job Submission ">40.1</A>)</SPAN>.When itruns a program, the kernel allocates a small slice of time&nbsp;- up to asecond&nbsp;- and lets the program run until that slice is used up, or theprogram decides to take a rest of its own accord (this is called&quot;sleeping&quot;). At this point, whether or not the program is finished,the kernel finds some other program to run. The UNIX kernel nevertakes a vacation. It is always watching over the system.</P><PCLASS="para">Once you understand that the kernel is a manager that schedules manydifferent kinds of activity, you understand a lot about how UNIXworks. For example, if you have used any computer system previously,you know that it's a bad idea to turn the computer off while it iswriting something on the disk. You will probably destroy the disk,and could conceivably damagethe disk drive. The same is true for UNIX-but with an importantcomplication. Any of the programs that are running can start doingsomething to the disk at any time. One of the daemons makes a pointof accessing the disk drive every 30 seconds or so, just to stay intouch. Therefore, you can't just turn a UNIX computer off. You mightdo all sorts of damage to the system's files&nbsp;- and not just your own,but conceivably files belonging to many other users. To turn aUNIX system off, you must first run a program called <EMCLASS="emphasis">shutdown</EM>,<ACLASS="indexterm"NAME="AUTOID-1367"></A>which kicks everyone off the system and makes sure that a daemonwon't try to play with a disk drive when you aren't looking.Then you<ACLASS="indexterm"NAME="AUTOID-1369"></A>run a program named <EMCLASS="emphasis">sync</EM>, which makes sure that the disks havefinished doing everything. Only then is it safe to pull the switch.When you start up a UNIX system, it automatically runs a<ACLASS="indexterm"NAME="AUTOID-1372"></A>program called <EMCLASS="emphasis">fsck</EM>, which stands for &quot;filesystemcheck&quot;-its job is to find out if you shut down the systemcorrectly and fix any damage that might have happened if you didn't.</P><PCLASS="para">In this book, we will avoid administrative issues like <EMCLASS="emphasis">shutdown</EM>,<EMCLASS="emphasis">sync</EM>, and <EMCLASS="emphasis">fsck</EM>. But they provide good examples of howUNIX differs from simpler operating systems. If you understand whythese programs are needed, you are on your way to becoming a poweruser.</P><ACLASS="indexterm"NAME="AUTOID-1379"></A><ACLASS="indexterm"NAME="AUTOID-1380"></A><DIVCLASS="sect1info"><PCLASS="SECT1INFO">- <SPANCLASS="authorinitials">ML</SPAN></P></DIV></DIV><DIVCLASS="htmlnav"><P></P><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch01_13.htm"TITLE="1.13 Why Fundamentals Are Important "><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 1.13 Why Fundamentals Are Important "BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="book"HREF="index.htm"TITLE="UNIX Power Tools"><IMGSRC="../gifs/txthome.gif"ALT="UNIX Power Tools"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch01_15.htm"TITLE="1.15 Filenames "><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 1.15 Filenames "BORDER="0"></A></TD></TR><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172">1.13 Why Fundamentals Are Important </TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="index"HREF="index/idx_0.htm"TITLE="Book Index"><IMGSRC="../gifs/index.gif"ALT="Book Index"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172">1.15 Filenames </TD></TR></TABLE><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><IMGSRC="../gifs/smnavbar.gif"USEMAP="#map"BORDER="0"ALT="The UNIX CD Bookshelf Navigation"><MAPNAME="map"><AREASHAPE="RECT"COORDS="0,0,73,21"HREF="../index.htm"ALT="The UNIX CD Bookshelf"><AREASHAPE="RECT"COORDS="74,0,163,21"HREF="index.htm"ALT="UNIX Power Tools"><AREASHAPE="RECT"COORDS="164,0,257,21"HREF="../unixnut/index.htm"ALT="UNIX in a Nutshell"><AREASHAPE="RECT"COORDS="258,0,321,21"HREF="../vi/index.htm"ALT="Learning the vi Editor"><AREASHAPE="RECT"COORDS="322,0,378,21"HREF="../sedawk/index.htm"ALT="sed &amp; awk"><AREASHAPE="RECT"COORDS="379,0,438,21"HREF="../ksh/index.htm"ALT="Learning the Korn Shell"><AREASHAPE="RECT"COORDS="439,0,514,21"HREF="../lrnunix/index.htm"ALT="Learning the UNIX Operating System"></MAP></DIV></BODY></HTML>