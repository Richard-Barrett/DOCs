<HTML><HEAD><TITLE>[Chapter 2] 2.15 Unclutter Logins: Show Login Messages Just Once </TITLE><METANAME="DC.title"CONTENT="UNIX Power Tools"><METANAME="DC.creator"CONTENT="Jerry Peek, Tim O'Reilly &amp; Mike Loukides"><METANAME="DC.publisher"CONTENT="O'Reilly &amp; Associates, Inc."><METANAME="DC.date"CONTENT="1998-08-04T21:32:20Z"><METANAME="DC.type"CONTENT="Text.Monograph"><METANAME="DC.format"CONTENT="text/html"SCHEME="MIME"><METANAME="DC.source"CONTENT="1-56592-260-3"SCHEME="ISBN"><METANAME="DC.language"CONTENT="en-US"><METANAME="generator"CONTENT="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><LINKREV="made"HREF="mailto:online-books@oreilly.com"TITLE="Online Books Comments"><LINKREL="up"HREF="ch02_01.htm"TITLE="2. Logging In"><LINKREL="prev"HREF="ch02_14.htm"TITLE="2.14 motd.diff: Show New Lines in Login Messages"><LINKREL="next"HREF="ch02_16.htm"TITLE="2.16 Approved Shells: Using Unapproved Login Shell "></HEAD><BODYBGCOLOR="#FFFFFF"TEXT="#000000"><DIVCLASS="htmlnav"><H1><IMGSRC="gifs/smbanner.gif"ALT="UNIX Power Tools"USEMAP="#srchmap"BORDER="0"></H1><MAPNAME="srchmap"><AREASHAPE="RECT"COORDS="0,0,466,58"HREF="index.htm"ALT="UNIX Power Tools"><AREASHAPE="RECT"COORDS="467,0,514,18"HREF="../search/psrch.htm"ALT="Search this book"></MAP><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch02_14.htm"TITLE="2.14 motd.diff: Show New Lines in Login Messages"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 2.14 motd.diff: Show New Lines in Login Messages"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><B><FONTFACE="ARIEL,HELVETICA,HELV,SANSERIF"SIZE="-1">Chapter 2<BR>Logging In</FONT></B></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch02_16.htm"TITLE="2.16 Approved Shells: Using Unapproved Login Shell "><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 2.16 Approved Shells: Using Unapproved Login Shell "BORDER="0"></A></TD></TR></TABLE>&nbsp;<HRALIGN="LEFT"WIDTH="515"TITLE="footer"></DIV><DIVCLASS="SECT1"><H2CLASS="sect1"><ACLASS="title"NAME="UPT-ART-6440">2.15 Unclutter Logins: Show Login Messages Just Once </A></H2><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-3747"></A><ACLASS="indexterm"NAME="AUTOID-3749"></A>Ignoring your system login messages because they're so long?You might miss something important some day.Here's a way to see the message, from the file <EMCLASS="emphasis">/etc/motd</EM>,only if it's changed since the last time you read it.The <EMCLASS="emphasis">ls</EM> option<SPANCLASS="link"><EMCLASS="emphasis">-t</EM> (<ACLASS="linkend"HREF="ch16_02.htm"TITLE="Finding Oldest or Newest Files with ls -t and ls -u ">16.2</A>)</SPAN>sorts a list of files with the most recently modified file first.The following lines use a<SPANCLASS="link"><EMCLASS="emphasis">csh</EM> array (<ACLASS="linkend"HREF="ch47_05.htm"TITLE="Using C Shell Arrays ">47.5</A>)</SPAN>to store the output of <EMCLASS="emphasis">ls -t</EM> comparing two files' modification times.If the <EMCLASS="emphasis">/etc/motd</EM> file is newer than the <EMCLASS="emphasis">~/.hushlogin</EM> file,two commands are run.I use these lines in my<SPANCLASS="link"><EMCLASS="emphasis">.login</EM> file (<ACLASS="linkend"HREF="ch02_02.htm"TITLE="Shell Setup Files-Which, Where, and Why ">2.2</A>)</SPAN>,though they will work anywhere in the C shell:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">&#13;set files=(`ls -t /etc/motd ~/.hushlogin`)if ( $files[1] == /etc/motd ) then    cat /etc/motd    touch ~/.hushloginendifunset files</PRE></BLOCKQUOTE></P><BLOCKQUOTECLASS="note"><PCLASS="para"><STRONG>NOTE:</STRONG> <ACLASS="indexterm"NAME="AUTOID-3769"></A>If you have <EMCLASS="emphasis">ls</EM><SPANCLASS="link">aliased (<ACLASS="linkend"HREF="ch10_02.htm"TITLE="Aliases for Common Commands ">10.2</A>)</SPAN>to output anything but filenames (forinstance, to print the sizes of files with <EMCLASS="emphasis">-s</EM>) you'll need touse the system version with<CODECLASS="literal">/bin/ls</CODE> instead of just <CODECLASS="literal">ls</CODE>.</P></BLOCKQUOTE><PCLASS="para">This method uses the <EMCLASS="emphasis">.hushlogin</EM> files on many UNIXes:if that file exists, the login process is quiet.We make <EMCLASS="emphasis">.hushlogin</EM> do double duty by<SPANCLASS="link">storing the current timestamp with <EMCLASS="emphasis">touch</EM> (<ACLASS="linkend"HREF="ch21_07.htm"TITLE="Setting File Modification Time with touch ">21.7</A>)</SPAN>.<ACLASS="indexterm"NAME="AUTOID-3781"></A><ACLASS="indexterm"NAME="AUTOID-3784"></A></P><PCLASS="para">(This <EMCLASS="emphasis">ls -t</EM> file-comparison technique will work on all UNIXesand it's useful any time you need to compare two files.You can use the same technique to mark the time that something has happenedto any file&nbsp;- orto compare any two files or directories.Use the<SPANCLASS="link"><EMCLASS="emphasis">ls -d</EM> option (<ACLASS="linkend"HREF="ch16_08.htm"TITLE="The ls -d Option ">16.8</A>)</SPAN>for directories.)</P><DIVCLASS="sect1info"><PCLASS="SECT1INFO">- <SPANCLASS="authorinitials">JP</SPAN></P></DIV></DIV><DIVCLASS="htmlnav"><P></P><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch02_14.htm"TITLE="2.14 motd.diff: Show New Lines in Login Messages"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 2.14 motd.diff: Show New Lines in Login Messages"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="book"HREF="index.htm"TITLE="UNIX Power Tools"><IMGSRC="../gifs/txthome.gif"ALT="UNIX Power Tools"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch02_16.htm"TITLE="2.16 Approved Shells: Using Unapproved Login Shell "><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 2.16 Approved Shells: Using Unapproved Login Shell "BORDER="0"></A></TD></TR><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172">2.14 motd.diff: Show New Lines in Login Messages</TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="index"HREF="index/idx_0.htm"TITLE="Book Index"><IMGSRC="../gifs/index.gif"ALT="Book Index"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172">2.16 Approved Shells: Using Unapproved Login Shell </TD></TR></TABLE><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><IMGSRC="../gifs/smnavbar.gif"USEMAP="#map"BORDER="0"ALT="The UNIX CD Bookshelf Navigation"><MAPNAME="map"><AREASHAPE="RECT"COORDS="0,0,73,21"HREF="../index.htm"ALT="The UNIX CD Bookshelf"><AREASHAPE="RECT"COORDS="74,0,163,21"HREF="index.htm"ALT="UNIX Power Tools"><AREASHAPE="RECT"COORDS="164,0,257,21"HREF="../unixnut/index.htm"ALT="UNIX in a Nutshell"><AREASHAPE="RECT"COORDS="258,0,321,21"HREF="../vi/index.htm"ALT="Learning the vi Editor"><AREASHAPE="RECT"COORDS="322,0,378,21"HREF="../sedawk/index.htm"ALT="sed &amp; awk"><AREASHAPE="RECT"COORDS="379,0,438,21"HREF="../ksh/index.htm"ALT="Learning the Korn Shell"><AREASHAPE="RECT"COORDS="439,0,514,21"HREF="../lrnunix/index.htm"ALT="Learning the UNIX Operating System"></MAP></DIV></BODY></HTML>