<HTML><HEAD><TITLE>[Chapter 5] 5.2 The Idea of a Terminal Database </TITLE><METANAME="DC.title"CONTENT="UNIX Power Tools"><METANAME="DC.creator"CONTENT="Jerry Peek, Tim O'Reilly &amp; Mike Loukides"><METANAME="DC.publisher"CONTENT="O'Reilly &amp; Associates, Inc."><METANAME="DC.date"CONTENT="1998-08-04T21:32:56Z"><METANAME="DC.type"CONTENT="Text.Monograph"><METANAME="DC.format"CONTENT="text/html"SCHEME="MIME"><METANAME="DC.source"CONTENT="1-56592-260-3"SCHEME="ISBN"><METANAME="DC.language"CONTENT="en-US"><METANAME="generator"CONTENT="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><LINKREV="made"HREF="mailto:online-books@oreilly.com"TITLE="Online Books Comments"><LINKREL="up"HREF="ch05_01.htm"TITLE="5. Setting Up Your Terminal"><LINKREL="prev"HREF="ch05_01.htm"TITLE="5.1 There's a Lot to Know About Terminals "><LINKREL="next"HREF="ch05_03.htm"TITLE="5.3 Setting the Terminal Type When You Log In "></HEAD><BODYBGCOLOR="#FFFFFF"TEXT="#000000"><DIVCLASS="htmlnav"><H1><IMGSRC="gifs/smbanner.gif"ALT="UNIX Power Tools"USEMAP="#srchmap"BORDER="0"></H1><MAPNAME="srchmap"><AREASHAPE="RECT"COORDS="0,0,466,58"HREF="index.htm"ALT="UNIX Power Tools"><AREASHAPE="RECT"COORDS="467,0,514,18"HREF="../search/psrch.htm"ALT="Search this book"></MAP><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch05_01.htm"TITLE="5.1 There's a Lot to Know About Terminals "><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 5.1 There's a Lot to Know About Terminals "BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><B><FONTFACE="ARIEL,HELVETICA,HELV,SANSERIF"SIZE="-1">Chapter 5<BR>Setting Up Your Terminal</FONT></B></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch05_03.htm"TITLE="5.3 Setting the Terminal Type When You Log In "><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 5.3 Setting the Terminal Type When You Log In "BORDER="0"></A></TD></TR></TABLE>&nbsp;<HRALIGN="LEFT"WIDTH="515"TITLE="footer"></DIV><DIVCLASS="SECT1"><H2CLASS="sect1"><ACLASS="title"NAME="UPT-ART-0075">5.2 The Idea of a Terminal Database </A></H2><PCLASS="para">Terminals differ. Manufacturers produce a variety of terminals, each oneincluding a particular set of features for a certain price.There are new terminals and old, smart terminals and dumb ones, terminalswith big screens and terminals with small screens, printing terminals and video displays, and terminals with all sorts of special features.</P><PCLASS="para">Differences between terminals do not matter much to programs like<SPANCLASS="link"><EMCLASS="emphasis">cat</EM> (<ACLASS="linkend"HREF="ch25_02.htm"TITLE="Four Ways to Skin a cat ">25.2</A>)</SPAN>or<SPANCLASS="link"><EMCLASS="emphasis">who</EM> (<ACLASS="linkend"HREF="ch51_04.htm"TITLE="Who's On? ">51.4</A>)</SPAN>that use theterminal screen as a sort of typewriter with an endless scroll of paper.These programs produce sequential outputand do not make use of the terminal's special features; they do not need to know much to do their job.<ACLASS="indexterm"NAME="AUTOID-4789"></A>Only programs such as screen editors,which make use of screen-handling features, need to know about differences between terminals.</P><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-4794"></A><ACLASS="indexterm"NAME="AUTOID-4796"></A>In the late 1970s, Bill Joycreated the<SPANCLASS="link"><EMCLASS="emphasis">vi</EM> (<ACLASS="linkend"HREF="ch30_02.htm"TITLE="What We Cover ">30.2</A>)</SPAN>text editor at U.C. Berkeley.Like all screen-oriented editors, <EMCLASS="emphasis">vi</EM> uses the terminalscreen non-sequentially. A program performing non-sequential output does not just print character after character,but must manipulatethe text that was sent before, scroll the page,move the cursor, delete lines, insert characters, and more.While it would be possible to keep redrawing the screen in itsentirety, many features are provided in hardware or firmware by theterminal itself, and save too much time and trouble to be ignored.</P><PCLASS="para">The first version of <EMCLASS="emphasis">vi</EM> was written specifically for Lear SieglerADM3a terminals. <EMCLASS="emphasis">vi</EM> was such an improvement over line-oriented editors that there was great demand to port <EMCLASS="emphasis">vi</EM> to other brands of terminals. The problem was that each terminal had different features and used different control codes to manipulate the features that they did have in common.</P><PCLASS="para">Rather than write separate<SPANCLASS="link">terminal drivers (<ACLASS="linkend"HREF="ch42_01.htm#UPT-ART-1142"TITLE="Making Sense Out of the Terminal Mess ">42.1</A>)</SPAN>for eachterminal type, Bill Joy did something very clever, which all UNIX usersnow take for granted.He wrote a version of <EMCLASS="emphasis">vi</EM> with generic commands to manipulatethe screen instead of hardcoding the control codes and dimensionsfor a particular terminal.</P><PCLASS="para">The generic terminal-handling mechanism Joy came up with had two parts:a database describing the capabilities of each of the terminals to be supported, and a subroutine library that allows programs toquery that database and to make use of the capability valuesit contains. Both the library and the database were giventhe name <EMCLASS="emphasis">termcap</EM>, which is short for <EMCLASS="emphasis">term</EM>inal<EMCLASS="emphasis">cap</EM>abilities.<ACLASS="indexterm"NAME="AUTOID-4813"></A></P><PCLASS="para">At this point, users take for granted the fact that you canuse just about any terminal with a UNIX system and usescreen-oriented programs like <EMCLASS="emphasis">vi</EM> without any problem.But it is really quite remarkable!</P><PCLASS="para">The <EMCLASS="emphasis">termcap</EM> database is contained in a single text file, which grew quite large over the years to include descriptions of hundreds ofdifferent terminals. To improve performance, AT&amp;T later introduced a<ACLASS="indexterm"NAME="AUTOID-4819"></A>database called <EMCLASS="emphasis">terminfo</EM>, which stores terminal descriptions, in compiled form, in a separate file for each terminal.</P><PCLASS="para">If a program is designed to use <EMCLASS="emphasis">termcap</EM> or <EMCLASS="emphasis">terminfo</EM>, it queries anenvironment variable called<SPANCLASS="link"><EMCLASS="emphasis">TERM</EM> (<ACLASS="linkend"HREF="ch05_10.htm"TITLE="Finding What Terminal Names You Can Use ">5.10</A>)</SPAN>to determine the terminal type, thenlooks up the entry for that terminal in the terminal database, and reads the definition of any capabilities it plans to use into external variables.Programs that use <EMCLASS="emphasis">termcap</EM> or <EMCLASS="emphasis">terminfo</EM> range from screen editors like<EMCLASS="emphasis">vi</EM> and<SPANCLASS="link"><EMCLASS="emphasis">emacs</EM> (<ACLASS="linkend"HREF="ch32_01.htm#UPT-ART-5540"TITLE="Emacs: The Other Editor ">32.1</A>)</SPAN>,which use the complete terminal description,to a program like<SPANCLASS="link"><EMCLASS="emphasis">clear</EM> (<ACLASS="linkend"HREF="ch22_18.htm"TITLE="Clear Your Terminal for Security, to Stop Burn-in ">22.18</A>)</SPAN>,which needs to know only one capability(the escape sequence to clear the screen). Other programs include<SPANCLASS="link"><EMCLASS="emphasis">more</EM> (<ACLASS="linkend"HREF="ch25_03.htm"TITLE="Using more to Page Through Files ">25.3</A>)</SPAN>,<EMCLASS="emphasis">pg</EM>, <EMCLASS="emphasis">rogue</EM>,<SPANCLASS="link"><EMCLASS="emphasis">tset</EM> (<ACLASS="linkend"HREF="ch05_03.htm"TITLE="Setting the Terminal Type When You Log In ">5.3</A>)</SPAN>,<EMCLASS="emphasis">ul</EM>, and<SPANCLASS="link"><EMCLASS="emphasis">nroff</EM> (<ACLASS="linkend"HREF="ch43_13.htm"TITLE="The Text Formatters nroff, troff, ditroff, ... ">43.13</A>)</SPAN>.</P><DIVCLASS="sect1info"><PCLASS="SECT1INFO">- <SPANCLASS="authorinitials">JS</SPAN> <SPANCLASS="bibliomisc">from O'Reilly &amp; Associates' <CITECLASS="citetitle">termcap &amp; terminfo</CITE>, Chapter 1</SPAN></P></DIV></DIV><DIVCLASS="htmlnav"><P></P><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch05_01.htm"TITLE="5.1 There's a Lot to Know About Terminals "><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 5.1 There's a Lot to Know About Terminals "BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="book"HREF="index.htm"TITLE="UNIX Power Tools"><IMGSRC="../gifs/txthome.gif"ALT="UNIX Power Tools"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch05_03.htm"TITLE="5.3 Setting the Terminal Type When You Log In "><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 5.3 Setting the Terminal Type When You Log In "BORDER="0"></A></TD></TR><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172">5.1 There's a Lot to Know About Terminals </TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="index"HREF="index/idx_0.htm"TITLE="Book Index"><IMGSRC="../gifs/index.gif"ALT="Book Index"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172">5.3 Setting the Terminal Type When You Log In </TD></TR></TABLE><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><IMGSRC="../gifs/smnavbar.gif"USEMAP="#map"BORDER="0"ALT="The UNIX CD Bookshelf Navigation"><MAPNAME="map"><AREASHAPE="RECT"COORDS="0,0,73,21"HREF="../index.htm"ALT="The UNIX CD Bookshelf"><AREASHAPE="RECT"COORDS="74,0,163,21"HREF="index.htm"ALT="UNIX Power Tools"><AREASHAPE="RECT"COORDS="164,0,257,21"HREF="../unixnut/index.htm"ALT="UNIX in a Nutshell"><AREASHAPE="RECT"COORDS="258,0,321,21"HREF="../vi/index.htm"ALT="Learning the vi Editor"><AREASHAPE="RECT"COORDS="322,0,378,21"HREF="../sedawk/index.htm"ALT="sed &amp; awk"><AREASHAPE="RECT"COORDS="379,0,438,21"HREF="../ksh/index.htm"ALT="Learning the Korn Shell"><AREASHAPE="RECT"COORDS="439,0,514,21"HREF="../lrnunix/index.htm"ALT="Learning the UNIX Operating System"></MAP></DIV></BODY></HTML>