<HTML><HEAD><TITLE>[Chapter 5] 5.3 Setting the Terminal Type When You Log In </TITLE><METANAME="DC.title"CONTENT="UNIX Power Tools"><METANAME="DC.creator"CONTENT="Jerry Peek, Tim O'Reilly &amp; Mike Loukides"><METANAME="DC.publisher"CONTENT="O'Reilly &amp; Associates, Inc."><METANAME="DC.date"CONTENT="1998-08-04T21:32:59Z"><METANAME="DC.type"CONTENT="Text.Monograph"><METANAME="DC.format"CONTENT="text/html"SCHEME="MIME"><METANAME="DC.source"CONTENT="1-56592-260-3"SCHEME="ISBN"><METANAME="DC.language"CONTENT="en-US"><METANAME="generator"CONTENT="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><LINKREV="made"HREF="mailto:online-books@oreilly.com"TITLE="Online Books Comments"><LINKREL="up"HREF="ch05_01.htm"TITLE="5. Setting Up Your Terminal"><LINKREL="prev"HREF="ch05_02.htm"TITLE="5.2 The Idea of a Terminal Database "><LINKREL="next"HREF="ch05_04.htm"TITLE="5.4 Setting the TERMCAP Variable with tset "></HEAD><BODYBGCOLOR="#FFFFFF"TEXT="#000000"><DIVCLASS="htmlnav"><H1><IMGSRC="gifs/smbanner.gif"ALT="UNIX Power Tools"USEMAP="#srchmap"BORDER="0"></H1><MAPNAME="srchmap"><AREASHAPE="RECT"COORDS="0,0,466,58"HREF="index.htm"ALT="UNIX Power Tools"><AREASHAPE="RECT"COORDS="467,0,514,18"HREF="../search/psrch.htm"ALT="Search this book"></MAP><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch05_02.htm"TITLE="5.2 The Idea of a Terminal Database "><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 5.2 The Idea of a Terminal Database "BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><B><FONTFACE="ARIEL,HELVETICA,HELV,SANSERIF"SIZE="-1">Chapter 5<BR>Setting Up Your Terminal</FONT></B></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch05_04.htm"TITLE="5.4 Setting the TERMCAP Variable with tset "><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 5.4 Setting the TERMCAP Variable with tset "BORDER="0"></A></TD></TR></TABLE>&nbsp;<HRALIGN="LEFT"WIDTH="515"TITLE="footer"></DIV><DIVCLASS="SECT1"><H2CLASS="sect1"><ACLASS="title"NAME="UPT-ART-7721">5.3 Setting the Terminal Type When You Log In </A></H2><PCLASS="para">If you always work at the same terminal, there's no problem with setting the terminal type explicitly in your<ACLASS="indexterm"NAME="AUTOID-4850"></A><SPANCLASS="link"><EMCLASS="emphasis">.login</EM> file (<ACLASS="linkend"HREF="ch02_02.htm"TITLE="Shell Setup Files-Which, Where, and Why ">2.2</A>)</SPAN>:</P><PCLASS="para"><TABLECLASS="screen.co"BORDER="1"><TR><THVALIGN="TOP"><PRECLASS="calloutlist"><ACLASS="co"HREF="ch06_01.htm"TITLE="6.1 What Environment Variables Are Good For ">setenv</A> </PRE></TH><TDVALIGN="TOP"><PRECLASS="screen">setenv TERM vt100</PRE></TD></TR></TABLE></P><PCLASS="para">or in your<SPANCLASS="link"><EMCLASS="emphasis">.profile</EM> (<ACLASS="linkend"HREF="ch02_02.htm"TITLE="Shell Setup Files-Which, Where, and Why ">2.2</A>)</SPAN>:</P><PCLASS="para"><TABLECLASS="screen.co"BORDER="1"><TR><THVALIGN="TOP"><PRECLASS="calloutlist"><ACLASS="co"HREF="ch06_01.htm"TITLE="6.1 What Environment Variables Are Good For ">export</A> </PRE></TH><TDVALIGN="TOP"><PRECLASS="screen">TERM=vt100; export TERM</PRE></TD></TR></TABLE></P><PCLASS="para">But if, like many UNIX users, you might log in from time to time atdifferent terminals, from home, or on different systems over a network,you need some more intelligent method for setting the terminal type.</P><PCLASS="para">It's possible to set up various kinds of<SPANCLASS="link">tests (<ACLASS="linkend"HREF="ch02_12.htm"TITLE="Automatic Setups for Different Terminals ">2.12</A>)</SPAN>in your shell setup filesto do this.<ACLASS="indexterm"NAME="AUTOID-4867"></A>But you can also do a surprising amount of terminal typetesting with <EMCLASS="emphasis">tset</EM>, even though it was nominally designed for <SPANCLASS="link">initializing the terminal (<ACLASS="linkend"HREF="ch05_11.htm"TITLE="Initializing the Terminal with tset ">5.11</A>)</SPAN>:</P><ULCLASS="itemizedlist"><LICLASS="listitem"><PCLASS="para">If no<SPANCLASS="link">arguments (<ACLASS="linkend"HREF="ch01_02.htm"TITLE="Who Listens to What You Type? ">1.2</A>)</SPAN>are specified and <EMCLASS="emphasis">TERM</EM> is already set, <EMCLASS="emphasis">tset</EM> uses the value of <EMCLASS="emphasis">TERM</EM> to determine the terminal type.</P></LI><LICLASS="listitem"><PCLASS="para">If no arguments are specified and <EMCLASS="emphasis">TERM</EM> is <EMCLASS="emphasis">not</EM> set,then <EMCLASS="emphasis">tset</EM> uses the value specified inthe system file <EMCLASS="emphasis">/etc/ttytype</EM> or <EMCLASS="emphasis">/etc/ttys</EM>(BSD 4.3 and derivatives only).</P></LI><LICLASS="listitem"><PCLASS="para">If a terminal type is specified as an argument, that argumentis used as the terminal type, regardless of the value of <EMCLASS="emphasis">TERM</EM>.</P></LI><LICLASS="listitem"><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-4890"></A>The <EMCLASS="emphasis">-m</EM> (map) option allows a fine degree of control in caseswhere the terminal type may be ambiguous. For example, ifyou sometimes log in on a dialup line, sometimesover a local area network, and sometimes on a hardwiredline, the <EMCLASS="emphasis">-m</EM> option can be specified to determine which login is currently being used, and the terminal type can beset accordingly.</P></LI></UL><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-4896"></A>In the Bourne shell, <EMCLASS="emphasis">tset</EM> can be used to set the value of<EMCLASS="emphasis">TERM</EM> as follows:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">TERM=`tset - -Q <CODECLASS="replaceable"><I>options</I></CODE>`; export TERM</PRE></BLOCKQUOTE></P><PCLASS="para">(Given the <EMCLASS="emphasis">-</EM> option, <EMCLASS="emphasis">tset</EM> prints the value that itdetermines for the terminal type to<SPANCLASS="link">standard output (<ACLASS="linkend"HREF="ch13_01.htm#UPT-ART-1023"TITLE="Using Standard Input and Output">13.1</A>)</SPAN>.Otherwise, it <SPANCLASS="link">initializes the terminal (<ACLASS="linkend"HREF="ch05_11.htm"TITLE="Initializing the Terminal with tset ">5.11</A>)</SPAN>,but keeps the terminal type to itself.<ACLASS="indexterm"NAME="AUTOID-4909"></A>The <EMCLASS="emphasis">-Q</EM> (quiet) option causes <EMCLASS="emphasis">tset</EM> to suppressprinting of a message it normally prints regarding thevalues to which it has set the erase and kill characters&nbsp;- ajob it does in its alternate role as terminal initializer.The<SPANCLASS="link">backquotes (<ACLASS="linkend"HREF="ch09_16.htm"TITLE="Command Substitution ">9.16</A>)</SPAN>surrounding the <EMCLASS="emphasis">tset</EM> command cause its output tobe interpolated into the command line.)</P><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-4917"></A><ACLASS="indexterm"NAME="AUTOID-4920"></A>In the C shell, you should use the <SPANCLASS="link"><EMCLASS="emphasis">eval</EM> (<ACLASS="linkend"HREF="ch08_10.htm"TITLE="eval: When You Need Another Chance ">8.10</A>)</SPAN>command to capture the output of <EMCLASS="emphasis">tset</EM>; this will also allow youto<ACLASS="indexterm"NAME="AUTOID-4925"></A><SPANCLASS="link">set the <EMCLASS="emphasis">TERMCAP</EM> variable (<ACLASS="linkend"HREF="ch05_04.htm"TITLE="Setting the TERMCAP Variable with tset ">5.4</A>)</SPAN>.(You must also issue the command <CODECLASS="literal">set noglob</CODE>,as explained in article<ACLASS="xref"HREF="ch06_09.htm"TITLE="Special C Shell Variables ">6.9</A>.)</P><PCLASS="para">To see what <EMCLASS="emphasis">tset</EM> can do, consider a case where the terminal's serialline is connected to a dialup modem, through which several differentusers might be connected, each using a different type ofterminal.Accordingly, the default terminal type in<EMCLASS="emphasis">/etc/ttytype</EM> should be set to <EMCLASS="emphasis">dialup</EM>.The <EMCLASS="emphasis">tset</EM> command couldthen be used inthe <EMCLASS="emphasis">.login</EM> file as follows, with the appropriate terminal typeset for each user:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">set noglobeval `tset -s -Q -m 'dialup:vt100'`</PRE></BLOCKQUOTE></P><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-4940"></A>This means that if <EMCLASS="emphasis">ttytype</EM> says <EMCLASS="emphasis">dialup</EM>, use<EMCLASS="emphasis">vt100</EM> as the terminal type. A colon separates the<EMCLASS="emphasis">ttytype</EM> value and the value to which it is to be mapped.If a user wants to be prompted to be sure, place a question mark after the colon and before the mapped terminal type:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">set noglobeval `tset -s -Q -m 'dialup:?vt100'`</PRE></BLOCKQUOTE></P><PCLASS="para">The prompt will look like this:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">TERM = (vt100)</PRE></BLOCKQUOTE></P><PCLASS="para">If the user presses  RETURN,the preferred terminal type will be used. Alternatively, anotherterminal type could be entered at that time.</P><PCLASS="para">You can cause <EMCLASS="emphasis">tset</EM> to prompt for a terminal typeeven without testing a generic entry like <EMCLASS="emphasis">dialup</EM>.Just specify the desired terminal type, preceded by a question mark,after the <EMCLASS="emphasis">-m</EM> option.For example:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">set noglobeval `tset -s -Q -m '?vt100'`</PRE></BLOCKQUOTE></P><PCLASS="para">It is also possible to specify different terminal types fordifferent line speeds. Say, forexample, that you normally used a Wyse-50 with a 9600-bpsmodem when dialing in from home, but used a portable PC witha VT100 terminal emulator and 2400-bps modem when you wereon the road. You might then use a <EMCLASS="emphasis">tset</EM> command like this:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">set noglobeval `tset -s -Q -m 'dialup@2400:vt100' wy50`</PRE></BLOCKQUOTE></P><PCLASS="para">&#13;Assuming that the type is set in <EMCLASS="emphasis">ttytype</EM> as <EMCLASS="emphasis">dialup</EM>, <EMCLASS="emphasis">tset</EM> will use the type <EMCLASS="emphasis">vt100</EM> if at 2400 bpsand, if not, will use the type <EMCLASS="emphasis">wy50</EM>.</P><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-4970"></A>[Watch out for the linespeed switches.They don't work on a lot of networked systems&nbsp;- usually, the line speedat the computer's port is higher than the speed at the terminal.The same problem occurs, these days, with dialup modems that use datacompression. <EMCLASS="emphasis">-JP</EM>&nbsp;]Various symbols can be used for line-speed calculations: &#13;</P><DLCLASS="variablelist"><DTCLASS="term"><CODECLASS="literal">@</CODE><CODECLASS="replaceable"><I>speed</I></CODE></DT><DDCLASS="listitem"><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-4980"></A>Means at the specified speed. </P></DD><DTCLASS="term"><CODECLASS="literal">&lt;</CODE><CODECLASS="replaceable"><I>speed</I></CODE></DT><DDCLASS="listitem"><PCLASS="para">Means less than the specified speed.</P></DD><DTCLASS="term"><CODECLASS="literal">&gt;</CODE><CODECLASS="replaceable"><I>speed</I></CODE></DT><DDCLASS="listitem"><PCLASS="para">Means greater than the specified speed. &#13;</P></DD></DL><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-4995"></A>An exclamation point can precede theoperator to reverse the sense of the comparison.(For example,<CODECLASS="literal">!@1200</CODE> would mean at any speed other than 1200 bps.In the C shell, you have to type<SPANCLASS="link"><CODECLASS="literal">\!@1200</CODE> (<ACLASS="linkend"HREF="ch11_02.htm"TITLE="History in a Nutshell ">11.2</A>)</SPAN>instead.)</P><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-5002"></A>Multiple <EMCLASS="emphasis">-m</EM> options can be specified; the first map to besatisfied will be used. If no match is found, a final valuespecified on the line without a <EMCLASS="emphasis">-m</EM> option (as in the above example) will be used. If no value is specified, the typein <EMCLASS="emphasis">/etc/ttytype</EM> will be used.</P><PCLASS="para">These changes may not always work; article<ACLASS="xref"HREF="ch42_03.htm"TITLE="Why Changing TERM Sometimes Doesn't Work ">42.3</A>explains why.Article<ACLASS="xref"HREF="ch41_09.htm"TITLE="Commands to Adjust Your Terminal ">41.9</A>has a script for adjusting your terminal.</P><DIVCLASS="sect1info"><PCLASS="SECT1INFO">- <SPANCLASS="authorinitials">TOR</SPAN> <SPANCLASS="bibliomisc">from O'Reilly &amp; Associates' <CITECLASS="citetitle">termcap &amp; terminfo</CITE>, Chapter 4</SPAN></P></DIV></DIV><DIVCLASS="htmlnav"><P></P><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch05_02.htm"TITLE="5.2 The Idea of a Terminal Database "><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 5.2 The Idea of a Terminal Database "BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="book"HREF="index.htm"TITLE="UNIX Power Tools"><IMGSRC="../gifs/txthome.gif"ALT="UNIX Power Tools"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch05_04.htm"TITLE="5.4 Setting the TERMCAP Variable with tset "><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 5.4 Setting the TERMCAP Variable with tset "BORDER="0"></A></TD></TR><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172">5.2 The Idea of a Terminal Database </TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="index"HREF="index/idx_0.htm"TITLE="Book Index"><IMGSRC="../gifs/index.gif"ALT="Book Index"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172">5.4 Setting the TERMCAP Variable with tset </TD></TR></TABLE><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><IMGSRC="../gifs/smnavbar.gif"USEMAP="#map"BORDER="0"ALT="The UNIX CD Bookshelf Navigation"><MAPNAME="map"><AREASHAPE="RECT"COORDS="0,0,73,21"HREF="../index.htm"ALT="The UNIX CD Bookshelf"><AREASHAPE="RECT"COORDS="74,0,163,21"HREF="index.htm"ALT="UNIX Power Tools"><AREASHAPE="RECT"COORDS="164,0,257,21"HREF="../unixnut/index.htm"ALT="UNIX in a Nutshell"><AREASHAPE="RECT"COORDS="258,0,321,21"HREF="../vi/index.htm"ALT="Learning the vi Editor"><AREASHAPE="RECT"COORDS="322,0,378,21"HREF="../sedawk/index.htm"ALT="sed &amp; awk"><AREASHAPE="RECT"COORDS="379,0,438,21"HREF="../ksh/index.htm"ALT="Learning the Korn Shell"><AREASHAPE="RECT"COORDS="439,0,514,21"HREF="../lrnunix/index.htm"ALT="Learning the UNIX Operating System"></MAP></DIV></BODY></HTML>