<HTML><HEAD><TITLE>[Chapter 20] 20.10 Avoid Absolute Paths with tar </TITLE><METANAME="DC.title"CONTENT="UNIX Power Tools"><METANAME="DC.creator"CONTENT="Jerry Peek, Tim O'Reilly &amp; Mike Loukides"><METANAME="DC.publisher"CONTENT="O'Reilly &amp; Associates, Inc."><METANAME="DC.date"CONTENT="1998-10-23T15:45:02Z"><METANAME="DC.type"CONTENT="Text.Monograph"><METANAME="DC.format"CONTENT="text/html"SCHEME="MIME"><METANAME="DC.source"CONTENT="1-56592-260-3"SCHEME="ISBN"><METANAME="DC.language"CONTENT="en-US"><METANAME="generator"CONTENT="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><LINKREV="made"HREF="mailto:online-books@oreilly.com"TITLE="Online Books Comments"><LINKREL="up"HREF="ch20_01.htm"TITLE="20. Backing Up Files"><LINKREL="prev"HREF="ch20_09.htm"TITLE="20.9 When a Program Doesn't Understand Wildcards "><LINKREL="next"HREF="ch20_11.htm"TITLE="20.11 Getting tar's Arguments in the Right Order "></HEAD><BODYBGCOLOR="#FFFFFF"TEXT="#000000"><DIVCLASS="htmlnav"><H1><IMGSRC="gifs/smbanner.gif"ALT="UNIX Power Tools"USEMAP="#srchmap"BORDER="0"></H1><MAPNAME="srchmap"><AREASHAPE="RECT"COORDS="0,0,466,58"HREF="index.htm"ALT="UNIX Power Tools"><AREASHAPE="RECT"COORDS="467,0,514,18"HREF="../search/psrch.htm"ALT="Search this book"></MAP><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch20_09.htm"TITLE="20.9 When a Program Doesn't Understand Wildcards "><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 20.9 When a Program Doesn't Understand Wildcards "BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><B><FONTFACE="ARIEL,HELVETICA,HELV,SANSERIF"SIZE="-1">Chapter 20<BR>Backing Up Files</FONT></B></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch20_11.htm"TITLE="20.11 Getting tar's Arguments in the Right Order "><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 20.11 Getting tar's Arguments in the Right Order "BORDER="0"></A></TD></TR></TABLE>&nbsp;<HRALIGN="LEFT"WIDTH="515"TITLE="footer"></DIV><DIVCLASS="SECT1"><H2CLASS="sect1"><ACLASS="title"NAME="UPT-ART-3691">20.10 Avoid Absolute Paths with tar </A></H2><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-22543"></A><ACLASS="indexterm"NAME="AUTOID-22546"></A>One problem with most versions of <EMCLASS="emphasis">tar</EM>:it can't change a file's pathname whenrestoring. Let's say that you put your home directory in anarchive (tape or otherwise) with a command like this:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">% <CODECLASS="userinput"><B>tar c /home/mike</B></CODE></PRE></BLOCKQUOTE></P><PCLASS="para">What will these files be named when you restore them, either on yourown system or on some other system? They will have <EMCLASS="emphasis">exactly</EM> thesame pathnames that they had originally. So if <EMCLASS="emphasis">/home/mike</EM>already exists, it will be destroyed. There's no way totell <EMCLASS="emphasis">tar</EM> that it should be careful about overwriting files; there's no way to tell <EMCLASS="emphasis">tar</EM> to put the files in some otherdirectory when it takes them off the tape, etc. If you use<SPANCLASS="link">absolute pathnames (<ACLASS="linkend"HREF="ch14_02.htm"TITLE="Using Relative and Absolute Pathnames ">14.2</A>)</SPAN>when you create a tape, you're stuck. If you use<SPANCLASS="link">relative paths (<ACLASS="linkend"HREF="ch14_02.htm"TITLE="Using Relative and Absolute Pathnames ">14.2</A>)</SPAN>(for example, <CODECLASS="literal">tar&nbsp;c&nbsp;.</CODE>), you can restore the files in any directory you want.[GNU <EMCLASS="emphasis">tar</EM> (on the CD-ROM) converts absolute pathnames torelative, by default.Most other <EMCLASS="emphasis">tar</EM>s don't do that, though, so I don't advise relyingon the feature. <EMCLASS="emphasis">-JP</EM>]</P><PCLASS="para">This means that you should:</P><ULCLASS="itemizedlist"><LICLASS="listitem"><PCLASS="para">Avoid using absolute paths when you create an archive (see below).</P></LI><LICLASS="listitem"><PCLASS="para">Use <EMCLASS="emphasis">tar&nbsp;t</EM> to see what files are on the tape before restoring thearchive.</P></LI><LICLASS="listitem"><PCLASS="para">Use GNU <EMCLASS="emphasis">tar</EM> (on the CD-ROM).It can ignore the leading <CODECLASS="literal">/</CODE> as it extracts files.</P></LI></UL><PCLASS="para">&#13;Rather than giving a command like <CODECLASS="literal">tar&nbsp;c&nbsp;/home/mike</CODE>, do something like:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">% <CODECLASS="userinput"><B>cd /home/mike</B></CODE>% <CODECLASS="userinput"><B>tar c .</B></CODE></PRE></BLOCKQUOTE></P><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-22582"></A>Or, even more elegant, use <EMCLASS="emphasis">-C</EM> on the <EMCLASS="emphasis">tar</EM> command line:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">% <CODECLASS="userinput"><B>tar c -C /home/mike .</B></CODE></PRE></BLOCKQUOTE></P><PCLASS="para">This command tells <EMCLASS="emphasis">tar</EM> to <EMCLASS="emphasis">cd</EM> to the directory<EMCLASS="emphasis">/home/mike</EM> before creating the archive.If you want to archive several directories, you can use several<EMCLASS="emphasis">-C</EM> options:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">% <CODECLASS="userinput"><B>tar c -C /home/mike ./docs  -C /home/susan ./test</B></CODE></PRE></BLOCKQUOTE></P><PCLASS="para">This command archives <EMCLASS="emphasis">mike</EM>'s <EMCLASS="emphasis">docs</EM> directory and <EMCLASS="emphasis">susan</EM>'s <EMCLASS="emphasis">test</EM> directory.</P><DIVCLASS="sect1info"><PCLASS="SECT1INFO">- <SPANCLASS="authorinitials">ML</SPAN></P></DIV></DIV><DIVCLASS="htmlnav"><P></P><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch20_09.htm"TITLE="20.9 When a Program Doesn't Understand Wildcards "><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 20.9 When a Program Doesn't Understand Wildcards "BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="book"HREF="index.htm"TITLE="UNIX Power Tools"><IMGSRC="../gifs/txthome.gif"ALT="UNIX Power Tools"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch20_11.htm"TITLE="20.11 Getting tar's Arguments in the Right Order "><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 20.11 Getting tar's Arguments in the Right Order "BORDER="0"></A></TD></TR><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172">20.9 When a Program Doesn't Understand Wildcards </TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="index"HREF="index/idx_0.htm"TITLE="Book Index"><IMGSRC="../gifs/index.gif"ALT="Book Index"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172">20.11 Getting tar's Arguments in the Right Order </TD></TR></TABLE><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><IMGSRC="../gifs/smnavbar.gif"USEMAP="#map"BORDER="0"ALT="The UNIX CD Bookshelf Navigation"><MAPNAME="map"><AREASHAPE="RECT"COORDS="0,0,73,21"HREF="../index.htm"ALT="The UNIX CD Bookshelf"><AREASHAPE="RECT"COORDS="74,0,163,21"HREF="index.htm"ALT="UNIX Power Tools"><AREASHAPE="RECT"COORDS="164,0,257,21"HREF="../unixnut/index.htm"ALT="UNIX in a Nutshell"><AREASHAPE="RECT"COORDS="258,0,321,21"HREF="../vi/index.htm"ALT="Learning the vi Editor"><AREASHAPE="RECT"COORDS="322,0,378,21"HREF="../sedawk/index.htm"ALT="sed &amp; awk"><AREASHAPE="RECT"COORDS="379,0,438,21"HREF="../ksh/index.htm"ALT="Learning the Korn Shell"><AREASHAPE="RECT"COORDS="439,0,514,21"HREF="../lrnunix/index.htm"ALT="Learning the UNIX Operating System"></MAP></DIV></BODY></HTML>