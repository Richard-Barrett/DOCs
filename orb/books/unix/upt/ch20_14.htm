<HTML><HEAD><TITLE>[Chapter 20] 20.14 RCS Basics </TITLE><METANAME="DC.title"CONTENT="UNIX Power Tools"><METANAME="DC.creator"CONTENT="Jerry Peek, Tim O'Reilly &amp; Mike Loukides"><METANAME="DC.publisher"CONTENT="O'Reilly &amp; Associates, Inc."><METANAME="DC.date"CONTENT="1998-10-23T15:45:05Z"><METANAME="DC.type"CONTENT="Text.Monograph"><METANAME="DC.format"CONTENT="text/html"SCHEME="MIME"><METANAME="DC.source"CONTENT="1-56592-260-3"SCHEME="ISBN"><METANAME="DC.language"CONTENT="en-US"><METANAME="generator"CONTENT="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><LINKREV="made"HREF="mailto:online-books@oreilly.com"TITLE="Online Books Comments"><LINKREL="up"HREF="ch20_01.htm"TITLE="20. Backing Up Files"><LINKREL="prev"HREF="ch20_13.htm"TITLE="20.13 SCCS Basics "><LINKREL="next"HREF="ch20_15.htm"TITLE="20.15 List RCS Revision Numbers with rcsrevs "></HEAD><BODYBGCOLOR="#FFFFFF"TEXT="#000000"><DIVCLASS="htmlnav"><H1><IMGSRC="gifs/smbanner.gif"ALT="UNIX Power Tools"USEMAP="#srchmap"BORDER="0"></H1><MAPNAME="srchmap"><AREASHAPE="RECT"COORDS="0,0,466,58"HREF="index.htm"ALT="UNIX Power Tools"><AREASHAPE="RECT"COORDS="467,0,514,18"HREF="../search/psrch.htm"ALT="Search this book"></MAP><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch20_13.htm"TITLE="20.13 SCCS Basics "><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 20.13 SCCS Basics "BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><B><FONTFACE="ARIEL,HELVETICA,HELV,SANSERIF"SIZE="-1">Chapter 20<BR>Backing Up Files</FONT></B></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch20_15.htm"TITLE="20.15 List RCS Revision Numbers with rcsrevs "><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 20.15 List RCS Revision Numbers with rcsrevs "BORDER="0"></A></TD></TR></TABLE>&nbsp;<HRALIGN="LEFT"WIDTH="515"TITLE="footer"></DIV><DIVCLASS="SECT1"><H2CLASS="sect1"><ACLASS="title"NAME="UPT-ART-6240">20.14 RCS Basics </A></H2><TABLECLASS="para.programreference"BORDER="1"><TR><THVALIGN="TOP"><ACLASS="programreference"HREF="examples/index.htm"TITLE="rcs">rcs</A><BR></TH><TDVALIGN="TOP">[I've patterned this article after<SPANCLASS="link">the article on SCCS (<ACLASS="linkend"HREF="ch20_13.htm"TITLE="SCCS Basics ">20.13</A>)</SPAN>by Bruce Barnett.<ACLASS="indexterm"NAME="UPT-ART-6240-IX-RCS"></A>This one shows how to do the same things with the Revision ControlSystem, RCS, which is on many systems&nbsp;- and also on the CD-ROM.-JP]</TD></TR></TABLE><PCLASS="para">You don't need to ask the system manager to restore files.You can recover any version you want with one command.Here is a simple introduction to RCS.</P><OLCLASS="orderedlist"><LICLASS="listitem"><PCLASS="para">Create a subdirectory called<EMCLASS="emphasis">RCS</EM>in the directory where you keep the code or other text filesyou want to protect.</P></LI><LICLASS="listitem"><PCLASS="para">It's a good idea (but not required) to add the characters<CODECLASS="literal">$Id$</CODE>somewhere in the file you want to place under RCS.Put this in a comment field. That is, use<CODECLASS="literal">/*&nbsp;$Id$&nbsp;*/</CODE>in a C program and<CODECLASS="literal">#&nbsp;$Id$</CODE>in a shell or Perl script.</P></LI><LICLASS="listitem"><PCLASS="para">Place the file under Revision Control. This is done by typing:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">% <CODECLASS="userinput"><B>ci</B></CODE> <CODECLASS="replaceable"><I>filename</I></CODE></PRE></BLOCKQUOTE></P><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-22777"></A>The <EMCLASS="emphasis">ci</EM> (checkin) program will prompt you for a short description of the file.That's it. You're done.There is another command and an option you need to know:<ACLASS="indexterm"NAME="AUTOID-22780"></A></P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">% <CODECLASS="userinput"><B>co</B></CODE> <CODECLASS="replaceable"><I>filename</I></CODE>% <CODECLASS="userinput"><B>co -l</B></CODE> <CODECLASS="replaceable"><I>filename</I></CODE></PRE></BLOCKQUOTE></P><PCLASS="para">The <EMCLASS="emphasis">co</EM> (checkout) command will get a copy of the file from RCS.The file will be marked read-only.If you want to edit the file, use the <EMCLASS="emphasis">co -l</EM> command (the optionis a lowercase L)-then,when you're done, return the file to the <EMCLASS="emphasis">RCS</EM> directory with the command<EMCLASS="emphasis">ci</EM>.When you check in the file, <EMCLASS="emphasis">ci</EM> asks for a brief descriptionof your changes.These can be very useful, later, to learn the history of revisions andto find a particular revision you might want to recover; the command<CODECLASS="literal">rlog</CODE><CODECLASS="replaceable"><I>&nbsp;filename</I></CODE> gives that info.</P></LI></OL><PCLASS="para">There are only two more commands that you will need to know.If you checked out a file for editing, and later on decided you didn'twant to change it, use:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">% <CODECLASS="userinput"><B>rcs -u</B></CODE> <CODECLASS="replaceable"><I>filename</I></CODE>% <CODECLASS="userinput"><B>rm</B></CODE> <CODECLASS="replaceable"><I>filename</I></CODE></PRE></BLOCKQUOTE></P><PCLASS="para">and if you want a list of all files currently checked out, use:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">% <CODECLASS="userinput"><B>rlog -L -R RCS/*</B></CODE></PRE></BLOCKQUOTE></P><PCLASS="para">(If you don't use RCS often, you may want to store those command linesin<SPANCLASS="link">aliases or shell functions (<ACLASS="linkend"HREF="ch10_01.htm#UPT-ART-4930"TITLE="Creating Custom Commands ">10.1</A>)</SPAN>with names like <EMCLASS="emphasis">Checkout</EM>,<EMCLASS="emphasis">Checkedout</EM>, and so on.)That's all there is to it!If you are not using RCS or SCCS, you should.They are the best way to protect yourself and do not require dozens oftapes.</P><PCLASS="para">It is much easier to just type:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">% <CODECLASS="userinput"><B>co -r1.12</B></CODE> <CODECLASS="replaceable"><I>filename</I></CODE></PRE></BLOCKQUOTE></P><PCLASS="para">One command, and version 1.12 is restored.If it's not the right one, restore the version before or after the oneyou just grabbed.(If you don't want to create a file, you can add the <EMCLASS="emphasis">-p</EM> option tosend the file to standard output.Pipe the <EMCLASS="emphasis">co</EM> output to another program: a pager, a printer, etc.)</P><PCLASS="para">If you are worried that you are keeping 12 versionsof the file on the disk, and that this will use up a lot of diskspace, don't. RCS stores the differences between versions, not 12separate copies of the file.It can recover any version of the file.</P><PCLASS="para">Suppose you delete a file by accident?Well, if the file is just checked out with a <EMCLASS="emphasis">co</EM>,it will be retrieved and marked read-only, so deleting the file will cause <EMCLASS="emphasis">rm</EM>to ask you for confirmation.If you do delete it, you can recover it with another<EMCLASS="emphasis">co</EM>command.Suppose you check out a file with <EMCLASS="emphasis">co -l</EM>,because you planned to change it.Well, if this file gets deleted accidentally, you would lose the mostrecent changes. This is why you should check your files back into RCSfrequently&nbsp;- several times a day or even more.Do it whenever you make significant changes to the file, and it wouldbe difficult to remember all of the changes. Making hundreds ofchanges to a file without checking it back into the system is justbegging for trouble.</P><PCLASS="para">This brief overview left out a lot of features and helpful information.For example, RCS can:</P><ULCLASS="itemizedlist"><LICLASS="listitem"><PCLASS="para">Merge two or more peoples' work into one with <EMCLASS="emphasis">rcsmerge</EM> and<EMCLASS="emphasis">co -j</EM>.</P></LI><LICLASS="listitem"><PCLASS="para">Build a tree of revisions with multiple branches and sub-branches.This lets you make and store multiple independent revisions.</P></LI><LICLASS="listitem"><PCLASS="para">Assign an arbitrary `state' to each revision&nbsp;- for example,<EMCLASS="emphasis">alpha</EM>, <EMCLASS="emphasis">released</EM>, <EMCLASS="emphasis">stable</EM>.</P></LI><LICLASS="listitem"><PCLASS="para">Name each revision, refer to revisions by name instead of number.</P></LI><LICLASS="listitem"><PCLASS="para">Keep a list of users who are allowed to manipulate a particularRCS file.</P></LI></UL><PCLASS="para">To find out more, see the RCS manual pages.<EMCLASS="emphasis">rcsintro</EM>(1) gives a more complete overview; manpages like<EMCLASS="emphasis">ci</EM>(1) have details on the many other useful features.Finally, O'Reilly &amp; Associates' <EMCLASS="emphasis">Applying RCS and SCCS</EM> is packedwith tips and techniques for using revision control in group projects(where you'll need it even more).Articles<ACLASS="xref"HREF="ch27_10.htm"TITLE="Search RCS Files with rcsgrep ">27.10</A>and<ACLASS="xref"HREF="ch20_15.htm"TITLE="List RCS Revision Numbers with rcsrevs ">20.15</A>explain tools for searching RCS files.The script in article<ACLASS="xref"HREF="ch25_05.htm"TITLE="Page Through Compressed, RCS, Unprintable Files ">25.5</A>,<EMCLASS="emphasis">rcsmore</EM> (and <EMCLASS="emphasis">rcsless</EM> and <EMCLASS="emphasis">rcspg</EM>),makes it easy to read through RCS files.</P><ACLASS="indexterm"NAME="AUTOID-22852"></A><DIVCLASS="sect1info"><PCLASS="SECT1INFO">- <SPANCLASS="authorinitials">JP</SPAN>, <SPANCLASS="authorinitials">BB</SPAN></P></DIV></DIV><DIVCLASS="htmlnav"><P></P><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch20_13.htm"TITLE="20.13 SCCS Basics "><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 20.13 SCCS Basics "BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="book"HREF="index.htm"TITLE="UNIX Power Tools"><IMGSRC="../gifs/txthome.gif"ALT="UNIX Power Tools"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch20_15.htm"TITLE="20.15 List RCS Revision Numbers with rcsrevs "><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 20.15 List RCS Revision Numbers with rcsrevs "BORDER="0"></A></TD></TR><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172">20.13 SCCS Basics </TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="index"HREF="index/idx_0.htm"TITLE="Book Index"><IMGSRC="../gifs/index.gif"ALT="Book Index"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172">20.15 List RCS Revision Numbers with rcsrevs </TD></TR></TABLE><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><IMGSRC="../gifs/smnavbar.gif"USEMAP="#map"BORDER="0"ALT="The UNIX CD Bookshelf Navigation"><MAPNAME="map"><AREASHAPE="RECT"COORDS="0,0,73,21"HREF="../index.htm"ALT="The UNIX CD Bookshelf"><AREASHAPE="RECT"COORDS="74,0,163,21"HREF="index.htm"ALT="UNIX Power Tools"><AREASHAPE="RECT"COORDS="164,0,257,21"HREF="../unixnut/index.htm"ALT="UNIX in a Nutshell"><AREASHAPE="RECT"COORDS="258,0,321,21"HREF="../vi/index.htm"ALT="Learning the vi Editor"><AREASHAPE="RECT"COORDS="322,0,378,21"HREF="../sedawk/index.htm"ALT="sed &amp; awk"><AREASHAPE="RECT"COORDS="379,0,438,21"HREF="../ksh/index.htm"ALT="Learning the Korn Shell"><AREASHAPE="RECT"COORDS="439,0,514,21"HREF="../lrnunix/index.htm"ALT="Learning the UNIX Operating System"></MAP></DIV></BODY></HTML>