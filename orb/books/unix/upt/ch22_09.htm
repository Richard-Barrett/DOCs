<HTML><HEAD><TITLE>[Chapter 22] 22.9 Protect Important Files: Make Them Unwritable </TITLE><METANAME="DC.title"CONTENT="UNIX Power Tools"><METANAME="DC.creator"CONTENT="Jerry Peek, Tim O'Reilly &amp; Mike Loukides"><METANAME="DC.publisher"CONTENT="O'Reilly &amp; Associates, Inc."><METANAME="DC.date"CONTENT="1998-08-04T21:40:30Z"><METANAME="DC.type"CONTENT="Text.Monograph"><METANAME="DC.format"CONTENT="text/html"SCHEME="MIME"><METANAME="DC.source"CONTENT="1-56592-260-3"SCHEME="ISBN"><METANAME="DC.language"CONTENT="en-US"><METANAME="generator"CONTENT="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><LINKREV="made"HREF="mailto:online-books@oreilly.com"TITLE="Online Books Comments"><LINKREL="up"HREF="ch22_01.htm"TITLE="22. File Security, Ownership, and Sharing"><LINKREL="prev"HREF="ch22_08.htm"TITLE="22.8 The Handy chmod = Operator "><LINKREL="next"HREF="ch22_10.htm"TITLE="22.10 cx, cw, c-w: Quick File Permission Changes "></HEAD><BODYBGCOLOR="#FFFFFF"TEXT="#000000"><DIVCLASS="htmlnav"><H1><IMGSRC="gifs/smbanner.gif"ALT="UNIX Power Tools"USEMAP="#srchmap"BORDER="0"></H1><MAPNAME="srchmap"><AREASHAPE="RECT"COORDS="0,0,466,58"HREF="index.htm"ALT="UNIX Power Tools"><AREASHAPE="RECT"COORDS="467,0,514,18"HREF="../search/psrch.htm"ALT="Search this book"></MAP><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch22_08.htm"TITLE="22.8 The Handy chmod = Operator "><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 22.8 The Handy chmod = Operator "BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><B><FONTFACE="ARIEL,HELVETICA,HELV,SANSERIF"SIZE="-1">Chapter 22<BR>File Security, Ownership, and Sharing</FONT></B></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch22_10.htm"TITLE="22.10 cx, cw, c-w: Quick File Permission Changes "><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 22.10 cx, cw, c-w: Quick File Permission Changes "BORDER="0"></A></TD></TR></TABLE>&nbsp;<HRALIGN="LEFT"WIDTH="515"TITLE="footer"></DIV><DIVCLASS="SECT1"><H2CLASS="sect1"><ACLASS="title"NAME="UPT-ART-0407">22.9 Protect Important Files: Make Them Unwritable </A></H2><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-24281"></A><ACLASS="indexterm"NAME="AUTOID-24285"></A><ACLASS="indexterm"NAME="AUTOID-24289"></A><ACLASS="indexterm"NAME="AUTOID-24291"></A>A good way to prevent yourself from making mistakes is to makecertain files read-only. If you try to delete a read-only file,you will get a warning. You will also get a warning if you try to movea file onto another file that is write&nbsp;- protected. If you know you want to remove or move a file, even though the file isread-only, you can use the <EMCLASS="emphasis">-f</EM>option with<EMCLASS="emphasis">rm</EM>or<EMCLASS="emphasis">mv</EM>to <EMCLASS="emphasis">force</EM>the change without warnings.</P><PCLASS="para">Manually changing the permissions of files all the time is counterproductive. You could create two aliases to make it easier to type:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">&#13;# change mode to read only alias -w chmod -w# change mode to add write permissionalias +w chmod u+w</PRE></BLOCKQUOTE></P><PCLASS="para">[These are really handy!I use a script named <EMCLASS="emphasis">c-w</EM> and <EMCLASS="emphasis">cw</EM>, respectively, instead.For shell programming, I also added <EMCLASS="emphasis">cx</EM> that does <EMCLASS="emphasis">chmod +x</EM>.Article<ACLASS="xref"HREF="ch22_10.htm"TITLE="cx, cw, c-w: Quick File Permission Changes ">22.10</A>explains the script. <EMCLASS="emphasis">-JP</EM>&nbsp;]It is a good idea to remove write permission from some files.Occasionally some files contain information difficult to replace.These files might be included with other, easily replaceable files.Or you might want to protect some files that rarely change.Combined with directory permissions, and the current value of<SPANCLASS="link"><EMCLASS="emphasis">umask</EM> (<ACLASS="linkend"HREF="ch22_04.htm"TITLE="Setting an Exact umask ">22.4</A>)</SPAN>,you can find some file that might be protected in this manner.You can always create a script that adds write permission, edits thefile, and removes write permission:</P><PCLASS="para"><TABLECLASS="screen.co"BORDER="1"><TR><THVALIGN="TOP"><PRECLASS="calloutlist">&#13;<ACLASS="co"HREF="ch44_15.htm"TITLE="44.15 Handling Command-Line Arguments in Shell Scripts ">&quot;$@&quot;</A> <ACLASS="co"HREF="ch45_12.htm"TITLE="45.12 Parameter Substitution ">${..=..}</A> &#13;</PRE></TH><TDVALIGN="TOP"><PRECLASS="screen">&#13;#!/bin/sh# add write permission to the fileschmod u+w &quot;$@&quot;# edit the files; use vi if VISUAL not defined${VISUAL=vi} &quot;$@&quot;# remove write permissionchmod -w &quot;$@&quot;</PRE></TD></TR></TABLE></P><DIVCLASS="sect1info"><PCLASS="SECT1INFO">- <SPANCLASS="authorinitials">BB</SPAN></P></DIV></DIV><DIVCLASS="htmlnav"><P></P><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch22_08.htm"TITLE="22.8 The Handy chmod = Operator "><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 22.8 The Handy chmod = Operator "BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="book"HREF="index.htm"TITLE="UNIX Power Tools"><IMGSRC="../gifs/txthome.gif"ALT="UNIX Power Tools"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch22_10.htm"TITLE="22.10 cx, cw, c-w: Quick File Permission Changes "><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 22.10 cx, cw, c-w: Quick File Permission Changes "BORDER="0"></A></TD></TR><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172">22.8 The Handy chmod = Operator </TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="index"HREF="index/idx_0.htm"TITLE="Book Index"><IMGSRC="../gifs/index.gif"ALT="Book Index"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172">22.10 cx, cw, c-w: Quick File Permission Changes </TD></TR></TABLE><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><IMGSRC="../gifs/smnavbar.gif"USEMAP="#map"BORDER="0"ALT="The UNIX CD Bookshelf Navigation"><MAPNAME="map"><AREASHAPE="RECT"COORDS="0,0,73,21"HREF="../index.htm"ALT="The UNIX CD Bookshelf"><AREASHAPE="RECT"COORDS="74,0,163,21"HREF="index.htm"ALT="UNIX Power Tools"><AREASHAPE="RECT"COORDS="164,0,257,21"HREF="../unixnut/index.htm"ALT="UNIX in a Nutshell"><AREASHAPE="RECT"COORDS="258,0,321,21"HREF="../vi/index.htm"ALT="Learning the vi Editor"><AREASHAPE="RECT"COORDS="322,0,378,21"HREF="../sedawk/index.htm"ALT="sed &amp; awk"><AREASHAPE="RECT"COORDS="379,0,438,21"HREF="../ksh/index.htm"ALT="Learning the Korn Shell"><AREASHAPE="RECT"COORDS="439,0,514,21"HREF="../lrnunix/index.htm"ALT="Learning the UNIX Operating System"></MAP></DIV></BODY></HTML>