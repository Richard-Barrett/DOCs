<HTML><HEAD><TITLE>[Chapter 23] 23.8 Safe Delete: Pros and Cons </TITLE><METANAME="DC.title"CONTENT="UNIX Power Tools"><METANAME="DC.creator"CONTENT="Jerry Peek, Tim O'Reilly &amp; Mike Loukides"><METANAME="DC.publisher"CONTENT="O'Reilly &amp; Associates, Inc."><METANAME="DC.date"CONTENT="1998-08-04T21:41:04Z"><METANAME="DC.type"CONTENT="Text.Monograph"><METANAME="DC.format"CONTENT="text/html"SCHEME="MIME"><METANAME="DC.source"CONTENT="1-56592-260-3"SCHEME="ISBN"><METANAME="DC.language"CONTENT="en-US"><METANAME="generator"CONTENT="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><LINKREV="made"HREF="mailto:online-books@oreilly.com"TITLE="Online Books Comments"><LINKREL="up"HREF="ch23_01.htm"TITLE="23. Removing Files"><LINKREL="prev"HREF="ch23_07.htm"TITLE="23.7 Safer File Deletion in Some Directories "><LINKREL="next"HREF="ch23_09.htm"TITLE="23.9 delete: Protecting Files from Accidental Deletion "></HEAD><BODYBGCOLOR="#FFFFFF"TEXT="#000000"><DIVCLASS="htmlnav"><H1><IMGSRC="gifs/smbanner.gif"ALT="UNIX Power Tools"USEMAP="#srchmap"BORDER="0"></H1><MAPNAME="srchmap"><AREASHAPE="RECT"COORDS="0,0,466,58"HREF="index.htm"ALT="UNIX Power Tools"><AREASHAPE="RECT"COORDS="467,0,514,18"HREF="../search/psrch.htm"ALT="Search this book"></MAP><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch23_07.htm"TITLE="23.7 Safer File Deletion in Some Directories "><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 23.7 Safer File Deletion in Some Directories "BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><B><FONTFACE="ARIEL,HELVETICA,HELV,SANSERIF"SIZE="-1">Chapter 23<BR>Removing Files</FONT></B></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch23_09.htm"TITLE="23.9 delete: Protecting Files from Accidental Deletion "><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 23.9 delete: Protecting Files from Accidental Deletion "BORDER="0"></A></TD></TR></TABLE>&nbsp;<HRALIGN="LEFT"WIDTH="515"TITLE="footer"></DIV><DIVCLASS="SECT1"><H2CLASS="sect1"><ACLASS="title"NAME="UPT-ART-0391">23.8 Safe Delete: Pros and Cons </A></H2><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-25426"></A>To protect themselves from accidentally deleting files, some userscreate a &quot;trash&quot; directory somewhere, and then write a &quot;safe delete&quot;program that, instead of <EMCLASS="emphasis">rm</EM>ing a file, moves it into the<EMCLASS="emphasis">trash</EM> directory. The implementation can be quite complex,but a simple alias will do most of what you want:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">alias del &quot;mv \!* ~/trash&quot;</PRE></BLOCKQUOTE></P><PCLASS="para">Of course, now your deleted files collect in your <EMCLASS="emphasis">trash</EM>directory, so you have to clean that out from time to time. You cando this either by hand or automatically, via a<SPANCLASS="link"><EMCLASS="emphasis">cron</EM> (<ACLASS="linkend"HREF="ch40_12.htm"TITLE="Periodic Program Execution: The cron Facility ">40.12</A>)</SPAN>entry like:</P><PCLASS="para"><TABLECLASS="screen.co"BORDER="1"><TR><THVALIGN="TOP"><PRECLASS="calloutlist"><ACLASS="co"HREF="ch44_09.htm"TITLE="44.9 Testing Your Success ">&amp;&amp;</A> <ACLASS="co"HREF="ch23_17.htm"TITLE="23.17 Problems Deleting Directories ">-r</A> </PRE></TH><TDVALIGN="TOP"><PRECLASS="screen">23 2 * * * cd $HOME/trash &amp;&amp; rm -rf *</PRE></TD></TR></TABLE></P><PCLASS="para">This deletes everything in the trash directory at 2:23 a.m. daily.To restore a file that you deleted, you have to look through yourtrash directory by hand and put the file back in the right place.That may not be much more pleasant than poking through your garbage tofind the tax return you threw out by mistake, but (hopefully) youdon't make lots of mistakes.</P><PCLASS="para">There are plenty of problems with this approach. Obviously, if youdelete two files with the same name in the same day, you're going tolose one of them. A shell script could (presumably) handle thisproblem, though you'd have to generate a new name for the deletedfile. There are also lots of nasty side effects and &quot;gotchas,&quot;particularly if you want an <EMCLASS="emphasis">rm -r</EM> equivalent, ifyou want this approach to work on a network of workstations, or if youuse it to delete files that are shared by a team of users.</P><PCLASS="para">Unfortunately, this is precisely the problem. A &quot;safe delete&quot; thatisn't really safe may not be worth the effort. A safety net withholes in it is only good if you can guarantee in advance that youwon't land in one of the holes. You can patch some of the holes byreplacing this simple alias with a shell script. But you can't fixall of them. For a real solution, see Jonathan Kamens'article on<SPANCLASS="link"><EMCLASS="emphasis">delete</EM> (<ACLASS="linkend"HREF="ch23_09.htm"TITLE="delete: Protecting Files from Accidental Deletion ">23.9</A>)</SPAN>.</P><DIVCLASS="sect1info"><PCLASS="SECT1INFO">- <SPANCLASS="authorinitials">ML</SPAN></P></DIV></DIV><DIVCLASS="htmlnav"><P></P><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch23_07.htm"TITLE="23.7 Safer File Deletion in Some Directories "><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 23.7 Safer File Deletion in Some Directories "BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="book"HREF="index.htm"TITLE="UNIX Power Tools"><IMGSRC="../gifs/txthome.gif"ALT="UNIX Power Tools"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch23_09.htm"TITLE="23.9 delete: Protecting Files from Accidental Deletion "><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 23.9 delete: Protecting Files from Accidental Deletion "BORDER="0"></A></TD></TR><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172">23.7 Safer File Deletion in Some Directories </TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="index"HREF="index/idx_0.htm"TITLE="Book Index"><IMGSRC="../gifs/index.gif"ALT="Book Index"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172">23.9 delete: Protecting Files from Accidental Deletion </TD></TR></TABLE><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><IMGSRC="../gifs/smnavbar.gif"USEMAP="#map"BORDER="0"ALT="The UNIX CD Bookshelf Navigation"><MAPNAME="map"><AREASHAPE="RECT"COORDS="0,0,73,21"HREF="../index.htm"ALT="The UNIX CD Bookshelf"><AREASHAPE="RECT"COORDS="74,0,163,21"HREF="index.htm"ALT="UNIX Power Tools"><AREASHAPE="RECT"COORDS="164,0,257,21"HREF="../unixnut/index.htm"ALT="UNIX in a Nutshell"><AREASHAPE="RECT"COORDS="258,0,321,21"HREF="../vi/index.htm"ALT="Learning the vi Editor"><AREASHAPE="RECT"COORDS="322,0,378,21"HREF="../sedawk/index.htm"ALT="sed &amp; awk"><AREASHAPE="RECT"COORDS="379,0,438,21"HREF="../ksh/index.htm"ALT="Learning the Korn Shell"><AREASHAPE="RECT"COORDS="439,0,514,21"HREF="../lrnunix/index.htm"ALT="Learning the UNIX Operating System"></MAP></DIV></BODY></HTML>