<HTML><HEAD><TITLE>[Chapter 24] Other Ways to Get Disk Space</TITLE><METANAME="DC.title"CONTENT="UNIX Power Tools"><METANAME="DC.creator"CONTENT="Jerry Peek, Tim O'Reilly &amp; Mike Loukides"><METANAME="DC.publisher"CONTENT="O'Reilly &amp; Associates, Inc."><METANAME="DC.date"CONTENT="1998-08-04T21:41:25Z"><METANAME="DC.type"CONTENT="Text.Monograph"><METANAME="DC.format"CONTENT="text/html"SCHEME="MIME"><METANAME="DC.source"CONTENT="1-56592-260-3"SCHEME="ISBN"><METANAME="DC.language"CONTENT="en-US"><METANAME="generator"CONTENT="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><LINKREV="made"HREF="mailto:online-books@oreilly.com"TITLE="Online Books Comments"><LINKREL="up"HREF="part03.htm"TITLE="III. Working with the Filesystem "><LINKREL="prev"HREF="ch23_22.htm"TITLE="23.22 Using find to Clear Out Unneeded Files "><LINKREL="next"HREF="ch24_02.htm"TITLE="24.2 Save Space with Bit Bucket Log Files and Mailboxes"></HEAD><BODYBGCOLOR="#FFFFFF"TEXT="#000000"><DIVCLASS="htmlnav"><H1><IMGSRC="gifs/smbanner.gif"ALT="UNIX Power Tools"USEMAP="#srchmap"BORDER="0"></H1><MAPNAME="srchmap"><AREASHAPE="RECT"COORDS="0,0,466,58"HREF="index.htm"ALT="UNIX Power Tools"><AREASHAPE="RECT"COORDS="467,0,514,18"HREF="../search/psrch.htm"ALT="Search this book"></MAP><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch23_22.htm"TITLE="23.22 Using find to Clear Out Unneeded Files "><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 23.22 Using find to Clear Out Unneeded Files "BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><B><FONTFACE="ARIEL,HELVETICA,HELV,SANSERIF"SIZE="-1">Chapter 24</FONT></B></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch24_02.htm"TITLE="24.2 Save Space with Bit Bucket Log Files and Mailboxes"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 24.2 Save Space with Bit Bucket Log Files and Mailboxes"BORDER="0"></A></TD></TR></TABLE>&nbsp;<HRALIGN="LEFT"WIDTH="515"TITLE="footer"></DIV><DIVCLASS="CHAPTER"><H1CLASS="chapter"><ACLASS="title"NAME="UPT-CHP-24">24. Other Ways to Get Disk Space</A></H1><DIVCLASS="htmltoc"><P><B>Contents:</B><BR><ACLASS="sect1"HREF="#UPT-ART-1730"TITLE="24.1 Instead of Removing a File, Empty It ">Instead of Removing a File, Empty It </A><BR><ACLASS="sect1"HREF="ch24_02.htm"TITLE="24.2 Save Space with Bit Bucket Log Files and Mailboxes">Save Space with Bit Bucket Log Files and Mailboxes</A><BR><ACLASS="sect1"HREF="ch24_03.htm"TITLE="24.3 Unlinking Open Files Isn't a Good Idea ">Unlinking Open Files Isn't a Good Idea </A><BR><ACLASS="sect1"HREF="ch24_04.htm"TITLE="24.4 Save Space with a Link ">Save Space with a Link </A><BR><ACLASS="sect1"HREF="ch24_05.htm"TITLE="24.5 Limiting File Sizes ">Limiting File Sizes </A><BR><ACLASS="sect1"HREF="ch24_06.htm"TITLE="24.6 Save Space with Tab Characters ">Save Space with Tab Characters </A><BR><ACLASS="sect1"HREF="ch24_07.htm"TITLE="24.7 Compressing Files to Save Space ">Compressing Files to Save Space </A><BR><ACLASS="sect1"HREF="ch24_08.htm"TITLE="24.8 Save Space: tar and compress a Directory Tree ">Save Space: tar and compress a Directory Tree </A><BR><ACLASS="sect1"HREF="ch24_09.htm"TITLE="24.9 How Much Disk Space? ">How Much Disk Space? </A><BR><ACLASS="sect1"HREF="ch24_10.htm"TITLE="24.10 zloop: Run a Command on Compressed Files ">zloop: Run a Command on Compressed Files </A><BR><ACLASS="sect1"HREF="ch24_11.htm"TITLE="24.11 Edit Compressed Files with zvi, zex, and zed ">Edit Compressed Files with zvi, zex, and zed </A><BR><ACLASS="sect1"HREF="ch24_12.htm"TITLE="24.12 Compressing a Directory Tree: Fine-Tuning ">Compressing a Directory Tree: Fine-Tuning </A><BR><ACLASS="sect1"HREF="ch24_13.htm"TITLE="24.13 Save Space in Executable Files with strip ">Save Space in Executable Files with strip </A><BR><ACLASS="sect1"HREF="ch24_14.htm"TITLE="24.14 Don't Use strip Carelessly ">Don't Use strip Carelessly </A><BR><ACLASS="sect1"HREF="ch24_15.htm"TITLE="24.15 Trimming a Directory ">Trimming a Directory </A><BR><ACLASS="sect1"HREF="ch24_16.htm"TITLE="24.16 Trimming a Huge Directory ">Trimming a Huge Directory </A><BR><ACLASS="sect1"HREF="ch24_17.htm"TITLE="24.17 Disk Quotas ">Disk Quotas </A><BR><ACLASS="sect1"HREF="ch24_18.htm"TITLE="24.18 Huge Files Might Not Take a Lot of Disk Space ">Huge Files Might Not Take a Lot of Disk Space </A></P><P></P></DIV><DIVCLASS="sect1"><H2CLASS="sect1"><ACLASS="title"NAME="UPT-ART-1730">24.1 Instead of Removing a File, Empty It </A></H2><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-26153"></A><ACLASS="indexterm"NAME="AUTOID-26156"></A><ACLASS="indexterm"NAME="AUTOID-26158"></A><ACLASS="indexterm"NAME="AUTOID-26161"></A>Sometimes you don't want to remove a file completely&nbsp;- you just want toempty it:</P><ULCLASS="itemizedlist"><LICLASS="listitem"><PCLASS="para">When you remove a file and create a new one with the same name, thenew file will have your<SPANCLASS="link">default permissions (<ACLASS="linkend"HREF="ch22_04.htm"TITLE="Setting an Exact umask ">22.4</A>)</SPAN>and<SPANCLASS="link">ownership (<ACLASS="linkend"HREF="ch22_03.htm"TITLE="Who Will Own a New File? ">22.3</A>)</SPAN>.It's better to empty the file now, then add new text later; this won'tchange the permissions and ownership.</P></LI><LICLASS="listitem"><PCLASS="para">Completely empty files (ones that <EMCLASS="emphasis">ls -l</EM> says have zero characters)don't take any disk space to store(except the few bytes that the<SPANCLASS="link">directory entry (<ACLASS="linkend"HREF="ch18_02.htm"TITLE="What's Really in a Directory ">18.2</A>)</SPAN>uses).</P></LI><LICLASS="listitem"><PCLASS="para">You can use the empty files as &quot;place markers&quot; to remind you thatsomething was there or belongs there.Some UNIX logging programs won't write errorsto their log files unless thelog files already exist.Empty files work fine for that.</P></LI><LICLASS="listitem"><PCLASS="para">Empty files hold a &quot;timestamp&quot; (just as files with text do)that shows when the file was last modified.I use empty files in some directories to remind me when I've last donesomething (backups,<SPANCLASS="link">printouts (<ACLASS="linkend"HREF="ch21_09.htm"TITLE="Keep File Printouts Up-to-Date Automatically with make">21.9</A>)</SPAN>,etc.).The<SPANCLASS="link"><EMCLASS="emphasis">find -newer</EM> (<ACLASS="linkend"HREF="ch17_08.htm"TITLE="Exact File Time Comparisons ">17.8</A>, <ACLASS="linkend"HREF="ch17_09.htm"TITLE="Problems with -newer ">17.9</A>)</SPAN>command can compare other files to a timestamp file.</P></LI></UL><PCLASS="para">Well, you get the idea by now.</P><PCLASS="para">How can you empty a file?Watch out: when some editors say that a file has &quot;nolines,&quot; they may still append a newline character when writing the file.Just one character still takes a block of disk space to store.Better:</P><ULCLASS="itemizedlist"><LICLASS="listitem"><PCLASS="para">In the Bourne shell, the most efficient way is to redirect the output ofa null command:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">$ <CODECLASS="userinput"><B>&gt; afile</B></CODE></PRE></BLOCKQUOTE></P><PCLASS="para">&#13;If the file already exists, that command will truncate the file withoutneeding a subprocess.</P></LI><LICLASS="listitem"><PCLASS="para">In the C shell copy the UNIX empty file,<SPANCLASS="link"><EMCLASS="emphasis">/dev/null</EM> (<ACLASS="linkend"HREF="ch13_14.htm"TITLE="What Can You Do with an Empty File? ">13.14</A>)</SPAN>,on top of the file:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">% <CODECLASS="userinput"><B>cp /dev/null afile</B></CODE></PRE></BLOCKQUOTE></P></LI></UL><PCLASS="para">You can also &quot;almost&quot; empty the file, leaving just a few lines, this way:</P><PCLASS="para"><TABLECLASS="screen.co"BORDER="1"><TR><THVALIGN="TOP"><PRECLASS="calloutlist"><ACLASS="co"HREF="ch25_14.htm"TITLE="25.14 How to Look at the End of a File: tail ">tail</A> &#13;</PRE></TH><TDVALIGN="TOP"><PRECLASS="screen">% <CODECLASS="userinput"><B>tail afile &gt; tmpfile</B></CODE>% <CODECLASS="userinput"><B>cat tmpfile &gt; afile</B></CODE>% <CODECLASS="userinput"><B>rm tmpfile</B></CODE></PRE></TD></TR></TABLE></P><PCLASS="para">That's especially good for log files that you never want to deletecompletely.Use <EMCLASS="emphasis">cat</EM> and <EMCLASS="emphasis">rm</EM>, not <EMCLASS="emphasis">mv</EM>-<EMCLASS="emphasis">mv</EM> will break the link tothe original file (<CODECLASS="literal">afile</CODE>) and replace it with the temporary file.</P><DIVCLASS="sect1info"><PCLASS="SECT1INFO">- <SPANCLASS="authorinitials">JP</SPAN></P></DIV></DIV></DIV><DIVCLASS="htmlnav"><P></P><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch23_22.htm"TITLE="23.22 Using find to Clear Out Unneeded Files "><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 23.22 Using find to Clear Out Unneeded Files "BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="book"HREF="index.htm"TITLE="UNIX Power Tools"><IMGSRC="../gifs/txthome.gif"ALT="UNIX Power Tools"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch24_02.htm"TITLE="24.2 Save Space with Bit Bucket Log Files and Mailboxes"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 24.2 Save Space with Bit Bucket Log Files and Mailboxes"BORDER="0"></A></TD></TR><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172">23.22 Using find to Clear Out Unneeded Files </TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="index"HREF="index/idx_0.htm"TITLE="Book Index"><IMGSRC="../gifs/index.gif"ALT="Book Index"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172">24.2 Save Space with Bit Bucket Log Files and Mailboxes</TD></TR></TABLE><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><IMGSRC="../gifs/smnavbar.gif"USEMAP="#map"BORDER="0"ALT="The UNIX CD Bookshelf Navigation"><MAPNAME="map"><AREASHAPE="RECT"COORDS="0,0,73,21"HREF="../index.htm"ALT="The UNIX CD Bookshelf"><AREASHAPE="RECT"COORDS="74,0,163,21"HREF="index.htm"ALT="UNIX Power Tools"><AREASHAPE="RECT"COORDS="164,0,257,21"HREF="../unixnut/index.htm"ALT="UNIX in a Nutshell"><AREASHAPE="RECT"COORDS="258,0,321,21"HREF="../vi/index.htm"ALT="Learning the vi Editor"><AREASHAPE="RECT"COORDS="322,0,378,21"HREF="../sedawk/index.htm"ALT="sed &amp; awk"><AREASHAPE="RECT"COORDS="379,0,438,21"HREF="../ksh/index.htm"ALT="Learning the Korn Shell"><AREASHAPE="RECT"COORDS="439,0,514,21"HREF="../lrnunix/index.htm"ALT="Learning the UNIX Operating System"></MAP></DIV></BODY></HTML>