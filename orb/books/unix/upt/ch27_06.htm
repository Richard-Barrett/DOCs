<HTML><HEAD><TITLE>[Chapter 27] 27.6 Fast grep Isn't </TITLE><METANAME="DC.title"CONTENT="UNIX Power Tools"><METANAME="DC.creator"CONTENT="Jerry Peek, Tim O'Reilly &amp; Mike Loukides"><METANAME="DC.publisher"CONTENT="O'Reilly &amp; Associates, Inc."><METANAME="DC.date"CONTENT="1998-08-04T21:44:22Z"><METANAME="DC.type"CONTENT="Text.Monograph"><METANAME="DC.format"CONTENT="text/html"SCHEME="MIME"><METANAME="DC.source"CONTENT="1-56592-260-3"SCHEME="ISBN"><METANAME="DC.language"CONTENT="en-US"><METANAME="generator"CONTENT="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><LINKREV="made"HREF="mailto:online-books@oreilly.com"TITLE="Online Books Comments"><LINKREL="up"HREF="ch27_01.htm"TITLE="27. Searching Through Files"><LINKREL="prev"HREF="ch27_05.htm"TITLE="27.5 Extended Searching for Text with egrep "><LINKREL="next"HREF="ch27_07.htm"TITLE="27.7 grepping for a List of Patterns "></HEAD><BODYBGCOLOR="#FFFFFF"TEXT="#000000"><DIVCLASS="htmlnav"><H1><IMGSRC="gifs/smbanner.gif"ALT="UNIX Power Tools"USEMAP="#srchmap"BORDER="0"></H1><MAPNAME="srchmap"><AREASHAPE="RECT"COORDS="0,0,466,58"HREF="index.htm"ALT="UNIX Power Tools"><AREASHAPE="RECT"COORDS="467,0,514,18"HREF="../search/psrch.htm"ALT="Search this book"></MAP><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch27_05.htm"TITLE="27.5 Extended Searching for Text with egrep "><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 27.5 Extended Searching for Text with egrep "BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><B><FONTFACE="ARIEL,HELVETICA,HELV,SANSERIF"SIZE="-1">Chapter 27<BR>Searching Through Files</FONT></B></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch27_07.htm"TITLE="27.7 grepping for a List of Patterns "><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 27.7 grepping for a List of Patterns "BORDER="0"></A></TD></TR></TABLE>&nbsp;<HRALIGN="LEFT"WIDTH="515"TITLE="footer"></DIV><DIVCLASS="SECT1"><H2CLASS="sect1"><ACLASS="title"NAME="UPT-ART-7954">27.6 Fast grep Isn't </A></H2><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-30130"></A><ACLASS="indexterm"NAME="AUTOID-30134"></A><ACLASS="indexterm"NAME="AUTOID-30137"></A>Have you heard this old saw:<BLOCKQUOTECLASS="blockquote"><PCLASS="para">UNIX beginners use <EMCLASS="emphasis">grep</EM> because it's all they know about.</P><PCLASS="para">Intermediate users use <EMCLASS="emphasis">fgrep</EM> because the manual says it'sfaster.</P><PCLASS="para">Advanced users use <EMCLASS="emphasis">egrep</EM> because they've tried it.</P></BLOCKQUOTE></P><PCLASS="para">Yes, despite what the manual page says (or rather, used to say, becausenowadays, many <EMCLASS="emphasis">grep</EM> manual pages have been rewritten toacknowledge the fact), <EMCLASS="emphasis">fgrep</EM> is usually the slowest of thethree standard <EMCLASS="emphasis">grep</EM>s. [I believe that <EMCLASS="emphasis">fgrep</EM> stands for &quot;fixed <EMCLASS="emphasis">grep</EM>&quot;because it doesn't accept metacharacters. <EMCLASS="emphasis">-JP</EM>]</P><PCLASS="para">If you want to prove this to yourself, try using the <EMCLASS="emphasis">runtime</EM> program (shown in article<ACLASS="xref"HREF="ch39_04.htm"TITLE="Average Command Runtimes with runtime ">39.4</A>)to give you the average execution time of a search.Here's the result of mysearch for the string <EMCLASS="emphasis">Waldo</EM> in a large directory crowded withsaved mail files.</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">% <CODECLASS="userinput"><B>runtime -10 grep Waldo  *</B></CODE>   ...AVERAGES: 4.13u  0.83s 0:04 0+203k 21+0io 19pf+0w % <CODECLASS="userinput"><B>runtime -10 fgrep Waldo *</B></CODE>   ...AVERAGES: 5.19u  0.80s 0:05 0+195k 4+0io 2pf+0w % <CODECLASS="userinput"><B>runtime -10 egrep Waldo *</B></CODE>   ...AVERAGES: 2.61u  0.76s 0:02 0+244k 0+0io 0pf+0w</PRE></BLOCKQUOTE></P><PCLASS="para">On my SPARCstation IPC, <EMCLASS="emphasis">grep</EM> managed the search in four seconds,<EMCLASS="emphasis">fgrep</EM> in five, and <EMCLASS="emphasis">egrep</EM> in only two. <EMCLASS="emphasis">egrep</EM> also usedthe least CPU time.</P><PCLASS="para">Just for the heck of it, let's see how some other search programsstack up. <EMCLASS="emphasis">sed</EM>, <EMCLASS="emphasis">awk</EM>, and <EMCLASS="emphasis">perl</EM> can also emulate theaction of <EMCLASS="emphasis">grep</EM>:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">% <CODECLASS="userinput"><B>runtime -10 sed -n '/Waldo/p' *</B></CODE>   ...AVERAGES: 3.64u  1.20s 0:04 0+227k 2+0io 1pf+0w % <CODECLASS="userinput"><B>runtime -10 awk '/Waldo/' *</B></CODE>   ...AVERAGES: 4.86u  0.76s 0:05 0+279k 1+0io 0pf+0w % <CODECLASS="userinput"><B>runtime -10 perl -ne \'print if \(/Waldo/\) \; \' *</B></CODE>   ...AVERAGES: 2.94u  0.69s 0:03 0+498k 28+4io 27pf+0w</PRE></BLOCKQUOTE></P><PCLASS="para">(Note that we have to escape any characters that the shell mightinterpret in the <EMCLASS="emphasis">perl</EM> command line.)</P><PCLASS="para"><EMCLASS="emphasis">perl</EM> is faster than all but <EMCLASS="emphasis">egrep</EM>, but even <EMCLASS="emphasis">sed</EM>edges your basic <EMCLASS="emphasis">grep</EM> by a hair.And <EMCLASS="emphasis">fgrep</EM> is by far the slowest&nbsp;- it even lost to <EMCLASS="emphasis">awk</EM>!</P><TABLECLASS="para.programreference"BORDER="1"><TR><THVALIGN="TOP"><ACLASS="programreference"HREF="examples/index.htm"TITLE="fgrep">fgrep</A><BR></TH><TDVALIGN="TOP">&#13;This doesn't mean that <EMCLASS="emphasis">fgrep</EM> is useless, though.It has acouple of handy options:<EMCLASS="emphasis">-x</EM> requires a line to be exactly the same as the search pattern;<SPANCLASS="link"><EMCLASS="emphasis">-f</EM> (<ACLASS="linkend"HREF="ch27_07.htm"TITLE="grepping for a List of Patterns ">27.7</A>)</SPAN>takes one or many search patterns from a file.You can sometimes exploit the fact that <EMCLASS="emphasis">fgrep</EM> doesn't understandregular expressions, and so using it to search for literal asterisksor other regular expression metacharacters can save you a bit ofquoting.The time saved on the command line can be worth the slowerexecution speed.</TD></TR></TABLE><DIVCLASS="sect1info"><PCLASS="SECT1INFO">- <SPANCLASS="authorinitials">TOR</SPAN></P></DIV></DIV><DIVCLASS="htmlnav"><P></P><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch27_05.htm"TITLE="27.5 Extended Searching for Text with egrep "><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 27.5 Extended Searching for Text with egrep "BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="book"HREF="index.htm"TITLE="UNIX Power Tools"><IMGSRC="../gifs/txthome.gif"ALT="UNIX Power Tools"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch27_07.htm"TITLE="27.7 grepping for a List of Patterns "><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 27.7 grepping for a List of Patterns "BORDER="0"></A></TD></TR><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172">27.5 Extended Searching for Text with egrep </TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="index"HREF="index/idx_0.htm"TITLE="Book Index"><IMGSRC="../gifs/index.gif"ALT="Book Index"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172">27.7 grepping for a List of Patterns </TD></TR></TABLE><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><IMGSRC="../gifs/smnavbar.gif"USEMAP="#map"BORDER="0"ALT="The UNIX CD Bookshelf Navigation"><MAPNAME="map"><AREASHAPE="RECT"COORDS="0,0,73,21"HREF="../index.htm"ALT="The UNIX CD Bookshelf"><AREASHAPE="RECT"COORDS="74,0,163,21"HREF="index.htm"ALT="UNIX Power Tools"><AREASHAPE="RECT"COORDS="164,0,257,21"HREF="../unixnut/index.htm"ALT="UNIX in a Nutshell"><AREASHAPE="RECT"COORDS="258,0,321,21"HREF="../vi/index.htm"ALT="Learning the vi Editor"><AREASHAPE="RECT"COORDS="322,0,378,21"HREF="../sedawk/index.htm"ALT="sed &amp; awk"><AREASHAPE="RECT"COORDS="379,0,438,21"HREF="../ksh/index.htm"ALT="Learning the Korn Shell"><AREASHAPE="RECT"COORDS="439,0,514,21"HREF="../lrnunix/index.htm"ALT="Learning the UNIX Operating System"></MAP></DIV></BODY></HTML>