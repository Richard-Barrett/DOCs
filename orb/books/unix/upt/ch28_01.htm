<HTML><HEAD><TITLE>[Chapter 28] Comparing Files</TITLE><METANAME="DC.title"CONTENT="UNIX Power Tools"><METANAME="DC.creator"CONTENT="Jerry Peek, Tim O'Reilly &amp; Mike Loukides"><METANAME="DC.publisher"CONTENT="O'Reilly &amp; Associates, Inc."><METANAME="DC.date"CONTENT="1998-08-04T21:44:41Z"><METANAME="DC.type"CONTENT="Text.Monograph"><METANAME="DC.format"CONTENT="text/html"SCHEME="MIME"><METANAME="DC.source"CONTENT="1-56592-260-3"SCHEME="ISBN"><METANAME="DC.language"CONTENT="en-US"><METANAME="generator"CONTENT="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><LINKREV="made"HREF="mailto:online-books@oreilly.com"TITLE="Online Books Comments"><LINKREL="up"HREF="part04.htm"TITLE="IV. Looking Inside Files "><LINKREL="prev"HREF="ch27_20.htm"TITLE="27.20 A Highlighting grep "><LINKREL="next"HREF="ch28_02.htm"TITLE="28.2 Comparing Three Different Versions with diff3 "></HEAD><BODYBGCOLOR="#FFFFFF"TEXT="#000000"><DIVCLASS="htmlnav"><H1><IMGSRC="gifs/smbanner.gif"ALT="UNIX Power Tools"USEMAP="#srchmap"BORDER="0"></H1><MAPNAME="srchmap"><AREASHAPE="RECT"COORDS="0,0,466,58"HREF="index.htm"ALT="UNIX Power Tools"><AREASHAPE="RECT"COORDS="467,0,514,18"HREF="../search/psrch.htm"ALT="Search this book"></MAP><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch27_20.htm"TITLE="27.20 A Highlighting grep "><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 27.20 A Highlighting grep "BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><B><FONTFACE="ARIEL,HELVETICA,HELV,SANSERIF"SIZE="-1">Chapter 28</FONT></B></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch28_02.htm"TITLE="28.2 Comparing Three Different Versions with diff3 "><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 28.2 Comparing Three Different Versions with diff3 "BORDER="0"></A></TD></TR></TABLE>&nbsp;<HRALIGN="LEFT"WIDTH="515"TITLE="footer"></DIV><DIVCLASS="CHAPTER"><H1CLASS="chapter"><ACLASS="title"NAME="UPT-CHP-28">28. Comparing Files</A></H1><DIVCLASS="htmltoc"><P><B>Contents:</B><BR><ACLASS="sect1"HREF="#UPT-ART-2680"TITLE="28.1 Checking Differences with diff ">Checking Differences with diff </A><BR><ACLASS="sect1"HREF="ch28_02.htm"TITLE="28.2 Comparing Three Different Versions with diff3 ">Comparing Three Different Versions with diff3 </A><BR><ACLASS="sect1"HREF="ch28_03.htm"TITLE="28.3 Context diffs ">Context diffs </A><BR><ACLASS="sect1"HREF="ch28_04.htm"TITLE="28.4 Side-by-Side diffs: sdiff ">Side-by-Side diffs: sdiff </A><BR><ACLASS="sect1"HREF="ch28_05.htm"TITLE="28.5 Comparing Files Alongside One Another ">Comparing Files Alongside One Another </A><BR><ACLASS="sect1"HREF="ch28_06.htm"TITLE="28.6 Choosing Sides with sdiff ">Choosing Sides with sdiff </A><BR><ACLASS="sect1"HREF="ch28_07.htm"TITLE="28.7 diff for Very Long Files: bdiff ">diff for Very Long Files: bdiff </A><BR><ACLASS="sect1"HREF="ch28_08.htm"TITLE="28.8 More Friendly diff Output ">More Friendly diff Output </A><BR><ACLASS="sect1"HREF="ch28_09.htm"TITLE="28.9 ex Scripts Built by diff ">ex Scripts Built by diff </A><BR><ACLASS="sect1"HREF="ch28_10.htm"TITLE="28.10 Problems with diff and Tabstops ">Problems with diff and Tabstops </A><BR><ACLASS="sect1"HREF="ch28_11.htm"TITLE="28.11 cmp and diff ">cmp and diff </A><BR><ACLASS="sect1"HREF="ch28_12.htm"TITLE="28.12 Comparing Two Files with comm ">Comparing Two Files with comm </A><BR><ACLASS="sect1"HREF="ch28_13.htm"TITLE="28.13 make Isn't Just for Programmers! ">make Isn't Just for Programmers! </A><BR><ACLASS="sect1"HREF="ch28_14.htm"TITLE="28.14 Even More Uses for make ">Even More Uses for make </A><BR><ACLASS="sect1"HREF="ch28_15.htm"TITLE="28.15 Show Changes in a troff File with diffmk ">Show Changes in a troff File with diffmk </A></P><P></P></DIV><DIVCLASS="sect1"><H2CLASS="sect1"><ACLASS="title"NAME="UPT-ART-2680">28.1 Checking Differences with diff </A></H2><TABLECLASS="para.programreference"BORDER="1"><TR><THVALIGN="TOP"><ACLASS="programreference"HREF="examples/index.htm"TITLE="diff">diff</A><BR></TH><TDVALIGN="TOP"><ACLASS="indexterm"NAME="AUTOID-30971"></A><ACLASS="indexterm"NAME="AUTOID-30975"></A><ACLASS="indexterm"NAME="AUTOID-30979"></A>The <EMCLASS="emphasis">diff</EM> command displays different versions of lines that are found whencomparing two files.(There's also a GNU version on the CD-ROM.)It prints a message that uses <EMCLASS="emphasis">ed</EM>-like notation (<EMCLASS="emphasis">a</EM> for append,<EMCLASS="emphasis">c</EM> for change, and <EMCLASS="emphasis">d</EM> for delete) to describehow a set of lines has changed.This is followed by the lines themselves.The <CODECLASS="literal">&lt;</CODE> character precedes lines from the first file and <CODECLASS="literal">&gt;</CODE>precedes lines from the second file.</TD></TR></TABLE><PCLASS="para">Let's create an example to explain the output produced by <EMCLASS="emphasis">diff</EM>. Look at the contents of three sample files:</P><TABLECLASS="informaltable"><THEADCLASS="thead"><TRCLASS="row"VALIGN="TOP"><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">test1</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">test2</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">test3</TH></TR></THEAD><TBODYCLASS="tbody"><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">apples</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">apples</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">oranges</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">oranges</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">oranges</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">walnuts</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">walnuts</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">grapes</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">chestnuts</TD></TR></TBODY></TABLE><PCLASS="para">When you run <EMCLASS="emphasis">diff</EM> on <EMCLASS="emphasis">test1</EM> and <EMCLASS="emphasis">test2</EM>, the following outputis produced:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">$ <CODECLASS="userinput"><B>diff test1 test2</B></CODE>3c3&lt; walnuts--&gt; grapes</PRE></BLOCKQUOTE></P><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-31019"></A>The <EMCLASS="emphasis">diff</EM> command displays the only line that differs between the two files.To understand the report, remember that <EMCLASS="emphasis">diff</EM> is prescriptive, describingwhat changesneed to be made to the first file to make it the same as the second file.This report specifies that only the third line is affected,exchanging <CODECLASS="literal">walnuts</CODE> for <CODECLASS="literal">grapes</CODE>.This is more apparent if you use the <EMCLASS="emphasis">-e</EM> option, which produces anediting script that can be submitted to <EMCLASS="emphasis">ed</EM>, the UNIX line editor.(You must<SPANCLASS="link">redirect standard output (<ACLASS="linkend"HREF="ch13_01.htm#UPT-ART-1023"TITLE="Using Standard Input and Output">13.1</A>)</SPAN>to capture this script in a file.)</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">$ <CODECLASS="userinput"><B>diff -e test1 test2</B></CODE>3cgrapes.</PRE></BLOCKQUOTE></P><PCLASS="para">This script, if run on <EMCLASS="emphasis">test1</EM>, will bring <EMCLASS="emphasis">test1</EM> into agreement with<EMCLASS="emphasis">test2</EM>.(Article<ACLASS="xref"HREF="ch28_09.htm"TITLE="ex Scripts Built by diff ">28.9</A>describes how to get <EMCLASS="emphasis">ed</EM> to execute this script.)</P><PCLASS="para">If you compare the first and third files, you find more differences:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">$ <CODECLASS="userinput"><B>diff test1 test3</B></CODE>1dO&lt; apples3a3&gt; chestnuts</PRE></BLOCKQUOTE></P><PCLASS="para">To make <EMCLASS="emphasis">test1</EM> the same as <EMCLASS="emphasis">test3</EM>, you'd have to delete the first line(apples) and append the third line from <EMCLASS="emphasis">test3</EM> after the third linein <EMCLASS="emphasis">test1</EM>.Again, this can be seen more clearly in the editing script producedby the <EMCLASS="emphasis">-e</EM> option.Notice that the script specifies editing lines in reverse order;otherwise, changing the first line would alter all succeeding line numbers.</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">$ <CODECLASS="userinput"><B>diff -e test1 test3</B></CODE>3achestnuts.1d</PRE></BLOCKQUOTE></P><PCLASS="para">So what's this good for?Here's one example. </P><PCLASS="para">When working on a document, it is not an uncommon practice to make a copy ofa file and edit the copy rather than the original.This might be done, for example, if someone other than the writer isinputing edits from a written copy.The <EMCLASS="emphasis">diff</EM> command can be used to compare the two versions of a document.A writer could use it to proof an edited copy against the original.</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">$ <CODECLASS="userinput"><B>diff brochure brochure.edits</B></CODE>49c43,44&lt; environment for program development and communications,--&gt; environment for multiprocessing, program development&gt; and communications, programmers56c51&lt; offering even more power and productivity for commericial--&gt; offering even more power and productivity for commercial76c69&lt; Languages such as FORTRAN, COBOL, Pascal, and C can be--&gt; Additional languages such as FORTRAN, COBOL, Pascal, and</PRE></BLOCKQUOTE></P><PCLASS="para">Using <EMCLASS="emphasis">diff</EM> in this manner is a simple way for a writer to examinechanges without reading the entire document.By redirecting <EMCLASS="emphasis">diff</EM> output to a file, you can keep arecord of changes made to any document.In fact, just that techniqueis used by <SPANCLASS="link">SCCS and RCS (<ACLASS="linkend"HREF="ch20_12.htm"TITLE="Protecting Files with SCCS or RCS ">20.12</A>)</SPAN>to manage multiple revisions of source code and documents.</P><DIVCLASS="sect1info"><PCLASS="SECT1INFO">- <SPANCLASS="authorinitials">DD</SPAN> <SPANCLASS="bibliomisc">from <CITECLASS="citetitle">UNIX Text Processing</CITE>, Hayden Books, 1987, Chapter 11</SPAN></P></DIV></DIV></DIV><DIVCLASS="htmlnav"><P></P><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch27_20.htm"TITLE="27.20 A Highlighting grep "><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 27.20 A Highlighting grep "BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="book"HREF="index.htm"TITLE="UNIX Power Tools"><IMGSRC="../gifs/txthome.gif"ALT="UNIX Power Tools"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch28_02.htm"TITLE="28.2 Comparing Three Different Versions with diff3 "><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 28.2 Comparing Three Different Versions with diff3 "BORDER="0"></A></TD></TR><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172">27.20 A Highlighting grep </TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="index"HREF="index/idx_0.htm"TITLE="Book Index"><IMGSRC="../gifs/index.gif"ALT="Book Index"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172">28.2 Comparing Three Different Versions with diff3 </TD></TR></TABLE><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><IMGSRC="../gifs/smnavbar.gif"USEMAP="#map"BORDER="0"ALT="The UNIX CD Bookshelf Navigation"><MAPNAME="map"><AREASHAPE="RECT"COORDS="0,0,73,21"HREF="../index.htm"ALT="The UNIX CD Bookshelf"><AREASHAPE="RECT"COORDS="74,0,163,21"HREF="index.htm"ALT="UNIX Power Tools"><AREASHAPE="RECT"COORDS="164,0,257,21"HREF="../unixnut/index.htm"ALT="UNIX in a Nutshell"><AREASHAPE="RECT"COORDS="258,0,321,21"HREF="../vi/index.htm"ALT="Learning the vi Editor"><AREASHAPE="RECT"COORDS="322,0,378,21"HREF="../sedawk/index.htm"ALT="sed &amp; awk"><AREASHAPE="RECT"COORDS="379,0,438,21"HREF="../ksh/index.htm"ALT="Learning the Korn Shell"><AREASHAPE="RECT"COORDS="439,0,514,21"HREF="../lrnunix/index.htm"ALT="Learning the UNIX Operating System"></MAP></DIV></BODY></HTML>