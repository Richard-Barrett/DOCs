<HTML><HEAD><TITLE>[Chapter 28] 28.15 Show Changes in a troff File with diffmk </TITLE><METANAME="DC.title"CONTENT="UNIX Power Tools"><METANAME="DC.creator"CONTENT="Jerry Peek, Tim O'Reilly &amp; Mike Loukides"><METANAME="DC.publisher"CONTENT="O'Reilly &amp; Associates, Inc."><METANAME="DC.date"CONTENT="1998-08-04T21:44:55Z"><METANAME="DC.type"CONTENT="Text.Monograph"><METANAME="DC.format"CONTENT="text/html"SCHEME="MIME"><METANAME="DC.source"CONTENT="1-56592-260-3"SCHEME="ISBN"><METANAME="DC.language"CONTENT="en-US"><METANAME="generator"CONTENT="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><LINKREV="made"HREF="mailto:online-books@oreilly.com"TITLE="Online Books Comments"><LINKREL="up"HREF="ch28_01.htm"TITLE="28. Comparing Files"><LINKREL="prev"HREF="ch28_14.htm"TITLE="28.14 Even More Uses for make "><LINKREL="next"HREF="ch29_01.htm"TITLE="29. Spell Checking, Word Counting, and Textual Analysis"></HEAD><BODYBGCOLOR="#FFFFFF"TEXT="#000000"><DIVCLASS="htmlnav"><H1><IMGSRC="gifs/smbanner.gif"ALT="UNIX Power Tools"USEMAP="#srchmap"BORDER="0"></H1><MAPNAME="srchmap"><AREASHAPE="RECT"COORDS="0,0,466,58"HREF="index.htm"ALT="UNIX Power Tools"><AREASHAPE="RECT"COORDS="467,0,514,18"HREF="../search/psrch.htm"ALT="Search this book"></MAP><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch28_14.htm"TITLE="28.14 Even More Uses for make "><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 28.14 Even More Uses for make "BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><B><FONTFACE="ARIEL,HELVETICA,HELV,SANSERIF"SIZE="-1">Chapter 28<BR>Comparing Files</FONT></B></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="CHAPTER"HREF="ch29_01.htm"TITLE="29. Spell Checking, Word Counting, and Textual Analysis"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 29. Spell Checking, Word Counting, and Textual Analysis"BORDER="0"></A></TD></TR></TABLE>&nbsp;<HRALIGN="LEFT"WIDTH="515"TITLE="footer"></DIV><DIVCLASS="SECT1"><H2CLASS="sect1"><ACLASS="title"NAME="UPT-ART-2530">28.15 Show Changes in a troff File with diffmk </A></H2><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-31715"></A><ACLASS="indexterm"NAME="AUTOID-31717"></A>Whenever you produce multiple drafts of a document for review,&quot;change marks&quot; in the newer draft are useful for showing where additions and deletions have occurred.The<SPANCLASS="link"><EMCLASS="emphasis">troff</EM> (<ACLASS="linkend"HREF="ch43_13.htm"TITLE="The Text Formatters nroff, troff, ditroff, ... ">43.13</A>)</SPAN>request <CODECLASS="literal">.mc</CODE>(margin character) can be used to print change marks in the margin of anydocument that is formatted through <EMCLASS="emphasis">troff</EM>, and the UNIX command <EMCLASS="emphasis">diffmk</EM> uses <CODECLASS="literal">.mc</CODE> requests to produce marked drafts.<EMCLASS="emphasis">diffmk</EM> has the following syntax:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">% <CODECLASS="userinput"><B>diffmk version.1 version.2 marked_file</B></CODE></PRE></BLOCKQUOTE></P><PCLASS="para">The above command line compares an old version of a file (<EMCLASS="emphasis">version.1</EM>) to a new version (<EMCLASS="emphasis">version.2</EM>) and creates a third file,<EMCLASS="emphasis">marked_file</EM>. <EMCLASS="emphasis">marked_file</EM> consists ofthe contents of <EMCLASS="emphasis">version.2</EM> plus <CODECLASS="literal">.mc</CODE> requeststhat show where that file differs from <EMCLASS="emphasis">version.1</EM>.When <EMCLASS="emphasis">marked_file</EM> is formatted, additions and changes will be indicated by vertical bars (<CODECLASS="literal">|</CODE>) in the margin,while deleted text will beindicated by an asterisk (<CODECLASS="literal">*</CODE>) in the margin.</P><PCLASS="para">There are times when you'll want the <EMCLASS="emphasis">diffmk</EM> command torun on many files at once. For example, suppose you have a projectdirectory containing eight chapter files from a first draft:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">% <CODECLASS="userinput"><B>ls project</B></CODE>chapters.old/          stuff% <CODECLASS="userinput"><B>ls project/chapters.old</B></CODE>ch01     ch03     ch05     ch07ch02     ch04     ch06     ch08</PRE></BLOCKQUOTE></P><PCLASS="para">Before making second-draft revisions, you copy the chapter files into a directorynamed <EMCLASS="emphasis">chapters.new</EM>:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">% <CODECLASS="userinput"><B>ls project</B></CODE>chapters.new/          chapters.old/          stuff% <CODECLASS="userinput"><B>cd project/chapters.new</B></CODE>% <CODECLASS="userinput"><B>ls</B></CODE>ch01     ch03     ch05     ch07ch02     ch04     ch06     ch08</PRE></BLOCKQUOTE></P><PCLASS="para">&#13;Copying the files allows you to edit new versions while preserving the original files in theold directory. After you've edited the files in the new directory,you want to run <EMCLASS="emphasis">diffmk</EM> on all of them. In the new directory, youwould want to type:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">% <CODECLASS="userinput"><B>diffmk  ../chapters.old/ch01  ch01  ch01.diffmk</B></CODE>% <CODECLASS="userinput"><B>diffmk  ../chapters.old/ch02  ch02  ch02.diffmk</B></CODE>% <CODECLASS="userinput"><B>diffmk  ../chapters.old/ch03  ch03  ch03.diffmk</B></CODE>   ...</PRE></BLOCKQUOTE></P><PCLASS="para">A<SPANCLASS="link">shell loop (<ACLASS="linkend"HREF="ch09_11.htm"TITLE="Repeating a Command with a foreach Loop ">9.11</A>, <ACLASS="linkend"HREF="ch09_12.htm"TITLE="The Bourne Shell for Loop ">9.12</A>)</SPAN>would simplify the amount of typing you need to do.You can save disk space by using a version control utilitysuch as<SPANCLASS="link">SCCS or RCS (<ACLASS="linkend"HREF="ch20_12.htm"TITLE="Protecting Files with SCCS or RCS ">20.12</A>)</SPAN>.</P><DIVCLASS="sect1info"><PCLASS="SECT1INFO">- <SPANCLASS="authorinitials">DG</SPAN></P></DIV></DIV><DIVCLASS="htmlnav"><P></P><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch28_14.htm"TITLE="28.14 Even More Uses for make "><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 28.14 Even More Uses for make "BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="book"HREF="index.htm"TITLE="UNIX Power Tools"><IMGSRC="../gifs/txthome.gif"ALT="UNIX Power Tools"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="CHAPTER"HREF="ch29_01.htm"TITLE="29. Spell Checking, Word Counting, and Textual Analysis"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 29. Spell Checking, Word Counting, and Textual Analysis"BORDER="0"></A></TD></TR><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172">28.14 Even More Uses for make </TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="index"HREF="index/idx_0.htm"TITLE="Book Index"><IMGSRC="../gifs/index.gif"ALT="Book Index"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172">29. Spell Checking, Word Counting, and Textual Analysis</TD></TR></TABLE><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><IMGSRC="../gifs/smnavbar.gif"USEMAP="#map"BORDER="0"ALT="The UNIX CD Bookshelf Navigation"><MAPNAME="map"><AREASHAPE="RECT"COORDS="0,0,73,21"HREF="../index.htm"ALT="The UNIX CD Bookshelf"><AREASHAPE="RECT"COORDS="74,0,163,21"HREF="index.htm"ALT="UNIX Power Tools"><AREASHAPE="RECT"COORDS="164,0,257,21"HREF="../unixnut/index.htm"ALT="UNIX in a Nutshell"><AREASHAPE="RECT"COORDS="258,0,321,21"HREF="../vi/index.htm"ALT="Learning the vi Editor"><AREASHAPE="RECT"COORDS="322,0,378,21"HREF="../sedawk/index.htm"ALT="sed &amp; awk"><AREASHAPE="RECT"COORDS="379,0,438,21"HREF="../ksh/index.htm"ALT="Learning the Korn Shell"><AREASHAPE="RECT"COORDS="439,0,514,21"HREF="../lrnunix/index.htm"ALT="Learning the UNIX Operating System"></MAP></DIV></BODY></HTML>