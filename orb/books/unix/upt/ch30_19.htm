<HTML><HEAD><TITLE>[Chapter 30] 30.19 Modelines: Bug or Feature?</TITLE><METANAME="DC.title"CONTENT="UNIX Power Tools"><METANAME="DC.creator"CONTENT="Jerry Peek, Tim O'Reilly &amp; Mike Loukides"><METANAME="DC.publisher"CONTENT="O'Reilly &amp; Associates, Inc."><METANAME="DC.date"CONTENT="1998-08-04T21:45:33Z"><METANAME="DC.type"CONTENT="Text.Monograph"><METANAME="DC.format"CONTENT="text/html"SCHEME="MIME"><METANAME="DC.source"CONTENT="1-56592-260-3"SCHEME="ISBN"><METANAME="DC.language"CONTENT="en-US"><METANAME="generator"CONTENT="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><LINKREV="made"HREF="mailto:online-books@oreilly.com"TITLE="Online Books Comments"><LINKREL="up"HREF="ch30_01.htm"TITLE="30. vi Tips and Tricks"><LINKREL="prev"HREF="ch30_18.htm"TITLE="30.18 Setting vi Options Automatically for Individual Files"><LINKREL="next"HREF="ch30_20.htm"TITLE="30.20 Multiple Editor Setup Files; Starting with a Search "></HEAD><BODYBGCOLOR="#FFFFFF"TEXT="#000000"><DIVCLASS="htmlnav"><H1><IMGSRC="gifs/smbanner.gif"ALT="UNIX Power Tools"USEMAP="#srchmap"BORDER="0"></H1><MAPNAME="srchmap"><AREASHAPE="RECT"COORDS="0,0,466,58"HREF="index.htm"ALT="UNIX Power Tools"><AREASHAPE="RECT"COORDS="467,0,514,18"HREF="../search/psrch.htm"ALT="Search this book"></MAP><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch30_18.htm"TITLE="30.18 Setting vi Options Automatically for Individual Files"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 30.18 Setting vi Options Automatically for Individual Files"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><B><FONTFACE="ARIEL,HELVETICA,HELV,SANSERIF"SIZE="-1">Chapter 30<BR>vi Tips and Tricks</FONT></B></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch30_20.htm"TITLE="30.20 Multiple Editor Setup Files; Starting with a Search "><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 30.20 Multiple Editor Setup Files; Starting with a Search "BORDER="0"></A></TD></TR></TABLE>&nbsp;<HRALIGN="LEFT"WIDTH="515"TITLE="footer"></DIV><DIVCLASS="SECT1"><H2CLASS="sect1"><ACLASS="title"NAME="UPT-ART-5210">30.19 Modelines: Bug or Feature?</A></H2><PCLASS="para">Some versions of <EMCLASS="emphasis">vi</EM> and <EMCLASS="emphasis">ex</EM> have a <EMCLASS="emphasis">modeline</EM> or<EMCLASS="emphasis">modelines</EM> option.<ACLASS="indexterm"NAME="AUTOID-33588"></A><ACLASS="indexterm"NAME="AUTOID-33590"></A><ACLASS="indexterm"NAME="AUTOID-33593"></A>When that option is set in your<SPANCLASS="link"><EMCLASS="emphasis">.exrc</EM> file (<ACLASS="linkend"HREF="ch30_06.htm"TITLE="Local Settings for vi and ex ">30.6</A>)</SPAN>,you can store setup commands at the top or bottom of any file you edit.When you start the editor, it will read the setup commands and run them.This is a lot like having a separate<EMCLASS="emphasis">.exrc</EM>for each file you edit.</P><BLOCKQUOTECLASS="caution"><PCLASS="para"><STRONG>CAUTION:</STRONG> Modelines can be a security problem.If any troublemakers should edit your files and change your modelines, thinkabout the difficulties they can cause you.Most newer versions of <EMCLASS="emphasis">vi</EM> disable modelines by default.</P></BLOCKQUOTE><PCLASS="para">Here's a sample file&nbsp;- a<SPANCLASS="link">shell script (<ACLASS="linkend"HREF="ch44_01.htm#UPT-ART-0065"TITLE="Everyone Should Learn Some Shell Programming ">44.1</A>)</SPAN>with a modeline on the second line:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">#! /bin/sh# vi:set number wrapmargin=0 autoindent showmatch:while read linedo   ...</PRE></BLOCKQUOTE></P><PCLASS="para">The modeline has <CODECLASS="literal">#</CODE>, the shell's comment character, at the startof it&nbsp;- so, the shell will ignore the line but <EMCLASS="emphasis">vi</EM> will still read it.This is only necessary in a shell script, but it demonstrates that themodeline need not start in column 1. The modeline itselfconsists of a space or tab, the string <EMCLASS="emphasis">vi:</EM> or <EMCLASS="emphasis">ex:</EM>, thecommands to be executed, and a closing colon. Both the space or tabbefore the modeline, and the closing colon are important&nbsp;- theytell the editor where the modeline begins and ends. Youcan put modelines on the first five or last five lines of a file(or both).</P><PCLASS="para">When you start <EMCLASS="emphasis">vi</EM> on the file shown in the example above, it sets the options <EMCLASS="emphasis">number,</EM><EMCLASS="emphasis">wrapmargin=0</EM>, <EMCLASS="emphasis">autoindent</EM>, and <EMCLASS="emphasis">showmatch</EM>.</P><BLOCKQUOTECLASS="note"><PCLASS="para"><STRONG>NOTE:</STRONG> Any time you open a file with a modeline, <EMCLASS="emphasis">vi</EM> changes the filestatus to &quot;modified&quot;-even if you haven't actually made any changes.To leave the file without writing it, you have to use the <CODECLASS="literal">:q!</CODE>command.This is a hassle when you use UNIX tools that depend on a file'smodification time, like<SPANCLASS="link"><EMCLASS="emphasis">make</EM> (<ACLASS="linkend"HREF="ch28_13.htm"TITLE="make Isn't Just for Programmers! ">28.13</A>)</SPAN>,especially if you also have the <EMCLASS="emphasis">autowrite</EM> option set.</P></BLOCKQUOTE><PCLASS="para">To find out whether your version of <EMCLASS="emphasis">vi</EM> supports modelines&nbsp;- andwhether the option is called <EMCLASS="emphasis">modeline</EM> or <EMCLASS="emphasis">modelines</EM>-geta list of all options with the command <CODECLASS="literal">:set</CODE> <CODECLASS="literal">all</CODE>.If the option is available, but not set, you'll see <EMCLASS="emphasis">nomodeline</EM>(or <EMCLASS="emphasis">nomodelines</EM>)as one of the options. Put the command</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">set modeline(s)</PRE></BLOCKQUOTE></P><PCLASS="para">in your <EMCLASS="emphasis">.exrc</EM> file to enable the option.Unfortunately, some versions list the option but don't support it!</P><DIVCLASS="sect1info"><PCLASS="SECT1INFO">- <SPANCLASS="authorinitials">JP</SPAN></P></DIV></DIV><DIVCLASS="htmlnav"><P></P><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch30_18.htm"TITLE="30.18 Setting vi Options Automatically for Individual Files"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 30.18 Setting vi Options Automatically for Individual Files"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="book"HREF="index.htm"TITLE="UNIX Power Tools"><IMGSRC="../gifs/txthome.gif"ALT="UNIX Power Tools"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch30_20.htm"TITLE="30.20 Multiple Editor Setup Files; Starting with a Search "><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 30.20 Multiple Editor Setup Files; Starting with a Search "BORDER="0"></A></TD></TR><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172">30.18 Setting vi Options Automatically for Individual Files</TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="index"HREF="index/idx_0.htm"TITLE="Book Index"><IMGSRC="../gifs/index.gif"ALT="Book Index"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172">30.20 Multiple Editor Setup Files; Starting with a Search </TD></TR></TABLE><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><IMGSRC="../gifs/smnavbar.gif"USEMAP="#map"BORDER="0"ALT="The UNIX CD Bookshelf Navigation"><MAPNAME="map"><AREASHAPE="RECT"COORDS="0,0,73,21"HREF="../index.htm"ALT="The UNIX CD Bookshelf"><AREASHAPE="RECT"COORDS="74,0,163,21"HREF="index.htm"ALT="UNIX Power Tools"><AREASHAPE="RECT"COORDS="164,0,257,21"HREF="../unixnut/index.htm"ALT="UNIX in a Nutshell"><AREASHAPE="RECT"COORDS="258,0,321,21"HREF="../vi/index.htm"ALT="Learning the vi Editor"><AREASHAPE="RECT"COORDS="322,0,378,21"HREF="../sedawk/index.htm"ALT="sed &amp; awk"><AREASHAPE="RECT"COORDS="379,0,438,21"HREF="../ksh/index.htm"ALT="Learning the Korn Shell"><AREASHAPE="RECT"COORDS="439,0,514,21"HREF="../lrnunix/index.htm"ALT="Learning the UNIX Operating System"></MAP></DIV></BODY></HTML>