<HTML><HEAD><TITLE>[Chapter 30] 30.28 Keep Track of Functions and Included Files with ctags and tags</TITLE><METANAME="DC.title"CONTENT="UNIX Power Tools"><METANAME="DC.creator"CONTENT="Jerry Peek, Tim O'Reilly &amp; Mike Loukides"><METANAME="DC.publisher"CONTENT="O'Reilly &amp; Associates, Inc."><METANAME="DC.date"CONTENT="1998-08-04T21:45:48Z"><METANAME="DC.type"CONTENT="Text.Monograph"><METANAME="DC.format"CONTENT="text/html"SCHEME="MIME"><METANAME="DC.source"CONTENT="1-56592-260-3"SCHEME="ISBN"><METANAME="DC.language"CONTENT="en-US"><METANAME="generator"CONTENT="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><LINKREV="made"HREF="mailto:online-books@oreilly.com"TITLE="Online Books Comments"><LINKREL="up"HREF="ch30_01.htm"TITLE="30. vi Tips and Tricks"><LINKREL="prev"HREF="ch30_27.htm"TITLE="30.27 vi Compound Searches "><LINKREL="next"HREF="ch30_29.htm"TITLE="30.29 Setting Multiple tags Files "></HEAD><BODYBGCOLOR="#FFFFFF"TEXT="#000000"><DIVCLASS="htmlnav"><H1><IMGSRC="gifs/smbanner.gif"ALT="UNIX Power Tools"USEMAP="#srchmap"BORDER="0"></H1><MAPNAME="srchmap"><AREASHAPE="RECT"COORDS="0,0,466,58"HREF="index.htm"ALT="UNIX Power Tools"><AREASHAPE="RECT"COORDS="467,0,514,18"HREF="../search/psrch.htm"ALT="Search this book"></MAP><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch30_27.htm"TITLE="30.27 vi Compound Searches "><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 30.27 vi Compound Searches "BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><B><FONTFACE="ARIEL,HELVETICA,HELV,SANSERIF"SIZE="-1">Chapter 30<BR>vi Tips and Tricks</FONT></B></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch30_29.htm"TITLE="30.29 Setting Multiple tags Files "><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 30.29 Setting Multiple tags Files "BORDER="0"></A></TD></TR></TABLE>&nbsp;<HRALIGN="LEFT"WIDTH="515"TITLE="footer"></DIV><DIVCLASS="SECT1"><H2CLASS="sect1"><ACLASS="title"NAME="UPT-ART-1560">30.28 Keep Track of Functions and Included Files with ctags and tags</A></H2><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-34124"></A><ACLASS="indexterm"NAME="AUTOID-34126"></A><ACLASS="indexterm"NAME="AUTOID-34129"></A><ACLASS="indexterm"NAME="AUTOID-34132"></A>The source code for a large C program will usually be spreadover several files. Sometimes, it is difficult to keep track ofwhich file contains which function definitions. To simplifymatters, a UNIX command called <EMCLASS="emphasis">ctags</EM> can be used togetherwith the <CODECLASS="literal">:tag</CODE> command of <EMCLASS="emphasis">vi</EM>.</P><PCLASS="para"><EMCLASS="emphasis">ctags</EM> creates an information file (a database)that <EMCLASS="emphasis">vi</EM> uses later to determine which files define whichfunctions. By default, this database file is called <EMCLASS="emphasis">tags</EM>.This file contains lines of the form:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen"><CODECLASS="replaceable"><I>tag_ID     file    context</I></CODE></PRE></BLOCKQUOTE></P><PCLASS="para">where <CODECLASS="replaceable"><I>tag_ID</I></CODE> is the name of the C function or macro,<CODECLASS="replaceable"><I>file</I></CODE> is the source file in which <CODECLASS="replaceable"><I>tag_ID</I></CODE> is defined,and <CODECLASS="replaceable"><I>context</I></CODE> is a search pattern that shows the line of codecontaining <CODECLASS="replaceable"><I>tag_ID</I></CODE>.</P><PCLASS="para">From within <EMCLASS="emphasis">vi</EM>, a command such as:</P><PCLASS="para"><TABLECLASS="screen.co"BORDER="1"><TR><THVALIGN="TOP"><PRECLASS="calloutlist"><ACLASS="co"HREF="ch30_26.htm"TITLE="30.26 Shell Escapes: Running One UNIX Command While Using Another">:!</A> </PRE></TH><TDVALIGN="TOP"><PRECLASS="screen"><CODECLASS="userinput"><B>:!ctags file.c</B></CODE></PRE></TD></TR></TABLE></P><PCLASS="para">creates a file named <EMCLASS="emphasis">tags</EM> under your current directory.<EMCLASS="emphasis">tags</EM> is a database containing information on the functions defined in <EMCLASS="emphasis">file.c</EM>. A command like:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen"><CODECLASS="userinput"><B>:!ctags *.c</B></CODE></PRE></BLOCKQUOTE></P><PCLASS="para">creates a <EMCLASS="emphasis">tags</EM> file describing all the C source files under thedirectory.[If you'll be using the tags file while you're in some other directory,be sure to use an absolute pathname, like this:</P><PCLASS="para"><TABLECLASS="screen.co"BORDER="1"><TR><THVALIGN="TOP"><PRECLASS="calloutlist"><ACLASS="co"HREF="ch09_16.htm"TITLE="9.16 Command Substitution ">`...`</A> </PRE></TH><TDVALIGN="TOP"><PRECLASS="screen"><CODECLASS="userinput"><B>:!ctags `pwd`/*.c</B></CODE></PRE></TD></TR></TABLE></P><PCLASS="para">That will store <SPANCLASS="link">absolute pathnames (<ACLASS="linkend"HREF="ch14_02.htm"TITLE="Using Relative and Absolute Pathnames ">14.2</A>)</SPAN>in the <EMCLASS="emphasis">tags</EM> file. <EMCLASS="emphasis">-JP</EM>&nbsp;]</P><PCLASS="para">Now suppose your <EMCLASS="emphasis">tags</EM> file contains information on all thesource files that make up a C program. Also suppose that you wantto look at or edit a function in the program but do not know wherethe function is. From within <EMCLASS="emphasis">vi</EM>, the command:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen"><CODECLASS="userinput"><B>:tag </B></CODE><CODECLASS="replaceable"><I>name</I></CODE></PRE></BLOCKQUOTE></P><PCLASS="para">will look at the <EMCLASS="emphasis">tags</EM> file to find out which file contains thedefinition of the function <EMCLASS="emphasis">name</EM>.It will then read in the file and positionthe cursor on the line where the name is defined. In this way,you don't have to know which file you have to edit; you only haveto decide which function you want to edit.[My favorite <EMCLASS="emphasis">tags</EM> shortcut is to put the cursor on the first letter of afunction name in your buffer.Then press CTRL-<CODECLASS="literal">]</CODE> (Control-right square bracket).<EMCLASS="emphasis">vi</EM> will read the <EMCLASS="emphasis">tags</EM> file and open to the function name that wasunder your cursor.At least, my version of <EMCLASS="emphasis">vi</EM> will do that! <EMCLASS="emphasis">-JP</EM>&nbsp;]</P><BLOCKQUOTECLASS="note"><PCLASS="para"><STRONG>NOTE:</STRONG> If <EMCLASS="emphasis">tags</EM> isn't working, that may be because you have the <EMCLASS="emphasis">vi</EM>option <EMCLASS="emphasis">nowrapscan</EM> set.That's a problem on many versions of <EMCLASS="emphasis">vi</EM>.If typing the following command fixes <EMCLASS="emphasis">tags</EM> for you:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen"><CODECLASS="userinput"><B>:set wrapscan</B></CODE></PRE></BLOCKQUOTE></P><PCLASS="para">then add that command to your<SPANCLASS="link"><EMCLASS="emphasis">.exrc</EM> file (<ACLASS="linkend"HREF="ch04_09.htm"TITLE="Setting Up vi with the .exrc File ">4.9</A>)</SPAN>or<SPANCLASS="link"><EMCLASS="emphasis">EXINIT</EM> variable (<ACLASS="linkend"HREF="ch06_03.htm"TITLE="Predefined Environment Variables ">6.3</A>)</SPAN>.(Thanks to Chris Torek for this tip.)</P></BLOCKQUOTE><DIVCLASS="sect1info"><PCLASS="SECT1INFO">- <SPANCLASS="authorinitials">JS</SPAN> <SPANCLASS="bibliomisc">from O'Reilly &amp; Associates' <CITECLASS="citetitle">Learning the vi Editor</CITE>, Chapter 7</SPAN></P></DIV></DIV><DIVCLASS="htmlnav"><P></P><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch30_27.htm"TITLE="30.27 vi Compound Searches "><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 30.27 vi Compound Searches "BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="book"HREF="index.htm"TITLE="UNIX Power Tools"><IMGSRC="../gifs/txthome.gif"ALT="UNIX Power Tools"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch30_29.htm"TITLE="30.29 Setting Multiple tags Files "><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 30.29 Setting Multiple tags Files "BORDER="0"></A></TD></TR><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172">30.27 vi Compound Searches </TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="index"HREF="index/idx_0.htm"TITLE="Book Index"><IMGSRC="../gifs/index.gif"ALT="Book Index"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172">30.29 Setting Multiple tags Files </TD></TR></TABLE><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><IMGSRC="../gifs/smnavbar.gif"USEMAP="#map"BORDER="0"ALT="The UNIX CD Bookshelf Navigation"><MAPNAME="map"><AREASHAPE="RECT"COORDS="0,0,73,21"HREF="../index.htm"ALT="The UNIX CD Bookshelf"><AREASHAPE="RECT"COORDS="74,0,163,21"HREF="index.htm"ALT="UNIX Power Tools"><AREASHAPE="RECT"COORDS="164,0,257,21"HREF="../unixnut/index.htm"ALT="UNIX in a Nutshell"><AREASHAPE="RECT"COORDS="258,0,321,21"HREF="../vi/index.htm"ALT="Learning the vi Editor"><AREASHAPE="RECT"COORDS="322,0,378,21"HREF="../sedawk/index.htm"ALT="sed &amp; awk"><AREASHAPE="RECT"COORDS="379,0,438,21"HREF="../ksh/index.htm"ALT="Learning the Korn Shell"><AREASHAPE="RECT"COORDS="439,0,514,21"HREF="../lrnunix/index.htm"ALT="Learning the UNIX Operating System"></MAP></DIV></BODY></HTML>