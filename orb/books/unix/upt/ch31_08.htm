<HTML><HEAD><TITLE>[Chapter 31] 31.8 More Examples of Mapping Keys in vi </TITLE><METANAME="DC.title"CONTENT="UNIX Power Tools"><METANAME="DC.creator"CONTENT="Jerry Peek, Tim O'Reilly &amp; Mike Loukides"><METANAME="DC.publisher"CONTENT="O'Reilly &amp; Associates, Inc."><METANAME="DC.date"CONTENT="1998-08-04T21:46:18Z"><METANAME="DC.type"CONTENT="Text.Monograph"><METANAME="DC.format"CONTENT="text/html"SCHEME="MIME"><METANAME="DC.source"CONTENT="1-56592-260-3"SCHEME="ISBN"><METANAME="DC.language"CONTENT="en-US"><METANAME="generator"CONTENT="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><LINKREV="made"HREF="mailto:online-books@oreilly.com"TITLE="Online Books Comments"><LINKREL="up"HREF="ch31_01.htm"TITLE="31. Creating Custom Commands in vi"><LINKREL="prev"HREF="ch31_07.htm"TITLE="31.7 Maps for Repeated Edits "><LINKREL="next"HREF="ch31_09.htm"TITLE="31.9 Good Stuff for Your .exrc File "></HEAD><BODYBGCOLOR="#FFFFFF"TEXT="#000000"><DIVCLASS="htmlnav"><H1><IMGSRC="gifs/smbanner.gif"ALT="UNIX Power Tools"USEMAP="#srchmap"BORDER="0"></H1><MAPNAME="srchmap"><AREASHAPE="RECT"COORDS="0,0,466,58"HREF="index.htm"ALT="UNIX Power Tools"><AREASHAPE="RECT"COORDS="467,0,514,18"HREF="../search/psrch.htm"ALT="Search this book"></MAP><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch31_07.htm"TITLE="31.7 Maps for Repeated Edits "><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 31.7 Maps for Repeated Edits "BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><B><FONTFACE="ARIEL,HELVETICA,HELV,SANSERIF"SIZE="-1">Chapter 31<BR>Creating Custom Commands in vi</FONT></B></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch31_09.htm"TITLE="31.9 Good Stuff for Your .exrc File "><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 31.9 Good Stuff for Your .exrc File "BORDER="0"></A></TD></TR></TABLE>&nbsp;<HRALIGN="LEFT"WIDTH="515"TITLE="footer"></DIV><DIVCLASS="SECT1"><H2CLASS="sect1"><ACLASS="title"NAME="UPT-ART-6390">31.8 More Examples of Mapping Keys in vi </A></H2><PCLASS="para">The examples that follow will give you an idea of the clevershortcuts possible when defining keyboard maps.</P><OLCLASS="orderedlist"><LICLASS="listitem"><PCLASS="para">Add text whenever you move to the end of a word:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">map e ea</PRE></BLOCKQUOTE></P><PCLASS="para">Most of the time, the only reason you want to move to the end ofa word is to add text. This map sequence puts you in text-input modeautomatically.Note that the mapped key, <CODECLASS="literal">e</CODE>, has meaning in <EMCLASS="emphasis">vi</EM>.You're allowed to map a key that is already used by <EMCLASS="emphasis">vi</EM>,but the key's normal function will be unavailable as longas the map is in effect. This isn't so bad in this case, sincethe <CODECLASS="literal">E</CODE> command is often identical to <CODECLASS="literal">e</CODE>.</P><PCLASS="para">In the remaining examples, we assume that <CODECLASS="literal">e</CODE> has been mapped to <CODECLASS="literal">ea</CODE>.&#13;</P></LI><LICLASS="listitem"><PCLASS="para"><SPANCLASS="link">Save a file and edit the next one in a series (<ACLASS="linkend"HREF="ch30_04.htm"TITLE="Editing Multiple Files with vi ">30.4</A>)</SPAN>:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">map q :w^M:n^M</PRE></BLOCKQUOTE></P><PCLASS="para">Notice that you can map keys to <EMCLASS="emphasis">ex</EM> commands, but be sureto finish each <EMCLASS="emphasis">ex</EM> command with a RETURN.This sequence makes it easy to move from one file to the nextand is useful when you've opened many short files with one <EMCLASS="emphasis">vi</EM>command.Mapping the letter <CODECLASS="literal">q</CODE> helps youremember that the sequence is similar to a &quot;quit.&quot;</P></LI><LICLASS="listitem"><PCLASS="para">Put <EMCLASS="emphasis">troff</EM> emboldening codes (<EMCLASS="emphasis">\fB</EM> and <EMCLASS="emphasis">\fP</EM>) around a word: </P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">map v i\fB^[e\fP^[</PRE></BLOCKQUOTE></P><PCLASS="para">This sequence assumes that the cursor is at the beginning of theword. First, you enter text-input mode, then you type the code forbold font. (In <EMCLASS="emphasis">map</EM> commands, you don't need to type two backslashes to produce one backslash.) Next, you return to command modeby typing a<SPANCLASS="link">&quot;quoted&quot; (<ACLASS="linkend"HREF="ch31_06.htm"TITLE="Protecting Keys from Interpretation by ex ">31.6</A>)</SPAN>ESC.Finally, you append the closing <EMCLASS="emphasis">troff</EM> code at the end of the word, and you return to command mode.Of course, the map is not limited to <EMCLASS="emphasis">troff</EM> font codes.You can use it to enclose a word in parentheses or C commentcharacters, to name just a few applications.</P><PCLASS="para">This example shows you that map sequences are allowed to contain other map commands (the <CODECLASS="literal">e</CODE> is already mapped to <CODECLASS="literal">ea</CODE>).The ability to use nested map sequences iscontrolled by <EMCLASS="emphasis">vi</EM>'s<SPANCLASS="link"><CODECLASS="literal">remap</CODE> option (<ACLASS="linkend"HREF="ch31_14.htm"TITLE="Don't Lose Important Functions with vi Maps: Use noremap">31.14</A>)</SPAN>,which is normallyenabled.</P></LI><LICLASS="listitem"><PCLASS="para">Put <EMCLASS="emphasis">troff</EM> emboldening codes around a word, even when thecursor is not at the beginning of the word:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">map V lbi\fB^[e\fP^[</PRE></BLOCKQUOTE></P><PCLASS="para">This sequence is the same as the previous one, except that ituses <CODECLASS="literal">lb</CODE> tohandle the additional task of positioning the cursor at thebeginning of the word. The cursor might be in the middle of theword, so you want to move to the beginning with the <CODECLASS="literal">b</CODE> command.</P><PCLASS="para">But if the cursor were already at the beginning of theword, the <CODECLASS="literal">b</CODE> command would move the cursor to the previousword instead. To guard against that case,type an <CODECLASS="literal">l</CODE> before moving back with <CODECLASS="literal">b</CODE>, so that the cursor never starts on the first letter of the word.You can define variations of this sequence by replacing the <CODECLASS="literal">b</CODE> with <CODECLASS="literal">B</CODE> and the <CODECLASS="literal">e</CODE> with <CODECLASS="literal">Ea</CODE>.In all cases though, the <CODECLASS="literal">l</CODE> command prevents this sequencefrom working if the cursor is at the end of a line.(To get around this, you could add a space to the end of the wordbefore typing the keymap.)</P></LI></OL><DIVCLASS="sect1info"><PCLASS="SECT1INFO">- <SPANCLASS="authorinitials">DG</SPAN> <SPANCLASS="bibliomisc">from O'Reilly &amp; Associates' <CITECLASS="citetitle">Learning the vi Editor</CITE>, Chapter 7</SPAN></P></DIV></DIV><DIVCLASS="htmlnav"><P></P><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch31_07.htm"TITLE="31.7 Maps for Repeated Edits "><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 31.7 Maps for Repeated Edits "BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="book"HREF="index.htm"TITLE="UNIX Power Tools"><IMGSRC="../gifs/txthome.gif"ALT="UNIX Power Tools"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch31_09.htm"TITLE="31.9 Good Stuff for Your .exrc File "><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 31.9 Good Stuff for Your .exrc File "BORDER="0"></A></TD></TR><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172">31.7 Maps for Repeated Edits </TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="index"HREF="index/idx_0.htm"TITLE="Book Index"><IMGSRC="../gifs/index.gif"ALT="Book Index"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172">31.9 Good Stuff for Your .exrc File </TD></TR></TABLE><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><IMGSRC="../gifs/smnavbar.gif"USEMAP="#map"BORDER="0"ALT="The UNIX CD Bookshelf Navigation"><MAPNAME="map"><AREASHAPE="RECT"COORDS="0,0,73,21"HREF="../index.htm"ALT="The UNIX CD Bookshelf"><AREASHAPE="RECT"COORDS="74,0,163,21"HREF="index.htm"ALT="UNIX Power Tools"><AREASHAPE="RECT"COORDS="164,0,257,21"HREF="../unixnut/index.htm"ALT="UNIX in a Nutshell"><AREASHAPE="RECT"COORDS="258,0,321,21"HREF="../vi/index.htm"ALT="Learning the vi Editor"><AREASHAPE="RECT"COORDS="322,0,378,21"HREF="../sedawk/index.htm"ALT="sed &amp; awk"><AREASHAPE="RECT"COORDS="379,0,438,21"HREF="../ksh/index.htm"ALT="Learning the Korn Shell"><AREASHAPE="RECT"COORDS="439,0,514,21"HREF="../lrnunix/index.htm"ALT="Learning the UNIX Operating System"></MAP></DIV></BODY></HTML>