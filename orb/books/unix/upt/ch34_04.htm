<HTML><HEAD><TITLE>[Chapter 34] 34.4 sed Addressing Basics </TITLE><METANAME="DC.title"CONTENT="UNIX Power Tools"><METANAME="DC.creator"CONTENT="Jerry Peek, Tim O'Reilly &amp; Mike Loukides"><METANAME="DC.publisher"CONTENT="O'Reilly &amp; Associates, Inc."><METANAME="DC.date"CONTENT="1998-08-04T21:47:12Z"><METANAME="DC.type"CONTENT="Text.Monograph"><METANAME="DC.format"CONTENT="text/html"SCHEME="MIME"><METANAME="DC.source"CONTENT="1-56592-260-3"SCHEME="ISBN"><METANAME="DC.language"CONTENT="en-US"><METANAME="generator"CONTENT="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><LINKREV="made"HREF="mailto:online-books@oreilly.com"TITLE="Online Books Comments"><LINKREL="up"HREF="ch34_01.htm"TITLE="34. The sed Stream Editor"><LINKREL="prev"HREF="ch34_03.htm"TITLE="34.3 Testing and Using a sed Script: checksed, runsed "><LINKREL="next"HREF="ch34_05.htm"TITLE="34.5 Order of Commands in a Script "></HEAD><BODYBGCOLOR="#FFFFFF"TEXT="#000000"><DIVCLASS="htmlnav"><H1><IMGSRC="gifs/smbanner.gif"ALT="UNIX Power Tools"USEMAP="#srchmap"BORDER="0"></H1><MAPNAME="srchmap"><AREASHAPE="RECT"COORDS="0,0,466,58"HREF="index.htm"ALT="UNIX Power Tools"><AREASHAPE="RECT"COORDS="467,0,514,18"HREF="../search/psrch.htm"ALT="Search this book"></MAP><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch34_03.htm"TITLE="34.3 Testing and Using a sed Script: checksed, runsed "><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 34.3 Testing and Using a sed Script: checksed, runsed "BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><B><FONTFACE="ARIEL,HELVETICA,HELV,SANSERIF"SIZE="-1">Chapter 34<BR>The sed Stream Editor</FONT></B></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch34_05.htm"TITLE="34.5 Order of Commands in a Script "><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 34.5 Order of Commands in a Script "BORDER="0"></A></TD></TR></TABLE>&nbsp;<HRALIGN="LEFT"WIDTH="515"TITLE="footer"></DIV><DIVCLASS="SECT1"><H2CLASS="sect1"><ACLASS="title"NAME="UPT-ART-7977">34.4 sed Addressing Basics </A></H2><PCLASS="para"><ACLASS="indexterm"NAME="UPT-ART-7977-IX-SED-EDITOR-ADDRESSING"></A></P><PCLASS="para">A <EMCLASS="emphasis">sed</EM> command can specify zero, one, or two addresses.An address can be a line number, a line addressing symbol, or a <SPANCLASS="link">regular expression (<ACLASS="linkend"HREF="ch26_04.htm"TITLE="Using Metacharacters in Regular Expressions ">26.4</A>)</SPAN>that describes a pattern.</P><ULCLASS="itemizedlist"><LICLASS="listitem"><PCLASS="para">If no address is specified, then the command is applied to each line.</P></LI><LICLASS="listitem"><PCLASS="para">If there is only one address, the command is appliedto any line matching the address.</P></LI><LICLASS="listitem"><PCLASS="para">If two comma-separated addresses are specified, the command isperformed on the first matching line and all succeeding lines upto and including a line matching the second address.This range may match multiple times throughout the input.</P></LI><LICLASS="listitem"><PCLASS="para">If an address is followed by an exclamation mark (<CODECLASS="literal">!</CODE>), the commandis applied to all lines that do <EMCLASS="emphasis">not</EM> match the address.</P></LI></UL><PCLASS="para">To illustrate how addressing works, let's look at examplesusing the delete command, <EMCLASS="emphasis">d</EM>.A script consisting of simply the <EMCLASS="emphasis">d</EM> command and no address:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">d</PRE></BLOCKQUOTE></P><PCLASS="para">produces no output since itdeletes <EMCLASS="emphasis">all</EM> lines.</P><PCLASS="para">When a line number is supplied as an address, the commandaffects only that line.For instance, the followingexample deletes only the first line:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">1d</PRE></BLOCKQUOTE></P><PCLASS="para">&#13;The line number refers to an internal line count maintainedby <EMCLASS="emphasis">sed</EM>.This counter is not reset for multiple input files.Thus, no matter how many files were specified as input, there is onlyone line 1 in the input stream.</P><PCLASS="para">Similarly, the input stream has only one last line.Itcan be specified using the addressing symbol, <CODECLASS="literal">$</CODE>.The followingexample deletes the last line of input:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">$d</PRE></BLOCKQUOTE></P><PCLASS="para">The <CODECLASS="literal">$</CODE> symbol should not be confused with the <CODECLASS="literal">$</CODE> usedin regular expressions, where it means the end of the line.</P><PCLASS="para">When a regular expression is supplied as an address, the commandaffects only the lines matching that pattern.The regular expression must be enclosed by slashes (<CODECLASS="literal">/</CODE>).The following delete command:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">/^$/d</PRE></BLOCKQUOTE></P><PCLASS="para">deletes only blank lines.All other lines are passed throughuntouched.</P><PCLASS="para">If you supply two addresses, then you specifya range of lines over which the command is executed.The following example shows how to delete all linessurrounded by a pair ofmacros, in this case, .TS and .TE, that mark a table as<SPANCLASS="link"><EMCLASS="emphasis">tbl</EM> (<ACLASS="linkend"HREF="ch43_15.htm"TITLE="From a Source File to the Printer ">43.15</A>)</SPAN>input:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">/^\.TS/,/^\.TE/d</PRE></BLOCKQUOTE></P><PCLASS="para">It deletes all lines beginning with the line matched by the first pattern uptoand including the line matched by the second pattern.Lines outside this range are not affected.If there is more than one table (another .TS/.TE pair after thefirst), those tables will also be deleted.</P><PCLASS="para">The following command deletes from line 50 to the last line in the file:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">50,$d</PRE></BLOCKQUOTE></P><PCLASS="para">You can mix a line address and a pattern address:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">1,/^$/d</PRE></BLOCKQUOTE></P><PCLASS="para">This example deletes from the first line up to the first blank line,which, for instance, will delete a mail header from a<SPANCLASS="link">mail message (<ACLASS="linkend"HREF="ch01_33.htm"TITLE="UNIX Networking and Communications ">1.33</A>)</SPAN>thatyou have saved in a file.</P><PCLASS="para">You can think of the first address as enabling the actionand the second address as disabling it.<EMCLASS="emphasis">sed</EM> has no way of looking ahead to determine if the second matchwill be made.The action will be applied to linesonce the first match is made.The command will be applied to <EMCLASS="emphasis">all</EM> subsequent lines untilthe second match ismade.In the previous example, if the filedid not contain a blank line, then all lines would be deleted.</P><PCLASS="para">An exclamation mark following an addressreverses the sense of the match.For instance,the following script deletes all lines <EMCLASS="emphasis">except</EM> those inside<EMCLASS="emphasis">tbl</EM> input:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">/^\.TS/,/^\.TE/!d</PRE></BLOCKQUOTE></P><PCLASS="para">&#13;This script, in effect, extracts <EMCLASS="emphasis">tbl</EM> input from a source file.(This can be handy for testing the format of tables.)</P><PCLASS="para">Curly braces (<CODECLASS="literal">{</CODE><CODECLASS="literal">}</CODE>)let you give more than one command with an address.For example, to search every line of a table, capitalize the word<CODECLASS="literal">Caution</CODE> on any of those lines, and delete any line with<CODECLASS="literal">.sp&nbsp;2p</CODE>:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">/^\.TS/,/^\.TE/{    s/Caution/CAUTION/g    /^\.sp 2p/d}</PRE></BLOCKQUOTE></P><ACLASS="indexterm"NAME="AUTOID-38487"></A><DIVCLASS="sect1info"><PCLASS="SECT1INFO">- <SPANCLASS="authorinitials">DD</SPAN> <SPANCLASS="bibliomisc">from O'Reilly &amp; Associates' <CITECLASS="citetitle">sed &amp; awk</CITE></SPAN></P></DIV></DIV><DIVCLASS="htmlnav"><P></P><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch34_03.htm"TITLE="34.3 Testing and Using a sed Script: checksed, runsed "><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 34.3 Testing and Using a sed Script: checksed, runsed "BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="book"HREF="index.htm"TITLE="UNIX Power Tools"><IMGSRC="../gifs/txthome.gif"ALT="UNIX Power Tools"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch34_05.htm"TITLE="34.5 Order of Commands in a Script "><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 34.5 Order of Commands in a Script "BORDER="0"></A></TD></TR><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172">34.3 Testing and Using a sed Script: checksed, runsed </TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="index"HREF="index/idx_0.htm"TITLE="Book Index"><IMGSRC="../gifs/index.gif"ALT="Book Index"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172">34.5 Order of Commands in a Script </TD></TR></TABLE><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><IMGSRC="../gifs/smnavbar.gif"USEMAP="#map"BORDER="0"ALT="The UNIX CD Bookshelf Navigation"><MAPNAME="map"><AREASHAPE="RECT"COORDS="0,0,73,21"HREF="../index.htm"ALT="The UNIX CD Bookshelf"><AREASHAPE="RECT"COORDS="74,0,163,21"HREF="index.htm"ALT="UNIX Power Tools"><AREASHAPE="RECT"COORDS="164,0,257,21"HREF="../unixnut/index.htm"ALT="UNIX in a Nutshell"><AREASHAPE="RECT"COORDS="258,0,321,21"HREF="../vi/index.htm"ALT="Learning the vi Editor"><AREASHAPE="RECT"COORDS="322,0,378,21"HREF="../sedawk/index.htm"ALT="sed &amp; awk"><AREASHAPE="RECT"COORDS="379,0,438,21"HREF="../ksh/index.htm"ALT="Learning the Korn Shell"><AREASHAPE="RECT"COORDS="439,0,514,21"HREF="../lrnunix/index.htm"ALT="Learning the UNIX Operating System"></MAP></DIV></BODY></HTML>