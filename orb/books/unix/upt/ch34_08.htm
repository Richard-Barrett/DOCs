<HTML><HEAD><TITLE>[Chapter 34] 34.8 Newlines in a sed Replacement </TITLE><METANAME="DC.title"CONTENT="UNIX Power Tools"><METANAME="DC.creator"CONTENT="Jerry Peek, Tim O'Reilly &amp; Mike Loukides"><METANAME="DC.publisher"CONTENT="O'Reilly &amp; Associates, Inc."><METANAME="DC.date"CONTENT="1998-08-04T21:47:16Z"><METANAME="DC.type"CONTENT="Text.Monograph"><METANAME="DC.format"CONTENT="text/html"SCHEME="MIME"><METANAME="DC.source"CONTENT="1-56592-260-3"SCHEME="ISBN"><METANAME="DC.language"CONTENT="en-US"><METANAME="generator"CONTENT="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><LINKREV="made"HREF="mailto:online-books@oreilly.com"TITLE="Online Books Comments"><LINKREL="up"HREF="ch34_01.htm"TITLE="34. The sed Stream Editor"><LINKREL="prev"HREF="ch34_07.htm"TITLE="34.7 Delimiting a Regular Expression "><LINKREL="next"HREF="ch34_09.htm"TITLE="34.9 Referencing the Search String in a Replacement "></HEAD><BODYBGCOLOR="#FFFFFF"TEXT="#000000"><DIVCLASS="htmlnav"><H1><IMGSRC="gifs/smbanner.gif"ALT="UNIX Power Tools"USEMAP="#srchmap"BORDER="0"></H1><MAPNAME="srchmap"><AREASHAPE="RECT"COORDS="0,0,466,58"HREF="index.htm"ALT="UNIX Power Tools"><AREASHAPE="RECT"COORDS="467,0,514,18"HREF="../search/psrch.htm"ALT="Search this book"></MAP><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch34_07.htm"TITLE="34.7 Delimiting a Regular Expression "><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 34.7 Delimiting a Regular Expression "BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><B><FONTFACE="ARIEL,HELVETICA,HELV,SANSERIF"SIZE="-1">Chapter 34<BR>The sed Stream Editor</FONT></B></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch34_09.htm"TITLE="34.9 Referencing the Search String in a Replacement "><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 34.9 Referencing the Search String in a Replacement "BORDER="0"></A></TD></TR></TABLE>&nbsp;<HRALIGN="LEFT"WIDTH="515"TITLE="footer"></DIV><DIVCLASS="SECT1"><H2CLASS="sect1"><ACLASS="title"NAME="UPT-ART-7773">34.8 Newlines in a sed Replacement </A></H2><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-38579"></A>The backslash (<CODECLASS="literal">\</CODE>)in the replacement string of the <EMCLASS="emphasis">sed</EM> substitutioncommand is generally used to escape other metacharacters,but it is also used to include a newline in a replacement string.</P><PCLASS="para">Given the following input line where each item is separatedby a tab:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">Column1     Column2    Column3     Column4</PRE></BLOCKQUOTE></P><PCLASS="para">we can replace the second tab character on each line with a newline character:</P><PCLASS="para"><TABLECLASS="screen.co"BORDER="1"><TR><THVALIGN="TOP"><PRECLASS="calloutlist">&#13;<ACLASS="co"HREF="ch34_11.htm"TITLE="34.11 Search &amp; Replacement: One Match Among Many ">2</A> </PRE></TH><TDVALIGN="TOP"><PRECLASS="screen">s/<KBDCLASS="keycap">[TAB]</KBD>/\/2&#13;</PRE></TD></TR></TABLE></P><PCLASS="para">Note that no spaces are permitted after the backslash. This script produces the following result:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">Column1     Column2Column3     Column4</PRE></BLOCKQUOTE></P><PCLASS="para">Another example comes from the conversion of a file for <EMCLASS="emphasis">troff</EM> to an ASCII input format for Ventura Publisher(TM). It converts the following line for <EMCLASS="emphasis">troff</EM>:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">.Ah &quot;Major Heading&quot;</PRE></BLOCKQUOTE></P><PCLASS="para">to a similar line for Ventura:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">@A HEAD = Major Heading</PRE></BLOCKQUOTE></P><PCLASS="para">&#13;The twist in this problem is that the line needs to be preceded and followedby a blank line. It is an example of writing a multiline replacementstring:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">/^\.Ah/{s/\.Ah */\\@A HEAD = /s/&quot;//gs/$/\/    }</PRE></BLOCKQUOTE></P><PCLASS="para">The first substitute command replaces <CODECLASS="literal">.Ah</CODE> with two newlines and <CODECLASS="literal">@A&nbsp;HEAD&nbsp;=&nbsp;</CODE>.Each backslash at the end of the line is necessary to escape the newline. The second substitution removes the quotation marks. The lastcommand matches the end of line in the pattern space (not the embeddednewlines) and adds a newline after it.</P><DIVCLASS="sect1info"><PCLASS="SECT1INFO">- <SPANCLASS="authorinitials">DD</SPAN> <SPANCLASS="bibliomisc">from O'Reilly &amp; Associates' <CITECLASS="citetitle">sed &amp; awk</CITE>, Chapter 5</SPAN></P></DIV></DIV><DIVCLASS="htmlnav"><P></P><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch34_07.htm"TITLE="34.7 Delimiting a Regular Expression "><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 34.7 Delimiting a Regular Expression "BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="book"HREF="index.htm"TITLE="UNIX Power Tools"><IMGSRC="../gifs/txthome.gif"ALT="UNIX Power Tools"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch34_09.htm"TITLE="34.9 Referencing the Search String in a Replacement "><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 34.9 Referencing the Search String in a Replacement "BORDER="0"></A></TD></TR><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172">34.7 Delimiting a Regular Expression </TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="index"HREF="index/idx_0.htm"TITLE="Book Index"><IMGSRC="../gifs/index.gif"ALT="Book Index"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172">34.9 Referencing the Search String in a Replacement </TD></TR></TABLE><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><IMGSRC="../gifs/smnavbar.gif"USEMAP="#map"BORDER="0"ALT="The UNIX CD Bookshelf Navigation"><MAPNAME="map"><AREASHAPE="RECT"COORDS="0,0,73,21"HREF="../index.htm"ALT="The UNIX CD Bookshelf"><AREASHAPE="RECT"COORDS="74,0,163,21"HREF="index.htm"ALT="UNIX Power Tools"><AREASHAPE="RECT"COORDS="164,0,257,21"HREF="../unixnut/index.htm"ALT="UNIX in a Nutshell"><AREASHAPE="RECT"COORDS="258,0,321,21"HREF="../vi/index.htm"ALT="Learning the vi Editor"><AREASHAPE="RECT"COORDS="322,0,378,21"HREF="../sedawk/index.htm"ALT="sed &amp; awk"><AREASHAPE="RECT"COORDS="379,0,438,21"HREF="../ksh/index.htm"ALT="Learning the Korn Shell"><AREASHAPE="RECT"COORDS="439,0,514,21"HREF="../lrnunix/index.htm"ALT="Learning the UNIX Operating System"></MAP></DIV></BODY></HTML>