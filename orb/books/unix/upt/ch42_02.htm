<HTML><HEAD><TITLE>[Chapter 42] 42.2 Fixing a Hung Terminal or Job </TITLE><METANAME="DC.title"CONTENT="UNIX Power Tools"><METANAME="DC.creator"CONTENT="Jerry Peek, Tim O'Reilly &amp; Mike Loukides"><METANAME="DC.publisher"CONTENT="O'Reilly &amp; Associates, Inc."><METANAME="DC.date"CONTENT="1998-08-04T21:52:22Z"><METANAME="DC.type"CONTENT="Text.Monograph"><METANAME="DC.format"CONTENT="text/html"SCHEME="MIME"><METANAME="DC.source"CONTENT="1-56592-260-3"SCHEME="ISBN"><METANAME="DC.language"CONTENT="en-US"><METANAME="generator"CONTENT="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><LINKREV="made"HREF="mailto:online-books@oreilly.com"TITLE="Online Books Comments"><LINKREL="up"HREF="ch42_01.htm"TITLE="42. Problems with Terminals"><LINKREL="prev"HREF="ch42_01.htm"TITLE="42.1 Making Sense Out of the Terminal Mess "><LINKREL="next"HREF="ch42_03.htm"TITLE="42.3 Why Changing TERM Sometimes Doesn't Work "></HEAD><BODYBGCOLOR="#FFFFFF"TEXT="#000000"><DIVCLASS="htmlnav"><H1><IMGSRC="gifs/smbanner.gif"ALT="UNIX Power Tools"USEMAP="#srchmap"BORDER="0"></H1><MAPNAME="srchmap"><AREASHAPE="RECT"COORDS="0,0,466,58"HREF="index.htm"ALT="UNIX Power Tools"><AREASHAPE="RECT"COORDS="467,0,514,18"HREF="../search/psrch.htm"ALT="Search this book"></MAP><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch42_01.htm"TITLE="42.1 Making Sense Out of the Terminal Mess "><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 42.1 Making Sense Out of the Terminal Mess "BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><B><FONTFACE="ARIEL,HELVETICA,HELV,SANSERIF"SIZE="-1">Chapter 42<BR>Problems with Terminals</FONT></B></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch42_03.htm"TITLE="42.3 Why Changing TERM Sometimes Doesn't Work "><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 42.3 Why Changing TERM Sometimes Doesn't Work "BORDER="0"></A></TD></TR></TABLE>&nbsp;<HRALIGN="LEFT"WIDTH="515"TITLE="footer"></DIV><DIVCLASS="SECT1"><H2CLASS="sect1"><ACLASS="title"NAME="UPT-ART-5250">42.2 Fixing a Hung Terminal or Job </A></H2><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-46572"></A><ACLASS="indexterm"NAME="AUTOID-46575"></A><ACLASS="indexterm"NAME="AUTOID-46578"></A>Here are a lot of techniques for unlocking alocked-up terminal or window session.</P><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="UPT-ART-5250-SECT-1.1">42.2.1 Output Stopped? </A></H3><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-46584"></A><ACLASS="indexterm"NAME="AUTOID-46586"></A>If your terminal has a HOLD SCREEN or SCROLL LOCK button, did youaccidentally press it?Try pressing it and see if things start working.If pressing the button once doesn't fix the problem, you should probably pressit once more to undo the screen hold.Otherwise, you may lock up your session worse than it was before!</P><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-46589"></A><ACLASS="indexterm"NAME="AUTOID-46592"></A><ACLASS="indexterm"NAME="AUTOID-46595"></A>Another way to stop output is by pressing CTRL-s.The way to restart stopped output is with CTRL-q&nbsp;- trypressing that now.(Unlike aSCROLL&nbsp;LOCKbutton, though, if CTRL-qdoesn't help, you don't needto undo it.)</P></DIV><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="UPT-ART-5250-SECT-1.2">42.2.2 Job Stopped? </A></H3><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-46601"></A>If you have a<SPANCLASS="link">shell prompt (<ACLASS="linkend"HREF="ch07_01.htm#UPT-ART-4820"TITLE="Why Change Your Prompt? ">7.1</A>)</SPAN>instead of being in the program you thought youwere running&nbsp;- andif your UNIX has job control&nbsp;- you may have stopped a job.<SPANCLASS="link"> Try the <EMCLASS="emphasis">jobs</EM> command; if the job is stopped, restart it . (<ACLASS="linkend"HREF="ch12_08.htm"TITLE="Job Control in a Nutshell ">12.8</A>)</SPAN></P></DIV><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="UPT-ART-5250-SECT-1.3">42.2.3 Program Waiting for Input? </A></H3><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-46609"></A>The program may be waiting for you to answer a question or type textto its standard input.</P><BLOCKQUOTECLASS="caution"><PCLASS="para"><STRONG>CAUTION:</STRONG> If the program you were running does something that's hard to undo-likeremoving files-<EMCLASS="emphasis">don't</EM> try this step unless you've thought about itcarefully.&#13;</P><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-46616"></A><ACLASS="indexterm"NAME="AUTOID-46619"></A>If your system hasjob control,you can find out by putting the job in the background with CTRL-zand <EMCLASS="emphasis">bg</EM>.If the job was waiting for input, you'll see the message:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">[1]  + Stopped (tty input)  grep pat</PRE></BLOCKQUOTE></P><PCLASS="para">You canbring the job back into the foreground and answer its question,if you know what that question is.Otherwise, now that the job is stopped, you can kill it.See the following directions.</P><PCLASS="para">On systems without job control, you may be able to satisfy the program bypressing <KBDCLASS="keycap">[RETURN]</KBD>or some other key that the program is expecting, like <EMCLASS="emphasis">y</EM>or <EMCLASS="emphasis">n</EM>.You could also try pressing <KBDCLASS="keycap">[CTRL-d]</KBD> or whatever your &quot;end of input&quot; character is set to.That might log you out, though, unless you've set the<SPANCLASS="link"><EMCLASS="emphasis">ignoreeof</EM> variable (<ACLASS="linkend"HREF="ch03_05.htm"TITLE="Stop Accidental C Shell Logouts ">3.5</A>)</SPAN>.</P></BLOCKQUOTE></DIV><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="UPT-ART-5250-SECT-1.4">42.2.4 Stalled Data Connection? </A></H3><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-46636"></A><ACLASS="indexterm"NAME="AUTOID-46639"></A>If your terminal is hooked to a computer, modem, or network, be sure thatthe wires haven't come loose.</P><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-46642"></A><ACLASS="indexterm"NAME="AUTOID-46644"></A>If you're using a modem and the modem has function lights, try pressingkeys and see if the SD or Send Data light flashes.If it does, your terminal is sending data to the host computer.If the RD or Receive Data light flashes, the computer is sending data to yourterminal-if you don't see anything, there might be something wrong on yourterminal.</P><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-46647"></A><ACLASS="indexterm"NAME="AUTOID-46650"></A>If you're connected with<SPANCLASS="link"><EMCLASS="emphasis">rlogin</EM> or <EMCLASS="emphasis">telnet</EM> (<ACLASS="linkend"HREF="ch01_33.htm"TITLE="UNIX Networking and Communications ">1.33</A>)</SPAN>,the network to the remote computer might be down or be really slow.Try opening another connection to the same remote host-if you get a responselike <CODECLASS="literal">Connection</CODE> <CODECLASS="literal">timed</CODE> <CODECLASS="literal">out</CODE>, you have two choices:</P><OLCLASS="orderedlist"><LICLASS="listitem"><PCLASS="para">Wait for your original connection to unfreeze.The connection may come back and let you keep working where you left off.Or the connection may end when <EMCLASS="emphasis">rlogin</EM> or <EMCLASS="emphasis">telnet</EM> noticesthe network problem.</P></LI><LICLASS="listitem"><PCLASS="para">Quit the session and try later.</P></LI></OL></DIV><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="UPT-ART-5250-SECT-1.5">42.2.5 Aborting Programs </A></H3><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-46669"></A><ACLASS="indexterm"NAME="AUTOID-46672"></A><ACLASS="indexterm"NAME="AUTOID-46675"></A>To abort a program, most users press CTRL-c.Your account may be set up to use a different interruptcharacter, like DELETE or RUBOUT.If these don't work, try CTRL-/(CTRL-backslash).Under most circumstances, this will force the program to terminate.Otherwise, do the following:</P><OLCLASS="orderedlist"><LICLASS="listitem"><PCLASS="para">Log in at another terminal or window.</P></LI><LICLASS="listitem"><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-46682"></A>Enter the command <CODECLASS="literal">ps -x</CODE>.On System V, use <CODECLASS="literal">ps -u </CODE><CODECLASS="replaceable"><I>yourname</I></CODE>, where <CODECLASS="replaceable"><I>yourname</I></CODE>is your UNIX username.This displays a list of theprograms you are running, something like this:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">% <CODECLASS="userinput"><B>ps -x</B></CODE>PID     TTY     STAT    TIME    COMMAND163     i26     I       0:41    -csh (csh)8532    i26     TW      2:17    vi ts.ms22202   i26     S       12:50   vi UNIXintro.ms8963    pb      R       0:00    ps -x24077   pb      S       0:05    -bin/csh (csh)%</PRE></BLOCKQUOTE></P><PCLASS="para"></P></LI><LICLASS="listitem"><PCLASS="para">Search through this list to find the command that has backfired.Note the process identification (PID) number for this command.</P></LI><LICLASS="listitem"><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-46697"></A>Enter the command<SPANCLASS="link"><CODECLASS="literal">kill </CODE><CODECLASS="replaceable"><I>PID</I></CODE> (<ACLASS="linkend"HREF="ch38_10.htm"TITLE="Destroying Processes with kill ">38.10</A>)</SPAN>,where <EMCLASS="emphasis">PID</EM> is the identification number from the previous step.If that doesn't work, try <CODECLASS="literal">kill -1 </CODE><CODECLASS="replaceable"><I>PID</I></CODE> to send aHUP signal.You may need <EMCLASS="emphasis">kill -9</EM>, but try the other <EMCLASS="emphasis">kill</EM>s first.</P></LI><LICLASS="listitem"><PCLASS="para">If the UNIX shell prompt (like <CODECLASS="literal">%</CODE> or <CODECLASS="literal">$</CODE>)has appeared at youroriginal terminal, things are probably back to normal.You may still have to<SPANCLASS="link">  take the terminal out of a strange mode  (<ACLASS="linkend"HREF="ch42_04.htm"TITLE="Checklist for Resetting a Messed Up Terminal ">42.4</A>)</SPAN>though.</P><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-46714"></A><ACLASS="indexterm"NAME="AUTOID-46716"></A><ACLASS="indexterm"NAME="AUTOID-46718"></A>If the shell prompt hasn't come back, find the shell associated with your terminal (identified by a tty number) and <EMCLASS="emphasis">kill</EM> it.The command name for the C shell is <EMCLASS="emphasis">csh</EM>.For the Bourne shell, it is <EMCLASS="emphasis">sh</EM>.In most cases, this will destroy any other commands running from your terminal.Be sure to <EMCLASS="emphasis">kill</EM> the shell on your own terminal, not the terminal you borrowed to enter these commands. The tty you borrowed is the one running <EMCLASS="emphasis">ps</EM>; look atthe example above and check the <CODECLASS="literal">TTY</CODE> column.In this case, the borrowed terminal is TTYpb.</P><PCLASS="para">Check <EMCLASS="emphasis">ps</EM> to ensure that your shell has died.If it is still there, take more drastic action with the command <CODECLASS="literal">kill -9 </CODE><CODECLASS="replaceable"><I>PID</I></CODE>.</P></LI><LICLASS="listitem"><PCLASS="para">Run <EMCLASS="emphasis">ps -x</EM> again to be sure that all processes on the other ttyhave died.(In some cases, processes will remain.)If there are still processes on the other tty, kill them.</P></LI><LICLASS="listitem"><PCLASS="para">At this point, you should be able to log in again from your own terminal.</P></LI></OL><PCLASS="para">The<SPANCLASS="link"><EMCLASS="emphasis">ps</EM> (<ACLASS="linkend"HREF="ch38_05.htm"TITLE="The ps Command ">38.5</A>)</SPAN>command,which lists all the programs you are running, also gives you useful information about the status of each program and the amount of CPU time it has consumed.Note that <EMCLASS="emphasis">ps</EM> lists all the programs you are running, including programs you maynot know about (e.g., programs that other programs execute automatically).</P></DIV><DIVCLASS="sect1info"><PCLASS="SECT1INFO">- <SPANCLASS="authorinitials">JP</SPAN>, <SPANCLASS="authorinitials">ML</SPAN></P></DIV></DIV><DIVCLASS="htmlnav"><P></P><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch42_01.htm"TITLE="42.1 Making Sense Out of the Terminal Mess "><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 42.1 Making Sense Out of the Terminal Mess "BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="book"HREF="index.htm"TITLE="UNIX Power Tools"><IMGSRC="../gifs/txthome.gif"ALT="UNIX Power Tools"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch42_03.htm"TITLE="42.3 Why Changing TERM Sometimes Doesn't Work "><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 42.3 Why Changing TERM Sometimes Doesn't Work "BORDER="0"></A></TD></TR><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172">42.1 Making Sense Out of the Terminal Mess </TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="index"HREF="index/idx_0.htm"TITLE="Book Index"><IMGSRC="../gifs/index.gif"ALT="Book Index"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172">42.3 Why Changing TERM Sometimes Doesn't Work </TD></TR></TABLE><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><IMGSRC="../gifs/smnavbar.gif"USEMAP="#map"BORDER="0"ALT="The UNIX CD Bookshelf Navigation"><MAPNAME="map"><AREASHAPE="RECT"COORDS="0,0,73,21"HREF="../index.htm"ALT="The UNIX CD Bookshelf"><AREASHAPE="RECT"COORDS="74,0,163,21"HREF="index.htm"ALT="UNIX Power Tools"><AREASHAPE="RECT"COORDS="164,0,257,21"HREF="../unixnut/index.htm"ALT="UNIX in a Nutshell"><AREASHAPE="RECT"COORDS="258,0,321,21"HREF="../vi/index.htm"ALT="Learning the vi Editor"><AREASHAPE="RECT"COORDS="322,0,378,21"HREF="../sedawk/index.htm"ALT="sed &amp; awk"><AREASHAPE="RECT"COORDS="379,0,438,21"HREF="../ksh/index.htm"ALT="Learning the Korn Shell"><AREASHAPE="RECT"COORDS="439,0,514,21"HREF="../lrnunix/index.htm"ALT="Learning the UNIX Operating System"></MAP></DIV></BODY></HTML>