<HTML><HEAD><TITLE>[Chapter 43] 43.15 From a Source File to the Printer </TITLE><METANAME="DC.title"CONTENT="UNIX Power Tools"><METANAME="DC.creator"CONTENT="Jerry Peek, Tim O'Reilly &amp; Mike Loukides"><METANAME="DC.publisher"CONTENT="O'Reilly &amp; Associates, Inc."><METANAME="DC.date"CONTENT="1998-10-23T15:51:57Z"><METANAME="DC.type"CONTENT="Text.Monograph"><METANAME="DC.format"CONTENT="text/html"SCHEME="MIME"><METANAME="DC.source"CONTENT="1-56592-260-3"SCHEME="ISBN"><METANAME="DC.language"CONTENT="en-US"><METANAME="generator"CONTENT="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><LINKREV="made"HREF="mailto:online-books@oreilly.com"TITLE="Online Books Comments"><LINKREL="up"HREF="ch43_01.htm"TITLE="43. Printing"><LINKREL="prev"HREF="ch43_14.htm"TITLE="43.14 nroff/troff and Macro Packages "><LINKREL="next"HREF="ch43_16.htm"TITLE="43.16 groff "></HEAD><BODYBGCOLOR="#FFFFFF"TEXT="#000000"><DIVCLASS="htmlnav"><H1><IMGSRC="gifs/smbanner.gif"ALT="UNIX Power Tools"USEMAP="#srchmap"BORDER="0"></H1><MAPNAME="srchmap"><AREASHAPE="RECT"COORDS="0,0,466,58"HREF="index.htm"ALT="UNIX Power Tools"><AREASHAPE="RECT"COORDS="467,0,514,18"HREF="../search/psrch.htm"ALT="Search this book"></MAP><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch43_14.htm"TITLE="43.14 nroff/troff and Macro Packages "><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 43.14 nroff/troff and Macro Packages "BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><B><FONTFACE="ARIEL,HELVETICA,HELV,SANSERIF"SIZE="-1">Chapter 43<BR>Printing</FONT></B></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch43_16.htm"TITLE="43.16 groff "><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 43.16 groff "BORDER="0"></A></TD></TR></TABLE>&nbsp;<HRALIGN="LEFT"WIDTH="515"TITLE="footer"></DIV><DIVCLASS="SECT1"><H2CLASS="sect1"><ACLASS="title"NAME="UPT-ART-2480">43.15 From a Source File to the Printer </A></H2><PCLASS="para">The path from a TeX or <EMCLASS="emphasis">troff</EM> source file to your printer issurprisingly complex.It's often useful to know exactly what ishappening.It isn't knowledge that will help you &quot;do anything&quot; (i.e.,you won't be able to make fancier documents), but it will come inhandy&nbsp;- particularly when something goes wrong.</P><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-48363"></A>For TeX and <EMCLASS="emphasis">troff</EM>, the processing is surprisingly similar, asshown in<ACLASS="xref"HREF="ch43_15.htm#UPT-ART-2480-FIG-0"TITLE="Processing Path for TeX or troff Source File">Figure 43.1</A>.</P><H4CLASS="figure"><ACLASS="title"NAME="UPT-ART-2480-FIG-0">Figure 43.1: Processing Path for TeX or troff Source File</A></H4><IMGCLASS="graphic"SRC="figs/2480.gif"ALT="Figure 43.1"><PCLASS="para">You start with a source file, containing your text and markup.First,it's processed by one or more <EMCLASS="emphasis">preprocessors</EM> to handle figures,tables, and so on.Preprocessors are essential to <EMCLASS="emphasis">troff</EM>; theyaren't used that often with TeX, but they do exist.What a preprocessor does is provide a simpler language for formattingcomplex elements like tables, equations, or figures; the preprocessorinterprets this language, and outputs the low-level <EMCLASS="emphasis">troff</EM> requestsneeded to implement the desired result.</P><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-48376"></A>The most commonlyused preprocessors are listed in<ACLASS="xref"HREF="ch43_15.htm#UPT-ART-2480-TAB-0"TITLE="Common troff and TeX Preprocessors">Table 43.1</A></P><TABLECLASS="table"><CAPTIONCLASS="table"><ACLASS="title"NAME="UPT-ART-2480-TAB-0">Table 43.1: Common troff and TeX Preprocessors</A></CAPTION><THEADCLASS="thead"><TRCLASS="row"VALIGN="TOP"><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Name</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Used with</TH><THCLASS="entry"ALIGN="LEFT"ROWSPAN="1"COLSPAN="1">Function</TH></TR></THEAD><TBODYCLASS="tbody"><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">pic</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">troff</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Illustrations</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">grap</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">troff</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Graphs; not frequently used</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">tbl</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">troff</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Tables</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">eqn</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">troff</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Equations</TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">tpic</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">TeX</TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1">Illustrations; equivalent to <EMCLASS="emphasis">pic</EM></TD></TR></TBODY></TABLE><PCLASS="para">After going through the preprocessors, you're left with a &quot;pure&quot;document that consists of basic commands and macros.This is fed intothe TeX or <EMCLASS="emphasis">troff</EM> processor, which starts by adding a &quot;macrodefinition file&quot; to the beginning of your text.The processor thenproduces a device independent file; this is a generic representation ofyour document in terms of low-level commands.You can't do much withdevice-independent output except (possibly) inspect it for bugs.</P><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-48413"></A>Before going on, a word about macro files.A macro file is nothingmore than a file of <EMCLASS="emphasis">troff</EM> or TeX commands that defines macros,sets up page borders, headers, footers, and so on.Basically, a macrofile defines the look of your document, together with any&quot;high-level&quot; (e.g., paragraph or heading) commands that you use.For <EMCLASS="emphasis">troff</EM>, these files are kept in the directory <EMCLASS="emphasis">/usr/lib/tmac</EM>and have filenames like <EMCLASS="emphasis">tmac.name</EM>; when you invoke <EMCLASS="emphasis">troff</EM>,you give the option <CODECLASS="literal">-m</CODE><CODECLASS="replaceable"><I>name</I></CODE> to select a macro package.</P><PCLASS="para">Since the macro file is nothing more than another file of <EMCLASS="emphasis">troff</EM>commands, there's no reason you can't just stick it onto the front ofyour source file.That is, the command:</P><PCLASS="para"><TABLECLASS="screen.co"BORDER="1"><TR><THVALIGN="TOP"><PRECLASS="calloutlist"><ACLASS="co"HREF="ch08_05.htm"TITLE="8.5 Command-Line Evaluation ">;</A> </PRE></TH><TDVALIGN="TOP"><PRECLASS="screen">% <CODECLASS="userinput"><B>cat /usr/lib/tmac/tmac.s myfile.ms &gt; foo.ms; troff foo.ms</B></CODE></PRE></TD></TR></TABLE></P><PCLASS="para">is completely equivalent to <CODECLASS="literal">troff&nbsp;-ms&nbsp;foo.ms</CODE>.</P><PCLASS="para">Why would you want to insert the macro file &quot;by hand&quot;?You usuallydon't; but if you're debugging a new macro file, or ifyou're defining one or two special macros for your own purposes,adding the macros by hand can be a useful trick.</P><PCLASS="para">After <EMCLASS="emphasis">troff</EM> or TeX has finished grinding your file intodust, you're left with a device independent (or DVI) file.  I'm reallystretching terminology here, but (conceptually) this is the right wayto think.  The problem is that there are two versions of<EMCLASS="emphasis">troff</EM>: device independent <EMCLASS="emphasis">troff</EM>, or <EMCLASS="emphasis">ditroff</EM>, and&quot;old&quot; <EMCLASS="emphasis">troff</EM>.  <EMCLASS="emphasis">ditroff</EM> is the only one that reallygenerates device independent output: generic output that caneasily be translated into a file for any printer.  The old <EMCLASS="emphasis">troff</EM>generates output for a C/A/T phototypesetter, an archaic beast thatprobably exists only in museums.  C/A/T output is not deviceindependent at all: it reflects lots of C/A/T idiosyncraciesthat are a pain to deal with. However, conceptually, you can think ofC/A/T output as device independent output with a botcheddesign; it's certainly independent of any device you're likely to see!<CODECLASS="literal">:-)</CODE></P><PCLASS="para">The concept of device independent output really originated with TeX;TeX's DVI files are very well defined and quite elegant.Unfortunately, they're completely different from <EMCLASS="emphasis">ditroff</EM>&nbsp;'s DVIfiles. And if you're using some &quot;third-party&quot; version of <EMCLASS="emphasis">troff</EM>, likeSoftQuad's <EMCLASS="emphasis">sqtroff</EM> or the FSF's <EMCLASS="emphasis">groff</EM>, you probably haveyet another kind of device independent output to deal with.Although they sound like they're standardized, device independentformats aren't.</P><PCLASS="para">At any rate, once your processor is finished, its device independentoutput (of whatever type) needs to be converted to commands for yourprinter. This is done by a postprocessor. The name of thepostprocessor depends entirely onwhat kind of printer you're using, which version of TeX or <EMCLASS="emphasis">troff</EM>you're using, and where you bought your software.One such program is<EMCLASS="emphasis">psroff</EM>, which is part of Adobe's <EMCLASS="emphasis">transcript</EM> package; itconverts <EMCLASS="emphasis">ditroff</EM> output to PostScript.</P><PCLASS="para">Although this may seem complex, most of this is invisible toyou; most often, you'll invoke <EMCLASS="emphasis">troff</EM> through a script that willhandle all the postprocessing (and possibly even the preprocessing)for you.However, when you need to debug something that isn'tworking, there's no substitute for understanding the machinery.</P><DIVCLASS="sect1info"><PCLASS="SECT1INFO">- <SPANCLASS="authorinitials">ML</SPAN></P></DIV></DIV><DIVCLASS="htmlnav"><P></P><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch43_14.htm"TITLE="43.14 nroff/troff and Macro Packages "><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 43.14 nroff/troff and Macro Packages "BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="book"HREF="index.htm"TITLE="UNIX Power Tools"><IMGSRC="../gifs/txthome.gif"ALT="UNIX Power Tools"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch43_16.htm"TITLE="43.16 groff "><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 43.16 groff "BORDER="0"></A></TD></TR><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172">43.14 nroff/troff and Macro Packages </TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="index"HREF="index/idx_0.htm"TITLE="Book Index"><IMGSRC="../gifs/index.gif"ALT="Book Index"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172">43.16 groff </TD></TR></TABLE><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><IMGSRC="../gifs/smnavbar.gif"USEMAP="#map"BORDER="0"ALT="The UNIX CD Bookshelf Navigation"><MAPNAME="map"><AREASHAPE="RECT"COORDS="0,0,73,21"HREF="../index.htm"ALT="The UNIX CD Bookshelf"><AREASHAPE="RECT"COORDS="74,0,163,21"HREF="index.htm"ALT="UNIX Power Tools"><AREASHAPE="RECT"COORDS="164,0,257,21"HREF="../unixnut/index.htm"ALT="UNIX in a Nutshell"><AREASHAPE="RECT"COORDS="258,0,321,21"HREF="../vi/index.htm"ALT="Learning the vi Editor"><AREASHAPE="RECT"COORDS="322,0,378,21"HREF="../sedawk/index.htm"ALT="sed &amp; awk"><AREASHAPE="RECT"COORDS="379,0,438,21"HREF="../ksh/index.htm"ALT="Learning the Korn Shell"><AREASHAPE="RECT"COORDS="439,0,514,21"HREF="../lrnunix/index.htm"ALT="Learning the UNIX Operating System"></MAP></DIV></BODY></HTML>