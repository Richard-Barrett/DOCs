<HTML><HEAD><TITLE>[Chapter 44] Shell Programming for the Uninitiated</TITLE><METANAME="DC.title"CONTENT="UNIX Power Tools"><METANAME="DC.creator"CONTENT="Jerry Peek, Tim O'Reilly &amp; Mike Loukides"><METANAME="DC.publisher"CONTENT="O'Reilly &amp; Associates, Inc."><METANAME="DC.date"CONTENT="1998-08-04T21:53:22Z"><METANAME="DC.type"CONTENT="Text.Monograph"><METANAME="DC.format"CONTENT="text/html"SCHEME="MIME"><METANAME="DC.source"CONTENT="1-56592-260-3"SCHEME="ISBN"><METANAME="DC.language"CONTENT="en-US"><METANAME="generator"CONTENT="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><LINKREV="made"HREF="mailto:online-books@oreilly.com"TITLE="Online Books Comments"><LINKREL="up"HREF="part08.htm"TITLE="VIII. Shell Programming "><LINKREL="prev"HREF="part08.htm"TITLE="VIII. Shell Programming "><LINKREL="next"HREF="ch44_02.htm"TITLE="44.2 Writing a Simple Shell Program "></HEAD><BODYBGCOLOR="#FFFFFF"TEXT="#000000"><DIVCLASS="htmlnav"><H1><IMGSRC="gifs/smbanner.gif"ALT="UNIX Power Tools"USEMAP="#srchmap"BORDER="0"></H1><MAPNAME="srchmap"><AREASHAPE="RECT"COORDS="0,0,466,58"HREF="index.htm"ALT="UNIX Power Tools"><AREASHAPE="RECT"COORDS="467,0,514,18"HREF="../search/psrch.htm"ALT="Search this book"></MAP><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="PART"HREF="part08.htm"TITLE="VIII. Shell Programming "><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: VIII. Shell Programming "BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><B><FONTFACE="ARIEL,HELVETICA,HELV,SANSERIF"SIZE="-1">Chapter 44</FONT></B></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch44_02.htm"TITLE="44.2 Writing a Simple Shell Program "><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 44.2 Writing a Simple Shell Program "BORDER="0"></A></TD></TR></TABLE>&nbsp;<HRALIGN="LEFT"WIDTH="515"TITLE="footer"></DIV><DIVCLASS="CHAPTER"><H1CLASS="chapter"><ACLASS="title"NAME="UPT-CHP-44">44. Shell Programming for the Uninitiated</A></H1><DIVCLASS="htmltoc"><P><B>Contents:</B><BR><ACLASS="sect1"HREF="#UPT-ART-0065"TITLE="44.1 Everyone Should Learn Some Shell Programming ">Everyone Should Learn Some Shell Programming </A><BR><ACLASS="sect1"HREF="ch44_02.htm"TITLE="44.2 Writing a Simple Shell Program ">Writing a Simple Shell Program </A><BR><ACLASS="sect1"HREF="ch44_03.htm"TITLE="44.3 What's a Shell, Anyway? ">What's a Shell, Anyway? </A><BR><ACLASS="sect1"HREF="ch44_04.htm"TITLE="44.4 Testing How Your System Executes Files ">Testing How Your System Executes Files </A><BR><ACLASS="sect1"HREF="ch44_05.htm"TITLE="44.5 Test String Values with Bourne Shell case ">Test String Values with Bourne Shell case </A><BR><ACLASS="sect1"HREF="ch44_06.htm"TITLE="44.6 Pattern Matching in case Statements ">Pattern Matching in case Statements </A><BR><ACLASS="sect1"HREF="ch44_07.htm"TITLE="44.7 Exit Status of UNIX Processes ">Exit Status of UNIX Processes </A><BR><ACLASS="sect1"HREF="ch44_08.htm"TITLE="44.8 Test Exit Status with the if Statement ">Test Exit Status with the if Statement </A><BR><ACLASS="sect1"HREF="ch44_09.htm"TITLE="44.9 Testing Your Success ">Testing Your Success </A><BR><ACLASS="sect1"HREF="ch44_10.htm"TITLE="44.10 Loops That Test Exit Status ">Loops That Test Exit Status </A><BR><ACLASS="sect1"HREF="ch44_11.htm"TITLE="44.11 Set Exit Status of a Shell (Script) ">Set Exit Status of a Shell (Script) </A><BR><ACLASS="sect1"HREF="ch44_12.htm"TITLE="44.12 Trapping Exits Caused by Interrupts ">Trapping Exits Caused by Interrupts </A><BR><ACLASS="sect1"HREF="ch44_13.htm"TITLE="44.13 read: Reading from the Keyboard ">read: Reading from the Keyboard </A><BR><ACLASS="sect1"HREF="ch44_14.htm"TITLE="44.14 Putting awk, sed, etc., Inside Shell Scripts ">Putting awk, sed, etc., Inside Shell Scripts </A><BR><ACLASS="sect1"HREF="ch44_15.htm"TITLE="44.15 Handling Command-Line Arguments in Shell Scripts ">Handling Command-Line Arguments in Shell Scripts </A><BR><ACLASS="sect1"HREF="ch44_16.htm"TITLE="44.16 Handling Command-Line Arguments with a for Loop ">Handling Command-Line Arguments with a for Loop </A><BR><ACLASS="sect1"HREF="ch44_17.htm"TITLE="44.17 Handling Arguments with while and shift ">Handling Arguments with while and shift </A><BR><ACLASS="sect1"HREF="ch44_18.htm"TITLE="44.18 Standard Command-Line Parsing ">Standard Command-Line Parsing </A><BR><ACLASS="sect1"HREF="ch44_19.htm"TITLE="44.19 The Bourne Shell set Command ">The Bourne Shell set Command </A><BR><ACLASS="sect1"HREF="ch44_20.htm"TITLE="44.20 test: Testing Files and Strings ">test: Testing Files and Strings </A><BR><ACLASS="sect1"HREF="ch44_21.htm"TITLE="44.21 Picking a Name for a New Command ">Picking a Name for a New Command </A><BR><ACLASS="sect1"HREF="ch44_22.htm"TITLE="44.22 Finding a Program Name; Multiple Program Names ">Finding a Program Name; Multiple Program Names </A><BR><ACLASS="sect1"HREF="ch44_23.htm"TITLE="44.23 Reading Files with the . and source Commands ">Reading Files with the . and source Commands </A></P><P></P></DIV><DIVCLASS="sect1"><H2CLASS="sect1"><ACLASS="title"NAME="UPT-ART-0065">44.1 Everyone Should Learn Some Shell Programming </A></H2><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-49912"></A><ACLASS="indexterm"NAME="AUTOID-49914"></A><ACLASS="indexterm"NAME="AUTOID-49917"></A>One of the great things about UNIX is that it's made up of individualutilities, &quot;building blocks&quot; like <EMCLASS="emphasis">cat</EM> and <EMCLASS="emphasis">grep</EM>, that you runfrom a shell prompt.Using pipes, redirection, filters, and so on, you can combine thoseutilities to do an incredible number of things.Shell programming lets you take the same commands you'd type at a shellprompt&nbsp;- and put them into a file you can run by just typing its name.You can make new programs that combine UNIX programs (and other shellscripts) in your own way to do exactly what you need.If you don't like the way a program works, you can write a shell scriptto do just what you want.</P><PCLASS="para">Because many UNIX users use the shell every day, they don't need tolearn a whole new language for programming... just some tips andtechniques.In fact, this chapter covers a lot of programming techniques thatyou'll want to use even when you aren'tprogramming. For example, loops and tests are handy on thecommand line.</P><PCLASS="para">(This series of articles does assume that you've written programs in some language before, or are generally familiar withprogramming concepts.If you haven't, you might start with a more comprehensive shellprogramming book.)</P><PCLASS="para">Some of the topics you need to learn about as a beginning shellprogrammer have already been covered in other chapters. Here are the articles you'll probably want to read&nbsp;- in an orderthat makes sense if you're looking for something of a tutorial:</P><ULCLASS="itemizedlist"><LICLASS="listitem"><PCLASS="para">To see how to write a simple shell program, article<ACLASS="xref"HREF="ch44_02.htm"TITLE="Writing a Simple Shell Program ">44.2</A>.To embed scripts from other languages like <EMCLASS="emphasis">sed</EM> and <EMCLASS="emphasis">awk</EM> ina shell script, article<ACLASS="xref"HREF="ch44_14.htm"TITLE="Putting awk, sed, etc., Inside Shell Scripts ">44.14</A>.</P></LI><LICLASS="listitem"><PCLASS="para">For explanation of shells in general, article<ACLASS="xref"HREF="ch44_03.htm"TITLE="What's a Shell, Anyway? ">44.3</A>.</P></LI><LICLASS="listitem"><PCLASS="para">To test how your system executes files so you'll know how to write yourshell programs, article<ACLASS="xref"HREF="ch44_04.htm"TITLE="Testing How Your System Executes Files ">44.4</A>.</P></LI><LICLASS="listitem"><PCLASS="para">To read about environment and shell variables, articles<ACLASS="xref"HREF="ch06_01.htm#UPT-ART-1170"TITLE="What Environment Variables Are Good For ">6.1</A>and<ACLASS="xref"HREF="ch06_08.htm"TITLE="Shell Variables ">6.8</A>,respectively.</P></LI><LICLASS="listitem"><PCLASS="para">The <EMCLASS="emphasis">echo</EM> command is covered by article<ACLASS="xref"HREF="ch08_06.htm"TITLE="Output Command-Line Arguments ">8.6</A>.</P></LI><LICLASS="listitem"><PCLASS="para">Shell quoting is explained in article<ACLASS="xref"HREF="ch08_14.htm"TITLE="Bourne Shell Quoting ">8.14</A>.</P></LI><LICLASS="listitem"><PCLASS="para">Test strings with a <EMCLASS="emphasis">case</EM> statement, article<ACLASS="xref"HREF="ch44_05.htm"TITLE="Test String Values with Bourne Shell case ">44.5</A>.Match patterns in a <EMCLASS="emphasis">case</EM> statement, article<ACLASS="xref"HREF="ch44_06.htm"TITLE="Pattern Matching in case Statements ">44.6</A>.</P></LI><LICLASS="listitem"><PCLASS="para">Use the output of one command as arguments to another commandwith command substitution, article<ACLASS="xref"HREF="ch09_16.htm"TITLE="Command Substitution ">9.16</A>.</P></LI><LICLASS="listitem"><PCLASS="para">Find out whether a program worked or failed with its exit status,article<ACLASS="xref"HREF="ch44_07.htm"TITLE="Exit Status of UNIX Processes ">44.7</A>.</P></LI><LICLASS="listitem"><PCLASS="para">Test a program's exit status and do different things if it worked or failed,articles<ACLASS="xref"HREF="ch44_08.htm"TITLE="Test Exit Status with the if Statement ">44.8</A>and<ACLASS="xref"HREF="ch44_09.htm"TITLE="Testing Your Success ">44.9</A>.</P></LI><LICLASS="listitem"><PCLASS="para">Loop through a set of commands and use another command to control that loop,article<ACLASS="xref"HREF="ch44_10.htm"TITLE="Loops That Test Exit Status ">44.10</A>.</P></LI><LICLASS="listitem"><PCLASS="para">Set exit status of a shell (shell script), article<ACLASS="xref"HREF="ch44_11.htm"TITLE="Set Exit Status of a Shell (Script) ">44.11</A>.</P></LI><LICLASS="listitem"><PCLASS="para">Handle interrupts (like CTRL-c) and other signals, article<ACLASS="xref"HREF="ch44_12.htm"TITLE="Trapping Exits Caused by Interrupts ">44.12</A>.</P></LI><LICLASS="listitem"><PCLASS="para">Read input from the keyboard, article<ACLASS="xref"HREF="ch44_13.htm"TITLE="read: Reading from the Keyboard ">44.13</A>.</P></LI><LICLASS="listitem"><PCLASS="para">Handle command-line arguments (options, filenames, etc.), article<ACLASS="xref"HREF="ch44_15.htm"TITLE="Handling Command-Line Arguments in Shell Scripts ">44.15</A>.</P></LI><LICLASS="listitem"><PCLASS="para">Step through arguments, or any list of words, with a <EMCLASS="emphasis">for</EM> loop,articles<ACLASS="xref"HREF="ch09_12.htm"TITLE="The Bourne Shell for Loop ">9.12</A>and<ACLASS="xref"HREF="ch44_16.htm"TITLE="Handling Command-Line Arguments with a for Loop ">44.16</A>.</P></LI><LICLASS="listitem"><PCLASS="para">Handle arguments with the <EMCLASS="emphasis">while</EM> and <EMCLASS="emphasis">shift</EM> commands, article<ACLASS="xref"HREF="ch44_17.htm"TITLE="Handling Arguments with while and shift ">44.17</A>.</P></LI><LICLASS="listitem"><PCLASS="para">Handle command-line arguments in a more standard and portable waywith <EMCLASS="emphasis">getopt</EM>, article<ACLASS="xref"HREF="ch44_18.htm"TITLE="Standard Command-Line Parsing ">44.18</A>.</P></LI><LICLASS="listitem"><PCLASS="para">Set shell options and command-line arguments with the <EMCLASS="emphasis">set</EM> command,article<ACLASS="xref"HREF="ch44_19.htm"TITLE="The Bourne Shell set Command ">44.19</A>.</P></LI><LICLASS="listitem"><PCLASS="para">Test files and strings of characters with the <EMCLASS="emphasis">test</EM> command,article<ACLASS="xref"HREF="ch44_20.htm"TITLE="test: Testing Files and Strings ">44.20</A>.</P></LI><LICLASS="listitem"><PCLASS="para">Pick a name for a new command with no conflict, article<ACLASS="xref"HREF="ch44_21.htm"TITLE="Picking a Name for a New Command ">44.21</A>.</P></LI><LICLASS="listitem"><PCLASS="para">Find the name of a program and use it in the script, article<ACLASS="xref"HREF="ch44_22.htm"TITLE="Finding a Program Name; Multiple Program Names ">44.22</A>.</P></LI><LICLASS="listitem"><PCLASS="para">Use &quot;subprograms&quot; that can change the current environment, article<ACLASS="xref"HREF="ch44_23.htm"TITLE="Reading Files with the . and source Commands ">44.23</A>.</P></LI></UL><PCLASS="para">This chapter discusses only Bourne shell programming.In most cases, the C shell<SPANCLASS="link">isn't great for shell programming (<ACLASS="linkend"HREF="ch47_02.htm"TITLE="C Shell Programming Considered Harmful ">47.2</A>)</SPAN>.</P><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-50013"></A>A note about command versions: unfortunately, the same commands on different versions of UNIX canhave different options.Some Bourne shells are a little different from others.For instance, some<SPANCLASS="link"><EMCLASS="emphasis">test</EM> (<ACLASS="linkend"HREF="ch44_20.htm"TITLE="test: Testing Files and Strings ">44.20</A>)</SPAN>commands have a <EMCLASS="emphasis">-x</EM> option to test for anexecutable file; others don't.As article<ACLASS="xref"HREF="ch46_10.htm"TITLE="A Portable echo Command ">46.10</A>explains,some <EMCLASS="emphasis">echo</EM> commands use a <EMCLASS="emphasis">-n</EM> option to mean &quot;no newline at theend of this string&quot;; others have you put <CODECLASS="literal">\c</CODE> at the end of the string.And so on.Where there are differences, these articles generally use the commands inBerkeley UNIX.If a command doesn't seem to work on your system, check its onlinemanual page or the <EMCLASS="emphasis">sh</EM> manual page.</P><DIVCLASS="sect1info"><PCLASS="SECT1INFO">- <SPANCLASS="authorinitials">JP</SPAN></P></DIV></DIV></DIV><DIVCLASS="htmlnav"><P></P><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="PART"HREF="part08.htm"TITLE="VIII. Shell Programming "><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: VIII. Shell Programming "BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="book"HREF="index.htm"TITLE="UNIX Power Tools"><IMGSRC="../gifs/txthome.gif"ALT="UNIX Power Tools"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch44_02.htm"TITLE="44.2 Writing a Simple Shell Program "><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 44.2 Writing a Simple Shell Program "BORDER="0"></A></TD></TR><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172">VIII. Shell Programming </TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="index"HREF="index/idx_0.htm"TITLE="Book Index"><IMGSRC="../gifs/index.gif"ALT="Book Index"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172">44.2 Writing a Simple Shell Program </TD></TR></TABLE><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><IMGSRC="../gifs/smnavbar.gif"USEMAP="#map"BORDER="0"ALT="The UNIX CD Bookshelf Navigation"><MAPNAME="map"><AREASHAPE="RECT"COORDS="0,0,73,21"HREF="../index.htm"ALT="The UNIX CD Bookshelf"><AREASHAPE="RECT"COORDS="74,0,163,21"HREF="index.htm"ALT="UNIX Power Tools"><AREASHAPE="RECT"COORDS="164,0,257,21"HREF="../unixnut/index.htm"ALT="UNIX in a Nutshell"><AREASHAPE="RECT"COORDS="258,0,321,21"HREF="../vi/index.htm"ALT="Learning the vi Editor"><AREASHAPE="RECT"COORDS="322,0,378,21"HREF="../sedawk/index.htm"ALT="sed &amp; awk"><AREASHAPE="RECT"COORDS="379,0,438,21"HREF="../ksh/index.htm"ALT="Learning the Korn Shell"><AREASHAPE="RECT"COORDS="439,0,514,21"HREF="../lrnunix/index.htm"ALT="Learning the UNIX Operating System"></MAP></DIV></BODY></HTML>