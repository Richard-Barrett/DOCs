<HTML><HEAD><TITLE>[Chapter 45] 45.3 Don't Need a Shell for Your Script?  Don't Use One </TITLE><METANAME="DC.title"CONTENT="UNIX Power Tools"><METANAME="DC.creator"CONTENT="Jerry Peek, Tim O'Reilly &amp; Mike Loukides"><METANAME="DC.publisher"CONTENT="O'Reilly &amp; Associates, Inc."><METANAME="DC.date"CONTENT="1998-08-04T21:54:21Z"><METANAME="DC.type"CONTENT="Text.Monograph"><METANAME="DC.format"CONTENT="text/html"SCHEME="MIME"><METANAME="DC.source"CONTENT="1-56592-260-3"SCHEME="ISBN"><METANAME="DC.language"CONTENT="en-US"><METANAME="generator"CONTENT="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><LINKREV="made"HREF="mailto:online-books@oreilly.com"TITLE="Online Books Comments"><LINKREL="up"HREF="ch45_01.htm"TITLE="45. Shell Programming for the Initiated"><LINKREL="prev"HREF="ch45_02.htm"TITLE="45.2 The Story of  : #  #! "><LINKREL="next"HREF="ch45_04.htm"TITLE="45.4 Fun with #! "></HEAD><BODYBGCOLOR="#FFFFFF"TEXT="#000000"><DIVCLASS="htmlnav"><H1><IMGSRC="gifs/smbanner.gif"ALT="UNIX Power Tools"USEMAP="#srchmap"BORDER="0"></H1><MAPNAME="srchmap"><AREASHAPE="RECT"COORDS="0,0,466,58"HREF="index.htm"ALT="UNIX Power Tools"><AREASHAPE="RECT"COORDS="467,0,514,18"HREF="../search/psrch.htm"ALT="Search this book"></MAP><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch45_02.htm"TITLE="45.2 The Story of  : #  #! "><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 45.2 The Story of  : #  #! "BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><B><FONTFACE="ARIEL,HELVETICA,HELV,SANSERIF"SIZE="-1">Chapter 45<BR>Shell Programming for the Initiated</FONT></B></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch45_04.htm"TITLE="45.4 Fun with #! "><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 45.4 Fun with #! "BORDER="0"></A></TD></TR></TABLE>&nbsp;<HRALIGN="LEFT"WIDTH="515"TITLE="footer"></DIV><DIVCLASS="SECT1"><H2CLASS="sect1"><ACLASS="title"NAME="UPT-ART-0182">45.3 Don't Need a Shell for Your Script?  Don't Use One </A></H2><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-52295"></A><ACLASS="indexterm"NAME="AUTOID-52299"></A><ACLASS="indexterm"NAME="AUTOID-52302"></A><ACLASS="indexterm"NAME="AUTOID-52305"></A>If your UNIX<SPANCLASS="link">understands (<ACLASS="linkend"HREF="ch44_04.htm"TITLE="Testing How Your System Executes Files ">44.4</A>)</SPAN>files that start with:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">#!<CODECLASS="replaceable"><I>/interpreter/program</I></CODE></PRE></BLOCKQUOTE></P><PCLASS="para">you don't have to use those lines to start a shell, such as <CODECLASS="literal">#!/bin/sh</CODE>.If your script is just starting a program like <EMCLASS="emphasis">awk</EM>, UNIX can start theprogram directly and save execution time.This is especially useful on small or overloaded computers, or when yourscript has to be called over and over (such as in a loop).</P><PCLASS="para">First, here are two scripts.Both scripts print the second word from each line of text files.One uses a shell; the other runs <EMCLASS="emphasis">awk</EM> directly:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">% <CODECLASS="userinput"><B>cat with_sh</B></CODE>#!/bin/shawk '{ print $2 }' $*% <CODECLASS="userinput"><B>cat no_sh</B></CODE>#!/usr/bin/awk -f{ print $2 }% <CODECLASS="userinput"><B>cat afile</B></CODE>one two three four five</PRE></BLOCKQUOTE></P><PCLASS="para">Let's run both commands and<SPANCLASS="link"><EMCLASS="emphasis">time</EM> (<ACLASS="linkend"HREF="ch39_02.htm"TITLE="Timing Programs ">39.2</A>)</SPAN>them:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">% <CODECLASS="userinput"><B>time with_sh afile</B></CODE>two0.1u 0.2s 0:00 26%% <CODECLASS="userinput"><B>time no_sh afile</B></CODE>two0.0u 0.1s 0:00 13%</PRE></BLOCKQUOTE></P><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-52330"></A><ACLASS="indexterm"NAME="AUTOID-52333"></A><ACLASS="indexterm"NAME="AUTOID-52336"></A>One of the things that's really important to understand here is thatwhen the kernel runs the program on the interpreter line, it is giventhe script's filename as an argument.If the intepreter program understands afile directly, like <EMCLASS="emphasis">/bin/sh</EM> does, nothing special needs to bedone.But a program like <EMCLASS="emphasis">awk</EM> or <EMCLASS="emphasis">sed</EM> requires the<EMCLASS="emphasis">-f</EM> option if it is to read its script from a file.This leadsto the seemingly odd syntax in the example above, with a call to <EMCLASS="emphasis">awk -f</EM> with no following filename.The script itself isthe input file!</P><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-52345"></A>One implication of this usage is that the interpreter program needsto understand <CODECLASS="literal">#</CODE> as a comment, or that first interpreter-selection line itself will be acted upon (and probably rejected by) the interpreter.(Fortunately, the shells, <EMCLASS="emphasis">perl</EM>, <EMCLASS="emphasis">sed</EM>, and <EMCLASS="emphasis">awk</EM> dorecognize this comment character.)</P><DIVCLASS="sect1info"><PCLASS="SECT1INFO">- <SPANCLASS="authorinitials">JP</SPAN></P></DIV></DIV><DIVCLASS="htmlnav"><P></P><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch45_02.htm"TITLE="45.2 The Story of  : #  #! "><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 45.2 The Story of  : #  #! "BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="book"HREF="index.htm"TITLE="UNIX Power Tools"><IMGSRC="../gifs/txthome.gif"ALT="UNIX Power Tools"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch45_04.htm"TITLE="45.4 Fun with #! "><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 45.4 Fun with #! "BORDER="0"></A></TD></TR><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172">45.2 The Story of  : #  #! </TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="index"HREF="index/idx_0.htm"TITLE="Book Index"><IMGSRC="../gifs/index.gif"ALT="Book Index"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172">45.4 Fun with #! </TD></TR></TABLE><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><IMGSRC="../gifs/smnavbar.gif"USEMAP="#map"BORDER="0"ALT="The UNIX CD Bookshelf Navigation"><MAPNAME="map"><AREASHAPE="RECT"COORDS="0,0,73,21"HREF="../index.htm"ALT="The UNIX CD Bookshelf"><AREASHAPE="RECT"COORDS="74,0,163,21"HREF="index.htm"ALT="UNIX Power Tools"><AREASHAPE="RECT"COORDS="164,0,257,21"HREF="../unixnut/index.htm"ALT="UNIX in a Nutshell"><AREASHAPE="RECT"COORDS="258,0,321,21"HREF="../vi/index.htm"ALT="Learning the vi Editor"><AREASHAPE="RECT"COORDS="322,0,378,21"HREF="../sedawk/index.htm"ALT="sed &amp; awk"><AREASHAPE="RECT"COORDS="379,0,438,21"HREF="../ksh/index.htm"ALT="Learning the Korn Shell"><AREASHAPE="RECT"COORDS="439,0,514,21"HREF="../lrnunix/index.htm"ALT="Learning the UNIX Operating System"></MAP></DIV></BODY></HTML>