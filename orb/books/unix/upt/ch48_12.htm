<HTML><HEAD><TITLE>[Chapter 48] 48.12 Using index with a Filter </TITLE><METANAME="DC.title"CONTENT="UNIX Power Tools"><METANAME="DC.creator"CONTENT="Jerry Peek, Tim O'Reilly &amp; Mike Loukides"><METANAME="DC.publisher"CONTENT="O'Reilly &amp; Associates, Inc."><METANAME="DC.date"CONTENT="1998-10-23T15:55:40Z"><METANAME="DC.type"CONTENT="Text.Monograph"><METANAME="DC.format"CONTENT="text/html"SCHEME="MIME"><METANAME="DC.source"CONTENT="1-56592-260-3"SCHEME="ISBN"><METANAME="DC.language"CONTENT="en-US"><METANAME="generator"CONTENT="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><LINKREV="made"HREF="mailto:online-books@oreilly.com"TITLE="Online Books Comments"><LINKREL="up"HREF="ch48_01.htm"TITLE="48. Office Automation"><LINKREL="prev"HREF="ch48_11.htm"TITLE="48.11 The index Database Program "><LINKREL="next"HREF="ch49_01.htm"TITLE="49. Working with Numbers"></HEAD><BODYBGCOLOR="#FFFFFF"TEXT="#000000"><DIVCLASS="htmlnav"><H1><IMGSRC="gifs/smbanner.gif"ALT="UNIX Power Tools"USEMAP="#srchmap"BORDER="0"></H1><MAPNAME="srchmap"><AREASHAPE="RECT"COORDS="0,0,466,58"HREF="index.htm"ALT="UNIX Power Tools"><AREASHAPE="RECT"COORDS="467,0,514,18"HREF="../search/psrch.htm"ALT="Search this book"></MAP><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch48_11.htm"TITLE="48.11 The index Database Program "><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 48.11 The index Database Program "BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><B><FONTFACE="ARIEL,HELVETICA,HELV,SANSERIF"SIZE="-1">Chapter 48<BR>Office Automation</FONT></B></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="CHAPTER"HREF="ch49_01.htm"TITLE="49. Working with Numbers"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 49. Working with Numbers"BORDER="0"></A></TD></TR></TABLE>&nbsp;<HRALIGN="LEFT"WIDTH="515"TITLE="footer"></DIV><DIVCLASS="SECT1"><H2CLASS="sect1"><ACLASS="title"NAME="UPT-ART-9028">48.12 Using index with a Filter </A></H2><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-58388"></A><ACLASS="indexterm"NAME="AUTOID-58391"></A>A particularly useful feature of the<SPANCLASS="link"><EMCLASS="emphasis">index</EM> (<ACLASS="linkend"HREF="ch48_11.htm"TITLE="The index Database Program ">48.11</A>)</SPAN>program is that you can usethe <EMCLASS="emphasis">-f</EM> option to filterthe output. When a filter is used, the <EMCLASS="emphasis">index</EM> program produces output in TAB-separated columns.Instead of listing each matching entry individually,the field titles are shown at the top, and each entry then appearsunderneath, displayed horizontally, with TABs between fields:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">% <CODECLASS="userinput"><B>index -f 'sed s/Mui/Mud/' addresses Peter</B></CODE>NAME    TITLE   ORGANIZATION    STREET ADDRESS  CITY    STATE   ...Henry K Smith           Peter Johnson &amp; Associates      324 Bur ...Peter Mud       International Sales Manager     O'Reilly and As ...Peter L. Loos   President       Introspective Solutions, Inc.   ...</PRE></BLOCKQUOTE></P><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-58402"></A>The TAB-separated fields don't line up properly on your screen, butthey make it convenient to manipulate columns using<SPANCLASS="link"><EMCLASS="emphasis">cut</EM> (<ACLASS="linkend"HREF="ch35_14.htm"TITLE="Cutting Columns or Fields with cut ">35.14</A>)</SPAN>,<SPANCLASS="link"><EMCLASS="emphasis">awk</EM> (<ACLASS="linkend"HREF="ch33_11.htm"TITLE="Quick Reference: awk ">33.11</A>)</SPAN>,or<SPANCLASS="link"><EMCLASS="emphasis">perl</EM> (<ACLASS="linkend"HREF="ch37_01.htm#UPT-ART-5560"TITLE="What We Do and Don't Tell You About Perl ">37.1</A>)</SPAN>.For example, you canuse the <EMCLASS="emphasis">cut</EM> command as your filter to limit the output to a fewsignificant fields:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">% <CODECLASS="userinput"><B>index -f 'cut -f1,8,10' addresses '.'</B></CODE>NAME    VOICE PHONE NUMBER      EMAIL ADDRESSHenry K Smith   617-555-1212    henry@pjaPaul S. Spencer        617-693-1111    paul@lotus.comPeter Mui       800-998-9938    peter@ora.com</PRE></BLOCKQUOTE></P><PCLASS="para">(We use <CODECLASS="literal">'.'</CODE> as the search string to match all entries.)</P><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-58418"></A><ACLASS="indexterm"NAME="AUTOID-58421"></A><ACLASS="indexterm"NAME="AUTOID-58423"></A>For your convenience, you can write up a shell script as a filterand place it in your <EMCLASS="emphasis">$HOME/.index</EM> directory with a <EMCLASS="emphasis">.fmt</EM>suffix.This feature comes in useful for particularly complicated filterprograms.For example, if you wantto be able to read the output of the previousexample properly, you can try using<EMCLASS="emphasis">awk</EM> as shown in article<ACLASS="xref"HREF="ch35_22.htm"TITLE="Straightening Jagged Columns ">35.22</A>,or you can just use<SPANCLASS="link"><EMCLASS="emphasis">tbl</EM> (<ACLASS="linkend"HREF="ch43_15.htm"TITLE="From a Source File to the Printer ">43.15</A>)</SPAN>and<SPANCLASS="link"><EMCLASS="emphasis">nroff</EM> (<ACLASS="linkend"HREF="ch43_13.htm"TITLE="The Text Formatters nroff, troff, ditroff, ... ">43.13</A>)</SPAN>.To do this in a single step, try writing a filter[Linda is a great typist; she uses<SPANCLASS="link"><CODECLASS="literal">cat&nbsp;&gt;&gt;</CODE> (<ACLASS="linkend"HREF="ch25_02.htm"TITLE="Four Ways to Skin a cat ">25.2</A>)</SPAN>to write short shell scripts (and show the script at the same time).A text editor likeEmacs or <EMCLASS="emphasis">vi</EM> will do fine, too, of course. -<EMCLASS="emphasis">JP</EM>&nbsp;]:</P><PCLASS="para"><TABLECLASS="screen.co"BORDER="1"><TR><THVALIGN="TOP"><PRECLASS="calloutlist"><ACLASS="co"HREF="ch14_11.htm"TITLE="14.11 Finding (Anyone's) Home Directory, Quickly ">~</A> <ACLASS="co"HREF="ch01_05.htm"TITLE="1.5 Anyone Can Program the Shell ">chmod +x</A> &#13;</PRE></TH><TDVALIGN="TOP"><PRECLASS="screen">&#13;% <CODECLASS="userinput"><B>cat &gt;&gt; /.index/printinfo.fmt#! /bin/shcut -f1,8,10 | sed '1i\.TS\l l l.$a\.TE' | tbl | nroff | col</B></CODE><KBDCLASS="keycap">[CTRL-d]</KBD>% <CODECLASS="userinput"><B>chmod +x ~/.index/printinfo.fmt</B></CODE>% <CODECLASS="userinput"><B>index -f printinfo addresses '.'</B></CODE>NAME                VOICE PHONE NUMBER   EMAIL ADDRESSHenry K Smith       617-555-1212         henry@pjaPaul S. Spencer     617-693-1111         paul@lotus.comPeter Mui           800-998-9938         peter@ora.com</PRE></TD></TR></TABLE></P><DIVCLASS="sect1info"><PCLASS="SECT1INFO">- <SPANCLASS="authorinitials">LM</SPAN></P></DIV></DIV><DIVCLASS="htmlnav"><P></P><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch48_11.htm"TITLE="48.11 The index Database Program "><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 48.11 The index Database Program "BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="book"HREF="index.htm"TITLE="UNIX Power Tools"><IMGSRC="../gifs/txthome.gif"ALT="UNIX Power Tools"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="CHAPTER"HREF="ch49_01.htm"TITLE="49. Working with Numbers"><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 49. Working with Numbers"BORDER="0"></A></TD></TR><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172">48.11 The index Database Program </TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="index"HREF="index/idx_0.htm"TITLE="Book Index"><IMGSRC="../gifs/index.gif"ALT="Book Index"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172">49. Working with Numbers</TD></TR></TABLE><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><IMGSRC="../gifs/smnavbar.gif"USEMAP="#map"BORDER="0"ALT="The UNIX CD Bookshelf Navigation"><MAPNAME="map"><AREASHAPE="RECT"COORDS="0,0,73,21"HREF="../index.htm"ALT="The UNIX CD Bookshelf"><AREASHAPE="RECT"COORDS="74,0,163,21"HREF="index.htm"ALT="UNIX Power Tools"><AREASHAPE="RECT"COORDS="164,0,257,21"HREF="../unixnut/index.htm"ALT="UNIX in a Nutshell"><AREASHAPE="RECT"COORDS="258,0,321,21"HREF="../vi/index.htm"ALT="Learning the vi Editor"><AREASHAPE="RECT"COORDS="322,0,378,21"HREF="../sedawk/index.htm"ALT="sed &amp; awk"><AREASHAPE="RECT"COORDS="379,0,438,21"HREF="../ksh/index.htm"ALT="Learning the Korn Shell"><AREASHAPE="RECT"COORDS="439,0,514,21"HREF="../lrnunix/index.htm"ALT="Learning the UNIX Operating System"></MAP></DIV></BODY></HTML>