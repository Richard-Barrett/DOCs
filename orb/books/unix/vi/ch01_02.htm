<HTML><HEAD><TITLE>[Chapter 1] 1.2 Quitting Without Saving Edits </TITLE><METANAME="DC.title"CONTENT="Learning the vi Editor"><METANAME="DC.creator"CONTENT="Linda Lamb"><METANAME="DC.publisher"CONTENT="O'Reilly &amp; Associates, Inc."><METANAME="DC.date"CONTENT="1998-08-03T20:48:10Z"><METANAME="DC.type"CONTENT="Text.Monograph"><METANAME="DC.format"CONTENT="text/html"SCHEME="MIME"><METANAME="DC.source"CONTENT="0-937175-67-6"SCHEME="ISBN"><METANAME="DC.language"CONTENT="en-US"><METANAME="generator"CONTENT="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><LINKREV="made"HREF="mailto:online-books@oreilly.com"TITLE="Online Books Comments"><LINKREL="up"HREF="ch01_01.htm"TITLE="1. The vi Text Editor"><LINKREL="prev"HREF="ch01_01.htm"TITLE="1.1 Opening and Closing Files"><LINKREL="next"HREF="ch02_01.htm"TITLE="2. Simple Editing "></HEAD><BODYBGCOLOR="#FFFFFF"TEXT="#000000"><DIVCLASS="htmlnav"><H1><IMGSRC="gifs/smbanner.gif"ALT="Learning the vi Editor"USEMAP="#srchmap"BORDER="0"></H1><MAPNAME="srchmap"><AREASHAPE="RECT"COORDS="0,0,466,65"HREF="index.htm"ALT="Learning the vi Editor"><AREASHAPE="RECT"COORDS="467,0,514,18"HREF="../search/vsrch.htm"ALT="Search this book"></MAP><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch01_01.htm"TITLE="1.1 Opening and Closing Files"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 1.1 Opening and Closing Files"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><B><FONTFACE="ARIEL,HELVETICA,HELV,SANSERIF"SIZE="-1">Chapter 1<BR>The vi Text Editor</FONT></B></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="CHAPTER"HREF="ch02_01.htm"TITLE="2. Simple Editing "><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 2. Simple Editing "BORDER="0"></A></TD></TR></TABLE>&nbsp;<HRALIGN="LEFT"WIDTH="515"TITLE="footer"></DIV><DIVCLASS="SECT1"><H2CLASS="sect1"><ACLASS="title"NAME="VI6-CH-1-SECT-2">1.2 Quitting Without Saving Edits </A></H2><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-545"></A><ACLASS="indexterm"NAME="AUTOID-548"></A><ACLASS="indexterm"NAME="AUTOID-551"></A>When you are first learning <EMCLASS="emphasis">vi</EM>, especially if you are an intrepid experimenter, there are two other <EMCLASS="emphasis">ex</EM> commands that are handy for getting out ofany mess that you might create.</P><PCLASS="para">What if you want to wipe out all of the edits you have made ina session and then return to the original file?  The command:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen"><CODECLASS="literal">:e!</CODE> <KBDCLASS="keycap">[RETURN]</KBD></PRE></BLOCKQUOTE></P><PCLASS="para">returns you to the last saved version of the file, so you can start over. </P><PCLASS="para">Suppose, however, that you want to wipe out your edits and thenjust quit <EMCLASS="emphasis">vi</EM>?<ACLASS="indexterm"NAME="AUTOID-564"></A><ACLASS="indexterm"NAME="AUTOID-568"></A><ACLASS="indexterm"NAME="AUTOID-571"></A>The command:</P><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen"><CODECLASS="literal">:q!</CODE> <KBDCLASS="keycap">[RETURN]</KBD></PRE></BLOCKQUOTE></P><PCLASS="para">quits the file you're editing and returns you to the UNIX prompt.With both of these commands, you lose all edits made in thebuffer since the last time you saved the file.<EMCLASS="emphasis">vi</EM> normally won't let you throw away your edits.  Theexclamation point added to the <CODECLASS="literal">:e</CODE> or <CODECLASS="literal">:q</CODE> command causes<EMCLASS="emphasis">vi</EM> to override this prohibition, performing the operation eventhough the buffer has been modified.</P><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="VI6-CH-1-SECT-2.1">1.2.1 Problems Saving Files </A></H3><PCLASS="para"><ACLASS="indexterm"NAME="AUTOID-586"></A><ACLASS="indexterm"NAME="AUTOID-589"></A><ACLASS="indexterm"NAME="AUTOID-593"></A></P><DLCLASS="variablelist"><DTCLASS="term"><EMCLASS="emphasis">You try to write your file, but you get one of the following messages:</EM></DT><DDCLASS="listitem"><PCLASS="para"><BLOCKQUOTECLASS="screen"><PRECLASS="screen">File existsFile <EMCLASS="emphasis">file</EM> exists - use w![Existing file]File is read only</PRE></BLOCKQUOTE></P><PCLASS="para">Type <CODECLASS="literal">:w!</CODE> <EMCLASS="emphasis">file</EM> to overwrite the existing file, or type<CODECLASS="literal">:w</CODE><EMCLASS="emphasis"> newfile</EM> to save the edited version in a new file.</P></DD><DTCLASS="term"><EMCLASS="emphasis">You want to write a file, but you don't have write permission forit.  You get the message &quot;Permission denied.&quot;</EM></DT><DDCLASS="listitem"><PCLASS="para">Use <CODECLASS="literal">:w</CODE> <EMCLASS="emphasis">newfile</EM> to write out the buffer into a new file.If you have write permission for the directory, you can use <CODECLASS="literal">mv</CODE> to replace the original version with your copy of it.If you don't have write permission for the directory,type <CODECLASS="literal">:w</CODE> <EMCLASS="emphasis">pathname/file</EM> towrite out the buffer to a directory in which you do have writepermission (such as your home directory).</P></DD><DTCLASS="term"><EMCLASS="emphasis">You try to write your file, but you get a message telling you that the file system is full.</EM></DT><DDCLASS="listitem"><PCLASS="para">Type <CODECLASS="literal">:!rm</CODE> <EMCLASS="emphasis">junkfile</EM> to delete a (large) unneeded file and free some space.(Starting an <EMCLASS="emphasis">ex</EM> command with an exclamation point gives you access to UNIX.)Or type <CODECLASS="literal">:!df</CODE> to see whether there's any space on another file system.If there is, choose a directory on that file system and write yourfile to it with <CODECLASS="literal">:w</CODE> <EMCLASS="emphasis">pathname</EM>.(<CODECLASS="literal">df</CODE> is the UNIX command to check a <EMCLASS="emphasis">d</EM>isk's <EMCLASS="emphasis">f</EM>ree space.)</P></DD><DTCLASS="term"><EMCLASS="emphasis">The system puts you into open mode and tells you that thefile system is full.</EM></DT><DDCLASS="listitem"><PCLASS="para">The disk with <EMCLASS="emphasis">vi</EM>'s temporary files is filled up.Type<CODECLASS="literal">:!ls</CODE>\ <CODECLASS="literal">/tmp</CODE> to see whether there are any files you can remove togain some disk space.If there are, create a temporary UNIX shell from which you can remove files or issueother UNIX commands.  You can create a shell by typing <CODECLASS="literal">:sh</CODE>;type<KBDCLASS="keycap">[CTRL-D]</KBD> or <CODECLASS="literal">exit</CODE> to terminate the shell and return to <EMCLASS="emphasis">vi</EM>.  (Ona Berkeley UNIX system, you can simply type<KBDCLASS="keycap">[CTRL-Z]</KBD> to suspend <EMCLASS="emphasis">vi</EM> and return to the UNIX prompt; type <CODECLASS="literal">%</CODE> to return to<EMCLASS="emphasis">vi</EM>.)Once you've freed up some space, write your file with <CODECLASS="literal">:w!</CODE>. </P></DD><DTCLASS="term"><EMCLASS="emphasis">You try to write your file, but you get a message telling you that yourdisk quota has been reached.</EM></DT><DDCLASS="listitem"><PCLASS="para">Try to force the system to save your buffer with the <EMCLASS="emphasis">ex</EM> command<CODECLASS="literal">:pre</CODE> (short for <CODECLASS="literal">:preserve</CODE>).If that doesn't work, look for some files to remove.Use <CODECLASS="literal">:sh</CODE> (or<KBDCLASS="keycap">[CTRL-Z]</KBD> if you are using a Berkeley system) to move out of <EMCLASS="emphasis">vi</EM> and removefiles.Use <KBDCLASS="keycap">[CTRL-D]</KBD> (or <CODECLASS="literal">%</CODE>) to return to <EMCLASS="emphasis">vi</EM> when you're done.Then write your file with <CODECLASS="literal">:w!</CODE>.</P></DD></DL></DIV><DIVCLASS="sect2"><H3CLASS="sect2"><ACLASS="title"NAME="AUTOID-665">1.2.2 Exercises</A></H3><PCLASS="para">The only way to learn <EMCLASS="emphasis">vi</EM> is to practice.  You now know enough to create a new file and to return to theUNIX prompt.Create a file called <EMCLASS="emphasis">practice</EM>, insert some text, and thensave and quit the file.<TABLECLASS="informaltable"><TBODYCLASS="tbody"><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><EMCLASS="emphasis">Open a file called practice in the current directory</EM> </P></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><PCLASS="para"><CODECLASS="literal">vi practice</CODE></P></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><EMCLASS="emphasis">Insert text</EM></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><CODECLASS="literal">i<CODECLASS="replaceable"><I> any text you like</I></CODE></CODE></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><EMCLASS="emphasis">Return to command mode</EM></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><KBDCLASS="keycap">[ESC]</KBD></TD></TR><TRCLASS="row"VALIGN="TOP"><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><EMCLASS="emphasis">Quit </EM>vi<EMCLASS="emphasis">, saving edits</EM></TD><TDCLASS="entry"ROWSPAN="1"COLSPAN="1"><CODECLASS="literal">ZZ</CODE></TD></TR></TBODY></TABLE><ACLASS="indexterm"NAME="AUTOID-697"></A></P></DIV></DIV><DIVCLASS="htmlnav"><P></P><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><TABLEWIDTH="515"BORDER="0"CELLSPACING="0"CELLPADDING="0"><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172"><ACLASS="SECT1"HREF="ch01_01.htm"TITLE="1.1 Opening and Closing Files"><IMGSRC="../gifs/txtpreva.gif"ALT="Previous: 1.1 Opening and Closing Files"BORDER="0"></A></TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="book"HREF="index.htm"TITLE="Learning the vi Editor"><IMGSRC="../gifs/txthome.gif"ALT="Learning the vi Editor"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172"><ACLASS="CHAPTER"HREF="ch02_01.htm"TITLE="2. Simple Editing "><IMGSRC="../gifs/txtnexta.gif"ALT="Next: 2. Simple Editing "BORDER="0"></A></TD></TR><TR><TDALIGN="LEFT"VALIGN="TOP"WIDTH="172">1.1 Opening and Closing Files</TD><TDALIGN="CENTER"VALIGN="TOP"WIDTH="171"><ACLASS="index"HREF="index/idx_a.htm"TITLE="Book Index"><IMGSRC="../gifs/index.gif"ALT="Book Index"BORDER="0"></A></TD><TDALIGN="RIGHT"VALIGN="TOP"WIDTH="172">2. Simple Editing </TD></TR></TABLE><HRALIGN="LEFT"WIDTH="515"TITLE="footer"><IMGSRC="../gifs/smnavbar.gif"USEMAP="#map"BORDER="0"ALT="The UNIX CD Bookshelf Navigation"><MAPNAME="map"><AREASHAPE="RECT"COORDS="0,0,73,21"HREF="../index.htm"ALT="The UNIX CD Bookshelf"><AREASHAPE="RECT"COORDS="74,0,163,21"HREF="../upt/index.htm"ALT="UNIX Power Tools"><AREASHAPE="RECT"COORDS="164,0,257,21"HREF="../unixnut/index.htm"ALT="UNIX in a Nutshell"><AREASHAPE="RECT"COORDS="258,0,321,21"HREF="index.htm"ALT="Learning the vi Editor"><AREASHAPE="RECT"COORDS="322,0,378,21"HREF="../sedawk/index.htm"ALT="sed &amp; awk"><AREASHAPE="RECT"COORDS="379,0,438,21"HREF="../ksh/index.htm"ALT="Learning the Korn Shell"><AREASHAPE="RECT"COORDS="439,0,514,21"HREF="../lrnunix/index.htm"ALT="Learning the UNIX Operating System"></MAP></DIV></BODY></HTML>