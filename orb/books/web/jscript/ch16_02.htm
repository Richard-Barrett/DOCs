<!DOCTYPE HTML PUBLIC "-//ORA//DTD CD HTML 3.2//EN"><HTML><HEAD><TITLE>[Chapter 16] 16.2 Off-Screen Images and Caching</TITLE><META NAME="author" CONTENT="David Flanagan"><META NAME="date" CONTENT="Wed Apr 23 18:20:46 1997"><META NAME="form" CONTENT="html"><META NAME="metadata" CONTENT="dublincore.0.1"><META NAME="objecttype" CONTENT="book part"><META NAME="otheragent" CONTENT="gmat dbtohtml"><META NAME="publisher" CONTENT="O'Reilly &amp; Associates, Inc."><META NAME="source" CONTENT="SGML"><META NAME="subject" CONTENT="JavaScript"><META NAME="title" CONTENT="JavaScript: The Definitive Guide"><!-- JavaScript: pathcont.js --></HEAD><BODY BGCOLOR="#FFFFFF"><DIV CLASS=htmlnav><H1><IMG SRC="gifs/smbanner.gif" ALT="Javascript: The Definitive Guide"></H1><table width=515 border=0 cellpadding=0 cellspacing=0><tr><td width=172 align=left valign=top><A HREF="ch16_01.htm"><IMG SRC="gifs/txtpreva.gif" ALT="Previous" border=0></A></td><td width=171 align=center valign=top><b>Chapter 16</b></td><td width=172 align=right valign=top><A HREF="ch16_03.htm"><IMG SRC="gifs/txtnexta.gif" ALT="Next" border=0></A></td></tr></table><!-- JavaScript: prev.js -->&nbsp;<!-- JavaScript: next.js --><hr align=left width=515></DIV><DIV CLASS=sect1><h2 CLASS=sect1><A CLASS="TITLE" NAME="ch16-SECT1-AUTOID.2">16.2 Off-Screen Images and Caching</A></h2><P CLASS=para>      To force an image to be cached, we create an off-screen image and      load the desired image into it. Then, when the image is required      on-screen, we know it will be quickly loaded from the cache      rather than slowly loaded over the network.      <A HREF="ch16_02.htm#JSCRIPT-CH-IMAGES-EX-1">Example 16-1</A> shows code that      performs a simple animation using this technique.    <DIV CLASS=example><h4 CLASS=example><A CLASS="TITLE" NAME="JSCRIPT-CH-IMAGES-EX-1">Example 16-1: An Animation Using Image Replacement</A></h4><DIV CLASS=programlisting><P><PRE>&lt;!--<tt CLASS=replaceable><i> The image that will be animated. Give it a name for convenience </i></tt>--&gt;&lt;IMG SRC="images/0.gif" NAME=animation&gt;&lt;SCRIPT&gt;//<tt CLASS=replaceable><i> Create a bunch of off-screen images, and get them started </i></tt>//<tt CLASS=replaceable><i> loading the images we're going to animate.</i></tt>images = new Array(10);for(var i = 0; i &lt; 10; i++) {    images[i] = new Image();                 //<tt CLASS=replaceable><i> Create an Image object</i></tt>    images[i].src = "images/" + i + ".gif";  //<tt CLASS=replaceable><i> tell it what URL to load</i></tt>}//<tt CLASS=replaceable><i> Later, when we want to perform our animation, we can use these URLs,</i></tt>//<tt CLASS=replaceable><i> knowing that they've been loaded into the cache. Note that we perform</i></tt>//<tt CLASS=replaceable><i> the animation by assigning the URL, not the Image object itself.</i></tt>//<tt CLASS=replaceable><i> Also note that we call the image by name, rather than as document.images[0].</i></tt>function animate(){    document.animation.src = images[frame].src;    frame = (frame + 1)%10;    timeout_id = setTimeout("animate()", 250);  //<tt CLASS=replaceable><i> display next frame later</i></tt>}var frame = 0;         //<tt CLASS=replaceable><i> Keep track of what frame of the animation we're on.</i></tt>var timeout_id = null; //<tt CLASS=replaceable><i> This allows us to stop the animation.</i></tt>&lt;/SCRIPT&gt;&lt;FORM&gt;                   &lt;!--<tt CLASS=replaceable><i> Buttons to control the animation </i></tt>--&gt;  &lt;INPUT TYPE=button VALUE="Start"          onClick="if (timeout_id == null) animate()"&gt;  &lt;INPUT TYPE=button VALUE="Stop"          onClick="if (timeout_id) clearTimeout(timeout_id); timeout_id=null;"&gt;&lt;/FORM&gt;</PRE></DIV></DIV><P CLASS=para>      <A HREF="ch16_02.htm#JSCRIPT-CH-IMAGES-EX-1">Example 16-1</A> demonstrates the important      steps involved in creating an off-screen image for image caching.      The first step is to create an Image object with the      <tt CLASS=literal>Image()</tt> constructor. The second step is to      assign the URL of the desired image to the <tt CLASS=literal>src</tt>      property of the newly created Image object. Doing so will cause      the browser to start loading the contents of the specified URL,      which, unless caching is turned off, will cause the image to be      loaded into the cache, even though it is not displayed anywhere.    <P CLASS=para>      A confusing detail about the use of off-screen Image objects is      that they are not themselves directly used for anything. To      perform image replacement with an off-screen Image object, you do      <I CLASS=emphasis>not</I> assign the Image object directly into the      <tt CLASS=literal>images[]</tt> array of the Document object.      Instead, you simply set the <tt CLASS=literal>src</tt> property of the      desired on-screen image to the URL of the desired image. If this      URL has previously been loaded by an off-screen image, then the      the desired image should be in the cache and the on-screen image      replacement will happen quickly. The off-screen image object is      used to force the image to be loaded, but there isn't anything      else that you can do with it.    </DIV><DIV CLASS=htmlnav><P><HR align=left width=515><table width=515 border=0 cellpadding=0 cellspacing=0><tr><td width=172 align=left valign=top><A HREF="ch16_01.htm"><IMG SRC="gifs/txtpreva.gif" ALT="Previous" border=0></A></td><td width=171 align=center valign=top><a href="index.htm"><IMG SRC="gifs/txthome.gif" ALT="Home" border=0></a></td><td width=172 align=right valign=top><A HREF="ch16_03.htm"><IMG SRC="gifs/txtnexta.gif" ALT="Next" border=0></A></td></tr><tr><td width=172 align=left valign=top>Image Replacement with the Image.src Property</td><td width=171 align=center valign=top><a href="index/idx_0.htm">Book Index</a></td><td width=172 align=right valign=top>Image Event Handlers</td></tr></table><!-- JavaScript: prev.js -->&nbsp;<!-- JavaScript: next.js --></DIV></BODY></HTML>