<!DOCTYPE HTML PUBLIC "-//ORA//DTD CD HTML 3.2//EN"><HTML><HEAD><TITLE>[Chapter 24] 24.7 Access Control Configuration</TITLE><META NAME="author" CONTENT="Stephen Spainhour and Valerie Quercia"><META NAME="date" CONTENT="Mon Mar 17 14:42:58 1997"><META NAME="form" CONTENT="html"><META NAME="metadata" CONTENT="dublincore.0.1"><META NAME="objecttype" CONTENT="book part"><META NAME="otheragent" CONTENT="gmat dbtohtml"><META NAME="publisher" CONTENT="O'Reilly &amp; Associates, Inc."><META NAME="source" CONTENT="SGML"><META NAME="subject" CONTENT="Webmaster in a Nutshell"><META NAME="title" CONTENT="Webmaster in a Nutshell"><!-- JavaScript: pathcont.js --></HEAD><BODY BGCOLOR="#FFFFFF"><DIV CLASS=htmlnav><H1><IMG SRC="gifs/smbanner.gif" ALT="Webmaster in a Nutshell"></H1><table width=515 border=0 cellpadding=0 cellspacing=0><tr><td width=172 align=left valign=top><A HREF="ch24_06.htm"><IMG SRC="gifs/txtpreva.gif" ALT="Previous" border=0></A></td><td width=171 align=center valign=top><b>Chapter 24</b></td><td width=172 align=right valign=top><A HREF="ch25_01.htm"><IMG SRC="gifs/txtnexta.gif" ALT="Next" border=0></A></td></tr></table><!-- JavaScript: prev.js -->&nbsp;<!-- JavaScript: next.js --><hr align=left width=515></DIV><DIV CLASS=sect1><h2 CLASS=sect1><A CLASS="TITLE" NAME="WEB-CH-24-SECT-7">24.7 Access Control Configuration</A></h2><P CLASS=para>The access control scheme used by the CERN server is a bitconfusing, but it allows you to set control access to eitherdirectories or specific files based on the client's host and/orusername/password authentication.<P CLASS=para>The access control scheme begins in the <I CLASS=emphasis>httpd.conf</I> filewith the <tt CLASS=literal>Protect</tt> directive. This directive specifiesa directory or group of directories to protect, and associatesthem with a specific <I CLASS=emphasis>protection setup file</I>. The protectionsetup file specifies valid authentication schemes, the password and group files to be used for authentication, and, optionally,user, group, and host access controls for all documents in theprotected tree.<P CLASS=para>When a request for a document in a protected directory is received,the server looks for a file in the directory named <I CLASS=emphasis>.www_acl</I>.This is the <I CLASS=emphasis>access control list</I> file (ACL). It designateswhich files in the directory may be accessed, with what methods,and by whom. It uses the password and group files and masksspecified in its associated protection setup file to carryout access authorization.<DIV CLASS=sect2><h3 CLASS=sect2><A CLASS="TITLE" NAME="WEB-CH-24-SECT-7.1">Password File</A></h3><P CLASS=para>Password files contain valid usernames and encrypted passwords foruser authentication on your server. They can be created withthe <I CLASS=emphasis>adm</I> program that comes with your server software.<P CLASS=para>Password files are similar to the UNIX password files, but thereis no correlation between valid users for your server and registeredusers on the UNIX machine.</DIV><DIV CLASS=sect2><h3 CLASS=sect2><A CLASS="TITLE" NAME="WEB-CH-24-SECT-7.2">Group File</A></h3><P CLASS=para>The group file lists the valid groups and their members for usewith access control to your system. Group members can be declaredby username, previously defined group names, and host address templates.Each group declaration looks like this:<P CLASS=para><DIV CLASS=screen><P><PRE><I CLASS=emphasis>groupname</I>: <I CLASS=emphasis>item1</I>, <I CLASS=emphasis>item2</I> ...</PRE></DIV><P CLASS=para>Each item uses <I CLASS=emphasis>group definition syntax</I> to declare membersof the group. With this syntax, each item may be specified as:<P><UL CLASS=itemizedlist><li CLASS=listitem>A single username<P><li CLASS=listitem>A group name that has already been defined in the same group file<P><li CLASS=listitem>A comma-separated list of usernames and group names surrounded byparentheses<P><li CLASS=listitem>Any of the above followed by an @sign and an IP-address template<P><li CLASS=listitem>Any of the above followed by an @sign and a comma-separated listof IP-address templates in parentheses<P></UL><P CLASS=para>IP-address templates not attached to user or group names meanthat all users from the specified IP are valid group members.When attached to users or groups, users are only valid fromthose IPs. Users and groups with no attached IP template arevalid from any IP.<P CLASS=para>IP-address templates are IP addresses that may use a wildcard (<tt CLASS=literal>*</tt>)for any part of the address for subnet restriction.<P CLASS=para>Here is a sample group file:<P CLASS=para><DIV CLASS=screen><P><PRE>humans: mike, joelbots: servo, crow, gypsy, cambotmads: forrester, frank@198.112.*.*, pearlcrew: humans, bots, @198.112.108.*deep13: mads, larry@198.113.*.*,        (gerry, sylvia)@198.114.*.*mst3k: crew, deep13, (glenn, jperkins, janpan)@(198.*.*.*, 36.108.*.*)</PRE></DIV><P CLASS=para>Group definitions can be broken across a line following a comma inthe definition list.<P CLASS=para>The group definition syntax described here is also used for<tt CLASS=literal>GetMask</tt> lines in protection setup files and forthe last field of ACL entries.<P CLASS=para>Additionally, there are two predefined group names that canbe used in those areas. They are:<P><DL CLASS=variablelist><DT CLASS=varlistentry><tt CLASS=literal>All</tt><DD><P CLASS=para>All users that have an entry in the password file. <tt CLASS=literal>Users</tt>is equivalent.<p><DT CLASS=varlistentry><tt CLASS=literal>Anybody</tt><DD><P CLASS=para>No restrictions are placed on access; all users are allowedwithout authorization. <tt CLASS=literal>Anonymous</tt> and <tt CLASS=literal>Anyone</tt>are equivalent.</DL></DIV><DIV CLASS=sect2><h3 CLASS=sect2><A CLASS="TITLE" NAME="WEB-CH-24-SECT-7.3">Protection Setup File</A></h3><P CLASS=para>A protection setup file is required for each protected directoryor tree designated by the <tt CLASS=literal>Protect</tt> directive in <I CLASS=emphasis>httpd.conf</I>.The <tt CLASS=literal>Protect</tt> directive specifies the pathname of theprotection setup file that its directories will use.Here is a sample protection setup file:<P CLASS=para><DIV CLASS=screen><P><PRE>AuthType      BasicServerId      SatelliteOfLovePasswordFile  /WWW/Admin/passwdGroupFile     /WWW/Admin/groupGetMask       AllACLOverRide    On</PRE></DIV><P CLASS=para>The <tt CLASS=literal>GetMask</tt> directive is optional. All other directivesmust be included.<DIV CLASS=sect3><h4 CLASS=sect3><A CLASS="TITLE" NAME="WEB-CH-24-SECT-7.4">AuthType</A></h4><P CLASS=para><tt CLASS=literal>AuthType</tt> <I CLASS=emphasis>type</I>  <P CLASS=para>Indicates the type of authentication to use. <tt CLASS=literal>Basic</tt> is most common. Other methods may be used if the server supports them.</DIV><DIV CLASS=sect3><h4 CLASS=sect3><A CLASS="TITLE" NAME="WEB-CH-24-SECT-7.5">ServerId</A></h4><P CLASS=para><tt CLASS=literal>ServerId</tt> <I CLASS=emphasis>name</I>  <P CLASS=para>This directive does not need to specify the server's actual machine name.It can be any string and is used to inform the client whatpassword file it is using (in case the user has multipleusernames on different parts of the server).</DIV><DIV CLASS=sect3><h4 CLASS=sect3><A CLASS="TITLE" NAME="WEB-CH-24-SECT-7.6">PasswordFile</A></h4><P CLASS=para><tt CLASS=literal>PasswordFile</tt> <I CLASS=emphasis>filename</I>  <P CLASS=para>Specifies the absolute pathname of the password file.</DIV><DIV CLASS=sect3><h4 CLASS=sect3><A CLASS="TITLE" NAME="WEB-CH-24-SECT-7.7">GroupFile</A></h4><P CLASS=para><tt CLASS=literal>GroupFile</tt> <I CLASS=emphasis>filename</I>  <P CLASS=para>This directive specifies the absolute pathname of the group file.</DIV><DIV CLASS=sect3><h4 CLASS=sect3><A CLASS="TITLE" NAME="WEB-CH-24-SECT-7.8">GetMask</A></h4><P CLASS=para><tt CLASS=literal>GetMask</tt> <I CLASS=emphasis>list</I>  <P CLASS=para>If you want to set general restrictions on all the documents ina protected directory tree, you can set them in the protectionsetup file with <tt CLASS=literal>GetMask</tt>. You can specify allowed users,groups, or IP addresses with the group definition syntax. Thisdirective is optional. </DIV><DIV CLASS=sect3><h4 CLASS=sect3><A CLASS="TITLE" NAME="WEB-CH-24-SECT-7.9">ACLOverRide</A></h4><P CLASS=para><tt CLASS=literal>ACLOverRide</tt> On|Off  <P CLASS=para>Protection setups files normally do not allow any access outside of whatis set in a <tt CLASS=literal>GetMask</tt> directive. To override the <tt CLASS=literal>GetMask</tt>rules, you can set <tt CLASS=literal>ACLOverRide</tt> to <tt CLASS=literal>On</tt>. The defaultis no overrides by the ACL.</DIV></DIV><DIV CLASS=sect2><h3 CLASS=sect2><A CLASS="TITLE" NAME="WEB-CH-24-SECT-7.10">Access Control List File</A></h3><P CLASS=para>To control per-file access in a protected directory, you needan access control list file (ACL) named <I CLASS=emphasis>.www_acl</I> inthat directory. Each directory in a protected tree needs itsown <I CLASS=emphasis>.www_acl</I> for file-level access control. In fact, youcannot have a <I CLASS=emphasis>.www_acl</I> file in a directory that is notdesignated in a <tt CLASS=literal>Protect</tt> directive in the configurationfile.<P CLASS=para>Each line of an ACL looks like this:<P CLASS=para><DIV CLASS=screen><P><PRE><I CLASS=emphasis>file</I> : <I CLASS=emphasis>methods</I> : <I CLASS=emphasis>groups</I></PRE></DIV><P CLASS=para>The first field contains the name of the file to be controlled.It can match a filename exactly or use the wildcard (<tt CLASS=literal>*</tt>)to designate a group of files.<P CLASS=para>The second field lists the request methods allowed on thefile. You can specify <tt CLASS=literal>GET</tt>, or <tt CLASS=literal>POST</tt>, or bothwith <tt CLASS=literal>GET,POST</tt> .<P CLASS=para>The last field lists the users that are allowed access to the file. You can use users listed in the password file,groups listed in the group file, or IP-address templates.Each item should be separated by a comma. Group definitionsyntax can be used in this field.<P CLASS=para>Here is a sample <I CLASS=emphasis>.www_acl</I> file:<P CLASS=para><DIV CLASS=screen><P><PRE>*.html : GET : mst3k,torgocgi-*.pl : GET,POST : crew,madssecret*.html : GET : bots,frank</PRE></DIV><P CLASS=para>There is no order to rules matching here. In the example, user<tt CLASS=literal>torgo</tt>, who is not a member of the <tt CLASS=literal>bots</tt> or<tt CLASS=literal>mst3k</tt> groups, is allowed to access the "secret" files.</DIV><DIV CLASS=sect2><h3 CLASS=sect2><A CLASS="TITLE" NAME="WEB-CH-24-SECT-7.11">Access Configuration Directives</A></h3><DIV CLASS=sect3><h4 CLASS=sect3><A CLASS="TITLE" NAME="WEB-CH-24-SECT-7.12">Protect <I CLASS=emphasis>expression setup_file uid.gid</I></A></h4><P CLASS=para><tt CLASS=literal>Protect </tt><I CLASS=emphasis>expression setup_file uid.gid</I><P CLASS=para>In the server configuration file (<I CLASS=emphasis>httpd.conf</I>&nbsp;), the<tt CLASS=literal>Protect</tt> directive specifies a set of directoriesto be protected and gives the name of the protection setupfile to be used for access control in those directories.The directive looks like this:<P CLASS=para><DIV CLASS=screen><P><PRE>Protect /WWW/mst3k/* /WWW/Admin/httpd.setup</PRE></DIV><P CLASS=para>This sets access control for all directories under <I CLASS=emphasis>/WWW/mst3k</I>.The directory names must be an absolute pathname, and mayuse the wildcard character (<tt CLASS=literal>*</tt>). An optional third argumentcan specify the user and group name (separated by a period)of the protected directory's owner, if the permissions aredifferent from the server daemon's. For example:<P CLASS=para><DIV CLASS=screen><P><PRE>Protect /WWW/mst3k/* /WWW/Admin/httpd.setup cambot.mst</PRE></DIV><P CLASS=para>User <tt CLASS=literal>cambot</tt> in group <tt CLASS=literal>mst</tt> owns the directories.</DIV><DIV CLASS=sect3><h4 CLASS=sect3><A CLASS="TITLE" NAME="WEB-CH-24-SECT-7.13">Protection</A></h4><P CLASS=para><tt CLASS=literal>Protection</tt> <I CLASS=emphasis>name</I>  <P CLASS=para>Beginning with version 3.0, the protection setup file information can be included in the server configuration file instead ofin an outside file. You use the <tt CLASS=literal>Protection</tt> directivefor this, and syntax looks like:<P CLASS=para><DIV CLASS=screen><P><PRE>Protection <I CLASS=emphasis>name</I> {    <I CLASS=emphasis>protection</I>    <I CLASS=emphasis>setup</I>    <I CLASS=emphasis>info</I>}</PRE></DIV><P CLASS=para>A <tt CLASS=literal>Protect</tt> directive can then use the name of the<tt CLASS=literal>Protection</tt> directive to specify its protectionsetup information.<P CLASS=para>You can save a step in the process by simply tacking theprotection setup section onto the <tt CLASS=literal>Protect</tt> directivewhere you would normally name the setup file. For example:<P CLASS=para><DIV CLASS=screen><P><PRE>Protect /WWW/mst3k/* {    UserId        cambot    GroupId       mst    AuthType      Basic    ServerId      SatelliteOfLove    PasswordFile  /WWW/Admin/passwd    GroupFile     /WWW/Admin/group    GetMask       all}</PRE></DIV><P CLASS=para>Each <tt CLASS=literal>Protection</tt> section uses the same directives usedin a regular setup file. Two additional directivescan be used here to specify the user and group idsof a protected directory when they differ from thoseof the server daemon: <tt CLASS=literal>UserId</tt> and <tt CLASS=literal>GroupId</tt>.</DIV><DIV CLASS=sect3><h4 CLASS=sect3><A CLASS="TITLE" NAME="WEB-CH-24-SECT-7.14">UserId</A></h4><P CLASS=para><tt CLASS=literal>UserId</tt> <I CLASS=emphasis>user</I>  <P CLASS=para>Specifies the user name of the directory owner.</DIV><DIV CLASS=sect3><h4 CLASS=sect3><A CLASS="TITLE" NAME="WEB-CH-24-SECT-7.15">GroupId</A></h4><P CLASS=para><tt CLASS=literal>GroupId</tt> <I CLASS=emphasis>group</I>  <P CLASS=para>Specifies the group name of the directory owner.</DIV></DIV></DIV><DIV CLASS=htmlnav><P><HR align=left width=515><table width=515 border=0 cellpadding=0 cellspacing=0><tr><td width=172 align=left valign=top><A HREF="ch24_06.htm"><IMG SRC="gifs/txtpreva.gif" ALT="Previous" border=0></A></td><td width=171 align=center valign=top><a href="index.htm"><IMG SRC="gifs/txthome.gif" ALT="Home" border=0></a></td><td width=172 align=right valign=top><A HREF="ch25_01.htm"><IMG SRC="gifs/txtnexta.gif" ALT="Next" border=0></A></td></tr><tr><td width=172 align=left valign=top>Directory Indexing</td><td width=171 align=center valign=top><a href="index/idx_0.htm">Book Index</a></td><td width=172 align=right valign=top>Netscape Server Configuration</td></tr></table><!-- JavaScript: prev.js -->&nbsp;<!-- JavaScript: next.js --></DIV></BODY></HTML>